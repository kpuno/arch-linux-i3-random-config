define("InsightsExtension/Client/Alerts/Constants",["require","exports","Alerts/ClientResources/AlertsResources"],function(n,t,i){"use strict";return function(){function n(){}return n.SubscriptionTypes={artemisSubscription:"CSP_2015-05-01"},n.DataUris={getAlertsSummary:"/api/Insights/GetAlertsSummary",getAlerts:"/api/Insights/GetAlerts",getAlertRule:"/api/Insights/GetAlertRule",createOrUpdateAlertRule:"/api/Insights/CreateOrUpdateAlertRule",deleteAlertRule:"/api/Insights/DeleteAlertRule",isAlertNameExisting:"/api/Insights/IsAlertNameExisting"},n.Validations={ruleDescriptionMaxLength:128,ruleThresholdRegEx:"(^\\d+(\\.\\d{1,3})?$)|(^\\.d{1,3}?$)",ruleAdditionalEmailsRegEx:"^([a-zA-Z0-9.!#$%&'*+-/=?^_`{|}~]+@(?!.*\\.\\..*)[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4})?$|^([a-zA-Z0-9.!#$%&'*+-/=?^_`{|}~]+@(?!.*\\.\\..*)[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4})(;[a-zA-Z0-9.!#$%&'*+-/=?^_`{|}~]+@(?!.*\\.\\..*)[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4})+$",ruleWebHookUrlRegEx:"(^(([Hh][Tt][Tt][Pp][Ss]?:)(///?)([w]*(?::[w]*)?@)?(([dw.-]+)(?::(d+))?)?)([/\\w.()-]*)?(?:([?][^#]*)?(#.*)?).*$)|^$"},
n.NotificationEventSource={AddAlert:"AddAlertRule",SaveAlert:"SaveAlertRule",EnableAlert:"EnableAlertRule",DisableAlert:"DisableAlertRule",DeleteAlert:"DeleteAlertRule"},n.AlertEditBlades={MetricBlade:"MetricAlertEditBlade",EventBlade:"EventAlertEditBlade"},n.AppInsightsBlades={WebTestAssetBlade:"WebTestAssetBlade",ProactiveDiagnosticsBlade:"ProactiveAlertEditBlade"},n.AppInsightsAdvancedAlerts={ProactiveDiagnosticsMetricId:"advanced::A3108E3D-5E26-44CF-B232-783F5E20EF10"},n.Extensions={AppInsights:"AppInsightsExtension"},n.UriTemplate={resourceGroup:"/subscriptions/{0}/resourceGroups/{1}",alertRule:"/subscriptions/{0}/resourceGroups/{1}/providers/microsoft.insights/alertrules/{2}"},n.PermissionDefinition={alertRuleWrite:"microsoft.insights/alertrules/write",alertRuleRead:"microsoft.insights/alertrules/read"},n.OperationNames={all:"",scaleDown:"Microsoft.Insights/autoscaleSettings/scaledown/action",scaleUp:"Microsoft.Insights/autoscaleSettings/scaleup/action",websiteStart:"microsoft.web/sites/start/action",
websiteStop:"microsoft.web/sites/stop/action",websiteDelete:"microsoft.web/sites/delete",webHostingPlanDelete:"microsoft.web/serverfarms/delete"},n.OperationStatus={failed:"failed",succeeded:"succeeded"},n.ThresholdRange={min:0,max:Math.pow(2,53)-1,precisionMetric:3,precisionEvent:-1},n.DataPointThreshold={maxNumberOfDataPointAllowed:1e3},n.SupportedOperations={website:[{text:ko.observable(i.formRuleOperationAll),value:n.OperationNames.all},{text:ko.observable(i.formRuleOperationDelete),value:n.OperationNames.websiteDelete},{text:ko.observable(i.formRuleOperationStart),value:n.OperationNames.websiteStart},{text:ko.observable(i.formRuleOperationStop),value:n.OperationNames.websiteStop}],webhostingplan:[{text:ko.observable(i.formRuleOperationAll),value:n.OperationNames.all},{text:ko.observable(i.formRuleOperationDelete),value:n.OperationNames.webHostingPlanDelete},{text:ko.observable(i.formRuleOperationScaleDown),value:n.OperationNames.scaleDown},{text:ko.observable(i.formRuleOperationScaleUp),
value:n.OperationNames.scaleUp}]},n.WebHookLearnMoreLink="http://go.microsoft.com/fwlink/?LinkId=626008",n.EmptyString="",n.targetResourceId="targetResourceId",n.automationAccountResourceId="automationAccountResourceId",n.automationRunbookName="automationRunbookName",n.webhookResourceId="webhookResourceId",n.isGlobalRunbook="isGlobalRunbook",n.isEnabled="isEnabled",n}()});define("InsightsExtension/Client/Alerts/Utilities/AuthorizationUtility",["require","exports","f","../Constants"],function(n,t,i,r){"use strict";return function(){function n(){}return n.VerifyResourceGroupWritePermissions=function(n,t,u){var f=r.UriTemplate.resourceGroup.format(n,t);i.Base.Security.hasPermission(f,[r.PermissionDefinition.alertRuleWrite]).then(function(n){n||u.unauthorized()},function(){})},n.VerifyResourceGroupReadPermissions=function(n,t,u){var f=r.UriTemplate.resourceGroup.format(n,t);i.Base.Security.hasPermission(f,[r.PermissionDefinition.alertRuleRead]).then(function(n){n||u.unauthorized()},function(
){})},n.VerifyResourceReadPermissions=function(n,t){i.Base.Security.hasPermission(n,[r.PermissionDefinition.alertRuleRead]).then(function(n){n||t.unauthorized()},function(){})},n.VerifyAlertRuleWritePermissions=function(n,t){i.Base.Security.hasPermission(n,["./write"]).then(function(n){n||t.unauthorized()},function(){})},n}()});define("InsightsExtension/Client/Metrics/Constants",["require","exports","f"],function(n,t,i){"use strict";return function(){function n(){}return n.maxMetricPointsAllowed=1e3,n.ApiVersion={mdmMetric:"2016-06-01",mdmMetricDefinitions:"2016-03-01"},n.ProviderName={microsoftClassicCompute:"Microsoft.ClassicCompute"},n.IECFormatName={bytesIECFormat:"bytesiecformat",bytesPerSecondIECFormat:"bytespersecondiecformat"},n.MetricAggregation={none:"None",average:"Average",minimum:"Minimum",maximum:"Maximum",total:"Total",last:"Last"},n.DataUris={listMetricDefinitions:"/api/Insights/ListMetricDefinitions",getMetricDefinition:"/api/Insights/GetMetricDefinition",getMetricHistory:
"/api/Insights/GetMetricHistory",getMetricHistoryCollection:"/api/Insights/GetMetricHistoryCollection",getMdmMetricDefinitions:"{baseUrl}/subscriptions/{subscription}/resourceGroups/{resourceGroup}/providers/{provider}/{type}/{resource}/providers/Microsoft.Insights/metricdefinitions?api-version={apiVersion}",getMdmMetricHistory:"{0}{1}/providers/Microsoft.Insights/metrics?api-version={2}&$filter={3}",getMdmMetricHistoryCollectionBatch:"{0}/providers/Microsoft.Insights/metrics?api-version={1}&$filter={2}"},n.MetricUnit={Percent:"Percent",Count:"Count",Seconds:"Seconds",Milliseconds:"Milliseconds",Bytes:"Bytes",BytesPerSecond:"BytesPerSecond",CountPerSecond:"CountPerSecond"},n.ChartColors={metricColors:["azc-color-g0","azc-color-h0","azc-color-i0","azc-color-a1","azc-color-b1","azc-color-c1","azc-color-d1","azc-color-e1","azc-color-f1","azc-color-g1"]},n.MetricDefinitionAggregationTypeToMetricRuleAggregationTypeMap={Average:i.ViewModels.Controls.Visualization.Chart.MetricRuleAggregationType.
AverageY,Last:i.ViewModels.Controls.Visualization.Chart.MetricRuleAggregationType.AverageY,Minimum:i.ViewModels.Controls.Visualization.Chart.MetricRuleAggregationType.MinY,Maximum:i.ViewModels.Controls.Visualization.Chart.MetricRuleAggregationType.MaxY,Total:i.ViewModels.Controls.Visualization.Chart.MetricRuleAggregationType.SumY},n.MetricHashColor=["a0","b0","c0","d0","e0","f0","g0","h0","i0","j0","a1","b1","c1","d1","e1","f1","g1","h1","i1","j1","a2","b2","c2","d2","e2","f2","g2","h2","i2","j2"],n.MetricChartColorPrefix="msportalfx-bgcolor-",n.ColorTints=["s2","t1","s1","t2"],n.ColorMapping={themeMain:"g0",themeWarning:"b0",themeError:"d0",themeSuccess:"j0"},n.MetricChartColorSchema={CpuTime:"g1",Requests:"g0",BytesReceived:"b2",BytesSent:"c2",Http2xx:"j0",Http3xx:"a1",Http401:"b1",Http403:"c1",Http404:"b0",Http406:"d1",Http4xx:"d0",Http5xx:"c0",MemoryWorkingSet:"e1",AverageMemoryWorkingSet:"e0",AverageResponseTime:"i1",CpuPercentage:"g1",MemoryPercentage:"e0",DiskQueueLength:"h1",HttpQueueLength:
"f1","Total Requests":"g0",Http400:"d0","Throttled Requests":"b0","Internal Server Error":"c0","Service Unavailable":"c1","Average Requests per Second":"h0",TotalIngress:"b2",TotalEgress:"c2",TotalRequests:"g0",TotalBillableRequests:"h2",Availability:"a0",AverageE2ELatency:"i1",Success:"j0",Capacity:"h1",cachehits:"h2",cachemisses:"d1",getcommands:"j1",setcommands:"i0",evictedkeys:"a1",expiredkeys:"b1",percentProcessorTime:"g1",usedmemory:"e0",totalcommandsprocessed:"h1",cacheWrite:"b2",cacheRead:"c2",blocked_by_firewall:"b1",deadlock:"a1",connection_failed:"d0",connection_successful:"j0",throttling:"b0",cpu_percent:"g1",physical_data_read_percent:"j1",log_write_percent:"e2",storage:"h1",dtu_consumption_percent:"h2","\\Processor(_Total)\\% Processor Time":"g1","\\Processor(_Total)\\% Interrupt Time":"d1","\\Processor(_Total)\\% Privileged Time":"a1","\\Processor(_Total)\\% User Time":"f2","\\Memory\\Committed Bytes":"e1","\\Memory\\Available Bytes":"f0","\\Memory\\% Committed Bytes In Use":
"e0","\\Process(_Total)\\% Processor Time":"g2","\\Process(_Total)\\Working Set":"e2","\\PhysicalDisk(_Total)\\Disk Read Bytes/sec":"j1","\\PhysicalDisk(_Total)\\Disk Write Bytes/sec":"i0","\\ASP.NET\\Request Wait Time":"i1","\\ASP.NET Applications(__Total__)\\Requests/Sec":"g0","\\ASP.NET Applications(__Total__)\\Errors Total/Sec":"d0","\\ASP.NET Applications(__Total__)\\Requests In Application Queue":"f1","Percentage CPU":"g1","Network In":"b2","Network Out":"c2","Disk Read Bytes/sec":"j1","Disk Write Bytes/sec":"i0",SuccessfulRuns:"j1",FailedRuns:"d0",networkBytesWrittenPerSecond:"b2",networkBytesReadPerSecond:"c2",connectedclients:"g0","Calls per Second":"h0","Errors per Second":"d0","Response Time in Seconds":"i1","External Time in Seconds":"e2",RunsStarted:"f1",RunsCompleted:"g0",RunsSucceeded:"j1",RunsFailed:"d0",RunsCancelled:"b0",RunLatency:"e2",RunSuccessLatency:"i1",RunRate:"h0",RunSuccessPercentage:"a0",RunThrottledEvents:"b1"},n.oneMinuteInSeconds=60,n.fiveMinuteInSeconds=
300,n.oneHourInSeconds=3600,n.twoHoursInSeconds=7200,n.oneDayInSeconds=86400,n.thirtyDaysInSeconds=2592e3,n.oneEightyDaysInSeconds=15552e3,n.hoursInOneDay=24,n}()});define("InsightsExtension/Client/ExtensionCore/Resource/Resources",["require","exports"],function(){"use strict";return function(){function n(){}return n._getResourcesDictionary=function(){var i="ExtensionCore.Resources",n=window,t;if(n.Resources&&n.Resources.getResources&&(t=n.Resources.getResources(i)),!t)throw new Error("Unable to find the resources for '"+i+"'.");return function(n){return t[n]}},n._getValue=n._getResourcesDictionary(),n.zettaBytesLong=n._getValue("zettaBytesLong"),n.zettaBytes=n._getValue("zettaBytes"),n.yottaBytesLong=n._getValue("yottaBytesLong"),n.yottaBytes=n._getValue("yottaBytes"),n.teraBytesLong=n._getValue("teraBytesLong"),n.teraBytes=n._getValue("teraBytes"),n.petaBytesLong=n._getValue("petaBytesLong"),n.petaBytes=n._getValue("petaBytes"),n.megaBytesLong=n._getValue("megaBytesLong"),n.megaBytes=
n._getValue("megaBytes"),n.kiloBytesLong=n._getValue("kiloBytesLong"),n.kiloBytes=n._getValue("kiloBytes"),n.gigaBytesLong=n._getValue("gigaBytesLong"),n.gigaBytes=n._getValue("gigaBytes"),n.exaBytesLong=n._getValue("exaBytesLong"),n.exaBytes=n._getValue("exaBytes"),n.bytesLong=n._getValue("bytesLong"),n.bytes=n._getValue("bytes"),n.genericErrorMessage=n._getValue("genericErrorMessage"),n.fieldMustBeUnique=n._getValue("EditableGrid_Validation_fieldMustBeUnique"),n}()});define("InsightsExtension/Client/ExtensionCore/Utilities/Formatters",["require","exports","../Resource/Resources"],function(n,t,i){"use strict";return function(){function n(){}return n.getFileSizeFormat=function(t,i,r,u){var e=1e3;r&&(e=1024);var o=i&&$.map(n.sizeSuffixes,function(n){return n.name}).indexOf(i)||0,f=o,s=t||0;return u=isNaN(u)?n.DefaultPrecision:u,t&&t>=e&&(f=Math.floor(Math.log(t)/Math.log(e)),s=t/Math.pow(e,f),f=o+f,f=f<n.sizeSuffixes.length?f:n.sizeSuffixes.length-1),{value:n._roundNumber(s,u),unitName:
n.sizeSuffixes[f].name,unitDisplayName:n.sizeSuffixes[f].localizedName,unitLongDisplayName:n.sizeSuffixes[f].localizedLongName,conversionFactor:n.sizeSuffixes[f].conversionFactor,conversionValue:Math.pow(e,o-f)}},n._roundNumber=function(n,t){return n%1!=0?parseFloat(n.toFixed(t)):n},n.sizeSuffixes=[{name:"B",localizedName:i.bytes,localizedLongName:i.bytesLong,conversionFactor:""},{name:"KB",localizedName:i.kiloBytes,localizedLongName:i.kiloBytesLong,conversionFactor:"k"},{name:"MB",localizedName:i.megaBytes,localizedLongName:i.megaBytesLong,conversionFactor:"M"},{name:"GB",localizedName:i.gigaBytes,localizedLongName:i.gigaBytesLong,conversionFactor:"g"},{name:"TB",localizedName:i.teraBytes,localizedLongName:i.teraBytesLong,conversionFactor:"T"},{name:"PT",localizedName:i.petaBytes,localizedLongName:i.petaBytesLong,conversionFactor:"P"},{name:"EB",localizedName:i.exaBytes,localizedLongName:i.exaBytesLong,conversionFactor:"E"},{name:"ZB",localizedName:i.zettaBytes,localizedLongName:i.zettaBytesLong,
conversionFactor:"Z"},{name:"YB",localizedName:i.yottaBytes,localizedLongName:i.yottaBytesLong,conversionFactor:"Y"}],n.DefaultPrecision=2,n}()});define("InsightsExtension/Client/ExtensionCore/Polyfills/StringComparison",["require","exports"],function(){"use strict";var n;return function(n){n[n.IgnoreCase=0]="IgnoreCase"}(n||(n={})),n});define("InsightsExtension/Client/ExtensionCore/Polyfills/StringEx",["require","exports","./StringComparison"],function(n,t,i){"use strict";return function(){function n(){}return n.equals=function(n,t,r){return typeof n!="string"||typeof t!="string"?!1:(r===i.IgnoreCase&&(n=n.toUpperCase(),t=t.toUpperCase()),n===t)},n.isStringInArray=function(t,i,r){return typeof t!="string"||!Array.isArray(i)?!1:!!i.first(function(i){return n.equals(t,i,r)})},n.startsWith=function(n,t,r){return typeof n!="string"||typeof t!="string"?!1:(r===i.IgnoreCase&&(n=n.toUpperCase(),t=t.toUpperCase()),n.length>=t.length&&n.indexOf(t)===0)},n.endsWith=function(n,t,r){return typeof
n!="string"||typeof t!="string"?!1:(r===i.IgnoreCase&&(n=n.toUpperCase(),t=t.toUpperCase()),n.length>=t.length&&n.indexOf(t,n.length-t.length)!==-1)},n.convertToStringMap=function(n){var t={};return n.split(",").forEach(function(n){var i=n.split(":");i.length===2&&(t[i[0]]=i[1])}),t},n}()});define("InsightsExtension/Client/Metrics/Utilities/MetricFormatter",["require","exports","f","../Constants","Metrics/ClientResources/MetricsResources","../../ExtensionCore/Utilities/Formatters","../../ExtensionCore/Polyfills/StringEx","../../ExtensionCore/Polyfills/StringComparison"],function(n,t,i,r,u,f,e,o){"use strict";var s;return function(n){function l(n,t,i){var r=f.getFileSizeFormat(n,"B",i,t);return{value:r.value,unitName:"bytes/sec",unitDisplayName:u.perSecond.format(r.unitDisplayName),unitLongDisplayName:u.perSecond.format(r.unitLongDisplayName),conversionFactor:r.conversionFactor,conversionValue:r.conversionValue}}var a=function(){function n(){}return n}(),c;n.FormattedUnit=a;c=function()
{function n(){}return n}();n.TransformedUnit=c;var t={bytes:function(n,t,i){return f.getFileSizeFormat(n,"B",i,t)},kilobytes:function(n,t,i){return f.getFileSizeFormat(n,"KB",i,t)},mbytes:function(n,t,i){return f.getFileSizeFormat(n,"MB",i,t)},gbytes:function(n,t,i){return f.getFileSizeFormat(n,"GB",i,t)},tbytes:function(n,t,i){return f.getFileSizeFormat(n,"TB",i,t)},bytespersecond:l,"bytes/sec":l,milliseconds:function(n,i){var f=u.metricUnitMillisecondsShort,e=u.metricUnitMilliseconds,r;return n>=1e3?(r=t.seconds(n/1e3,i),r.conversionValue=r.conversionValue/1e3,r):{value:n?parseInt(n.toFixed(i),10):n,unitName:"milliseconds",unitDisplayName:f,unitLongDisplayName:e,conversionFactor:"",conversionValue:1}},seconds:function(n,i){var e,r;if(n<1)return e=t.milliseconds(n*1e3,i),e.conversionFactor="ms",e.conversionValue=1e3,e;var o="seconds",l=0,s=u.metricUnitSecondsShort,h=u.metricUnitSeconds,c="",f=1;return n>=60&&(r=n/60,r>1&&r<60?(o="minutes",s=u.metricUnitMinutesShort,h=u.metricUnitMinutes,
c="m",f=f/60,n=r):r>=60&&r<1440?(o="hours",s=u.metricUnitHoursShort,h=u.metricUnitHours,c="h",f=f/3600,n=r/60):r>=1440&&(o="days",s=u.metricUnitDaysShort,h=u.metricUnitDays,c="d",f=f/86400,n=r/1440)),n%1!=0&&(l=i),{value:n?parseFloat(n.toFixed(l)):n,unitName:o,unitDisplayName:s,unitLongDisplayName:h,conversionFactor:c,conversionValue:f}},percent:function(n,t){var i=0;return n%1!=0&&(i=t),{value:n?parseFloat(n.toFixed(i)):n,unitName:"%",unitDisplayName:u.metricUnitPercent,unitLongDisplayName:u.metricUnitPercent,conversionFactor:"",conversionValue:1}},countpersecond:function(n,t){var i=n,r="",f=1,e=0;return n>=1e3&&(i=n/1e3,r="k",f=1/1e3),i%1!=0&&(e=t),{value:i?parseFloat(i.toFixed(e)):i,unitName:"countpersecond",unitDisplayName:u.perSecond.format(r),unitLongDisplayName:u.perSecond.format(r),conversionFactor:r,conversionValue:f}},count:function(n,t){var i=n,r="",u=1,f=0;return n>=1e3&&(i=n/1e3,r="k",u=1/1e3),i%1!=0&&(f=t),{value:i?parseFloat(i.toFixed(f)):i,unitName:"count",unitDisplayName:
r,unitLongDisplayName:r,conversionFactor:r,conversionValue:u}}},s={terabytes:"tbytes",tb:"tbytes",gigabytes:"gbytes",gb:"gbytes",megabytes:"mbytes",mb:"mbytes",kb:"kilobytes",percentage:"percent","%":"percent",sec:"seconds"},h={bytes:{valueFromBaseUnit:1,unitName:"bytes",fxUnit:i.UnitConversion.Unit.Bytes_SI},bytespersecond:{valueFromBaseUnit:1,unitName:"bytes/sec",fxUnit:i.UnitConversion.Unit.BytesPerSecond_SI},bytesiecformat:{valueFromBaseUnit:1,unitName:"bytes",fxUnit:i.UnitConversion.Unit.Bytes},bytespersecondiecformat:{valueFromBaseUnit:1,unitName:"bytes/sec",fxUnit:i.UnitConversion.Unit.BytesPerSecond},count:{valueFromBaseUnit:1,unitName:"count",fxUnit:i.UnitConversion.Unit.Count},countpersecond:{valueFromBaseUnit:1,unitName:"count/sec",fxUnit:i.UnitConversion.Unit.CountPerSecond},percent:{valueFromBaseUnit:1,unitName:"percent",fxUnit:i.UnitConversion.Unit.Percentage},seconds:{valueFromBaseUnit:1,unitName:"seconds",fxUnit:i.UnitConversion.Unit.Seconds}},v={b:"B",kb:"KiB",mb:"MiB",
gb:"GiB",tb:"TiB",pb:"PiB",eb:"EiB",zb:"ZiB",yb:"YiB","b/s":"B/s","kb/s":"KiB/s","mb/s":"MiB/s","gb/s":"GiB/s","tb/s":"TiB/s","pb/s":"PiB/s","eb/s":"EiB/s","zb/s":"ZiB/s","yb/s":"YiB/s"},y=function(){function n(){}return n.Format=function(n,i,r,e){var o=i?i.toLowerCase():"",h,c;return e=isNaN(e)?f.DefaultPrecision:e,t[o]?h=t[o](n,e,r):s[o]?h=t[s[o]](n,e,r):(c=u[o]||i,h={value:n?Number(n.toFixed(e)):n,unitName:i,unitDisplayName:c,unitLongDisplayName:c,conversionFactor:"",conversionValue:1}),h},n.GetFxUnit=function(n,t){t===void 0&&(t=!1);var u=n?n.toLowerCase():"",f=i.UnitConversion.Unit.None;return t&&(e.equals(u,r.MetricUnit.Bytes,o.IgnoreCase)?u=r.IECFormatName.bytesIECFormat:e.equals(u,r.MetricUnit.BytesPerSecond,o.IgnoreCase)&&(u=r.IECFormatName.bytesPerSecondIECFormat)),h[u]?f=h[u].fxUnit:s[u]&&(f=h[s[u]].fxUnit),f},n.GetDisplayUnit=function(n,t,i){return t===void 0&&(t=!1),i===void 0&&(i=!1),!t||i?n:v[n.toLowerCase()]||n},n}();n.MetricFormatter=y}(s||(s={})),s});define("InsightsExtension/Client/Usages/Constants",
["require","exports"],function(){"use strict";return function(){function n(){}return n.DataUris={listUsageMetricsUri:"api/Insights/ListUsageMetrics"},n.UsageLimits={Unlimited:-1,UsageWarningLimit:80},n}()});define("InsightsExtension/Client/Usages/Parts/UsageGaugeBasePart",["require","exports","f","../../Metrics/Utilities/MetricFormatter","../Constants","../../Alerts/Utilities/AuthorizationUtility","Usages/ClientResources/UsagesResources","../../ExtensionCore/Polyfills/StringEx","../../ExtensionCore/Polyfills/StringComparison"],function(n,t,i,r,u,f,e,o,s){"use strict";var h=r.MetricFormatter,c=i.ViewModels.Parts.QuotaGauge;return function(n){function t(t,i,r){n.call(this);this.resourceId=ko.observable();this.usageMetricName=ko.observable();this.options=ko.observable();this._useIECFormat=!1;this._displaySIUnit=!1;this._container=t;this._dataView=r.usagesData.getUsageDataView();this._dataView.onLoaded(this.onDataLoaded.bind(this));this._container.registerForDispose(this._dataView);this.instanceQuota(
u.UsageLimits.UsageWarningLimit);this.maximum(100);this.captionDisplayFormat("");this.valueDisplayFormat("{0}%");this._container.partTitle(e.usageGaugePartDefaultTitle)}return __extends(t,n),t.prototype.onInputsSet=function(n){var o=this,t,r,u;return(this._useIECFormat=n.options?!!n.options.useIECFormat:!1,this._displaySIUnit=n.options?!!n.options.displaySIUnit:!1,this._noDataMessage=e.noDataMessage,n.options&&n.options.noDataMessage&&(this._noDataMessage=n.options.noDataMessage),this._disabledMessage=e.disabledMessage,n.options&&n.options.disabledMessage&&(this._disabledMessage=n.options.disabledMessage),t=i.ViewModels.Services.ResourceTypes.parseResourceDescriptor(n.resourceId),r=t.subscription,u=t.resource,this.resourceId(n.resourceId),this.usageMetricName(n.usageMetricName),this.options(n.options),f.VerifyResourceReadPermissions(this.resourceId(),this._container),this._container.assetName(u),n.options&&n.options.isDisabled)?(this._container.noDataMessage(this._disabledMessage),null):
(i.Base.Security.hasPermission(n.resourceId,["./read"]).then(function(n){n||o._container.unauthorized()},function(){}),this._dataView.setQuery({subscriptionId:r,resourceId:n.resourceId}))},t.prototype.onDataLoaded=function(n){var t=this;this._updateUsageResults(n.usageResults());this._usageSubscription&&(this._usageSubscription.dispose(),this._usageSubscription=null);n.usageResults.subscribe(this._container,function(n){t._updateUsageResults(n)})},t.prototype._updateUsageResults=function(n){var i=this,t=n.first(function(n){return o.equals(n.name(),i.usageMetricName(),s.IgnoreCase)});n.length===0?this._container.noDataMessage(this._noDataMessage):t&&this._updateUsageResult(t)},t.prototype._updateUsageResult=function(n){var o=h.Format(n.currentValue(),n.unit(),this._useIECFormat),s=h.Format(n.limit(),n.unit(),this._useIECFormat),l,i,f,r;this._container.partTitle(n.displayName());this._container.noDataMessage(null);this.instance(t._convertToPercent(n.currentValue(),n.limit()));l={value:ko.
observable(o.value.toString()),caption:ko.observable(e.usagePartCaptionCurrent),unit:ko.observable(h.GetDisplayUnit(o.unitDisplayName,this._useIECFormat,this._displaySIUnit)),metricColorBarKind:ko.observable(c.MetricColorBarKind.CurrentValue)};i={value:ko.observable(s.value.toString()),caption:ko.observable(e.usagePartCaptionThreshold),unit:ko.observable(h.GetDisplayUnit(s.unitDisplayName,this._useIECFormat,this._displaySIUnit)),metricColorBarKind:ko.observable(c.MetricColorBarKind.None)};n.limit()===u.UsageLimits.Unlimited&&(i.value(e.usageQuotaUnlimited),i.unit(""));f=[l,i];n.nextResetTime&&n.nextResetTime()&&(r=new Date(Date.parse(n.nextResetTime())),r&&r.getUTCFullYear()<9999&&f.push(this._getResetMetric(r)));this.metrics(f)},t._convertToPercent=function(n,t){return t>0?Math.round(n/t*1e4)/100:0},t.prototype._getResetMetric=function(n){var i=new Date,r=(n.getTime()-i.getTime())/1e3,t=h.Format(r,"seconds");return{value:ko.observable(t.value.toString()),caption:ko.observable(e.usagePartCaptionResets),
unit:ko.observable(t.unitDisplayName),metricColorBarKind:ko.observable(c.MetricColorBarKind.None)}},t}(c.ViewModel)})