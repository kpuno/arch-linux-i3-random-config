FxImpl.setupRequire({bundles:{"***Fx0":["Fx/Pinner"],"**0MsPortalImpl/Init":["MsPortalImpl/Base/Base.UriHelper","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.CssSelectorParser","_generated/Less/MsPortalImpl/Themes/Themes.Reset.css","_generated/Less/MsPortalImpl/Themes/Themes.Classes.css","_generated/Less/MsPortalImpl/Themes/Themes.Blue.css","_generated/Less/MsPortalImpl/Themes/Themes.LightMode.css","MsPortalImpl/Base/Themes","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.KnockoutBindingSanitizer","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","Viva.Controls/Util/Viva.Util.Private","Viva.Controls/Util/Viva.Util","_generated/Less/Viva.Controls/Controls/Base/Viva.Base.css","Viva.Controls/Controls/Base/Viva.Image","Viva.Controls/Controls/Base/Viva.KnockoutExtensions","Viva.Controls/Controls/Base/Viva.Base","_generated/Less/MsPortalImpl.Controls/Controls/Base.css","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl.Controls/Controls/Base/Loadable","MsPortalImpl/Base/Base.BrowserDetection",
"Viva.Controls/Util/Viva.Positioning","_generated/Less/Viva.Controls/Controls/Viva.Balloon.css","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","Viva.Controls/Controls/Viva.Balloon","MsPortalImpl.Controls/Controls/Balloon","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Generated/SvgDefinitions","MsPortalImpl/Base/Base.ImageHelper","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Widgets/Widgets.Common","Viva.Controls/Controls/Base/Viva.EditableControl","Viva.Controls/Controls/Base/Viva.ValidatableControl","_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css","Viva.Controls/Controls/Base/Viva.ValueUpdateTrigger","Viva.Controls/Controls/Base/Viva.TypableControl","_generated/Less/Viva.Controls/Controls/Forms/Viva.TextBox.css","Viva.Controls/Controls/Forms/Viva.TextBox","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Base/Telemetry","MsPortalImpl/Base/Base.SelectableSet2",
"MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.Events","MsPortalImpl/Services/Services.PortalIdentity","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Extension/AddCloudName","MsPortalImpl/ViewModels/ViewModels.BladeCaller","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Base/Base.Router","MsPortalImpl/UI/Hubs/UI.NotificationManager","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.BreadCrumb.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css",
"_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/Base/Base.Selectable2.ClickContext","MsPortalImpl/Base/Languages","MsPortalImpl/Services/Services.AssetTypes.Utils",
"MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/UI/Compositions/UI.Composition.CloudName","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/Compositions/UI.Composition.Pipeline","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/Widgets/Widgets.CommandBarBase","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","_generated/Templates/WidgetsContextMenu","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/Interactions/Interactions.FocusHandler","_generated/Templates/PartError","_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css",
"MsPortalImpl/Widgets/Widgets.PartError","_generated/Templates/Part","_generated/Less/MsPortalImpl/Parts/Parts.Part.css","_generated/Less/MsPortalImpl/CustomPart.css","_generated/Less/MsPortalImpl/CustomForm.css","MsPortalImpl/Parts/Parts","MsPortalImpl/Interactions/Interactions.RightClick","_generated/Templates/WidgetsTileActionBar","MsPortalImpl/Widgets/Widgets.TileActionBar","_generated/Templates/WidgetsTile","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","_generated/Templates/WidgetsDropMenu","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Services/Services.SettingsProcessor","MsPortalImpl/Services/Services.GeneralSettings"],"*0MsPortalImpl/Init":["MsPortalImpl.Controls/Controls/ResourceFilterHelper","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Base/Base.CustomControlsBladeHost",
"MsPortalImpl/Base/Base.HierarchyMap","MsPortalImpl/Controls/ControlBindings.Async","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Controls/ControlBindings","_generated/Less/MsPortalImpl/Widgets/CopyField.css","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand","MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/Base.PartGallery","MsPortalImpl/Base/ClaimsIdentity","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.Permissions","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/Compositions/UI.Composition.JourneySettingSerializer","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/Parts/Parts.Error",
"MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","_generated/Templates/WidgetsStartboard","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Dashboard/DashboardRepository","MsPortalImpl/UI/Dashboard/ArmDashboardRepository","MsPortalImpl/UI/Dashboard/DashboardCompressor","MsPortalImpl/UI/Dashboard/PrivateDashboardRepository","MsPortalImpl/UI/Dashboard/DashboardClient","MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository","_generated/Templates/WidgetsBreadCrumb","_generated/Templates/WidgetsBreadCrumbOverFlow","MsPortalImpl/Widgets/Widgets.BreadCrumb","_generated/Templates/WidgetsJourneysMenu","_generated/Templates/WidgetsJourneysMenuButton","MsPortalImpl/Widgets/Widgets.JourneysMenu","_generated/Templates/WidgetsTopBar","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/UI/Dashboard/DashboardManager",
"MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop","_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css","MsPortalImpl/UI/UI.DesktopModeManager","MsPortalImpl/UI/Compositions/UI.Composition.Services","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager","_generated/Less/MsPortalImpl/Base/Base.Images.css","_generated/Less/MsPortalImpl/Widgets/HighContrastMode.css","_generated/Less/MsPortalImpl/Themes/Themes.Universal.css","_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css","_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Interactions/Interactions.ContextMenuTouch","_generated/Templates/WidgetsAvatarMenu","_generated/Templates/WidgetsAvatarMenuButton","MsPortalImpl/Widgets/Widgets.AvatarMenu","MsPortalImpl/Widgets/Widgets.ContextPane",
"_generated/Templates/WidgetsHelpMenu","_generated/Templates/WidgetsHelpMenuButton","MsPortalImpl/Widgets/Widgets.HelpMenu","_generated/Templates/WidgetsNotificationMenu","_generated/Templates/WidgetsNotificationMenuButton","_generated/Templates/WidgetsToast","MsPortalImpl/Widgets/Widgets.Toast","MsPortalImpl/Widgets/Widgets.NotificationMenu","_generated/Templates/WidgetsPanorama","MsPortalImpl/Widgets/Widgets.Panorama","_generated/Templates/WidgetsPortal","_generated/Templates/WidgetsSearch","MsPortalImpl/Widgets/Widgets.Search","_generated/Templates/WidgetsSideBar","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Services/Services.FileUploadInitialization","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/Extension.Manifest","MsPortalImpl/_generated/Common/Relex.Channel","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/ExtensionMetadataSource","MsPortalImpl/GalleryPackage/GalleryPackageLoader",
"MsPortalImpl/GalleryPackage/GalleryPackageMetadataSource","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css","MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler","MsPortalImpl/Services/Services.AzureStorage","MsPortalImpl/Services/Services.BrowseCurationEndpoints","MsPortalImpl/Services/Services.Controller","MsPortalImpl/Services/Services.FileUploadEndpointRegistration","MsPortalImpl/Services/Services.GalleryEndpoints","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.SharedSettings","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.ShellProvisioner","MsPortalImpl/Services/Services.TelemetrySharing","MsPortalImpl/Services/Services.Util","MsPortalImpl/UI/Hubs/ViewModels/UI.Hubs.Common","MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration","MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks",
"MsPortalImpl/UI/Hubs/UI.ResourceMapManagerRpc","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration","MsPortalImpl/UI/UI.StatusHandler","MsPortalImpl/UI/UI.ViewTimeTelemetry","_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css","MsPortalImpl/Parts/Parts.ButtonPart","_generated/Less/MsPortalImpl/Parts/Parts.Collection.css","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration","MsPortalImpl/UI/UI.Initialize","MsPortalImpl/Init"],"**1MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2":["Viva.Controls/Util/Viva.TemplateEngine","Viva.Controls/Util/Viva.DateUtil","MsPortalImpl/Base/Base.Timers","_generated/Less/Viva.Controls/Util/Viva.Resize.css","Viva.Controls/Util/Viva.Resize","MsPortalImpl/UI/Commands/UI.Commands.Base","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ActionHandler","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ExtensibleControl",
"MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Base","MsPortalImpl/Base/Base.FeatureDetection"],"*1MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2":["MsPortalImpl.Controls/Controls/Controls.ContextMenuHelpers","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Focus","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Formatters","MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.Selection","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Formatters.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Base","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Plugins","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Impl","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.ContextMenu.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.ContextMenu","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Scrolling.css",
"MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Scrolling","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Focus.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Focus","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Selection.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Selection","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Sorting.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Sorting","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Resizing.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Resizing","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2"],"**1MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1":["Viva.Controls/Controls/Base/Viva.ExtensibleControl","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters.Helpers","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Formatters.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.PercentFormatter.css",
"Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Formatters","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.FocusableRow.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SelectableRow.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.EditableRow.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.EditableRow","MsPortalImpl.Controls/Controls/Base/Formatters","_generated/Less/Viva.Controls/Controls/Viva.DockedBalloon.css","Viva.Controls/Controls/Viva.DockedBalloon","_generated/Less/Viva.Controls/Controls/Forms/Viva.Button.css","Viva.Controls/Controls/Forms/Viva.Button","MsPortalImpl.Controls/Fields/Base/LabelAndBalloonWidget","_generated/Less/Viva.Controls/Controls/Base/Viva.ValidationPlacements.css","Viva.Controls/Controls/Base/ValidationPlacements/Viva.Base",
"Viva.Controls/Controls/Base/ValidationPlacements/Viva.Css","Viva.Controls/Controls/Base/Viva.Validators","Viva.Controls/Controls/Base/ValidationPlacements/Viva.DockedBalloon","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Extensibility","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Impl","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FocusableRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SelectableRowActivate.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SelectableRowActivate","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.SelectableRow","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.RightClickableRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.RightClickableRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ContextMenuShortcut.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ContextMenuShortcut","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ContextMenuShortcut","MsPortalImpl/Controls/Helpers/Validation","_generated/Less/MsPortalImpl.Controls/Fields/Fields.css",
"MsPortalImpl.Controls/Fields/Base/Field","MsPortalImpl.Controls/Fields/TextField","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.EditableRow","_generated/Less/Viva.Controls/Controls/Forms/Viva.SearchBox.css","Viva.Controls/Controls/Forms/Viva.SearchBox","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Filterable.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Filterable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Filterable","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.FocusableRowHover","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FocusableRowHover","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid1.Formatters.css","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Formatter","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.FormatterHtmlBindings","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Groupable.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Groupable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Groupable","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Hierarchical.css",
"Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Hierarchical","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Hierarchical","_generated/Less/Viva.Controls/Controls/Viva.Pager.css","Viva.Controls/Controls/Viva.Pager","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Pageable.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Pageable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Pageable","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ReorderRow.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ReorderRow","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ReorderRow","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.ResizableColumn.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.ResizableColumn","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.ResizableColumn","_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.Scrollable.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.Scrollable","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.Scrollable",
"_generated/Less/Viva.Controls/Controls/Lists/Viva.Grid1.SortableColumn.css","Viva.Controls/Controls/Lists/Grid1/Viva.Grid1.SortableColumn","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1.SortableColumn","MsPortalImpl.Controls/Controls/Lists/Grid1/Grid1"],"*_generated/Templates/SplashScreen":["_generated/Templates/SplashScreen"],"*_generated/Templates/AttachmentControlIcon":["_generated/Templates/AttachmentControlIcon"],"*_generated/Less/Viva.Controls/Controls/Themes/Themes.Control.Classes.css":["_generated/Less/Viva.Controls/Controls/Themes/Themes.Control.Classes.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Reset.ColorsAlt.css":["_generated/Less/MsPortalImpl/Themes/Themes.Reset.ColorsAlt.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Reset.Colors.css":["_generated/Less/MsPortalImpl/Themes/Themes.Reset.Colors.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Light.css":["_generated/Less/MsPortalImpl/Themes/Themes.Light.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.DarkMode.css":
["_generated/Less/MsPortalImpl/Themes/Themes.DarkMode.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Dark.css":["_generated/Less/MsPortalImpl/Themes/Themes.Dark.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.BlueAlt.css":["_generated/Less/MsPortalImpl/Themes/Themes.BlueAlt.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Blades.Light.css":["_generated/Less/MsPortalImpl/Themes/Themes.Blades.Light.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Blades.DarkMode.css":["_generated/Less/MsPortalImpl/Themes/Themes.Blades.DarkMode.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Blades.Dark.css":["_generated/Less/MsPortalImpl/Themes/Themes.Blades.Dark.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Blades.BlueAlt.css":["_generated/Less/MsPortalImpl/Themes/Themes.Blades.BlueAlt.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Blades.Azure.css":["_generated/Less/MsPortalImpl/Themes/Themes.Blades.Azure.css"],"*_generated/Less/MsPortalImpl/Themes/Themes.Azure.css":["_generated/Less/MsPortalImpl/Themes/Themes.Azure.css"],
"*_generated/Less/MsPortalImpl/Parts/Parts.Error.css":["_generated/Less/MsPortalImpl/Parts/Parts.Error.css"],"*_generated/Less/MsPortalImpl/Controls/Visualization/Controls.CsmTopology.css":["_generated/Less/MsPortalImpl/Controls/Visualization/Controls.CsmTopology.css"],"*_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Reordering.css":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Reordering.css"],"*_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Grouping.css":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Grouping.css"],"*_generated/Less/MsPortalImpl.Controls/Controls/Forms/History.css":["_generated/Less/MsPortalImpl.Controls/Controls/Forms/History.css"],"*_generated/Less/MsPortalImpl.Controls/Controls/Forms/Attachment.css":["_generated/Less/MsPortalImpl.Controls/Controls/Forms/Attachment.css"],"*_generated/Less/MsPortalImpl.Controls/Controls/Data/QueryBuilder2.css":["_generated/Less/MsPortalImpl.Controls/Controls/Data/QueryBuilder2.css"],
"*_generated/Less/CoBrand/Site.css":["_generated/Less/CoBrand/Site.css"],"*_generated/Less/CoBrand/rtl/Site.css":["_generated/Less/CoBrand/rtl/Site.css"],"*_generated/Content/Scripts/_oss/monaco-editor/min/vs/editor/editor.main.css":["_generated/Content/Scripts/_oss/monaco-editor/min/vs/editor/editor.main.css"],"*_generated/Content/Scripts/_oss/monaco-editor/dev/vs/editor/editor.main.css":["_generated/Content/Scripts/_oss/monaco-editor/dev/vs/editor/editor.main.css"],"*Viva.Controls/Controls/Viva.MouseCompanion":["_generated/Less/Viva.Controls/Controls/Viva.MouseCompanion.css","Viva.Controls/Controls/Viva.MouseCompanion"],"*Viva.Controls/Controls/Viva.Command":["Viva.Controls/Controls/Viva.Command"],"**Viva.Controls/Controls/Visualization/Viva.SvgBase":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.SvgBase.css"],"*Viva.Controls/Controls/Visualization/Viva.SvgBase":["Viva.Controls/Controls/Visualization/Viva.SvgBase"],"*Viva.Controls/Controls/Visualization/Viva.SparkLine":[
"_generated/Less/Viva.Controls/Controls/Visualization/Viva.SparkLine.css","Viva.Controls/Controls/Visualization/Viva.SparkLine"],"**Viva.Controls/Controls/Visualization/Viva.BarGauge":["Viva.Controls/Controls/Visualization/Viva.GaugeBase"],"*Viva.Controls/Controls/Visualization/Viva.BarGauge":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.BarGauge.css","Viva.Controls/Controls/Visualization/Viva.BarGauge"],"*Viva.Controls/Controls/Visualization/Graph/GraphEntitiesAddition":["Viva.Controls/Controls/Visualization/Graph/GraphEntitiesAddition"],"*Viva.Controls/Controls/Visualization/Graph/Commands/ICommand":["Viva.Controls/Controls/Visualization/Graph/Commands/ICommand"],"*Viva.Controls/Controls/Toolbars/Viva.ToolbarGroupType":["Viva.Controls/Controls/Toolbars/Viva.ToolbarGroupType"],"**Viva.Controls/Controls/Forms/Viva.Password.StrengthIndicator":["_generated/Less/Viva.Controls/Controls/Forms/Viva.Password.css","Viva.Controls/Controls/Forms/Viva.Password"],"*Viva.Controls/Controls/Forms/Viva.Password.StrengthIndicator":
["_generated/Less/Viva.Controls/Controls/Visualization/Viva.ColorBar.css","Viva.Controls/Controls/Visualization/Viva.ColorBar","Viva.Controls/Controls/Forms/Viva.Password.StrengthIndicator"],"*Viva.Controls/Controls/Forms/Viva.CommandButton":["_generated/Less/Viva.Controls/Controls/Forms/Viva.CommandButton.css","Viva.Controls/Controls/Forms/Viva.CommandButton"],"*Viva.Controls/Controls/Base/Viva.Sanitizer":["Viva.Controls/Controls/Base/Viva.Sanitizer"],"*MsPortalImpl/Widgets/Widgets.SharedOptionsInit":["MsPortalImpl/Widgets/Widgets.SharedOptionsInit"],"**MsPortalImpl/Widgets/Widgets.ShareDashboardPane":["MsPortalImpl/UI/UI.PartGalleryDataClient"],"*MsPortalImpl/Widgets/Widgets.ShareDashboardPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.ShareDashboardPane.css","MsPortalImpl/Widgets/Widgets.ShareDashboardPane"],"*MsPortalImpl/Widgets/Widgets.SettingsPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.SettingsPane.css","MsPortalImpl/Widgets/Widgets.SettingsPane"],"*MsPortalImpl/Widgets/Widgets.SearchDefered":
["_generated/Less/MsPortalImpl/Widgets/Widgets.SearchDefered.css","MsPortalImpl/Widgets/Widgets.SearchDefered"],"*MsPortalImpl/Widgets/Widgets.Nps":["MsPortalImpl/Widgets/Widgets.Nps"],"*MsPortalImpl/Widgets/Widgets.KeyboardShortcutsPane":["MsPortalImpl/Widgets/Widgets.KeyboardShortcutsPane"],"*MsPortalImpl/Widgets/Widgets.FilterPane":["_generated/Less/MsPortalImpl/Widgets/Widgets.FilterPane.css","MsPortalImpl/Widgets/Widgets.FilterPane"],"*MsPortalImpl/Widgets/Widgets.FeedbackPane":["MsPortalImpl/Base/Base.SafeMarkup","_generated/Less/MsPortalImpl/Widgets/Widgets.FeedbackPane.css","MsPortalImpl/Widgets/Widgets.FeedbackPane"],"*MsPortalImpl/Widgets/Widgets.DebugHub.Performance.Timeline":["_generated/Less/MsPortalImpl/Widgets/Widgets.DebugHub.Performance.Timeline.css","MsPortalImpl/Widgets/Widgets.DebugHub.Performance.Timeline"],"*MsPortalImpl/Widgets/Widgets.DebugContextPane":["MsPortalImpl/Widgets/Widgets.DebugHub.Performance","_generated/Less/MsPortalImpl/Widgets/Widgets.DebugHub.css",
"MsPortalImpl/Widgets/Widgets.DebugContextPane"],"*MsPortalImpl/ViewModels/ViewModels.Forms":["MsPortalImpl/ViewModels/ViewModels.Forms"],"*MsPortalImpl/UI/UI.Portal.Actions":["MsPortalImpl/UI/UI.Portal.Actions"],"**MsPortalImpl/UI/UI.PartGalleryManager":["Viva.Controls/Controls/Base/Viva.ItemList","_generated/Less/Viva.Controls/Controls/Forms/Viva.DropDown.css","Viva.Controls/Controls/Forms/Viva.GroupDropDown"],"*MsPortalImpl/UI/UI.PartGalleryManager":["MsPortalImpl/Interactions/Interactions.PartGalleryDragDrop","MsPortalImpl/UI/UI.PartGalleryHelper","MsPortalImpl/Widgets/Widgets.PartGalleryPivots","_generated/Less/MsPortalImpl/Widgets/Widgets.PartGallery.css","MsPortalImpl/Widgets/Widgets.PartGallery","MsPortalImpl/UI/UI.PartGalleryPivotControllers","MsPortalImpl/UI/UI.PartGalleryManager"],"*MsPortalImpl/UI/UI.DragDropCompositionManager":["MsPortalImpl/UI/UI.DragDropCompositionManager"],"*MsPortalImpl/UI/UI.DialogManager":["_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css",
"MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog","_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css","MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup","_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css","MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","MsPortalImpl/UI/UI.DialogManager"],"*MsPortalImpl/UI/UI.Desktop.Actions":["MsPortalImpl/UI/Compositions/UI.Composition.Util","MsPortalImpl/UI/UI.Desktop.Actions"],"*MsPortalImpl/UI/UI.BladeLauncher":["MsPortalImpl/UI/UI.BladeLauncher"],"*MsPortalImpl/UI/UI.AssetBladeLauncher":["MsPortalImpl/UI/UI.AssetBladeLauncher"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.SettingsPart":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.SettingsPart"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LocaleSelectionBlade":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LocaleSelectionBlade"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LocaleGrid":
["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LocaleGrid"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LanguageSelectionBlade":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LanguageSelectionBlade"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LanguageGrid":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.LanguageGrid"],"**MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.DiagnosticsPart":["MsPortalImpl/Base/Base.Text"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.DiagnosticsPart":["MsPortalImpl/UI/Hubs/UI.HubsDiagnostics","MsPortalImpl/Services/Services.AssetTypes.Diagnostics","MsPortalImpl/Base/Base.DiagnosticsPopup","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.DiagnosticsPart"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.Blade":["MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.Blade"],"**MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.PinnedPart":["MsPortalImpl/UI/Hubs/UI.BrowseManagerDelayed"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.PinnedPart":["MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.PinnedPart"],
"*MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.Part":["MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.Part"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.Blade":["MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseService.Blade"],"*MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseAll.Part":["MsPortalImpl/UI/Hubs/ViewModels/UI.BrowseAll.Part"],"*MsPortalImpl/UI/Hubs/UI.ResourceMapManager":["MsPortalImpl/UI/Hubs/UI.ResourceMapManager"],"*MsPortalImpl/UI/Hubs/UI.CreateManager":["MsPortalImpl/UI/Hubs/UI.CreateManager"],"*MsPortalImpl/UI/Hubs/Services/NotificationsBrowseService":["MsPortalImpl/UI/Hubs/Services/NotificationsBrowseService"],"*MsPortalImpl/UI/Dashboard/SessionDashboardRepository":["MsPortalImpl/UI/Dashboard/SessionDashboardRepository"],"*MsPortalImpl/UI/Dashboard/BrowseDashboardsPane":["_generated/Less/MsPortalImpl/Widgets/BrowseDashboardsPane.css","MsPortalImpl/UI/Dashboard/BrowseDashboardsPane"],"*MsPortalImpl/UI/Compositions/UI.Composition.Journey":["MsPortalImpl/Base/Base.Router.Blade",
"MsPortalImpl/UI/Commands/UI.CommandBarManager","MsPortalImpl/UI/Compositions/UI.Composition.DefinitionChangeMonitor","MsPortalImpl/UI/Compositions/UI.Composition.Blade.Actions","MsPortalImpl/UI/Compositions/UI.Composition.Lens","MsPortalImpl/UI/Compositions/UI.Composition.BladeTemplateManager","MsPortalImpl/UI/Compositions/UI.Composition.LensAddition","MsPortalImpl/UI/Compositions/UI.Composition.Blade","MsPortalImpl/UI/Compositions/UI.Composition.BladePair","MsPortalImpl/UI/Compositions/UI.Composition.Journey"],"**MsPortalImpl/UI/Compositions/UI.Composition.Journey":["_generated/Less/MsPortalImpl/Themes/Themes.Blades.Universal.css","_generated/Less/MsPortalImpl/Themes/Themes.Blades.Blue.css","_generated/Less/MsPortalImpl/Themes/Themes.Blades.LightMode.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Blade.css","MsPortalImpl/UI/Compositions/UI.Composition.BladeInvocationHandler","_generated/Templates/WidgetsBladeContent","_generated/Templates/WidgetsLens","_generated/Less/MsPortalImpl/Widgets/Widgets.Lens.css",
"MsPortalImpl/Widgets/Widgets.Lens","MsPortalImpl/Widgets/Widgets.StackLayout","MsPortalImpl/Widgets/Widgets.BladeContent","_generated/Templates/WidgetsBlade","_generated/Templates/WidgetsCommandBar","_generated/Templates/WidgetsCommandBarItem","_generated/Less/MsPortalImpl/Widgets/Widgets.CommandBar.css","MsPortalImpl/Widgets/Widgets.CommandBar","MsPortalImpl/Widgets/Widgets.Blade","_generated/Less/MsPortalImpl/Widgets/Widgets.Journey.css","MsPortalImpl/Widgets/Widgets.Journey","MsPortalImpl/UI/Compositions/UI.Composition.DelayedBladeManager","MsPortalImpl/UI/Compositions/UI.Composition.SelectableSetBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableSet2Binder","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener","MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar"],"*MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuV2":["MsPortalImpl/UI/Commands/UI.Commands.Lists","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer.DemandLoad","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuV2"],
"*MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Selectable2":["MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Selectable2"],"*MsPortalImpl/UI/Compositions/UI.Composition.BladeActionBar":["_generated/Less/MsPortalImpl/Controls/ActionBars/Controls.ActionBarBase.css","MsPortalImpl/Controls/ActionBars/Controls.ActionBarBase","MsPortalImpl/Controls/ActionBars/Controls.ErrorInfoBoxActionBar","_generated/Less/MsPortalImpl/Controls/ActionBars/Controls.CreateActionBar.css","MsPortalImpl/Controls/ActionBars/Controls.CreateActionBar","MsPortalImpl/Controls/ActionBars/Controls.DeleteActionBar","MsPortalImpl/Controls/ActionBars/Controls.FilterActionBar","MsPortalImpl/Controls/ActionBars/Controls.FormActionBar","_generated/Less/MsPortalImpl/Controls/ActionBars/Controls.GenericActionBar.css","MsPortalImpl/Controls/ActionBars/Controls.GenericActionBar","_generated/Less/MsPortalImpl/Controls/ActionBars/Controls.PickerActionBar.css","MsPortalImpl/Controls/ActionBars/Controls.PickerActionBar",
"_generated/Less/MsPortalImpl/Widgets/Widgets.BladeActionBar.css","MsPortalImpl/Widgets/Widgets.BladeActionBar","MsPortalImpl/UI/Compositions/UI.Composition.BladeActionBar"],"*MsPortalImpl/Services/Services.PortalPrefetch":["MsPortalImpl/Services/Services.PortalPrefetch"],"*MsPortalImpl/Services/Services.BrowseCuration":["MsPortalImpl/Services/Services.BrowseCuration"],"*MsPortalImpl/Services/Services.AssetTypesDelayed":["MsPortalImpl/Services/Services.AssetTypesDelayed"],"*MsPortalImpl/Services/Services.AssetTypes.Logger":["MsPortalImpl/Services/Services.AssetTypes.Logger"],"*MsPortalImpl/Services/BrowseCuration/oms":["MsPortalImpl/Services/BrowseCuration/oms"],"*MsPortalImpl/Services/BrowseCuration/default":["MsPortalImpl/Services/BrowseCuration/default"],"*MsPortalImpl/Parts/Parts.SingleValueGauge":["_generated/Less/MsPortalImpl/Parts/Parts.SingleValueGauge.css","MsPortalImpl/Parts/Parts.SingleValueGauge"],"**MsPortalImpl/Parts/Parts.ResourceSummary":["_generated/Less/MsPortalImpl/Parts/Parts.Properties.css"],
"*MsPortalImpl/Parts/Parts.ResourceSummary":["MsPortalImpl/Parts/Parts.Properties","_generated/Less/MsPortalImpl/Parts/Parts.ResourceSummary.css","MsPortalImpl/Parts/Parts.ResourceSummary"],"*MsPortalImpl/Parts/Parts.QuotaGauge":["_generated/Less/MsPortalImpl/Parts/Parts.QuotaGauge.css","MsPortalImpl/Parts/Parts.QuotaGauge"],"*MsPortalImpl/Parts/Parts.QuickStart":["_generated/Less/MsPortalImpl/Parts/Parts.QuickStart.css","MsPortalImpl/Parts/Parts.QuickStart"],"*MsPortalImpl/Parts/Parts.Provisioning":["_generated/Less/MsPortalImpl/Parts/Parts.Provisioning.css","MsPortalImpl/Parts/Parts.Provisioning"],"*MsPortalImpl/Parts/Parts.InfoList":["_generated/Less/MsPortalImpl/Parts/Parts.InfoList.css","MsPortalImpl/Parts/Parts.InfoList"],"***Fx1":["Fx/Composition/FramePart"],"*MsPortalImpl/Parts/Parts.Frame":["_generated/Less/MsPortalImpl/Parts/Parts.Frame.css","MsPortalImpl/Parts/Parts.Frame"],"**MsPortalImpl/Parts/Parts.Donut":["Viva.Controls/Controls/Base/Viva.CompositeControl","Viva.Controls/Controls/Forms/Viva.ComboDropBase",
"_generated/Less/Viva.Controls/Controls/Viva.SingleSetting.css","Viva.Controls/Controls/Viva.SingleSetting","Viva.Controls/Util/Viva.Hatching","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Legend.css","Viva.Controls/Controls/Visualization/Viva.Legend","_generated/Less/Viva.Controls/Controls/Forms/Viva.MultiSelectDropDown.css","Viva.Controls/Controls/Forms/Viva.MultiSelectDropDown","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Gauge.css","Viva.Controls/Controls/Visualization/Viva.Gauge","_generated/Less/Viva.Controls/Controls/Visualization/Viva.UsageGauge.css","Viva.Controls/Controls/Visualization/Viva.UsageGauge","_generated/Less/Viva.Controls/Controls/Visualization/Viva.QuotaGauge.css","Viva.Controls/Controls/Visualization/Viva.QuotaGauge","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Donut.css","Viva.Controls/Controls/Visualization/Viva.Donut"],"*MsPortalImpl/Parts/Parts.Donut":["_generated/Less/MsPortalImpl/Parts/Parts.Donut.css","MsPortalImpl/Parts/Parts.Donut"],
"*MsPortalImpl/Parts/Parts.CustomControlsPart":["_generated/Less/MsPortalImpl/Parts/Parts.Custom.css","MsPortalImpl/Parts/Parts.CustomControlsPart"],"*MsPortalImpl/Parts/Parts.CollectionSummary":["_generated/Less/MsPortalImpl/Parts/Parts.CollectionSummary.css","MsPortalImpl/Parts/Parts.CollectionSummary"],"**MsPortalImpl/Parts/Parts.Chart":["MsPortalImpl.Controls/Controls/Visualization/ChartViewModelConversionHelper"],"*MsPortalImpl/Parts/Parts.Chart":["_generated/Less/MsPortalImpl/Parts/Parts.Chart.css","MsPortalImpl/Parts/Parts.Chart"],"*MsPortalImpl/Parts/Parts.Asset":["_generated/Less/MsPortalImpl/Parts/Parts.Asset.css","MsPortalImpl/Parts/Parts.Asset"],"*MsPortalImpl/Interactions/Interactions.MousePanning":["MsPortalImpl/Interactions/Interactions.MousePanning"],"*MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize":["MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize"],"*MsPortalImpl/ExtensionHostInit":["MsPortalImpl/ExtensionHostInit"],"*MsPortalImpl/Extension/PinBladeInferred":
["MsPortalImpl/Extension/PinBladeInferred"],"**MsPortalImpl/Controls/Forms/GroupDropDown":["MsPortalImpl/Controls/Helpers/Validators"],"*MsPortalImpl/Controls/Forms/GroupDropDown":["_generated/Less/MsPortalImpl/Controls/Forms/GroupDropDown.css","MsPortalImpl/Controls/Forms/GroupDropDown"],"**MsPortalImpl/Controls/Forms/Controls.TokenComboBox":["_generated/Less/Viva.Controls/Controls/Forms/Viva.EditableCombo.css","Viva.Controls/Controls/Forms/Viva.EditableCombo","_generated/Less/Viva.Controls/Controls/Forms/Viva.FilterCombo.css","Viva.Controls/Controls/Forms/Viva.FilterCombo"],"*MsPortalImpl/Controls/Forms/Controls.TokenComboBox":["MsPortalImpl/Controls/Forms/TokenParsing","_generated/Less/MsPortalImpl/Controls/Forms/Controls.TokenComboBox.css","MsPortalImpl/Controls/Forms/Controls.TokenComboBox"],"*MsPortalImpl/Controls/Forms/Controls.FileUpload":["_generated/Less/Viva.Controls/Controls/Forms/Viva.FileUpload2.css","Viva.Controls/Controls/Forms/Viva.FileUpload2","MsPortalImpl/Controls/Forms/Controls.FileUpload"],
"*MsPortalImpl/Controls/Forms/AsyncFileUpload":["MsPortalImpl/Services/Services.FileUploadSettings","MsPortalImpl/Services/Services.FileUpload","MsPortalImpl/Services/Services.FileUploadManager","_generated/Less/MsPortalImpl/Controls/Forms/AsyncFileUpload.css","MsPortalImpl/Controls/Forms/AsyncFileUpload"],"*MsPortalImpl/Controls/CustomControlHost":["MsPortalImpl/Controls/CustomControlHost"],"*MsPortalImpl/Controls/Controls.Wizard":["_generated/Less/MsPortalImpl/Controls/Controls.Wizard.css","MsPortalImpl/Controls/Controls.Wizard"],"*MsPortalImpl/Controls/Controls.PickerV3":["_generated/Less/MsPortalImpl/Controls/Controls.PickerV3.css","MsPortalImpl/Controls/Controls.PickerV3"],"*MsPortalImpl/Controls/Controls.Picker":["_generated/Less/MsPortalImpl/Controls/Controls.Picker.css","MsPortalImpl/Controls/Controls.Picker"],"*MsPortalImpl/Controls/Controls.Notice":["_generated/Less/MsPortalImpl/Controls/Controls.Notice.css","MsPortalImpl/Controls/Controls.Notice"],"*MsPortalImpl/Controls/Controls.InfoBox":
["_generated/Less/MsPortalImpl/Controls/Controls.HotSpot.css","MsPortalImpl/Controls/Controls.HotSpot","_generated/Less/MsPortalImpl/Controls/Controls.InfoBox.css","MsPortalImpl/Controls/Controls.InfoBox"],"*MsPortalImpl/Controls/Controls.HeroBanner":["_generated/Less/MsPortalImpl/Controls/Controls.HeroBanner.css","MsPortalImpl/Controls/Controls.HeroBanner"],"**MsPortalImpl/Controls/Controls.FileDownloadButton":["Viva.Controls/Controls/Toolbars/Viva.ToolbarItemType","Viva.Controls/Controls/Toolbars/Viva.ToolbarItem","_generated/Less/Viva.Controls/Controls/Toolbars/Viva.ToolbarButton.css","Viva.Controls/Controls/Toolbars/Viva.ToolbarButton","Viva.Controls/Controls/Toolbars/Viva.ExecutableButtonBase","_generated/Less/Viva.Controls/Controls/Toolbars/Viva.CommandButton.css","Viva.Controls/Controls/Toolbars/Viva.CommandButton"],"*MsPortalImpl/Controls/Controls.FileDownloadButton":["MsPortalImpl/Commands/Commands.FileDownloadCommand","_generated/Less/MsPortalImpl/Controls/Controls.FileDownloadButton.css",
"MsPortalImpl/Controls/Controls.FileDownloadButton"],"*MsPortalImpl/Controls/Controls.DeleteAssetConfirmation":["MsPortalImpl/Controls/Controls.DeleteAssetConfirmation"],"*MsPortalImpl/ControlHostInit":["MsPortalImpl/Base/Base.KnockoutExtensions.Controls","_generated/Less/MsPortalImpl/ControlHost.css","MsPortalImpl/ControlHostInit"],"*MsPortalImpl/Base/Template":["MsPortalImpl/Base/Template"],"*MsPortalImpl/Base/Base.DebugInfo":["_generated/Templates/ConsoleErrorInfo","_generated/Less/MsPortalImpl/Base/Base.DebugInfo.css","MsPortalImpl/Base/Base.DebugInfo"],"**MsPortalImpl.Controls/Fields/TriStateCheckBox":["_generated/Less/Viva.Controls/Controls/Forms/Viva.CheckBox.css","Viva.Controls/Controls/Forms/Viva.CheckBox"],"*MsPortalImpl.Controls/Fields/TriStateCheckBox":["MsPortalImpl.Controls/Fields/TriStateCheckBox"],"**MsPortalImpl.Controls/Fields/TimePickerField":["Viva.Controls/Controls/Forms/Viva.TimePicker"],"*MsPortalImpl.Controls/Fields/TimePickerField":["MsPortalImpl.Controls/Fields/TimePickerField"],
"*MsPortalImpl.Controls/Fields/StringListField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.StringList.css","Viva.Controls/Controls/Forms/Viva.StringList","_generated/Less/MsPortalImpl.Controls/Controls/Forms/StringList.css","MsPortalImpl.Controls/Fields/StringListField"],"*MsPortalImpl.Controls/Fields/Splitter":["_generated/Less/Viva.Controls/Controls/Forms/Viva.Splitter.css","Viva.Controls/Controls/Forms/Viva.Splitter","MsPortalImpl.Controls/Fields/Splitter"],"**MsPortalImpl.Controls/Fields/SliderField":["MsPortalImpl.Controls/Fields/Base/SliderBaseField","_generated/Less/Viva.Controls/Controls/Forms/Viva.Slider.css","Viva.Controls/Controls/Base/Viva.SliderBase","Viva.Controls/Controls/Forms/Viva.Slider"],"*MsPortalImpl.Controls/Fields/SliderField":["MsPortalImpl.Controls/Fields/SliderField"],"**MsPortalImpl.Controls/Fields/SelectorField":["MsPortalImpl.Controls/Controls/Base/ValidatableControl","_generated/Less/MsPortalImpl.Controls/Fields/Selector.css","_generated/Less/MsPortalImpl.Controls/Fields/CreatorAndSelector.css",
"MsPortalImpl.Controls/Controls/Forms/SelectorBase"],"*MsPortalImpl.Controls/Fields/SelectorField":["MsPortalImpl.Controls/Controls/Forms/Selector","MsPortalImpl.Controls/Fields/SelectorField"],"*MsPortalImpl.Controls/Fields/SectionField":["MsPortalImpl.Controls/Fields/SectionField"],"*MsPortalImpl.Controls/Fields/Section":["_generated/Less/MsPortalImpl.Controls/Fields/Section.css","MsPortalImpl.Controls/Fields/Section"],"**MsPortalImpl.Controls/Fields/RangeSliderField":["Viva.Controls/Controls/Forms/Viva.RangeSlider"],"*MsPortalImpl.Controls/Fields/RangeSliderField":["MsPortalImpl.Controls/Fields/RangeSliderField"],"*MsPortalImpl.Controls/Fields/PasswordField":["MsPortalImpl.Controls/Fields/PasswordField"],"*MsPortalImpl.Controls/Fields/OptionsGroupField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.OptionPicker.css","Viva.Controls/Controls/Forms/Viva.OptionPicker","MsPortalImpl.Controls/Fields/OptionsGroupField"],"*MsPortalImpl.Controls/Fields/OAuthButtonField":["MsPortalImpl/Commands/Commands.OAuthCommand",
"MsPortalImpl.Controls/Fields/OAuthButtonField"],"*MsPortalImpl.Controls/Fields/NumericTextBoxField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.NumericTextBox.css","Viva.Controls/Controls/Forms/Viva.NumericTextBox","MsPortalImpl.Controls/Fields/NumericTextBoxField"],"*MsPortalImpl.Controls/Fields/MultiselectDropDownField":["MsPortalImpl.Controls/Fields/MultiselectDropDownField"],"*MsPortalImpl.Controls/Fields/MultiLineTextField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.MultiLineTextBox.css","Viva.Controls/Controls/Forms/Viva.MultiLineTextBox","MsPortalImpl.Controls/Fields/MultiLineTextField"],"*MsPortalImpl.Controls/Fields/HtmlEditorField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.ContentEditable.css","Viva.Controls/Controls/Forms/Viva.ContentEditable","MsPortalImpl.Controls/Fields/HtmlEditorField"],"*MsPortalImpl.Controls/Fields/FilterComboField":["MsPortalImpl.Controls/Fields/FilterComboField"],"*MsPortalImpl.Controls/Fields/DurationPickerField":["_generated/Less/MsPortalImpl.Controls/Fields/DurationPicker.css",
"MsPortalImpl.Controls/Fields/DurationPickerField"],"*MsPortalImpl.Controls/Fields/DropDownField":["MsPortalImpl.Controls/Fields/DropDownField"],"*MsPortalImpl.Controls/Fields/DayPickerField":["_generated/Less/MsPortalImpl.Controls/Fields/DayPicker.css","MsPortalImpl.Controls/Fields/DayPickerField"],"**MsPortalImpl.Controls/Fields/DateTimeRangePickerField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.DatePanel.css","Viva.Controls/Controls/Forms/Viva.DatePanel","Viva.Controls/Util/Viva.ArrayUtil","_generated/Less/Viva.Controls/Controls/Forms/Viva.DatePicker.css","Viva.Controls/Controls/Forms/Viva.DatePicker","_generated/Less/Viva.Controls/Controls/Forms/Viva.DateTimePicker.css","Viva.Controls/Controls/Forms/Viva.DateTimePicker"],"*MsPortalImpl.Controls/Fields/DateTimeRangePickerField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.DateTimeRangePicker.css","Viva.Controls/Controls/Forms/Viva.DateTimeRangePicker","MsPortalImpl.Controls/Fields/DateTimeRangePickerField"],"*MsPortalImpl.Controls/Fields/DateTimePickerField":
["MsPortalImpl.Controls/Fields/DateTimePickerField"],"**MsPortalImpl.Controls/Fields/DateTimeComboField":["_generated/Less/Viva.Controls/Controls/Forms/Viva.DateTimeCombo.css","Viva.Controls/Controls/Forms/Viva.DateTimeCombo"],"*MsPortalImpl.Controls/Fields/DateTimeComboField":["MsPortalImpl.Controls/Fields/DateTimeComboField"],"*MsPortalImpl.Controls/Fields/DatePickerField":["MsPortalImpl.Controls/Fields/DatePickerField"],"*MsPortalImpl.Controls/Fields/CustomValueSliderField":["MsPortalImpl.Controls/Fields/CustomValueSliderField"],"*MsPortalImpl.Controls/Fields/CustomRangeSlider":["MsPortalImpl.Controls/Fields/CustomRangeSlider"],"*MsPortalImpl.Controls/Fields/CustomHtmlField":["MsPortalImpl.Controls/Fields/CustomHtmlField"],"**MsPortalImpl.Controls/Fields/CreatorAndSelectorFieldV2":["MsPortalImpl.Controls/Controls/Forms/CreatorAndSelector"],"*MsPortalImpl.Controls/Fields/CreatorAndSelectorFieldV2":["MsPortalImpl.Controls/Fields/CreatorAndSelectorFieldV2"],"*MsPortalImpl.Controls/Fields/CreatorAndSelectorField":
["MsPortalImpl.Controls/Fields/CreatorAndSelectorField"],"*MsPortalImpl.Controls/Fields/CheckBoxField":["MsPortalImpl.Controls/Fields/CheckBoxField"],"*MsPortalImpl.Controls/Controls/Visualization/StepGauge":["Viva.Controls/Controls/Visualization/Viva.StepGauge","MsPortalImpl.Controls/Controls/Visualization/StepGauge"],"*MsPortalImpl.Controls/Controls/Visualization/SingleValueGauge":["Viva.Controls/Controls/Visualization/Viva.SingleValueGauge","MsPortalImpl.Controls/Controls/Visualization/SingleValueGauge"],"*MsPortalImpl.Controls/Controls/Visualization/QuotaGauge":["MsPortalImpl.Controls/Controls/Visualization/QuotaGauge"],"**MsPortalImpl.Controls/Controls/Visualization/PairedTimeline":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/List.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.List.FocusableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.List.GroupableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.List.SelectableExtension.css",
"_generated/Less/Viva.Controls/Controls/Lists/Viva.ListView.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.ListView.FocusableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.ListView.GroupableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.ListView.SelectableExtension.css","Viva.Controls/Controls/Lists/List1/Viva.List","Viva.Controls/Controls/Lists/List1/Viva.List.Focusable","Viva.Controls/Controls/Lists/List1/Viva.List.Selectable","Viva.Controls/Controls/Lists/List1/Viva.List.Groupable","Viva.Controls/Controls/Lists/List1/Viva.List.ContextMenu","_generated/Less/MsPortalImpl.Controls/Controls/Lists/ListView.css","MsPortalImpl.Controls/Controls/Lists/List1/ListView","_generated/Less/Viva.Controls/Controls/Visualization/Viva.ChartBase.css","Viva.Controls/Controls/Visualization/Viva.ChartBase"],"*MsPortalImpl.Controls/Controls/Visualization/PairedTimeline":["_generated/Less/MsPortalImpl.Controls/Controls/Visualization/RangeSelection.css","MsPortalImpl.Controls/Controls/Visualization/RangeSelection",
"_generated/Less/MsPortalImpl.Controls/Controls/Visualization/PairedTimelineBadges.css","MsPortalImpl.Controls/Controls/Visualization/PairedTimelineBadges","_generated/Less/MsPortalImpl.Controls/Controls/Visualization/PairedTimeline.css","MsPortalImpl.Controls/Controls/Visualization/PairedTimeline"],"*MsPortalImpl.Controls/Controls/Visualization/Metrics":["_generated/Less/Viva.Controls/Controls/Visualization/Viva.Metrics.css","Viva.Controls/Controls/Visualization/Viva.Metrics","MsPortalImpl.Controls/Controls/Visualization/Metrics"],"*MsPortalImpl.Controls/Controls/Visualization/MapV2":["MsPortalImpl.Controls/Controls/Visualization/MapV2"],"*MsPortalImpl.Controls/Controls/Visualization/Map":["Viva.Controls/Controls/Visualization/Viva.MapCoordinateConverter","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Map.css","Viva.Controls/Controls/Visualization/Viva.Map","Viva.Controls/Controls/Visualization/Viva.Hexagon","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Map.HexagonLayoutExtension.css",
"Viva.Controls/Controls/Visualization/Viva.Map.HexagonLayoutExtension","MsPortalImpl.Controls/Controls/Visualization/Map"],"*MsPortalImpl.Controls/Controls/Visualization/Graph":["Viva.Controls/Controls/Visualization/Graph/GraphEntityViewModel","Viva.Controls/Controls/Visualization/Graph/GraphViewModel","Viva.Controls/Controls/Visualization/Graph/GraphWidget.Constants","Viva.Controls/Controls/Visualization/Graph/Animation","Viva.Controls/Controls/Visualization/Graph/MouseCapture","Viva.Controls/Controls/Visualization/Graph/Geometry","Viva.Controls/Controls/Visualization/Graph/Commands/MoveNodes","Viva.Controls/Controls/Visualization/Graph/SvgUtils","_generated/Less/Viva.Controls/Controls/Visualization/Graph.css","_generated/Less/Viva.Controls/Controls/Visualization/Graph.Skins.css","Viva.Controls/Controls/Visualization/Graph/GraphWidget","MsPortalImpl.Controls/Controls/Visualization/Graph"],"*MsPortalImpl.Controls/Controls/Visualization/Gauge":["MsPortalImpl.Controls/Controls/Visualization/Gauge"],
"*MsPortalImpl.Controls/Controls/Visualization/Donut":["MsPortalImpl.Controls/Controls/Visualization/Donut"],"*MsPortalImpl.Controls/Controls/Visualization/CsmTopology":["_generated/Less/MsPortalImpl.Controls/Controls/Visualization/CsmTopology.css","MsPortalImpl.Controls/Controls/Visualization/CsmTopology"],"*MsPortalImpl.Controls/Controls/Visualization/Chart":["Viva.Controls/Controls/Visualization/Viva.ChartViewImpl","Viva.Controls/Controls/Visualization/Viva.StackedChartViewImpl","Viva.Controls/Controls/Visualization/Viva.StackedAreaChartViewImpl","Viva.Controls/Controls/Visualization/Viva.ScatterChartViewImpl","Viva.Controls/Controls/Visualization/Viva.LineChartViewImpl","Viva.Controls/Controls/Visualization/Viva.AreaChartViewImpl","Viva.Controls/Controls/Visualization/Viva.BarChartViewImpl","_generated/Less/Viva.Controls/Controls/Visualization/Viva.Chart.css","Viva.Controls/Controls/Visualization/Viva.Chart","_generated/Less/MsPortalImpl.Controls/Controls/Visualization/Chart.css","MsPortalImpl.Controls/Controls/Visualization/Chart"],
"*MsPortalImpl.Controls/Controls/Toolbars/Toolbar":["Viva.Controls/Controls/Toolbars/Viva.ToolbarGroup","Viva.Controls/Controls/Toolbars/Viva.ToolbarOptionsGroup","_generated/Less/Viva.Controls/Controls/Toolbars/Viva.Toolbar.css","_generated/Less/Viva.Controls/Controls/Toolbars/Viva.ToggleCommandButton.css","Viva.Controls/Controls/Toolbars/Viva.ToggleCommandButton","Viva.Controls/Controls/Toolbars/Viva.ClickableLink","Viva.Controls/Controls/Toolbars/Viva.OpenLinkButton","Viva.Controls/Controls/Toolbars/Viva.Toolbar","_generated/Less/MsPortalImpl.Controls/Controls/Toolbars/Toolbar.css","MsPortalImpl.Controls/Controls/Toolbars/Toolbar"],"**MsPortalImpl.Controls/Controls/TextBlock":["_generated/Less/MsPortalImpl.Controls/Controls/TextBlock.css"],"*MsPortalImpl.Controls/Controls/TextBlock":["MsPortalImpl.Controls/Controls/TextBlock"],"*MsPortalImpl.Controls/Controls/TerminalEmulator":["_generated/Less/MsPortalImpl.Controls/Controls/TerminalEmulator.css","MsPortalImpl.Controls/Controls/TerminalEmulator"],
"*MsPortalImpl.Controls/Controls/SpecComparisonTable":["_generated/Less/MsPortalImpl.Controls/Controls/SpecComparisonTable.css","MsPortalImpl.Controls/Controls/SpecComparisonTable"],"*MsPortalImpl.Controls/Controls/SingleSetting":["MsPortalImpl.Controls/Controls/SingleSetting"],"*MsPortalImpl.Controls/Controls/SimpleButton":["_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css","MsPortalImpl.Controls/Controls/SimpleButton"],"*MsPortalImpl.Controls/Controls/Settings":["_generated/Less/Viva.Controls/Controls/Viva.Settings.css","Viva.Controls/Controls/Viva.Settings","MsPortalImpl.Controls/Controls/Settings"],"*MsPortalImpl.Controls/Controls/SearchBox":["_generated/Less/MsPortalImpl.Controls/Controls/SearchBox.css","MsPortalImpl.Controls/Controls/SearchBox"],"**MsPortalImpl.Controls/Controls/Scrollbar":["_generated/Less/Viva.Controls/Controls/Viva.Scrollbar.css","Viva.Controls/Controls/Viva.Scrollbar"],"*MsPortalImpl.Controls/Controls/Scrollbar":["MsPortalImpl.Controls/Controls/Scrollbar"],
"*MsPortalImpl.Controls/Controls/ResourceFilter":["_generated/Less/MsPortalImpl.Controls/Controls/ResourceFilter.css","MsPortalImpl.Controls/Controls/ResourceFilter"],"*MsPortalImpl.Controls/Controls/PreviewTag":["MsPortalImpl.Controls/Controls/PreviewTag"],"*MsPortalImpl.Controls/Controls/PartPinner":["_generated/Less/MsPortalImpl.Controls/Controls/PartPinner.css","MsPortalImpl.Controls/Controls/PartPinner"],"*MsPortalImpl.Controls/Controls/MarkdownHtmlToReact":["MsPortalImpl.Controls/Controls/MarkdownHtmlToReact"],"***Fx2":["Fx/Controls/Video"],"*MsPortalImpl.Controls/Controls/Markdown":["MsPortalImpl.Controls/Controls/Video","_generated/Less/MsPortalImpl.Controls/Controls/Markdown.css","MsPortalImpl.Controls/Controls/Markdown"],"**MsPortalImpl.Controls/Controls/LogStream":["MsPortalImpl.Controls/Controls/Controls.CommandHelpers","_generated/Less/Viva.Controls/Controls/Viva.TextStream.css","Viva.Controls/Controls/Viva.TextStream","_generated/Less/Viva.Controls/Controls/Viva.LogStream.css",
"Viva.Controls/Controls/Viva.LogStream"],"*MsPortalImpl.Controls/Controls/LogStream":["_generated/Less/MsPortalImpl.Controls/Controls/LogStream.css","MsPortalImpl.Controls/Controls/LogStream"],"*MsPortalImpl.Controls/Controls/Lists/Tree1/TreeView":["_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.FocusableExtension.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.LoadByContinuationToken.css","_generated/Less/Viva.Controls/Controls/Lists/Viva.TreeView.OnDemandLoadableExtension.css","Viva.Controls/Controls/Lists/Tree1/Viva.Tree","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Focusable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.Selectable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.OnDemandLoadable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.RightClickable","Viva.Controls/Controls/Lists/Tree1/Viva.Tree.LoadByContinuationToken","MsPortalImpl.Controls/Controls/Lists/Tree1/TreeView"],"*MsPortalImpl.Controls/Controls/Lists/Menu":
["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Menu.css","MsPortalImpl.Controls/Controls/Lists/Menu"],"*MsPortalImpl.Controls/Controls/Lists/List1/Gallery":["MsPortalImpl.Controls/Controls/Lists/List1/Gallery"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Search":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Search.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Search"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Paging":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Paging.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Paging"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Hierarchical":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Hierarchical.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Hierarchical"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Editing":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.Editing.css",
"MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.Editing"],"*MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.DemandLoading":["_generated/Less/MsPortalImpl.Controls/Controls/Lists/Grid2/Grid2.DemandLoading.css","MsPortalImpl.Controls/Controls/Lists/Grid2/Controls.Grid2.DemandLoading"],"*MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ContextMenu":["MsPortalImpl.Controls/Controls/Lists/Base/Controls.Lists.ContextMenu"],"**MsPortalImpl.Controls/Controls/IFrameV2":["_generated/Less/MsPortalImpl.Controls/Controls/IFrame.css"],"*MsPortalImpl.Controls/Controls/IFrameV2":["MsPortalImpl.Controls/Controls/IFrameV2"],"*MsPortalImpl.Controls/Controls/IFrame":["MsPortalImpl.Controls/Controls/IFrame"],"*MsPortalImpl.Controls/Controls/Forms/TextBox":["MsPortalImpl.Controls/Controls/Forms/TextBox"],"*MsPortalImpl.Controls/Controls/Forms/Obsolete.GroupDropDown":["_generated/Less/MsPortalImpl.Controls/Controls/Forms/GroupDropDown.css","MsPortalImpl.Controls/Controls/Forms/Obsolete.GroupDropDown"],
"*MsPortalImpl.Controls/Controls/Forms/FileUpload":["_generated/Less/MsPortalImpl.Controls/Controls/Forms/ProgressOverlay.css","Viva.Controls/Controls/Visualization/Viva.Progress","_generated/Less/MsPortalImpl.Controls/Controls/Visualization/ProgressBar.css","MsPortalImpl.Controls/Controls/Visualization/ProgressBar","_generated/Less/Viva.Controls/Controls/Forms/Viva.FileUpload.css","Viva.Controls/Controls/Forms/Viva.FileUpload","_generated/Less/MsPortalImpl.Controls/Controls/Forms/FileUpload.css","MsPortalImpl.Controls/Controls/Forms/FileUpload"],"*MsPortalImpl.Controls/Controls/Forms/DateTimeCombo":["MsPortalImpl.Controls/Controls/Forms/EditableCombo","MsPortalImpl.Controls/Controls/Forms/DateTimeCombo"],"*MsPortalImpl.Controls/Controls/Forms/CopyableLabel":["_generated/Less/MsPortalImpl.Controls/Controls/DockedBalloon.css","MsPortalImpl.Controls/Controls/DockedBalloon","_generated/Less/MsPortalImpl.Controls/Controls/Forms/CopyableLabel.css","MsPortalImpl.Controls/Controls/Forms/CopyableLabel"],
"*MsPortalImpl.Controls/Controls/Forms/Button":["_generated/Less/MsPortalImpl.Controls/Controls/Forms/Button.css","MsPortalImpl.Controls/Controls/Forms/Button"],"**MsPortalImpl.Controls/Controls/Documents/DiscussionTimeline":["_generated/Less/MsPortalImpl.Controls/Controls/Documents/DiscussionThread.css","MsPortalImpl.Controls/Controls/Documents/DiscussionThread"],"*MsPortalImpl.Controls/Controls/Documents/DiscussionTimeline":["_generated/Less/MsPortalImpl.Controls/Controls/Documents/DiscussionTimeline.css","MsPortalImpl.Controls/Controls/Documents/DiscussionTimeline"],"*MsPortalImpl.Controls/Controls/Documents/DiffList":["_generated/Less/MsPortalImpl.Controls/Controls/Documents/DiffView.css","MsPortalImpl.Controls/Controls/Documents/DiffView","_generated/Less/MsPortalImpl.Controls/Controls/Documents/DiffList.css","MsPortalImpl.Controls/Controls/Documents/DiffList"],"*MsPortalImpl.Controls/Controls/Documents/DiffEditor":["MsPortalImpl.Controls/Controls/Documents/Editor.Extension","_generated/Less/MsPortalImpl.Controls/Controls/Documents/Editor.DiscussionExtension.css",
"MsPortalImpl.Controls/Controls/Documents/Editor.DiscussionExtension","_generated/Less/MsPortalImpl.Controls/Controls/Documents/Editor.css","MsPortalImpl.Controls/Controls/Documents/Editor","MsPortalImpl.Controls/Controls/Documents/DiffEditor"],"*MsPortalImpl.Controls/Controls/Data/QueryBuilder":["_generated/Less/MsPortalImpl.Controls/Controls/Data/QueryBuilder.css","_generated/Less/Viva.Controls/Controls/Forms/Viva.CommandLink.css","Viva.Controls/Controls/Forms/Viva.CommandLink","MsPortalImpl.Controls/Controls/Data/QueryBuilder"],"*MsPortalImpl.Controls/Controls/ConsoleV2":["_generated/Less/MsPortalImpl.Controls/Controls/ConsoleV2.css","MsPortalImpl.Controls/Controls/ConsoleV2"],"*MsPortalImpl.Controls/Controls/Console":["_generated/Less/Viva.Controls/Controls/Viva.Console.css","Viva.Controls/Controls/Viva.Console","_generated/Less/MsPortalImpl.Controls/Controls/Console.css","MsPortalImpl.Controls/Controls/Console"],"*MsPortalImpl.Controls/Controls/AzureMediaPlayer":["MsPortalImpl.Controls/Controls/AzureMediaPlayer"],
"*Fx/Specs/DropDown":["Fx/Specs/DropDown"],"**Fx/Internal/Data/QueryListNavigator":["Fx/Internal/Data/BaseProjection","Fx/Internal/Data/MapProjection","Fx/Internal/Data/QueryBaseNavigator"],"*Fx/Internal/Data/QueryListNavigator":["Fx/Internal/Data/QueryListNavigator"],"*Fx/Internal/Data/QueryDemandLoadNavigator":["Fx/Internal/Utils/KnockoutArrayUtils","Fx/Internal/Data/PageMapProjection","Fx/Internal/Data/QueryDemandLoadNavigator"],"*Fx/Internal/Data/OData":["Fx/Internal/Data/OData"],"*Fx/Internal/Data/LifetimeMapProjection":["Fx/Internal/Data/LifetimeMapProjection"],"*Fx/Internal/Data/Expressions":["Fx/Internal/Data/Expressions"],"**Fx/Internal/Data/ArrayListNavigator":["Fx/Internal/Data/ClientFilters","Fx/Internal/Data/SortProjection","Fx/Internal/Data/FilterProjection","Fx/Internal/Data/PageProjection","Fx/Internal/Data/ArrayBaseNavigator"],"*Fx/Internal/Data/ArrayListNavigator":["Fx/Internal/Data/ArrayListNavigator"],"*Fx/Internal/Data/ArrayDemandLoadNavigator":["Fx/Internal/Data/ContinuationProjection",
"Fx/Internal/Data/ArrayDemandLoadNavigator"],"*Fx/Internal/Controls/HotSpot":["Fx/Internal/Controls/HotSpot"],"*Fx/Internal/Controls/Grid2/Grid2":["Fx/Internal/Controls/Grid2/ViewModels.Grid2.Base","Fx/Internal/Controls/Grid2/ViewModels.Grid2.ContextMenu","Fx/Internal/Controls/Grid2/ViewModels.Grid2.DemandLoading","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Editing","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Focus","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Hover","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Grouping","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Hierarchical","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Paging","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Reordering","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Resizing","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Scrolling","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Search","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Selection","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Sorting","Fx/Internal/Controls/Grid2/Grid2"],
"*Fx/Internal/Controls/FxClickBinding":["Fx/Internal/Controls/FxClickBinding"],"*Fx/Internal/Controls/DropDown":["Fx/Internal/Controls/DropDown"],"*Fx/Internal/Composition/MenuBlade":["Fx/Internal/Composition/MenuBlade"],"*Fx/Internal/Composition/CustomControl":["Fx/Internal/Composition/CustomControl"],"*Fx/Internal/Composition":["Fx/Internal/Composition"],"*Fx/Composition/MenuBlade":["Fx/Composition/MenuBlade"],"*Fx/Composition/CustomControl":["Fx/Composition/CustomControl"],"*Fx/Base/Base.Net.Batch":["Fx/Base/Base.Net.Batch"]}},{bundles:{"***Fx0":["Fx/Pinner"],"***Fx1":["Fx/Composition/FramePart"],"***Fx2":["Fx/Controls/Video"],"*Fx/Specs/DropDown":["Fx/Specs/DropDown"],"**Fx/Internal/Data/QueryListNavigator":["Fx/Internal/Data/BaseProjection","Fx/Internal/Data/MapProjection","Fx/Internal/Data/QueryBaseNavigator"],"*Fx/Internal/Data/QueryListNavigator":["Fx/Internal/Data/QueryListNavigator"],"*Fx/Internal/Data/QueryDemandLoadNavigator":["Fx/Internal/Utils/KnockoutArrayUtils","Fx/Internal/Data/PageMapProjection",
"Fx/Internal/Data/QueryDemandLoadNavigator"],"*Fx/Internal/Data/OData":["Fx/Internal/Data/OData"],"*Fx/Internal/Data/LifetimeMapProjection":["Fx/Internal/Data/LifetimeMapProjection"],"*Fx/Internal/Data/Expressions":["Fx/Internal/Data/Expressions"],"**Fx/Internal/Data/ArrayListNavigator":["Fx/Internal/Data/ClientFilters","Fx/Internal/Data/SortProjection","Fx/Internal/Data/FilterProjection","Fx/Internal/Data/PageProjection","Fx/Internal/Data/ArrayBaseNavigator"],"*Fx/Internal/Data/ArrayListNavigator":["Fx/Internal/Data/ArrayListNavigator"],"*Fx/Internal/Data/ArrayDemandLoadNavigator":["Fx/Internal/Data/ContinuationProjection","Fx/Internal/Data/ArrayDemandLoadNavigator"],"*Fx/Internal/Controls/HotSpot":["Fx/Internal/Controls/HotSpot"],"*Fx/Internal/Controls/Grid2/Grid2":["Fx/Internal/Controls/Grid2/ViewModels.Grid2.Base","Fx/Internal/Controls/Grid2/ViewModels.Grid2.ContextMenu","Fx/Internal/Controls/Grid2/ViewModels.Grid2.DemandLoading","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Editing",
"Fx/Internal/Controls/Grid2/ViewModels.Grid2.Focus","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Hover","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Grouping","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Hierarchical","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Paging","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Reordering","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Resizing","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Scrolling","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Search","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Selection","Fx/Internal/Controls/Grid2/ViewModels.Grid2.Sorting","Fx/Internal/Controls/Grid2/Grid2"],"*Fx/Internal/Controls/FxClickBinding":["Fx/Internal/Controls/FxClickBinding"],"*Fx/Internal/Controls/DropDown":["Fx/Internal/Controls/DropDown"],"*Fx/Internal/Composition/MenuBlade":["Fx/Internal/Composition/MenuBlade"],"*Fx/Internal/Composition/CustomControl":["Fx/Internal/Composition/CustomControl"],"*Fx/Internal/Composition":["Fx/Internal/Composition"],"*Fx/Composition/MenuBlade":
["Fx/Composition/MenuBlade"],"*Fx/Composition/CustomControl":["Fx/Composition/CustomControl"],"*Fx/Base/Base.Net.Batch":["Fx/Base/Base.Net.Batch"]}});define("MsPortalImpl.Controls/Controls/ResourceFilterHelper",["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){function s(n){t.getOrSet(n.cloudName,[]).push(n)}function a(n){if(n){var i=t.get(n.cloudName),r=i&&i.first(function(t){return t.id===n.id});r&&i.remove(r);i.length?t.set(n.cloudName,i):t.set(n.cloudName,[])}}function v(){return n.Internal.assetTypeService.assetTypes().forEach(function(n){s(n)}),t}function y(t,i){n.Internal.assetTypeService=t;t.assetTypes.subscribeArrayChanges(o,function(n){s(n)},function(n){a(n)});i.registerForDispose(o)}function p(n){var u=r.get(n),e,o;return u||(u=l(),r.set(n,u),e=t.get(n)?t:v(),o=(e.get(n)||[]).filter(function(n){var t=n.assetTypeManifest.browseType;return t===f.ResourceType||t===f.InstanceLink}).map(function(n){return{name:n.compositeDisplayName.plural,key:n.id}}
),u(i.stableSort(o,function(n,t){return n.name.localeCompareIgnoreCase(t.name)}))),u}var u=FxImpl,h=u.Extension,f=i.Extension.BrowseType,c=u.TriggerableLifetimeManager,e=h.CloudMap,o=new c,l=ko.observable,t,r;n.Internal={};t=new e;r=new e;n.initialize=y;n.getResourceTypes=p}(r||(r={})),r});define("MsPortalImpl/Services/Services.SelectedSubscriptions",["require","exports","f","h","i","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Resources/ImplScriptResources"],function(n,t,i,r,u,f,e){"use strict";var o;return function(n){function nt(){h=new v.CloudMap;s=new v.CloudMap}function l(n,t){var r=(n||[]).stableSort(at),i;return t&&t.length&&(i=r.filter(function(n){return t.indexOf(n.subscriptionId)!==-1}),i.length)?i:r}function at(n,t){var r=(n.state||"").toLowerCase(),u=(t.state||"").toLowerCase(),i;if(r!==u){if(r===k)return 1;if(u===k)return-1}return i=n.displayName.localeCompareIgnoreCase(t.displayName),i===0&&(i=n.subscriptionId.localeCompareIgnoreCase(t.subscriptionId)),i}function vt(
t){nt();n.userSettingsManager=t;rt.getSelectedSubscriptionsEndPoint.register(o.client,null,function(n,t){return t.srcWindowId!==p.Shell&&t.srcWindowId!==u.Extension.getHubsWindowId()&&(n=u.Extension.getDescriptor(t.srcWindowId).cloudName),tt(n)});n.selectedSubsUpdateTriggered.subscribe(lt,function(n){et.pingSelectedSubscriptionsListEndPoint.invoke(o.client,ht,n)})}function tt(i){var r=h.get(i);return r?Q(r):(s.get(i)||s.set(i,a.getAllSubscriptions(o.client,i).then(function(r){return n.userSettingsManager.querySetting(g,b).then(function(n){var e=(n||"").split(";"),u=l(r,e),f;return u.length>t&&(u=u.slice(0,t),f=r.length,ot.publish({status:st.Information,title:d.cappedTitleFmt.format(t,f),description:d.cappedFmt.format(t,f)})),h.set(i,u),u})})),s.get(i))}function yt(i,r){return a.getAllSubscriptions(o.client,r).then(function(u){var f=l(u,i),e;return h.set(r,f),n.selectedSubsUpdateTriggered({cloudName:r,selectedSubscriptions:f}),e=f.length===u.length?"":f.slice(0,t).map(function(n){return n.
subscriptionId}).join(";"),n.userSettingsManager.setSetting(g,b,e)})}var a=u.Azure,it=r.Hubs.Settings.Schema.Keys,c=u,rt=c.Azure,v=c.Extension,y=i.Base,p=y.Constants,o=y.Rpc.Internal,ut=f.SettingStore,ft=c.TriggerableLifetimeManager,et=r.RpcEndPoints.SelectedSubscriptions,w=i.Hubs.Notifications,ot=w.ClientNotification,st=w.NotificationStatus,b=it.subscriptionsSelected,k="disabled",ht=p.ExtensionNames.Hubs,t=40,d=e.SubscriptionsNotification,g=ut.HubsExtension,ct=ko.observable,lt=new ft,s,h;n.selectedSubsUpdateTriggered=ct();n.resetState=nt;n.getValidSelectedSubscriptions=l;n.init=vt;n.getSelectedSubscriptions=tt;n.setSelectedSubscriptions=yt}(o||(o={})),o});define("MsPortalImpl/Base/Base.CustomControlsBladeHost",["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){function u(n){return new t.ProxiedObjectTypeDefinition(n)}var t=i.Base.Rpc.Internal,r=t.FuncEndPointDefinition;n.customControlsState=new t.ProxiedObjectTypeDefinition("CustomControlsSharedObservables");
n.initializeEndpoint=new r("InitializeCustomControlsBlade");n.getControlDefinitionEndpoint=new r("GetControlDefinitionForCustomControlsBlade");n.getViewModelDefinitionFactory=u}(r||(r={})),r});define("MsPortalImpl/Base/Base.HierarchyMap",["require","exports","f"],function(){"use strict";var n;return function(n){var r=ko.observableArray,t=JSON.parse,i=JSON.stringify,u=function(){function n(){}return n.prototype.toJSON=function(n){return i(n)},n.prototype.fromJSON=function(n){return t(n)},n}(),f=function(){function n(n,i){this._observable=r();this._separator="##-##";this._serializer=n||new u;i&&this._fromJSON(typeof i=="string"?t(i):i)}return n.prototype.itemExists=function(n){return this._getItemIndex(n)>=0},n.prototype.addItem=function(n,t){if(n&&n.length){if(n.some(function(n){return!n}))throw new Error("All paths segments must be non-empty strings.");else if(this.itemExists(n))throw new Error("Cannot add two items with the same path '"+i(n)+"'.");}else throw new Error("Path must include at least one segment.");
this._observable.push({path:n,_pathKey:n.join(this._separator),value:t})},n.prototype.removeItem=function(n){var t=this._getItemIndex(n);t>=0&&this._removeItemsAt(t,1)},n.prototype.removeItemsInPath=function(n){this._removeItemsWithPath(n,!0)},n.prototype.removeItemsUnderPath=function(n){this._removeItemsWithPath(n,!1)},n.prototype.empty=function(){this._removeItemsAt(0)},n.prototype._getItemIndex=function(n){var t=n.join(this._separator);return this._observable.peek().firstIndex(function(n){return n._pathKey===t})},n.prototype.getItem=function(n){var t=this._getItemIndex(n);return t>=0?this._observable.peek()[t]:null},n.prototype.getItems=function(){return this._observable.peek()},n.prototype.getItemsInPath=function(n){return this._getItemsWithPath(n,!0)},n.prototype.getItemsUnderPath=function(n){return this._getItemsWithPath(n,!1)},n.prototype.getObservable=function(){return this._observable},n.prototype.toJSON=function(){var t=this,n=this._observable,r=ko.isObservable(n)?n.peek():n;
return{items:i(r,function(n,i){switch(n){case"value":return t._serializer.toJSON(i);case"_pathKey":return}return i})}},n.prototype._removeItemsAt=function(){var n=this._observable;n.splice.apply(n,arguments)},n.prototype._fromJSON=function(n){var e=this,i=this._observable.peek(),o=i.length,r,f,u;for(t(n.items,function(n,t){return n===""&&t&&t.forEach(function(n){n.value=e._serializer.fromJSON(n.value);i.push(n)}),t}),r=o,f=i.length;r<f;r++)u=i[r],u._pathKey=(u.path||[]).join(this._separator);this._observable(i)},n.prototype._removeItemsWithPath=function(n,t){var r=this._observable.peek(),i=[],u=this._getItemsWithPath(n,t,function(n,t){n||i.push(t)});this._observable(i)},n.prototype._getItemsWithPath=function(n,t,i){var r=n.join(this._separator);return this._observable.peek().filter(function(u){var f=u._pathKey.startsWith(r)&&(t||u.path.length>n.length);return i&&i(f,u),f})},n}();n.SerializableHierarchyMap=f}(n||(n={})),n});define("MsPortalImpl/Controls/ControlBindings.Async",["require",
"exports","../Widgets/Widgets.Common"],function(n,t,i){"use strict";var r;return function(n){function e(n,t,i,r){f.push({name:t,moduleId:n+i,initOptions:r})}function t(n,t,i){e("MsPortalImpl.Controls/",n,t,i)}function r(n,t,i){e("MsPortalImpl/Controls/",n,t,i)}function o(t){n.portalControlBindings.forEach(function(n){ko.bindingHandlers[n.name]=i.getAsyncBindingHandler(n.moduleId,n.initOptions,t)})}var f=[],u={controlsDescendantBindings:!1};t("pcButton","Controls/Forms/Button",u);t("pcChart","Controls/Visualization/Chart");t("pcCheckBoxField","Fields/CheckBoxField");t("pcConsole","Controls/Console");t("pcConsoleV2","Controls/ConsoleV2");t("pcCopyableLabel","Controls/Forms/CopyableLabel");t("pcCreatorAndSelector","Fields/CreatorAndSelectorField");t("pcCreatorAndSelectorV2","Fields/CreatorAndSelectorFieldV2");t("pcCsmTopology","Controls/Visualization/CsmTopology");t("pcCustomHtmlField","Fields/CustomHtmlField");t("pcCustomValueSlider","Fields/CustomValueSliderField");t("pcCustomRangeSlider",
"Fields/CustomRangeSlider");t("pcDatePickerField","Fields/DatePickerField");t("pcDateTimeCombo","Controls/Forms/DateTimeCombo");t("pcDateTimeComboField","Fields/DateTimeComboField");t("pcDateTimePickerField","Fields/DateTimePickerField");t("pcDateTimeRangePickerField","Fields/DateTimeRangePickerField");t("pcDayPickerField","Fields/DayPickerField");t("pcDiffEditor","Controls/Documents/DiffEditor");t("pcDiffList","Controls/Documents/DiffList");t("pcDiffView","Controls/Documents/DiffView");t("pcDiscussionTimeline","Controls/Documents/DiscussionTimeline");t("pcDockedBalloon","Controls/DockedBalloon");t("pcDonut","Controls/Visualization/Donut");t("pcDropDownField","Fields/DropDownField");t("pcDurationPickerField","Fields/DurationPickerField");t("pcEditor","Controls/Documents/Editor");t("pcFileUpload","Controls/Forms/FileUpload");t("pcFilterComboField","Fields/FilterComboField");t("pcFormSection","Fields/SectionField",u);t("pcGallery","Controls/Lists/List1/Gallery");t("pcGauge","Controls/Visualization/Gauge");
t("pcGraph","Controls/Visualization/Graph");t("pcGrid","Controls/Lists/Grid1/Grid1");t("pcGrid2","Controls/Lists/Grid2/Controls.Grid2");t("pcGroupDropDown","Controls/Forms/Obsolete.GroupDropDown");t("pcHtmlEditorField","Fields/HtmlEditorField");t("pcIFrame","Controls/IFrame");t("pcIFrame2","Controls/IFrameV2");t("pcListView","Controls/Lists/List1/ListView");t("pcLogStream","Controls/LogStream");t("pcMap","Controls/Visualization/Map");t("pcMapV2","Controls/Visualization/MapV2");t("pcMediaPlayer","Controls/AzureMediaPlayer");t("pcMenu","Controls/Lists/Menu");t("pcMetrics","Controls/Visualization/Metrics");t("pcMultiLineTextField","Fields/MultiLineTextField");t("pcMultiselectDropDownField","Fields/MultiselectDropDownField");t("pcNumericTextBoxField","Fields/NumericTextBoxField");t("pcOAuthButtonField","Fields/OAuthButtonField");t("pcOptionsGroupField","Fields/OptionsGroupField");t("pcPairedTimeline","Controls/Visualization/PairedTimeline");t("pcPairedTimelineBadges","Controls/Visualization/PairedTimelineBadges");
t("pcPartPinner","Controls/PartPinner");t("pcPasswordField","Fields/PasswordField");t("pcPreviewTag","Controls/PreviewTag");t("pcProgressBar","Controls/Visualization/ProgressBar");t("pcQueryBuilder","Controls/Data/QueryBuilder");t("pcQuotaGauge","Controls/Visualization/QuotaGauge");t("pcRangeSliderField","Fields/RangeSliderField");t("pcScrollbar","Controls/Scrollbar",u);t("pcSearchBox","Controls/SearchBox");t("pcResourceFilter","Controls/ResourceFilter");t("pcSection","Fields/Section");t("pcSelector","Controls/Forms/Selector");t("pcSelectorField","Fields/SelectorField");t("pcSettings","Controls/Settings");t("pcSimpleButton","Controls/SimpleButton");t("pcSingleSetting","Controls/SingleSetting");t("pcSingleValueGauge","Controls/Visualization/SingleValueGauge");t("pcSliderField","Fields/SliderField");t("pcSpecComparisonTable","Controls/SpecComparisonTable");t("pcSplitter","Fields/Splitter",u);t("pcStepGauge","Controls/Visualization/StepGauge");t("pcStringListField","Fields/StringListField");
t("pcTerminalEmulator","Controls/TerminalEmulator");t("pcTextBlock","Controls/TextBlock");t("pcTextBox","Controls/Forms/TextBox");t("pcTextField","Fields/TextField");t("pcTimePickerField","Fields/TimePickerField");t("pcToolbar","Controls/Toolbars/Toolbar");t("pcTreeView","Controls/Lists/Tree1/TreeView");t("pcTriStateCheckBox","Fields/TriStateCheckBox");t("pcMarkdown","Controls/Markdown");t("pcVideo","Controls/Video");r("pcAsyncFileUpload","Forms/AsyncFileUpload");r("pcDeleteAssetConfirmation","Controls.DeleteAssetConfirmation");r("pcFileDownloadButton","Controls.FileDownloadButton");r("pcFileUploadWidget","Forms/Controls.FileUpload");r("pcGroupDropDownField","Forms/GroupDropDown");r("pcHeroBanner","Controls.HeroBanner");r("pcHotSpot","Controls.HotSpot",u);r("pcInfoBox","Controls.InfoBox");r("pcNotice","Controls.Notice");r("pcPicker","Controls.Picker");r("pcPickerV3","Controls.PickerV3");r("pcTokenComboBox","Forms/Controls.TokenComboBox");r("pcWizard","Controls.Wizard");r("pcCustomControl",
"CustomControlHost");n.portalControlBindings=f;n.initialize=o}(r||(r={})),r});define("MsPortalImpl/Services/Services.PortalIdleState",["require","exports","f"],function(){"use strict";var n;return function(n){function r(){return new t.PortalIdleStateServiceImpl(window,i)}var t,i;(function(n){var t,i;(function(n){n[n.None=0]="None";n[n.Idle=1]="Idle";n[n.Busy=2]="Busy"})(t||(t={}));i=function(){function n(n,i){var r=this;this._win=n;this._defaultPollMS=i;this._state=t.None;this._handleId=1;this._iteration=0;this._actions=[];this._win.addEventListener("blur",this._blurFunc=function(){r._state=t.Idle;r._processCallbacks(r._defaultPollMS)});this._win.addEventListener("focus",this._focusFunc=function(){r.signalBusy()})}return n.prototype.dispose=function(){var n=this._win;return n?(this._win=null,n.removeEventListener("blur",this._blurFunc),n.removeEventListener("focus",this._focusFunc),this._state=t.None,!0):!1},n.prototype.addCallbacks=function(n){var t=this._handleId++;return this._actions.
push({key:t,value:n}),t},n.prototype.removeCallbacks=function(n){var t=this._actions,i=t.firstIndex(function(t){return n===t.key});return i!==-1?(t.splice(i,1),!0):!1},n.prototype.signalBusy=function(){this._state===t.Idle&&(this._state=t.Busy,this._processCallbacks(5e3))},n.prototype.signalIdle=function(){this._state=t.Idle;this._processCallbacks(0)},n.prototype._processCallbacks=function(n){var i=this,r=this._timeoutHandle;r&&this._win.clearTimeout(r);this._timeoutHandle=this._win.setTimeout(function(){i._timeoutHandle=null;try{i._processIteration()}finally{i._state!==t.None&&i._processCallbacks(i._defaultPollMS)}},n)},n.prototype._processIteration=function(){var e=this,i,n;switch(this._state){case t.Busy:this._state=t.None;i=function(n){n.onBusy(new Date)};break;case t.Idle:this._state=t.Idle;i=function(n){n.onIdle(new Date)};break;default:case t.None:return}var r=function(n){var t=e._actions[n];t&&i(t.value)},u=this._actions.length,f=this._iteration%u;for(this._iteration++,n=f;n<u;
n++)r(n);for(n=0;n<f;n++)r(n)},n}();n.PortalIdleStateServiceImpl=i})(t=n.Internal||(n.Internal={}));i=18e5;n.createInstance=r}(n||(n={})),n});define("MsPortalImpl/Controls/ControlBindings",["require","exports","f"],function(n,t,i){"use strict";var r;return function(){function t(n,t){r[n]=t}function e(n,t){var i=ko.unwrap(n()),r;if(i){if(r=t[i.controlType],!r)throw new Error("Unsupported ControlType in formControl binding handler: "+i.controlType+".");return f[r]}}function o(n,t,i,r,u,f){var s=e(t,f),o;if(s)return o=$(n),o.attr("data-formelement",o.attr("data-bind")),s.init(n,t,i,r,u)}function s(n,t,i,r,u,f){if(n){var o=e(t,f);if(o)return o.update(n,t,i,r,u)}}var h=i.ViewModels,n=h.ControlType,f=ko.bindingHandlers,r={},u;t(n.ArtifactLinks,"pcArtifactLinks");t(n.AsyncFileUpload,"pcAsyncFileUpload");t(n.Attachment,"pcAttachment");t(n.Button,"pcButton");t(n.Chart,"pcChart");t(n.CheckBox,"pcCheckBoxField");t(n.Console,"pcConsole");t(n.ConsoleV2,"pcConsoleV2");t(n.CopyableLabel,"pcCopyableLabel");
t(n.CreatorAndSelector,"pcCreatorAndSelector");t(n.CreatorAndSelectorV2,"pcCreatorAndSelectorV2");t(n.CsmTopology,"pcCsmTopology");t(n.CustomControl,"pcCustomControl");t(n.CustomHtml,"pcCustomHtmlField");t(n.CustomValueSlider,"pcCustomValueSlider");t(n.CustomRangeSlider,"pcCustomRangeSlider");t(n.DatePicker,"pcDatePickerField");t(n.DateTimeCombo,"pcDateTimeComboField");t(n.DateTimePicker,"pcDateTimePickerField");t(n.DateTimeRangePicker,"pcDateTimeRangePickerField");t(n.DayPicker,"pcDayPickerField");t(n.DeleteAssetConfirmation,"pcDeleteAssetConfirmation");t(n.DiffEditor,"pcDiffEditor");t(n.DiffList,"pcDiffList");t(n.DiffView,"pcDiffView");t(n.DiscussionTimeline,"pcDiscussionTimeline");t(n.DockedBalloon,"pcDockedBalloon");t(n.Donut,"pcDonut");t(n.DropDown,"pcDropDownField");t(n.DurationPicker,"pcDurationPickerField");t(n.DynamicSection,"pcSection");t(n.Editor,"pcEditor");t(n.FileDownloadButton,"pcFileDownloadButton");t(n.FileUpload,"pcFileUpload");t(n.FileUploadWidget,"pcFileUploadWidget");
t(n.FilterCombo,"pcFilterComboField");t(n.Gallery,"pcGallery");t(n.Gauge,"pcGauge");t(n.Graph,"pcGraph");t(n.Grid2,"pcGrid2");t(n.GroupDropDown,"pcGroupDropDownField");t(n.HeroBanner,"pcHeroBanner");t(n.History,"pcHistory");t(n.HotSpot,"pcHotSpot");t(n.HtmlEditor,"pcHtmlEditorField");t(n.IFrame,"pcIFrame");t(n.IFrameV2,"pcIFrame2");t(n.InfoBox,"pcInfoBox");t(n.LinkHotSpot,"pcHotSpot");t(n.LinkInfoBox,"pcInfoBox");t(n.List2,"pcList2");t(n.LogStream,"pcLogStream");t(n.Map,"pcMap");t(n.MapV2,"pcMapV2");t(n.MediaPlayer,"pcMediaPlayer");t(n.Menu,"pcMenu");t(n.Metrics,"pcMetrics");t(n.MultiLineTextBox,"pcMultiLineTextField");t(n.MultiselectDropDown,"pcMultiselectDropDownField");t(n.Notice,"pcNotice");t(n.NumericTextBox,"pcNumericTextBoxField");t(n.OAuthButton,"pcOAuthButtonField");t(n.OptionsGroup,"pcOptionsGroupField");t(n.PairedTimeline,"pcPairedTimeline");t(n.PairedTimelineBadges,"pcPairedTimelineBadges");t(n.Password,"pcPasswordField");t(n.pcCheckBox,"pcCheckBox");t(n.pcDateTimeCombo,"pcDateTimeCombo");
t(n.pcDropDown,"pcDropDown");t(n.pcFilterCombo,"pcFilterCombo");t(n.pcGrid,"pcGrid");t(n.pcGroupDropDown,"pcGroupDropDown");t(n.pcListView,"pcListView");t(n.Markdown,"pcMarkdown");t(n.pcMultiLineTextBox,"pcMultiLineTextBox");t(n.pcMultiselectDropDown,"pcMultiselectDropDown");t(n.pcNumericTextBox,"pcNumericTextBox");t(n.pcOptionPicker,"pcOptionPicker");t(n.pcPassword,"pcPassword");t(n.pcRangeSlider,"pcRangeSlider");t(n.pcSelector,"pcSelector");t(n.pcSlider,"pcSlider");t(n.pcTextBox,"pcTextBox");t(n.pcTreeView,"pcTreeView");t(n.PartPinner,"pcPartPinner");t(n.Picker,"pcPicker");t(n.PreviewTag,"pcPreviewTag");t(n.ProgressBar,"pcProgressBar");t(n.QueryBuilder,"pcQueryBuilder");t(n.QuotaGauge,"pcQuotaGauge");t(n.RangeSlider,"pcRangeSliderField");t(n.Scrollbar,"pcScrollbar");t(n.SearchBox,"pcSearchBox");t(n.ResourceFilter,"pcResourceFilter");t(n.Section,"pcFormSection");t(n.Selector,"pcSelectorField");t(n.Settings,"pcSettings");t(n.SimpleButton,"pcSimpleButton");t(n.SimpleChart,"pcChart");t(n.
SingleSetting,"pcSingleSetting");t(n.SingleValueGauge,"pcSingleValueGauge");t(n.Slider,"pcSliderField");t(n.SpecComparisonTable,"pcSpecComparisonTable");t(n.Splitter,"pcSplitter");t(n.StepGauge,"pcStepGauge");t(n.StringList,"pcStringListField");t(n.TerminalEmulator,"pcTerminalEmulator");t(n.TextBlock,"pcTextBlock");t(n.TextBox,"pcTextField");t(n.TimePicker,"pcTimePickerField");t(n.TokenComboBox,"pcTokenComboBox");t(n.Toolbar,"pcToolbar");t(n.Tree2,"pcTree2");t(n.TriStateCheckBox,"pcTriStateCheckBox");t(n.Video,"pcVideo");t(n.Wizard,"pcWizard");u={};[n.ArtifactLinks,n.Attachment,n.CheckBox,n.CreatorAndSelector,n.CreatorAndSelectorV2,n.CustomHtml,n.CustomValueSlider,n.CustomRangeSlider,n.DatePicker,n.DateTimeCombo,n.DateTimePicker,n.DateTimeRangePicker,n.DayPicker,n.DropDown,n.DurationPicker,n.DynamicSection,n.FileUploadWidget,n.FilterCombo,n.GroupDropDown,n.History,n.HtmlEditor,n.IFrame,n.IFrameV2,n.Markdown,n.MultiLineTextBox,n.MultiselectDropDown,n.NumericTextBox,n.OAuthButton,n.OptionsGroup,
n.Password,n.PreviewTag,n.RangeSlider,n.Section,n.Selector,n.Slider,n.Splitter,n.StringList,n.TextBox,n.PartPinner,n.TimePicker,n.TokenComboBox,n.TriStateCheckBox].forEach(function(n){return u[n]=r[n]});f.pcControl={init:function(n,t,i,u,f){return o(n,t,i,u,f,r)},update:function(n,t,i,u,f){return s(n,t,i,u,f,r)}};f.formElement={init:function(n,t,i,r,f){return o(n,t,i,r,f,u)},update:function(n,t,i,r,f){return s(n,t,i,r,f,u)}}}(r||(r={})),r});define("_generated/Less/MsPortalImpl/Widgets/CopyField.css",["require","exports","module"],function(n,t,i){"use strict";var r;return function(){window.fx.injectCss(i,".fxs-copyfield{display:none;position:absolute;width:24px;top:0;right:0}.fxs-copyfield .fxc-copyablelabel{padding:0}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox{display:none}.fxs-copyfield-container .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-textbox{display:block}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{padding:0;border:0;margin:0;height:auto;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button{padding:0;margin:0;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button:hover{background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button .fxc-copyablelabel-copyimage{padding:0}.fxs-copyfield-container .fxs-copyfield-wrapper{position:absolute;top:0;right:0;width:24px;height:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxc-copyablelabel{padding-right:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield-wrapper{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-copybutton{margin-right:-24px}.fxs-part-resourcesummary .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{font-size:13px}")}
(r||(r={})),r});define("MsPortalImpl/Base/Base.KnockoutExtensions.Copy",["require","exports","f","i","../../_generated/Less/MsPortalImpl/Widgets/CopyField.css"],function(n,t,i,r){"use strict";var u;return function(t){function v(n,t){var i=f(n),e=i.css("position"),o;if(n&&n.offsetParent&&(!e||e.toLowerCase()!==c&&e.toLowerCase()!==l)){var w=i.attr("class"),nt=i.attr("data-bind"),r=i,v="Element : "+w+"; ";for(o=0;o<5&&r&&r.parent&&r.parent()&&r.parent().length;++o)r=r.parent(),v=v+("Parent["+o+"] : "+r.attr("class")+"; ");k.error("The position of the target element of copy binding is '"+e+"'. It needs to be '"+c+"' or '"+l+"' to position the copy UI correctly. Classes:'"+w+"'. DataBind:'"+nt+"'. ParentClasses: '"+v+"'")}var s,y,p=function(){s&&s.dispose();s=null;clearTimeout(y);y=null},b=function(){y=setTimeout(function(){p();s=new a(n,t())},g)},d=function(){p()};i.mouseenter(b).mouseleave(d);h.domNodeDisposal.addDisposeCallback(n,function(){p();i.off(u.mouseenter,b);i.off(u.mouseleave,d)}
)}var y=r.TriggerableLifetimeManager,o=i.Base,p=o.Diagnostics,u=o.EventTypes,w=o.Utilities,b=i.ViewModels.Controls,f=jQuery,k=p.createLog(n),e="fxs-copyfield",d=e+"-container",s=e+"-copied",g=400,h=ko.utils,c="relative",l="absolute",a=function(){function n(n,t){var r=f(n),c=this._lifespan=new y,i=f('<div class="'+e+'-wrapper" data-bind="stopBindings: true"><\/div>'),l=f('<div data-bind="pcCopyableLabel: $data" class="'+e+'"><\/div>'),o;l.appendTo(i);i.appendTo(r);o=new b.Forms.CopyableLabel.ViewModel(c);o.disabled(!0);ko.reactor(c,function(){var n=ko.unwrap(t);o.value(n);r.toggleClass(d,!w.isNullOrWhiteSpace(n))});ko.applyBindingsToDescendants(o,i[0]);c.registerForDispose([r.setEvents([u.fxcopybuttonclick,function(){r.addClass(s)}],[u.mouseleave,function(){r.removeClass(s)}]),function(){i&&(h.cleanDescendantNodes(i),i.remove())}])}return n.prototype.dispose=function(){this._lifespan.dispose()},n}();t.CopyField=a;t.initializeCopyBinding=v;ko.bindingHandlers.copy={init:function(n,t){v(n,
t)}}}(u||(u={})),u});define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../UI.NotificationManager"],function(n,t,i,r,u){"use strict";var f;return function(t){var a=i.Azure,e=a.ResourceManager,s=i.Base,v=s.Diagnostics,y=i.Services.Gallery,h=y.Constants,o=r.Gallery.Notifications,f=v.createLog(n),c=h.GalleryParametersKey,p=h.GalleryOptionsKey,w=i.Hubs.Notifications.NotificationStatus.Error,l=s.Utilities.clone,b=ko.observable,k=function(){function n(n){this.status=b();this._cloudName=n}return n.prototype.execute=function(t){var s;if("data"in t&&"options"in t){if(s=t.data,c in s.outputParameters){var i=s.outputParameters[c],r=t.options[p],u=r&&r.launchingContext||{},b=!!i.templateJson&&"Inline template JSON was used."||i.selectedTemplateId,h=this._getGalleryItemId(r.galleryItem);if(h||(f.warning("GalleryItemId should not be null."),h=i.deploymentName),u=l(u,!0),u.oldCreateApi=!0,u.galleryItemId||(u.galleryItemId=
h),this._validateOptions(i,r,s)){var v=l(s.outputParameters[i.selectedTemplateId],!0),y=n._findPropInObject(i.selectedTemplateId,r.deploymentTemplateFileUris),w={subscriptionId:i.subscriptionId,deploymentName:i.deploymentName||r.deploymentName,resourceGroupName:i.resourceGroupName,resourceGroupLocation:i.resourceGroupLocation,resourceProviders:JSON.parse(i.resourceProviders||null),parameters:v,templateLinkUri:!i.templateJson&&y||undefined,templateJson:i.templateJson,deploymentMode:e.TemplateDeploymentMode.RequestDeploymentOnly,launchingContext:u,cloudName:this._cloudName},a=new Date;return e.Deployments.deployTemplate(w).then(function(n){var t;return n.deploymentStatusCode===e.DeploymentStatusCode.Success?(t=new Date(n&&n.timestamp&&n.timestamp.valueOf()),t.getTime()<=a.getTime()&&(t=new Date(a.getTime()+1)),{correlationId:n.correlationId,timestamp:t}):Q.reject()},function(){return Q.reject()})}return this._notify(o.createArgumentsValidationFailedMessage),Q.reject()}return this._notify(
o.createOptionsNotSpecifiedMessage),f.error("Create options are not specified in the output parameters."),Q.reject()}return this._notify(o.createCommandMissingArgumentsMessage),f.error("The data or the options needed by the deployment command are not specified."),Q.reject()},n.prototype._validateOptions=function(t,i,r){var u="CsmCommand was rejected because ",e;if(t){if(!t.templateJson&&!t.selectedTemplateId)return f.error(u+"neither the templateJson or the selectedTemplateId were specified in galleryParameters."),!1;if(!!t.templateJson)try{e=JSON.parse(t.templateJson)}catch(o){return f.error(u+"the templateJson specified in galleryParameters was malformed."),!1}if(!t.subscriptionId)return f.error(u+"subscriptionId not specified in galleryParameters."),!1;if(!t.resourceGroupName)return f.error(u+"resourceGroupName not specified in galleryParameters."),!1;if(!t.resourceGroupLocation)return f.error(u+"resourceGroupLocation not specified in galleryParameters."),!1;if(i){if("subscriptionId"in
i&&i.subscriptionId!==t.subscriptionId)return f.error(u+"subscriptionId was changed in the create process."),!1;if("resourceGroupName"in i&&i.resourceGroupName!==t.resourceGroupName)return f.error(u+"resourceGroupName was changed in the create process."),!1;if("resourceGroupLocation"in i&&i.resourceGroupLocation!==t.resourceGroupLocation)return f.error(u+"resourceGroupLocation was changed in the create process."),!1}}else return f.error(u+"galleryParameters were not specified."),!1;if(i){if(i.deploymentTemplateFileUris){if(!t.templateJson&&!n._findPropInObject(t.selectedTemplateId,i.deploymentTemplateFileUris))return f.error(u+"the templateJson was not defined and the selectedTemplateId is not defined in the deploymentTemplateFileUris."),!1}else return f.error(u+"deploymentTemplateFileUris not specified."),!1;if(!("deploymentName"in i))return f.error(u+"deploymentName not specified."),!1}else return f.error(u+"configurationOptions were not specified."),!1;return r?!0:(f.error(u+"create outputs were not specified."),
!1)},n._findPropInObject=function(n,t){n=n.toLowerCase();for(var i in t)if(t.hasOwnProperty(i)&&n===(i+"").toLowerCase())return t[i];return null},n.prototype._notify=function(n){var t={title:o.createResourceFailedLabel,description:n,status:w};u.getNotificationManager().addClientNotification(t)},n.prototype._getGalleryItemId=function(n){var t=n&&n.id,r=n.launchingContext,i;return t=r&&r.galleryItemId||t,t&&(i=t.split("."),i.length>1&&(t="{0}.{1}".format(i[0],i[1]))),t},n.prototype._deployTemplate=function(n){var t=new Date;return e.deployTemplate(n).then(function(n){var i=n&&n.timestamp&&new Date(n.timestamp.valueOf());return i&&i.getTime()<=t.getTime()&&(i=new Date(t.getTime()+1)),{correlationId:n.correlationId,timestamp:i}})},n}();t.CsmCommand=k}(f||(f={})),f});define("MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector",["require","exports","f","i","../Extension/Extension.Definition.Locator","../UI/Hubs/ViewModels/UI.Gallery.CsmCommand","../Widgets/Widgets.WidgetBase"],function(
n,t,i,r,u,f,e){"use strict";var o;return function(t){function tt(){return s||(s=i.require("MsPortalImpl/UI/Hubs/UI.CreateManager")),s}function it(n,t){ko.bindingHandlers.fxParameterCollector={init:function(){return{controlsDescendantBindings:!1}},update:function(i,r,u,f,e){var o=ko.unwrap(r()),s=e.$data.cloudName||nt();o&&new h(g(i),o,n,t,s)}}}var a=u.Locator,v=r.Extension,y=v.CloudName,o=i.Base,p=o.Constants.ExtensionNames.Hubs,w=o.Diagnostics,b=o.Utilities,k=i.Parts.PartSize,c=i.Resources.Strings.Part.Provisioning,rt=window,d=w.createLog(n),g=jQuery,nt=ko.observable,s,l=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(e.ViewModel),h;t.ViewModel=l;h=function(n){function t(t,i,r,u,e){var o,s,h;n.call(this,t,i||new l);o=i.privatePcPrBI;o.triggerProvisioningInStartboardPart.subscribe(this.lifetimeManager,function(n){var t;if(n){var i=o.provisioningPartExtensionName(),u=o.provisioningPartName(),f=a.forExtension(i,e.peek()).withPartType(u);i===p&&(n=b.clone(n,!0),y.
addToModel(e.peek(),n));r.addPartToStartBoard({originPartLocator:f,model:n,modelContainsSensitiveData:!0,initialSize:k.Normal});t=r.getActiveJourney();t&&o.forceDiscardJourney()&&r.forceDiscardJourney(t.id)}});s=function(){var n=new f.CsmCommand(e.peek());o.provisioningCommand(n)};o.triggerProvisioningCommand.subscribe(this.lifetimeManager,s);o.triggerProvisioningCommand.peek()&&ko.ignoreDependencies(s);o.provisioningAttempted.subscribe(this.lifetimeManager,function(n){if(n){var t=r.getActiveJourney();t&&o.forceDiscardJourney()&&r.forceDiscardJourney(t.id)}});h=function(n){n&&(n.galleryParameters?tt().then(function(t){return t.processResourceGroupChange(u,n.galleryParameters,n.configurationOptions,n.deploymentResponse,e.peek()).then(function(){o.provisioningCompleted({succeeded:!0})},function(n){o.provisioningCompleted({succeeded:!1,statusUnavailable:n===c.deploymentStatusUnavailable,pollingFailed:n===c.pollingFailed,errorMessage:n})})}):d.error("galleryParameters should be specified in the provisioningStarted object."))}
;o.provisioningStarted.subscribe(this.lifetimeManager,function(n){h(n)});h(o.provisioningStarted())}return __extends(t,n),t}(e.Widget);t.Widget=h;t.initialize=it}(o||(o={})),o});define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",["require","exports","f","./Base.KnockoutTemplateSanitizer"],function(n,t,i,r){"use strict";var u;return function(){function e(n,t){var i=ko.unwrap(n()),r=l(i,t);return function(){return r}}function l(n,t){var i;if(n&&typeof n=="object")return i={},Object.getOwnPropertyNames(n).forEach(function(u){s.isSerializableProperty(u)&&(r.isAllowedCssClassName(u)?i[u]=n[u]:u&&t.push(u))}),i;var u=String(n||""),f=u.split(" "),e=Array.prototype.map.call(f,function(n){return n=String(n||""),r.isAllowedCssClassName(n)?n:(n&&t.push(n),"")});return e.join(" ")}function a(n,t){var i=n.getAttribute("data-bind")||"None",r=c.format(String(n.tagName),i,t.join(", "));h.error(r)}var u=i.Base,o=u.Diagnostics,s=u.Utilities,v=window,h=o.createLog(n),c="Sanitization error found in 'sanitizedCss' binding\nTag name: {0}; Binding attribute: \"{1}\"\nDisallowed class name(s): {2}",
f=ko.bindingHandlers,t=f.css;f.sanitizedCss={init:function(n,i,r,u,f){if(t.init){var o=e(i,[]);return t.init(n,o,r,u,f)}return null},update:function(n,i,r,u,f){var o=[],s=e(i,o);return o.length&&a(n,o),t.update(n,s,r,u,f)}}}(u||(u={})),u});define("MsPortalImpl/Base/Base.PartGallery",["require","exports"],function(){"use strict";var n;return function(n){(function(n){n[n.None=0]="None";n[n.ResourceGroup=1]="ResourceGroup";n[n.AssetType=2]="AssetType";n[n.Search=3]="Search";n[n.Tag=4]="Tag";n[n.General=5]="General"})(n.PivotType||(n.PivotType={}));var t=n.PivotType}(n||(n={})),n});define("MsPortalImpl/Base/ClaimsIdentity",["require","exports","f","../Services/Services.Storage"],function(n,t,i,r){"use strict";var u;return function(t){function s(n,t){var i=Q.defer(),r=new FileReader,u="data:image/jpeg;base64,";return r.onload=function(n){for(var s,r=n.target.result,f="",o=new Uint8Array(r),e=0;e<o.byteLength;e++)f+=String.fromCharCode(o[e]);try{s=atob(f);r=u+f}catch(h){r=h.code===5?u+btoa(f):
t}i.resolve(r)},r.onerror=function(n){o.error("Error {0} occured while reading user's thumbnail photo".format(n.target.error));i.resolve(t)},r.readAsArrayBuffer(n),i.promise}function h(n,t,i,u){var e=t,o,h;return n&&(o=r.ComponentName.Avatar,h=r.Lifetime.Default,e=!u&&i.getValue(o,n,h),!e)?f.ajax({uri:n,type:"GET",dataType:"binary",responseType:"arraybuffer",isBackgroundTask:!0,setAuthorizationHeader:{resourceName:"graph"}}).then(function(n){return s(n,t)}).catch(function(n){if(n.jqXHR.status===f.HttpStatusCode.NotFound)return t;throw n;}).then(function(t){return i.setValue(o,n,t,h),t}):Q(e)}var u=i.Base,e=u.Diagnostics,f=u.Net2,o=e.createLog(n);t.getAvatarImage=h}(u||(u={})),u});define("MsPortalImpl/Base/JQueryExtensions",["require","exports","f"],function(n,t,i){"use strict";var r;return function(){function f(t){return function(i){var c=n(o,this),r=s(c),h,f,e;for(t&&(r=r.reverse()),h=i?function(n){return!n.hasClass(u)&&i(n)&&n.is(":tabbable")}:function(n){return!n.hasClass(u)&&n.is(":tabbable")}
,f=0;f<r.length;f++)if(e=n(r[f]),h(e))return e;return n([])}}var r=i.Base.EventTypes,e=window,n=jQuery,u="msportalfx-skip-initial-focus",t=n.fn,o="input, textarea, select, button, a, [tabindex=0]",s=n.makeArray;t.setEvents=function(){for(var n,i,r=[],t=0;t<arguments.length;t++)r[+t]=arguments[t];return n=this,i=function(t){var i=n[t].bind(n);r.forEach(function(n){var u=n[0],t=n[1],f=typeof t,r;f==="function"?i(u,t):(r=n[2],r&&i(u,t,r))})},i("on"),{dispose:function(){n&&(i("off"),n=null)}}};t.findByClassName=function(n){return this.find("."+n)};t.findFirstTabbable=f();t.findLastTabbable=f(!0);t.isInScrollView=function(n){var u,t=n?this.closest("."+n):u=this.scrollParent();if(!t[0].offsetParent||!t.is(u||this.scrollParent())&&!this.isInScrollView())return!1;var i=t.offset().top,f=i+t.height(),r=this.offset().top,e=r+this.height(),o=r>=i&&r<=f,s=e<=f&&e>=i;return o&&s};t.handleTransitionEndOnce=function(t,i,u){var s=this,f,h=!1,o;this.on(r.transitionend,f=function(n){for(var e,o=[],i=1;i<
arguments.length;i++)o[i-1]=arguments[i];(e=n&&n.originalEvent,e&&e.propertyName!==t)||h||(h=!0,s.off(r.transitionend,f),u.apply(s,[n].concat(o)))});return o=function(){var i=n.Event("transitionend",{originalEvent:{propertyName:t}});f(i)},n.fx.off?o():e.setTimeout(o,i),this};n.enableAnimations=function(t){var i="fxs-transition-off-style-head-marker",u=n("<style/>").addClass(i).append("* {transition: none !important;-webkit-animation-iteration-count: .5 !important;animation-iteration-count: .5 !important;-webkit-animation-duration: 0s !important;animation-duration: 0s !important;-webkit-animation-delay: 0s !important;animation-delay: 0s !important;}"),r=n("head");n.fx.off=!t;t?r.findByClassName(i).remove():r.findByClassName(i).length===0&&r.append(u)}}(r||(r={})),r});define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels",["require","exports","f","i"],function(n,t,i,r){"use strict";var u;return function(t){var c=r.Extension,e=i.Base,l=e.Constants,a=e.Diagnostics,f=a.createLog(
n),o="^[a-zA-Z][\\w]*$",u,v,s,h;(function(n){n[n.GetCodeComponentsFailed=0]="GetCodeComponentsFailed";n[n.InvalidMetadata=1]="InvalidMetadata";n[n.ListCodeComponentsFailed=2]="ListCodeComponentsFailed";n[n.NoModifiedCodeComponentsFound=3]="NoModifiedCodeComponentsFound";n[n.RegisterCodeComponentFailed=4]="RegisterCodeComponentFailed";n[n.UnregisterAllCodeComponentsFailed=5]="UnregisterAllCodeComponentsFailed";n[n.UnregisterCodeComponentFailed=6]="UnregisterCodeComponentFailed";n[n.UsingModifiedCodeComponents=7]="UsingModifiedCodeComponents";n[n.InvalidCodeComponentName=8]="InvalidCodeComponentName"})(t.ErrorCodes||(t.ErrorCodes={}));u=t.ErrorCodes,function(n){n[n.Extension=0]="Extension";n[n.GalleryPackage=1]="GalleryPackage"}(t.SideLoadComponentTypeEnum||(t.SideLoadComponentTypeEnum={}));v=t.SideLoadComponentTypeEnum;s=function(){function n(){}return n.prototype._normalizeCloudNameHelper=function(n){return n?n:l.EmptyCloudName},n.prototype.isValid=function(){var n,t,i;return typeof this.
name!="string"?(f.error("Invalid name specified for extension",u.InvalidMetadata,this),!1):typeof this.uri!="string"||!this.uri?(f.error("Invalid uri specified for extension",u.InvalidMetadata,this),!1):(n=new RegExp(o),t=n.test(this.name),!t)?(i="Invalid extension name '{0}' specified. Extension names must match the following expression '{1}'.",f.error(i.format(this.name,o),u.InvalidCodeComponentName),!1):!0},n.prototype.isEqual=function(n){var t=n;return c.isEqualDescriptor(this,t)},n.prototype.updateWith=function(n){var t=n;this.name=t.name;this.uri=t.uri;this.features=t.features;this.trustedHost=t.trustedHost;this.startBoardParts=t.startBoardParts;this.isTestExtension=t.isTestExtension},n.prototype.markAsTestExtension=function(){this.isTestExtension=!0},n.prototype.logUsageWarning=function(){f.warning("Extension '{0}' is running untrusted code from '{1}'".format(this.name,this.uri),u.UsingModifiedCodeComponents,this)},n.prototype.normalizeCloudName=function(){this.cloudName=this._normalizeCloudNameHelper(
this.cloudName);this.trustedHost||(this.trustedHost="*")},n.create=function(t){var i=new n;return i.cacheability=t.cacheability,i.cloudName=t.cloudName,i.encryptTokens=t.encryptTokens,i.features=t.features,i.feedbackEmail=t.feedbackEmail,i.isTestExtension=t.isTestExtension,i.isTestStamp=t.isTestStamp,i.name=t.name,i.startBoardParts=t.startBoardParts,i.trustedHost=t.trustedHost,i.uri=t.uri,i},n}();t.ExtensionMetadataExt=s;h=function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n;return(this.uri&&this.uri.toLowerCase())===(t&&t.uri&&t.uri.toLowerCase())},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){f.warning("The untrusted gallery package '{0}' is running".format(this.uri),u.UsingModifiedCodeComponents,this)},n.create=function(t){var i=new n;return i.uri=t.uri,i},n}();t.GalleryPackageExt=h}(u||(u={})),u});define("MsPortalImpl/Services/Services.AssetManagement",["require","exports",
"f","h","../Services/Services.AssetTypes","../Services/Services.AssetTypes.Utils","../Services/Services.PortalIdentity","../Services/Services.Settings","../Services/Services.Storage","./Services.Settings.Schema"],function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return function(t){function ft(n){return tt(n)||it(n)||pt(n)}function wt(n,t,i){return new a(e.getSignedInUser(),n,t,i,ot.client)}function et(n,t){return c.getWindowId(n)+":"+t}function bt(n,t){return t}function kt(n,t){var i=n;return i&&Array.isArray(i)?(i.reverse().forEach(function(n){var i=f.getMruItemKey({cloudName:n.cloudName,name:n.extension},n.assetType,n.resourceId||n.assetId);t.addOrUpdate(i,n)}),!0):!1}var y=FxImpl,c=y.Extension,r=i.Base,ot=r.Rpc.Internal,st=r.Utilities,ht=i.Extension.BrowseType,u=i.ViewModels.Services.ResourceTypes,p=o.SettingStore,l=y.AssetManager,ct=r.Constants,w=ct.ResourceTypes,lt=r.Diagnostics,at=1e4,b=50,k=h.assetMruListKey,dt=s.Lifetime.Session,vt=2e4,d="fulfilled",g=lt.createLog(n),nt="MRU entry with no mapping view model",
yt=ko.observableArray,tt=u.isSubscriptionId,it=u.isResourceGroupId,pt=u.isResourceId,rt=u.tryBuildResourceManagerKey,ut=u.parseResourceDescriptor,a,v;t.createAssetManager=wt;a=function(){function n(n,t,i,r,f,e){var s=this,o;this._assetDeletedCallbacks=$.Callbacks();this._deletedAssets={};this._hubsWindowId=c.getHubsWindowId();this.deletedAssets=[];this._extensionManager=t;this._settingsService=i;this._assetTypeService=r;this._portalIdentity=n;this._assetMruList=e;o=function(n,t,i){var h=s.handleAssetDeleted.bind(s),f=n.assetId,e,o;n.assetType===l.resourceAssetType?(e=t.cloudName,o=void 0,o=tt(f)?w.Subscriptions:it(f)?w.ResourceGroups:u.buildResourceTypeFromResourceId(f),o&&r.mapResourceIdToAssetId(f,e).then(function(n){h({cloudName:e,name:n.extensionName},n.assetType,n.assetId,i)},function(){})):h(t,n.assetType,f,i)};f&&(l.notifyAssetDeletedDefinition.register(f,null,function(n,t){var i=t.srcWindowId,r="Received asset deletion notification from the extension '"+i+"'",u=c.getDescriptor(
i);o(n,u,r)}),l.hubsNotifyAssetDeletedDefinition.register(f,[this._hubsWindowId],function(n){o(n,{cloudName:n.cloudName,name:n.extensionName},n.reason)}));this._notifyDeletedResources()}return n.prototype.onAssetDeleted=function(n){this._assetDeletedCallbacks.add(n)},n.prototype.isAssetDeleted=function(n,t,i){var u=et(n,t),r=this._deletedAssets[u];return r&&r.some(function(n){return f.compareAssetId(n,i)})},n.prototype.markAssetDeleted=function(n,t,i,r){this.handleAssetDeleted(n,t,i,r)},n.prototype.getDiagnosticsData=function(){return{mruList:this.assetMruList.mruList.peek()}},n.prototype.handleAssetDeleted=function(n,t,i,r){if(!this.isAssetDeleted(n,t,i)){var u=et(n,t),f=this._deletedAssets[u]||(this._deletedAssets[u]=[]);f.push(i)}this.deletedAssets.push({extensionDescriptor:n,assetId:i,assetType:t,reason:r});this._assetDeletedCallbacks.fire(n,t,i,r)},Object.defineProperty(n.prototype,"assetMruList",{get:function(){var n=this._assetMruList;if(!n){n=this._assetMruList=this._createMruList(
);this.onAssetDeleted(function(t,i,r){return n.removeAssetEntry(t,i,r)})}return n},enumerable:!0,configurable:!0}),n.prototype._createMruList=function(){return new v(this._portalIdentity,this._settingsService,this._assetTypeService)},n.prototype._notifyDeletedResources=function(){var t=this,n={},i=[];this.assetMruList.mruList.peek().filter(function(n){return!ft(n.assetId)}).forEach(function(r){var f=r.assetType,e=r.extension,o=r.cloudName,u=((o||"")+":"+e+f).toLowerCase(),s;n[u]||(s=t._assetTypeService.getAssetTypePromise(e,f,o).then(function(n){return{assetType:n,mapKey:u}}),i.push(s),n[u]=[]);n[u].push(r)});Q.allSettled(i).then(function(i){i.forEach(function(i){var r,u;i.state===d&&(r=i.value,r&&(u=r.assetType&&r.assetType.assetTypeManifest.resourceType,u&&!u.mappingViewModel&&n[r.mapKey].forEach(function(n){g.debug("Removing "+nt+": "+JSON.stringify(n));t._assetMruList.removeEntry({name:n.extension,cloudName:n.cloudName},n.assetType,n.assetId)})))})})},n}();t.AssetManagerImpl=a;v=function(
){function n(n,t,i,u){var f=this;this._list=new r.LruMap(b);this._observableList=null;this._settingsService=t;this._assetTypeService=i;this._logDelay=st.isNullOrUndefined(u)?at:u;this._debouncer=new r.Debouncer(bt,function(n){return f._logAssetAccess(n)},this._logDelay);this.initialSettingsSyncPromise=this._startSyncSettingsFromCloud().then(function(){f.updateObservableList()})}return n.prototype.logAssetAccess=function(n,t,i,r){var u={cloudName:n.cloudName,extension:n.name,assetType:t,assetId:i,assetName:r,timeStamp:Date.now()};return this._logDelay?(this._debouncer.execute([u]),Q(!0)):this._logAssetAccess([u])},Object.defineProperty(n.prototype,"mruList",{get:function(){var n=this._observableList;return n||(n=this._observableList=yt([]),this.updateObservableList()),n},enumerable:!0,configurable:!0}),n.prototype.removeAssetEntry=function(n,t,i){var f=this,r,u=rt(i);return r=u?Q(u):Q(this._assetTypeService.mapAssetIdToResourceId({extensionName:n.name,assetType:t,assetId:i},n.cloudName).
then(function(n){return ut(n),n},function(){return null})),r.then(function(r){f.removeEntry(n,t,r||i)})},n.prototype.clear=function(){this._list.getList().forEach(function(n){n.removedTimeStamp=Date.now()});this.updateObservableList();this._startSyncSettingsFromCloud()},n.prototype.removeEntry=function(n,t,i){var u=f.getMruItemKey(n,t,i),r=this._list.get(u);r&&(r.removedTimeStamp=Date.now(),this.updateObservableList(),this._startSyncSettingsFromCloud())},n.prototype.onCloudSyncFinished=function(n){this._cloudSyncCompletedCallback=n},n.prototype._logAssetAccess=function(n){var t=this,i=[];return n.forEach(function(n){var r=rt(n.assetId);r?i.push(Q({resourceId:r,entry:n})):i.push(Q(t._assetTypeService.mapAssetIdToResourceId({extensionName:n.extension,assetType:n.assetType,assetId:n.assetId},n.cloudName).then(function(t){return ut(t),{resourceId:t,entry:n}},function(){return{resourceId:null,entry:n}})))}),Q.allSettled(i).then(function(n){var i=!1;n.forEach(function(n){var o,s,y,u;if(n.state===
d){var h=n.value,e=h.resourceId,r=h.entry,c=r.assetId,l=r.cloudName,a=r.extension,v=r.assetType;if(!e&&!ft(c)&&(o=t._assetTypeService.getAssetType(a,v,l),s=o&&o.assetTypeManifest.resourceType,s&&!s.mappingViewModel)){g.warning("Not adding "+nt+": "+JSON.stringify(r));return}i=!0;y=f.getMruItemKey({cloudName:l,name:a},v,e||c);u=t._list.getOrAdd(y,function(){return r});u.resourceId=e;u===r||u.removedTimeStamp&&Date.now()-u.removedTimeStamp<vt||(u.removedTimeStamp=undefined,u.assetName=r.assetName,u.timeStamp=r.timeStamp)}});i&&(t.updateObservableList(),t._startSyncSettingsFromCloud())})},n.prototype.updateObservableList=function(){var i=this,n=this._observableList,t;n&&(t=this._list.getList().filter(function(n){if(n.removedTimeStamp)return!1;var t=i._assetTypeService.getAssetType(n.extension,n.assetType,n.cloudName,0);return!(t&&t.assetTypeManifest.browseType===ht.ResourceType&&!n.resourceId&&typeof n.assetId!="string")}),n.splice.apply(n,[0,n().length].concat(t)))},n.prototype._startSyncSettingsFromCloud=
function(){var n=this,f=function(){n._settingsService.setSetting(p.General,k,n._list.getList());var t=n._cloudSyncCompletedCallback;t&&t()},t,u=this._querySettingsCalledDeferred;return u?t=u.promise():(this._querySettingsCalledDeferred=i.Helpers.Deferred(),t=this._settingsService.querySetting(p.General,k).then(function(t){var i=new r.LruMap(b);kt(t,i)&&(n._list=i);return})),Q(t).then(function(){f();n._querySettingsCalledDeferred.resolve();return})},n}();t.AssetMruListImpl=v}(c||(c={})),c});define("MsPortalImpl/Services/Services.Permissions",["require","exports","f","h"],function(n,t,i,r){"use strict";var u;return function(t){function k(n,t){return new a(n,t)}function d(n,t,i){return h.hasPermissionsToHubs.invoke(u.client,f,{entityId:n,requestedActions:t,providedActions:null,cloudName:i})}function g(n,t){return h.getPermissionsToHubs.invoke(u.client,f,{entityId:n,cloudName:t})}function nt(n){return h.isCoAdminEndpoint.invoke(u.client,f,{cloudName:n})}var v=FxImpl,e=v.Extension,o=i.Base,
y=o.Diagnostics,u=o.Rpc.Internal,p=i.ViewModels,w=p.Services.ResourceTypes,s=r.Permissions,c=s.PermissionChecker,h=s.Rpc,b=window,tt=!!b.fx.environment.isDevelopmentMode,f=e.getHubsWindowId(),l=y.createLog(n),a;t.Internal={};t.createPermissionsManager=k;a=function(){function n(n,t){var r=this,i;this._extensionManager=n;this._assetTypeService=t;i=s.createCachedPermissionsGetter(g);this._cachedPermissionsGetter=i;this._getPermissionsCallback=i.getPermissions.bind(i);e.hasPermissionsToShell.register(u.client,null,function(n,t){var i=t.srcWindowId;return i!==f&&i!==o.Constants.Shell&&(n.cloudName&&l.warning("{0} should not pass cloud name".format(i)),n.cloudName=e.getDescriptor(t.srcWindowId).cloudName),r.hasPermission(n.entityId,n.requestedActions,n.cloudName)})}return n.prototype.isCoAdmin=function(n){return nt(n)},n.prototype.hasPermission=function(n,i,r){return t.Internal.hasPermissionOverride?t.Internal.hasPermissionOverride(n,i):c.isRDFEAction(i)?d(n,i,r):w.isResourceManagerId(n,!0)?
c.hasPermission(n,i,null,r,this._getPermissionsCallback):(l.error("The entity ID for hasPermission must be a resource ID, a subscription ID or a resource group ID, failing open"),Q(!0))},n.prototype.getCachedPermissions=function(n){return this._cachedPermissionsGetter.getCachedPermissions(n)},n}()}(u||(u={})),u});define("MsPortalImpl/UI/Hubs/UI.BrowseManager",["require","exports","f","i","u","../../Services/Services.AssetTypes","../../Services/Services.AssetTypes.Utils"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function gt(n){tt||(tt=n.assetManager.assetMruList.mruList.subscribe(function(){var t=c.pingMruAssetsListEndPoint;n.extensionManager.getHubsExtension().then(function(){t.invoke(p.client,y,nt).catch(function(n){if(!p.errorIsRpcTimeout(n,t.getName(),y))throw n;})})}))}function ni(n){if(!it){it=!0;var t=n.rpcClient,o=n.assetManager,i=n.assetTypeService,r=[wt],u=o.assetMruList;c.clearMruAssetsListEndPoint.register(t,r,function(){return u.clear(),Q(!0)});c.removeMruAssetEndPoint.
register(t,r,function(n){return u.removeAssetEntry({cloudName:n.cloudName,name:n.extension},n.assetType,n.assetId).then(function(){return!0})});c.getMruAssetsListEndPoint.register(t,r,function(){var t=u.mruList().slice(0),n=[];return t.forEach(function(t){var o=t.cloudName,s=t.extension,h=t.assetType,c=at.getAssetTypeOrResourceTypeId(s,o,h),u,r,l;(s===ft&&h===ut||i.hasAssetTypeById(c,1))&&(u=t.resourceId||t.assetId,r=i.getAssetTypeById(c),r?(l={key:e.getMruItemKey({cloudName:o,name:s},h,u),isResourceTypeBrowse:r.assetTypeManifest.browseType===k,id:u,isPreview:r.isPreview,name:t.assetName,resourceTypeAssetTypeInformation:i.mapAssetTypeToResourceTypeAssetTypeInformation(r),timeStamp:t.timeStamp,cloudName:o},n.push(l)):f.warning("Could not find the asset type for the MRU entry. AssetTypeId : <"+c+"> : ID: <"+JSON.stringify(u)+">"))}),n})}}function ti(n,t,i,r){return new rt(n,t,i,r)}var s=i.Base,h=s.Constants,ut=h.AssetNames.SubscriptionDetail,v=h.ExtensionNames,y=v.Hubs,ft=v.Billing,et=h.
ResourceTypes.ResourceGroups,ot=s.Diagnostics,p=s.Rpc.Internal,l=s.Utilities,st=i.Extension,o=st.BrowseType,w=i.ViewModels,ht=MsPortalHubs,ct=w.Services.Browse,lt=w.Services.GridColumns,c=ht.RpcEndPoints.Mru,a=r.Extension,at=r.Assets,vt=window,yt=vt.fx.environment,f=ot.createLog(n),pt=et.toLowerCase(),wt=a.getHubsWindowId(),b=i.forEachKey,ii=o.AssetTypeBlade,bt=o.InstanceLink,k=o.ResourceType,d=o.ServiceLink,g=o.ServiceViewModel,kt=ko.observableArray,nt=u,tt=null,it=!1,dt=r.getErrorMap({badCriteria:""}),rt;t.subscribeToMruItems=gt;t.registerRpcEndpoints=ni;t.createBrowseManager=ti;rt=function(){function n(n,t,i,r){var f=this,u;this._browsePackages={};this._registeredResourceProviders=kt(["*"]);this._haveRdfeAccess=!1;this._callbacks={};this._isCoAdmin=!1;this._extensionManager=n;this._assetTypeService=t;this._permissionsService=i;u=this._executeCallbacks.bind(this);this._registeredResourceProviders.subscribe(u);this._haveRdfeAccess=r();r.subscribe(function(n){f._haveRdfeAccess=n;u()});
n.initialManifestsLoadPromise().then(function(){u();t.assetTypes.subscribe(u)})}return n.prototype._executeCallbacks=function(){var n=this._callbacks;n&&b(n,function(n,t){t()})},n.prototype._assetTypeSupportsCriteria=function(n,t){return n.extension===t.assetOwner&&n.assetTypeManifest.name===t.assetType&&a.isEqualCloudName(n.cloudName,t.cloudName)},n.prototype._releaseViewModel=function(n,t){l.disposeViewModelProperties(t);n.releaseViewModel(t)},n.prototype._assetTypeMeetsRequirements=function(n){var r,c,l,u,f,e,o,s,h,a;if(!n)return!1;var t=n.browseType,v=n.browseRequirements&i.Assets.BrowseRequirements.CoAdmin,y=!v||this._isCoAdmin;if(t===nt||!y)return!1;r=this._haveRdfeAccess;c=!n.browseRequiresRdfe||r;switch(t){case d:case bt:if(l=n.browseLinkUri||"",u=function(n){return n+="Portal",l.indexOf("{"+n+"}")>=0&&(i.getFeatureValue(n)==="false"||!yt.links[n])},u("classic")||u("account"))return!1;case g:case k:if(!c)return!1}return(f=n.resourceType,!f)?!0:(e=f.resourceTypeName,o=e.toLowerCase(
),o===pt)?!0:!r&&!o.startsWith("microsoft.")?!1:(s=e.split("/"),s.length<2)?!1:t===d?!0:(h=this._registeredResourceProviders,h().some(function(n){return n.toLowerCase()==="*"}))?!0:(a=s[0].toLowerCase(),h().some(function(n){return n.toLowerCase()===a}))},n.prototype.dispose=function(){b(this._browsePackages,function(n,t){t.cancel();t.dispose()});this._browsePackages=null},n.prototype.initialize=function(){this._extensionManager.getHubsExtension()},n.prototype.registerAssetTypesUpdateCallback=function(n){var t=l.getUniqueId();return this._callbacks[t]=n,t},n.prototype.unregisterAssetTypesUpdateCallback=function(n){var t=this._callbacks;t[n]&&delete t[n]},n.prototype.addRegisteredResourceProvider=function(n){this._registeredResourceProviders.push(n)},n.prototype.initiateBrowse=function(n){var t=this,r;return n||dt.badCriteria(),r=new ct.ResultsViewModel(n,[]),i.require("MsPortalImpl/UI/Hubs/UI.BrowseManagerDelayed").then(function(i){var s="browse-"+l.getUniqueId(),u=new i.BrowsePackage(r,
t),c=u.lifetimeManager;t._browsePackages[s]=u;var e=0,o=0,h=!1;return t._assetTypeService.assetTypes().forEach(function(i){var l,s;if(!u.canceled&&t._assetTypeSupportsCriteria(i,n)&&(l=i.assetTypeManifest,l.browseType===g)){var r=function(){++o;h&&o===e&&(f.verbose("All browse operations returned."),u.allOperationsReturned())},v=l.browseServiceViewModel,y=a.getWindowId({name:i.extension,cloudName:i.cloudName})+"."+l.name+"."+v;f.verbose("Browse provider "+y+" using optimized browse.");s="browse operation from "+y+" browse provider";t._extensionManager.getExtensionByName(i.extension,i.cloudName).then(function(e){e.getViewModel(v).then(function(o){var h=o.content,a,v,l;h?(a=!1,c.registerForDispose(function(){a=!0;t._releaseViewModel(e,o)}),a?(f.verbose("The "+s+" was already disposed."),r()):(v=function(n,t){u.canceled||(f.verbose("Got "+s+"."),u.addOperation(i,n,t));r()},l=void 0,typeof h.onInputsSet=="function"&&(l=h.onInputsSet({criteria:n})),l?l.then(function(){v(y,h)},function(){f.verbose(
"The "+s+" rejected the load promise.");r()}):v(y,h))):(f.verbose("Failed to get the "+s+"."),r())},function(n){f.verbose("Failed to get browse operation "+v+", "+n+".");r()})},function(n){f.error("Failed to get extension for browse operation "+v+", "+n+".");r()});f.verbose("Getting "+s+".");++e}}),h=!0,o===e&&(f.verbose("All browse operations returned."),u.allOperationsReturned()),s})},n.prototype.getViewModelForBrowse=function(n){var t=this._browsePackages;return n in t?t[n].viewModel:null},n.prototype.releaseBrowse=function(n){var t=this._browsePackages,i;n in t&&(i=t[n],i.cancel(),i.dispose(),delete t[n])},n.prototype.compareAssetTypeNameForSorting=function(n,t){var i=n.toLocaleLowerCase(),r=t.toLocaleLowerCase();return i===r?0:i<r?-1:1},n.prototype.getFilteredAssetTypes=function(){var n=this,t,r;return this._isCoAdminPromise||(this._isCoAdminPromise=Q(this._permissionsService.isCoAdmin(h.DefaultCloudName)).then(function(t){n._isCoAdmin!==t&&(n._isCoAdmin=t,n._executeCallbacks())})),
t=[],r=[],this._assetTypeService.assetTypes().forEach(function(i){var r=i.assetTypeManifest;n._assetTypeMeetsRequirements(r)&&(r.privateBrowse||t.push(i))}),t.length&&i.stableSort(t,function(t,i){return n.compareAssetTypeNameForSorting(t.compositeDisplayName.service,i.compositeDisplayName.service)}).forEach(function(n){r.push(n)}),r},n.prototype.getGridColumnsPromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.gridColumnsServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension,n.cloudName)).then(function(n){return Q(n.getViewModel(i)).then(function(i){var e=!1,u,f;return(t.registerForDispose(function(){e=!0;r._releaseViewModel(n,i)}),!e)?(u=i.content,f=void 0,typeof u.onInputsSet=="function"&&(f=u.onInputsSet({usage:lt.Usage.Default})),f)?f.then(function(){return u}):u:Q.reject("The grid columns service view model was already disposed.")})}):Q.reject("The asset type does not have a grid columns service view model.")},n.prototype.getDynamicBladePromiseForAssetType=
function(n,t){var r=this,i=n.assetTypeManifest.dynamicBladeServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension,n.cloudName)).then(function(n){return Q(n.getViewModel(i)).then(function(i){var u=!1;return(t.registerForDispose(function(){u=!0;r._releaseViewModel(n,i)}),!u)?i.content:Q.reject("The dynamic blade service view model was already disposed.")})}):Q.reject("The asset type does not have a dynamic blade service view model.")},n}()}(o||(o={})),o});define("MsPortalImpl/UI/Commands/UI.CommandManager",["require","exports","f","i","MsPortalImpl.Controls/Controls/Balloon","../../Interactions/Interactions.DismissHandler","./UI.Commands","../Compositions/UI.Composition","../../Widgets/Widgets.ContextMenu"],function(n,t,i,r,u,f,e,o,s){"use strict";var h;return function(t){function d(n){return new l(n)}var y=r.TriggerableLifetimeManager,a=i.Base,p=a.Diagnostics,c=a.EventTypes,v=i.ViewModels.Controls.Balloon,w=v.ViewModel,b=window,h=jQuery,g=p.createLog(n),k="<div class='fxs-commands-contextMenu'><\/div>",
l;t.createCommandManager=d;l=function(){function n(n){var t=this,r;this._lifetimeManager=new y;this._body=h("body");this._desktop=n;this._initializeContextMenu();this._handleDesktopModeChange();r=function(n){var i=t._balloonContentElement;return!(i===n)&&!h.contains(i,n)};this._dismissHandle={dismissFn:function(){i.require("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox").then(function(n){n.cancelMessageBox(h(t.getForm()));t.hideForm()})},shouldDismissOnMouseDownFn:r,shouldDismissOnMouseWheelFn:r,restoreFocus:function(){f.validatePreviousFocusedElement(t._dismissHandle,t._previouslyFocusedElement)&&t._previouslyFocusedElement.focus()},logName:"commandmanager"}}return n.prototype.dispose=function(){this.stopListeningForEvents();f.unregister(this._dismissHandle);this._lifetimeManager.dispose()},n.prototype.startListeningForEvents=function(){var u=this,n=this._body;n.on(c.fxcontextmenu,this._fxMenuEventHandler=function(n,t){u._showContextMenu(n,t)}).on(c.contextmenu,this._browserMenuEventHandler=
function(n){var i,t;if(n.ctrlKey||(i=b.getSelection(),i.rangeCount&&!i.getRangeAt(0).collapsed)||h(n.target).filter("input,textarea").length)return!0;n.preventDefault();n.stopPropagation();t=h.Event(c.fxcontextmenurequest);t.pageX=n.pageX;t.pageY=n.pageY;t.clientX=n.clientX;t.clientY=n.clientY;h(n.target).trigger(t)});var t=this._contextMenuElement,i=this._desktop.portalWidget,r=i&&i.element;return r?r.append(t):n.append(t),this},n.prototype.stopListeningForEvents=function(){var n=this._body;this._fxMenuEventHandler&&(n.off(c.fxcontextmenu,this._fxMenuEventHandler),this._fxMenuEventHandler=null);this._browserMenuEventHandler&&(n.off(c.contextmenu,this._browserMenuEventHandler),this._browserMenuEventHandler=null);this._contextMenu.hide();this._contextMenuElement.detach()},n.prototype.getForm=function(){if(!this._balloonContentElement){var n=h("<div/>"),t=this._balloonViewModel=new w(this._lifetimeManager);t.position(v.Position.Top);t.content("<div><\/div>");h("body").append(n);new u.Widget(
n,t);n.addClass("fxs-dialogballoon");this._balloonContentElement=n.findByClassName("azc-balloon-content").children()[0].children[0]}return this._balloonContentElement},n.prototype.showForm=function(n){var t=this;this._previouslyFocusedElement=document.activeElement;this._balloonViewModel.box(n);this._balloonViewModel.visible(!0);i.require("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox").then(function(n){setTimeout(function(){n.setFocusOnMessageBox(h(t.getForm()))},125)});f.register(this._dismissHandle)},n.prototype.hideForm=function(){this._balloonViewModel&&(this._balloonViewModel.visible(!1),h(this._balloonContentElement).empty());f.unregister(this._dismissHandle)},n.prototype._initializeContextMenu=function(){this._contextMenuElement=h(k);this._contextMenu=new s.Widget(this._contextMenuElement);this._contextMenu.hide()},n.prototype._showContextMenu=function(n,t){var v=this,f=t.contextMenu?t.contextMenu:this._contextMenu,l=f.options.menuItems,i,r,a,s=n.clientX,c=n.clientY,u;if(t.commands&&
t.commands.length!==0){a=t.formTarget&&t.formTarget.length>0?e.getBladeWidget(t.formTarget):this;f.hide();l.splice(0,l().length);do r=r?r.parentNode:n.target,i=h(r).data(o.CompositionInstanceDataName);while(!i&&r.parentNode);(o.isContextMenuContainer(i)&&i.beforeActivateCommandMenuItems(t),t.commands.forEach(function(t){v._shouldShowCommand(t)&&(t.activate(),t.bind(new e.CompositionInstanceCommandContext(n.target,a,i)),l.push(t))}),f.options.hasVisibleCommands())&&(s||c||(u=n.target.getClientRects()[0],s=u&&u.left||s,c=u&&u.bottom||c),f.show(s,c,t&&t.forceLeft))}},n.prototype._handleDesktopModeChange=function(){var n=this;this._desktop.mode.subscribe(this._lifetimeManager,function(t){t===1&&n.hideForm()})},n.prototype._shouldShowCommand=function(n){return this._desktop.mode()!==1||!this._isExtensionCommand(n)},n.prototype._isExtensionCommand=function(n){return!!n._extension},n}();t.PortalCommandManager=l}(h||(h={})),h});define("MsPortalImpl/UI/UI.ContextPane",["require","exports","f","../Interactions/Interactions.DismissHandler"],
function(n,t,i,r){"use strict";var u;return function(n){function e(n,i,r){return new t(n,i,r)}var f=i.Base,u=f.EventTypes,t;n.create=e;t=function(){function n(n,t,i){var s=this,f,e,o;this._widget=n;f=this._viewModel=n.options;this._themeManager=i;this.collapsed=f.collapsed;e=function(n){n.stopPropagation();s.close()};n.element.on(u.fxcontextpaneclosing,e);o={dismissFn:function(){s.close()},shouldDismissOnMouseDownFn:$.noop,shouldDismissOnMouseWheelFn:$.noop,logName:"contextPane"};ko.reactor(t,function(){f.opened()?r.register(o):r.unregister(o)});t.registerForDispose(function(){n.element.off(u.fxcontextpaneclosing,e)})}return Object.defineProperty(n.prototype,"opened",{get:function(){return this._viewModel.opened},enumerable:!0,configurable:!0}),n.prototype.hasContent=function(n){return this._contentProvider===n},n.prototype.getContent=function(){return this._contentProvider},n.prototype.tryOpen=function(n){var r=this,t,i;return this._contentProvider===n?(this._widget.setFocus(),Q(!0)):
(t=this._tryRemoveContent(),t)?(this._contentProvider=n,this._previouslyFocusedElement=document.activeElement,i=this._viewModel,i.opened(!0),i.loading(!0),this._themeManager.loadBladesCSS().finally(function(){return n.onAddingContent(r._widget)}).finally(function(){i.loading(!1)}).then(function(){return r._widget.setFocus(),t})):Q(t)},n.prototype.close=function(n){var t=!0,i;return n?this._clearContent():t=this._tryRemoveContent(),t&&(i=this._viewModel,i.opened(!1),i.loading(!1),this._restoreFocus()),t},n.prototype._clearContent=function(){var n=this._contentProvider;n&&n.onRemovingContent(this._widget);this._contentProvider=null},n.prototype._tryRemoveContent=function(){if(!this._contentProvider)return!0;var n=this._contentProvider.canRemoveContent();return n&&this._clearContent(),n},n.prototype._restoreFocus=function(){var n=this._previouslyFocusedElement;n&&n.focus()},n}();n.ContextPaneImpl=t}(u||(u={})),u});define("MsPortalImpl/UI/Compositions/UI.Composition.JourneySettingSerializer",
["require","exports","../../Base/Base.HierarchyMap"],function(n,t,i){"use strict";var r;return function(n){function r(n){if(n instanceof i.SerializableHierarchyMap)return n;var r=new t;return new i.SerializableHierarchyMap(r,n)}var t=function(){function n(){}return n.prototype.toJSON=function(n){var t={type:n.type};return n.editScope&&(t.editScope={editScopeId:n.editScope.editScopeId,dirty:!!n.editScope.dirty,saving:!!n.editScope.saving,disposeOnSelectionChange:n.editScope.disposeOnSelectionChange,disposeOnJourneyDiscard:!!n.editScope.disposeOnJourneyDiscard}),JSON.stringify(t)},n.prototype.fromJSON=function(n){var t=JSON.parse(n),i=t.editScope&&{editScopeId:t.editScope.editScopeId,dirty:t.editScope.dirty,saving:!!t.editScope.saving,disposeOnSelectionChange:t.editScope.disposeOnSelectionChange,disposeOnJourneyDiscard:t.editScope.disposeOnJourneyDiscard};return{editScope:i,type:t.type}},n}();n.JourneySettingSerializer=t;n.deserializeAmbientSettings=r}(r||(r={})),r});define("MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager",
["require","exports","f","u","./UI.Composition","./UI.Composition.PropertyBinding","../../Services/Services.Settings"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function h(n,i,r){var f=""+t.partIdentityStatePrefix+n.toString(),e;return r&&(f+="-"+r),i&&(e=i.hasOwnProperty(u.PartContainerModelIdProperty)&&[u.PartContainerModelIdProperty],f+="-"+l.toSortedString(ko.toJS(i),e)),f}function k(n){var i=n.widget;i&&i.element.trigger(t.fxpartsettingchanged,{part:n})}function d(n){var t;try{t=JSON.parse(JSON.stringify(n))}catch(i){t=n}return t}function rt(n){return n.some(function(n){var t=d(n.propertyValue),r=d(n.propertyOldValue);return!i.deepEquals(t,r)})}var y=i.Base,nt=y.Diagnostics,l=y.Utilities,c=l.Internal.Serialization,o=e.SettingStore,a=u.CompositionType,s=f.PropertyBinding,tt=window,p=tt.fx.environment,v=nt.createLog(n),w=Object.keys(p.trace.partsettings||{}),it=w.length>0,b=p.features.multidashboards==="true",g;t.partIdentityStatePrefix="[PartIdentityState]-";t.fxpartsettingchanged=
"fxpartsettingchanged";t.buildIdentitySettingKey=h;g=function(){function n(){this._trace=!1}return n.prototype.configure=function(n){this._options=n},n.prototype.configureInstanceProperties=function(n){this._options.instanceProperties=n},n.prototype.initialize=function(){var n=this;this.dispose();this._registerPartIdentityStateChangeHandler();this._registerPartSharedKeyChangeHandler();this._registerPartInstanceChangedHandler();it&&(this._trace=w.some(function(t){return n._options.partViewModelId.toLowerCase().indexOf(t)>=0}))},n.prototype.saveIdentityPartSettings=function(n){var u=this._options,f=u.part,s=u.services,e=s.sharedSettings,t=this.getKeyForIdentitySettings(n),i,r;b&&f.getCompositionType()===a.StartboardPart&&(i=t,t=h(f.locator,n));t&&(i&&e.deleteSettings({store:o.Part,keys:[i]}),r=c.toSerializableObject(this._identityState.targetModel),this._traceOperationWithSettings("Save identity part settings.",r,t),e.setSetting(o.Part,t,r),k(this._options.part))},n.prototype.clearIdentityPartSettings=
function(){var t=this._options;if(t){var i=t.part,r=i.containerModel,n=[this.getKeyForIdentitySettings(r)];i.getCompositionType()===a.StartboardPart&&n.push(h(i.locator,r));n=n.filter(function(n){return!!n});n.length>0&&t.services.sharedSettings.deleteSettings({store:o.Part,keys:n})}},n.prototype.getPartSettingsAsync=function(){if(b&&this._options.part.getCompositionType()===a.StartboardPart)return this.getStartboardPartIdentitySettings();var n=this.getIdentityPartSettingsAsync(),t=this.getSharedPartSettingsAsync();return Q.all([n,t]).spread(function(n,t){var i={};return $.extend(!0,i,n),$.extend(!0,i,t),i})},n.prototype.registerInstanceStateProperty=function(n,t,i){i===void 0&&(i=!0);var r=this._options.part,u=this._getOrCreateInstanceStatePropertyBindings(),f=u.targetModel,e=r.getSettingsModel();this._registerViewModelPropertyChangeHandler(t,e,f,u,function(){r.save()},n);i&&r.save()},n.prototype.savePart=function(){var n=this._options;n&&n.part.save()},n.prototype.dispose=function(){
var i=this._partInstanceState,n,t;i&&(i.unbind(),this._partInstanceState=null);n=this._identityState;n&&(n.unbind(),this._identityState=null);t=this._sharedKey;t&&(t.unbind(),this._sharedKey=null)},n.prototype.getKeyForIdentitySettings=function(n){var f=null,t=this._options,i=t.part,e=t.partStateDefinition,r=t.identityInputs,s=i.getInputPropertyBindings(),o=e&&e.inputIdentityProperties,u;return i.allInputsSet()&&o&&o.length>0&&(u="",r&&r.length>0&&(u=l.toSortedString(ko.toJS(s.targetModel),r)),f=h(i.locator,n,u)),f},n.prototype._registerPartIdentityStateChangeHandler=function(){var u=this,t=this._options,i=t.part,r=t.partStateDefinition,n=r&&r.inputIdentityProperties;n&&n.length>0&&(this._identityState=new f.PropertyBindings(i.toString()+"-[PartIdentitySettings]",{}),this._registerViewModelChangeHandler(n,this._identityState,function(n){var t=rt(n);t&&u.saveIdentityPartSettings(i.containerModel)}))},n.prototype._registerPartSharedKeyChangeHandler=function(){var e=this,t=this._options,h=
t.part,r=t.partStateDefinition,l=t.services,n=r&&r.sharedProperties,u,i;n&&n.length>0&&(u=n.map(function(n){return n.property}),i={},this._sharedKey=new f.PropertyBindings(h.toString()+"-[PartSharedSettings]",i),this._registerViewModelChangeHandler(u,this._sharedKey,function(){var t={},r;n.forEach(function(n){var r=s.getModelValue(i,n.property).value;t[n.key]=c.toSerializableObject(r)});r={store:o.SharedPart,settings:t};e._traceOperationWithSettings("Save shared part settings.",t);l.sharedSettings.setSettings(r)}))},n.prototype._registerPartInstanceChangedHandler=function(){var n=this._options,i,t=n.instanceProperties,r=function(n){return n.some(function(n){return n.propertyName==="content.pollingOptions"})};t&&t.length>0&&(i=this._getOrCreateInstanceStatePropertyBindings(),this._registerViewModelChangeHandler(t,this._partInstanceState,function(t){n.part.save();r(t)&&k(n.part)}))},n.prototype._registerViewModelChangeHandler=function(n,t,i){var r=this,u=t.targetModel,f=this._options.part.
getSettingsModel();n.forEach(function(n){r._registerViewModelPropertyChangeHandler(n,f,u,t,i)})},n.prototype._registerViewModelPropertyChangeHandler=function(n,t,i,r,u,f){var e;s.getModelValue(i,n).exists||s.setModelValue(i,n,ko.toJS(s.getModelValue(t,n).value));e=r.addProperty(n).bind(this._options.partViewModelId,t,!1,u,function(n){v.error("[PartState] Failed to bind changes from viewmodel to part state. Error: "+n)});f&&f.registerForDispose(function(){r.removeProperty(e)})},n.prototype.getIdentityPartSettingsAsync=function(){var t=this,i=this._options,u=i.partStateDefinition,f=i.part.containerModel,e=u&&u.inputIdentityProperties,n,s;return(e&&e.length>0)?(n=this.getKeyForIdentitySettings(f),s={store:o.Part,keys:[n]},this._getPartSettingsAsync("Get identity part settings.",s,r).then(function(i){if(n===t.getKeyForIdentitySettings(f)){var r=t._identityState;return r&&$.extend(!0,r.targetModel,i),i}})):Q.resolve(null)},n.prototype.getStartboardPartIdentitySettings=function(){var t=this.
_options,n=t.part,i=t.partStateDefinition,u=i&&i.inputIdentityProperties,f;return(u&&u.length>0)?(f=[this.getKeyForIdentitySettings(n.containerModel),h(n.locator,n.containerModel)],this._getPartSettingsAsync("Get identity part settings.",{store:o.Part,keys:f},r)):Q.resolve(null)},n.prototype.getSharedPartSettingsAsync=function(){var f=this._options,r=f.partStateDefinition,n=r&&r.sharedProperties,t,i,u;return(n&&n.length>0)?(t=[],i={},n.forEach(function(n){t.push(n.key);i[n.key]=n.property}),u={store:o.SharedPart,keys:t},this._getPartSettingsAsync("Get shared part settings.",u,i)):Q.resolve(null)},n.prototype._traceOperationWithSettings=function(n,t,i){if(this._trace){if(i){var r={};r[i]=t;t=r}v.verbose("[PartSettingsManager] {0} Part: {1}.\nSettings: {2}".format(n,this._options.part.toString(),ko.toJSON(t,null,2)))}},n.prototype._traceOperationWithKeys=function(n,t){this._trace&&v.verbose("[PartSettingsManager] {0} Part: {1}.\nKeys: {2}".format(n,this._options.part.toString(),ko.toJSON(
t,null,2)))},n.prototype._getPartSettingsAsync=function(n,t,i){var f=this,u;return this._traceOperationWithKeys("BEGIN - "+n,t.keys),u=[this._options.services.sharedSettings.querySettings(t)],Q.all(u).then(function(u){var o,e={};return o=u[0]||{},t.keys.forEach(function(n){var t=o[n],f=c.isSerializedObject(t),u=f?c.fromSerializableObject(t):t;i?o[n]!==r&&i[n]&&s.setModelValue(e,i[n],u):$.extend(!0,e,u)}),f._traceOperationWithSettings("END - "+n,e),e})},n.prototype._getOrCreateInstanceStatePropertyBindings=function(){if(!this._partInstanceState){var n=this._options.part;this._partInstanceState=new f.PropertyBindings(n.toString()+"-[PartInstanceState]",n.partState)}return this._partInstanceState},n}();t.PartSettingsManager=g}(o||(o={})),o});define("MsPortalImpl/Parts/Parts.Error",["require","exports","f","./Parts","../Widgets/Widgets.PartError"],function(n,t,i,r,u){"use strict";var f;return function(){var n=i.Parts,t=n.PartKind,f=i.ViewModels,e=function(n){function t(t,i,r,u){n.call(this,
t,i,r,u);i.container.contentState(f.ContentState.Error);i.internal.allowUiBlocking(!1)}return __extends(t,n),t.prototype._bindContent=function(n){var t=new u.ViewModel,i=this._viewModel.content,r;t.title=i.title||t.title;t.subtitle=i.subtitle||t.subtitle;t.reason=i.reason||t.reason;r=i.clickable;t.clickable=typeof r!="undefined"?r:t.clickable;this._control=new u.Widget($(n),t)},t.prototype.dispose=function(){i.disposeDisposable(this._control);n.prototype.dispose.call(this)},t}(r.PartImpl);r.registerFactory(t[n.PartKind.Error],r.createPartFactory("",{partClass:e}))}(f||(f={})),f});define("MsPortalImpl/UI/Compositions/UI.Composition.Part",["require","exports","f","../../Base/Base.Events","../../Base/Base.Router","../../Base/Base.Selectable2","../../Base/Base.SelectableSet2","../../Extension/Extension.Definition.Locator","./UI.Composition.CloudName","MsPortalImpl/Resources/ImplScriptResources","../../Parts/Parts","../../Services/Services.AssetTypes.Utils","../../Services/Services.EditScopeManagement",
"../../Base/Telemetry","../Commands/UI.Commands","./UI.Composition","./UI.Composition.Base","./UI.Composition.BladeOpenerBase","./UI.Composition.CompositionBinder","./UI.Composition.ContextMenuContainer","./UI.Composition.PartSettingsManager","./UI.Composition.PropertyBinding","./UI.Composition.Security","../Commands/UI.ShellCommands","../../Widgets/Widgets.Common","../../Widgets/Widgets.Tile","../../Widgets/Widgets.UIElementBase","MsPortalImpl/Parts/Parts.Error"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft){"use strict";var et;return function(t){function pi(n){return n&&n.toFriendlyString()}function du(n,t){var i=!!t.first(function(t){return ru.isEqualDescriptor(t.extensionDescriptor,n.extension)});return i?Q(n.getAssetInstanceMetadataAsync()).then(function(i){var r=i&&t.first(function(n){return i.type===n.assetType&&l.compareAssetId(i.id,n.assetId)});r&&n.disableForAssetDeleted(!0,r.reason)}):Q()}function cr(n,t){t===void 0&&(t=!0);var i;return n&&(t&&!n.hasOwnProperty(
p.PartContainerModelIdProperty)&&(n=fi(n),n[p.PartContainerModelIdProperty]=ii.getUniqueId()),i=lt.createObservableModel(n)),i}function nu(n,t){var i;return n&&t?(i={},ku(n,function(n){i[n]=null})):i=n,li.toSerializableObject(i)}function tu(n){return li.isSerializedObject(n)?li.fromSerializableObject(n):{}}function gu(n,t,i,r,u){var f=new gr(n,t,null,i);return f.calculateInitialSize(),f.containerModel=cr(r),f.overridesModel=cr(u||{},!1),f}function di(n){var t=n.partDefinition,i=n.adapter,r=t&&t.viewModel?t.viewModel:"N/A",u;return u=i?"AdapterPart. Extension: {0}, ViewModel: {1}, Wrapped ViewModel: {2}".format(i.extension.name,i.viewModelName,r):"ViewModel: {0}".format(r),"{0} ({1})".format(n.toString(),u)}function ie(n){var t=n.partDefinition;return t&&t.partKind===dt.Custom&&t.htmlTemplate&&!(t.htmlTemplate in n.extension.definition.htmlTemplates)}function re(n,t,i){var r=n.getInputPropertyBindings();(i||[]).forEach(function(i){var u=r.properties.first(function(n){var r=n.compositionBindingDefinition;
return n.sourceProperty===i.source.property&&r&&r.source&&r.source.id===t.id});u||(fr(n,r,[i]),i.source.id=t.id,n.bindings.push(i),n.save())})}function ue(n,t){var i=n.getInputPropertyBindings(),r=n.bindings||[],u=r.filter(function(n){return n.source.scope!==ui.DetailsContainer});u.length!==r.length&&(i.properties.filter(function(n){var i=n.compositionBindingDefinition;return i&&i.source&&i.source.id===t.id}).forEach(function(n){i.removeProperty(n)}),n.bindings=u,n.save())}function fe(n,t,i){var r=!!t;return t&&(t.assetType&&!t.assetIdInputProperty?(et.error("'assetIdProperty' is required if 'assetType' is defined on part definition. Locator:'{0}'.".format(n.locator.toString())),r=!1):!i&&!!t.editScopeType&&n.bindings&&n.bindings.some(function(n){return n.targetProperty===vi})&&(r=!1,et.error("Declaring an 'editScopeType' and an input binding with '"+vi+"' as a target property is not supported. "+"A part cannot be the owner of an edit scope and also receive an edit scope id from an external source. Part: '{0}'. Bindings: {1}.".
format(n.toString(),JSON.stringify(n.bindings))))),r}function ee(n,t){var i=[],r=!0;return t&&t.invocationInputArguments&&t.invocationInputArguments.length&&(r=b.validateDetailsDefinition(t,i)),i.length&&lf.logDetailDefinitionError(i[0],n.toString(),t),r}function oe(n,t){var i=[],r=lt.validateInputBindings(n,t,i);return i.length&&et.error(i[0]+" Part:'"+n.toString()+"'."),r}function se(n){var t=n.adapter,i=t?t.allInputsSet:n.allInputsSet;yi(n,function(){if(i()){var t=nf(n);t&&t.exists&&n.assetId(pt(t.value))}})}function nf(n){var i=n.adapter,r=i?i.inputPropertyBindings:n.getInputPropertyBindings(),t=r.properties.first(function(t){return t.targetProperty===n.assetInstanceDefinition.assetIdInputProperty});return t?ht(t.sourceModel,t.sourceProperty):null}function he(n){var f,i,t,r,u;return n.isComposed&&(i=n.getViewModel(),i&&(t=i.container,t&&(r=t.partTitle&&t.partTitle(),u=t.assetName&&t.assetName(),(r||u)&&(f={partTitle:r,assetName:u})))),f}function tf(n){return n&&n._msPortalFx_viewModelApiV2}
function rf(n){return n&&n._msPortalFx_viewModelApiV2_wrapper}function ce(t){if(!kr){var r=st();kr=r.promise();i.require("./UI.Composition.BladeOpener",n).then(function(n){hr=n;r.resolve(n)})}return hr?t:kr.then(function(){return t})}function le(){if(!dr){var t=st();dr=t.promise();ni?t.resolve(ni):i.require("./UI.Composition.DynamicPartBinder",n).then(function(n){ni=n;t.resolve(n)})}return dr}function ae(n){hr=n}function ve(n){ni=n}function ye(n){return{property:n,modelType:t.inferredReferenceType,scope:ui.CurrentContainer,cardinality:nt.ReferenceCardinality.OneToOne}}function iu(n){return n&&n.modelType===t.inferredReferenceType}function uf(n){return n.isDynamicBinding&&!iu(n.source)}function pe(t,i){return tr(t,"./UI.Composition.Selectable2Registrar",i,n)}var ti=o.Locator,wt=o.LocatorType,gi=FxImpl,ru=gi.Extension,ci=gi.TelemetryContext,uu=ci.ContextType,fu=gi.ViewModels.Part,wi=i.Base,eu=wi.Diagnostics,ou=eu.Telemetry,ot=wi.EventTypes,lr=wi.Rpc.Internal,bi=lr.Measurement,bt=wi.Stopwatch.
TelemetryStopwatch,ii=wi.Utilities,li=ii.Internal.Serialization,su=i.Extension,kt=su.ReferenceType,ff=su.SetRequirement,oi=i.Parts,dt=oi.PartKind,ri=oi.PartSize,nr=oi.PartSizeHelper,ar=i.ViewModels,ef=ar.ShieldType,si=p.CompositionType,lt=k.CompositionBinder,yt=nt.PropertyBinding,ui=nt.ReferenceScope,hu=nt.PropertyBindings,of=gi.Diagnostics,cu=a.EditScopeState,ai=v.Action,sf=i.Helpers,vr=ar.PartLocation,tr=w.compositionRequire,lu=ii.clone,au=i.cloneAndRebindFunctions,hf=ar.Internal.shellViewModel,st=sf.Deferred,yr=ot.fxrecomposeframepart,pr=window,vt=jQuery,wr=pr.fx.environment,ir=wr.features,cf=h.Asset,rr=ii.isNullOrUndefined,et=eu.createLog(n),vu="fxs-part",lf={logDetailDefinitionError:function(n,t,i){et.error(n+" "+"Part: '{0}'. Details: '{1}'.".format(t,JSON.stringify(i)))}},yu="-[ContainerModel]",af="-[OverridesModel]",vf="-[Inferred]",yf="-[Adapter]",pf="-[AdapterInputs]",wf=b.PartContainerSelectable_ViewModelPath+".isSelected",bf=b.PartContainerSelectable_ViewModelPath+".isCommandSelected",
gt=ou,ur=v.Source.Shell,hi=kt.Adapter,ki=kt.AdapterInput,pu="internal.",vi=p.EditScopeIdPropertyName,fr=lt.setupPropertyBindings,yi=ko.computed,er=ko.isObservable,ct=ko.observable,or=ko.reactor,fi=ko.toJS,wu=ko.toJSON,pt=ko.unwrap,kf=ko.utils,we=Date.now,ht=yt.getModelValue,br=lt.mapInputBindingDefinitions,sr=lt.createAllInputsSetWatcherConfigExtended,df={isActivated:!0,isSelected:!0,itemsWithChildEdits:!0,selectedValue:!0,activatedItems:!0,selectedItems:!0},gf=ir&&ir.autosettings,ei=ir.spinnerbehavior,bu=ir.disablebladecustomization==="true",ne=0,ku=i.forEachKey,te=i.isFeatureEnabled("pov2"),hr=null,kr=null,ni=null,dr=null,at,gr;t.handleAssetDeleted=du;t.partName="Part";t.EmptyViewModel=fu.composePartViewModel(function(){return undefined});t.fxpartinputchanged="fxpartinputchanged",function(n){n[n.OldInputsNotHandled=1]="OldInputsNotHandled";n[n.UnrecoverableError=2]="UnrecoverableError";n[n.CustomPartWithMissingTemplate=3]="CustomPartWithMissingTemplate";n[n.PartDefinitionNotFound=4]=
"PartDefinitionNotFound";n[n.IncorrectPartType=5]="IncorrectPartType";n[n.ErrorLocatingPartDefinition=6]="ErrorLocatingPartDefinition";n[n.ErrorAcquiringViewModel=7]="ErrorAcquiringViewModel";n[n.ViewModelMissing=8]="ViewModelMissing";n[n.ErrorLoadingControl=9]="ErrorLoadingControl";n[n.ErrorCreatingWidget=10]="ErrorCreatingWidget";n[n.TransitionedToErrorState=11]="TransitionedToErrorState"}(at||(at={}));gr=function(o){function a(n,i,r,u,f,e){e===void 0&&(e=1e3);o.call(this,n,i,[],r,u);this.bindings=[];this.editScopeId=ct();this.invocationThrottleDuration=25;this.allInputsSet=ct(!1);this.calledOnInputsSet=ct(!1);this.failedOnInputsSet=ct(!1);this.assetId=ct();this.triggeringLockedBladeSpinner=ct(!1);this._viewStateProperties=[];this._registrationDeferred=st();this._disabled=!1;this._restoredFromJson=!1;this._perfData={instanceExtensionLoad:0,referenceExtensionLoad:0,adapterViewModelLoad:0,partViewModelLoad:0,extenderViewModelLoad:0,checkPermissions:0,prepareViewModel:0,finalizePartCompose:
0,allInputBindingsBoundPreprocess:0,allInputBindingsBound:0,srcExtension:"",contentRevealedCalled:!1};this._sequence=ne++;this._rebindCount=0;this._hasRebindableInputs=!1;this._showShellCommands=!0;this._allInputPropertyBindingsBound=st();this._onInputsSetCompleted=Q.defer();this._contentRevealed=Q.defer();this._contextMenuViewModels=null;this._containerInputsChanging=ko.observable(!1);this._updateRebindSequenceNumber();this._name=t.partName;this._vm=f||t.EmptyViewModel;this.partState={};this.bindings=[];this._showSpinnerTimeoutMillis=e;i&&(this._extensionName=ru.getWindowId(i.getExtensionLocator()));this.containerModel=null;this.overridesModel=cr({},!1);this.registerForDispose(this._partSettingsManager=new g.PartSettingsManager)}return __extends(a,o),a.prototype.getViewModel=function(n,i){var r=t.EmptyViewModel,u=this.adapter,f,e;if(n=n||kt.Part,n===kt.Part)r=this._vm;else if(n===kt.Command)if(f=this._contextMenuViewModels,f)r=f.getViewModel(n,i);else{var s=this._getCommands(),o=p.findCommand(
s,i,this.toString()),h=o&&o.getViewModel();r=h||t.EmptyViewModel}else n===hi?r=u&&u.viewModel:n===ki?(e=u&&u.inputPropertyBindings,r=e&&e.targetModel):et.error("Invalid model type '{0}' for part '{1}'.".format(n,this.locator.toString()));return r},a.prototype.getViewModelAsync=function(n,t){var i=this;return this._registrationDeferred.then(function(){var r,f,u;return n===kt.Command?(r=i._contextMenuViewModels,r?r.getViewModelAsync(n,t):(f=i._getCommands(),u=p.findCommand(f,t,i.toString()),u&&u.getViewModelAsync())):i.getViewModel(n)})},a.prototype.setViewModel=function(n){this._vm=n},a.prototype.setBladeOpener=function(n){this.registerForDispose(this._bladeOpener=n)},a.prototype.getBladeOpener=function(){return this._bladeOpener},Object.defineProperty(a.prototype,"isDisabled",{get:function(){return this._disabled},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"canClone",{get:function(){var n=this.awaitComposed().state()!=="pending",t=this.getInputPropertyBindings().
allBound,i=this.partDefinition.partKind===dt.ResourceSummary;return n&&t&&!i},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"eligibleForBinding",{get:function(){return!this.containerModel},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"templateKey",{get:function(){var n=this.locator.toString(),t=this.containerModel;return t&&(n+="-"+ii.toSortedString(fi(t))),n},enumerable:!0,configurable:!0}),a.prototype.getTemplate=function(){var n=o.prototype.getTemplate.call(this),i=this.containerModel,t;return i&&(n.modelJson=wu(i)),n.overridesModelJson=wu(this.overridesModel),t=this.originalPartLocator,t&&(n.originalPartLocator=t.toJSON()),n},Object.defineProperty(a.prototype,"journeyPath",{get:function(){return this.getPartsContainer().journeyPath.concat(this.templateKey)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dirtyAndNotSaving",{get:function(){return this.services.editScopeManager.getStateObservable(this.editScopeId())()===cu.Dirty}
,enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"instanceDefinition",{get:function(){return this._partInstanceDefinition},enumerable:!0,configurable:!0}),a.prototype.getCompositionType=function(){return si.Part},a.prototype.getPartSettingsManager=function(){return this._partSettingsManager},a.prototype.getPerfData=function(){return this._perfData},a.prototype.getSettingsModel=function(){var n=this._settingsModel,t;if(!n&&(t=this.getViewModel())){var u=tf(t.content),f=this.partDefinition,r=f&&f.partState,e=i.unique((r?(r.inputIdentityProperties||[]).concat((r.sharedProperties||[]).map(function(n){return n.property})):[]).concat(!u&&this._viewStateProperties||[]));this._settingsModel=n=lu(t);n.content={};e.forEach(function(i){if(i.startsWith("content.")){var r=u?ct():ht(t,i).value;yt.setModelValue(n,i,r)}})}return n},a.prototype.isOrganizable=function(){return bu?!1:!0},a.prototype.dispose=function(n){this._releaseResources(n);[this._loadedMarker,this._readyMarker,this.
_revealedMarker,this._onInputsSetResolvedMarker].forEach(function(n){n&&gt.cancelTrace(n)});o.prototype.dispose.call(this,n)},a.prototype._setExtension=function(n){this.extension=n;this._partContainer&&this._partContainer.attr("data-extensionname",this.extension?this.extension.name:null)},a.prototype._releaseResources=function(n){var u,f,i,e,r,o;this._removeEventHandlers();this._clearLoadingReactor();u=this._inputBindings;u&&(u.unbind(),this._inputBindings=null);f=this._part;f&&(f.dispose(),this._part=null);i=this._vm;e=this.extension;e&&i&&i!==t.EmptyViewModel&&e.releaseViewModel(i);this._releaseAdapter();r=this._extenderVM;o=this._extenderVMExtn;r&&o&&(ii.disposeViewModelProperties(r),o.releaseViewModel(r));n||this._disposeEditScope();this._journey=null;this._vm=t.EmptyViewModel},a.prototype._clearLoadingReactor=function(){var n=this._loadingReactorLifetime;n&&(n.dispose(),this._loadingReactorLifetime=null)},a.prototype._releaseAdapter=function(){var n=this.adapter,t;n&&(n.inputPropertyBindings.
unbind(),ii.disposeViewModelProperties(n.viewModel),t=n.viewModel,t&&n.extension.releaseViewModel(t),this.adapter=null)},a.prototype.getInputPropertyBindings=function(){if(!this._inputBindings)this._inputBindings=new hu(di(this),{},!1);return this._inputBindings},a.prototype.getAssetId=function(){var t=this,i=this.assetInstanceDefinition,r=i&&i.assetIdInputProperty;if(!r)return Q.reject();var u=function(n){var i=nf(t);i&&i.exists?n.resolve(pt(i.value)):(et.error("Asset id property '{0}' does not exist in model for composition '{1}'.".format(r,t.locator.toString())),n.reject())},n=Q.defer(),f=this.adapter,e=f?f.allInputsSet:this.allInputsSet;return e()?u(n):e.subscribe(this,function(t){t&&!n.promise.isFulfilled()&&u(n)}),n.promise},a.prototype.toJSON=function(){var n=o.prototype.toJSON.call(this),t,i;return n.assetInstanceDefinition=this.assetInstanceDefinition,n.partState=li.toSerializableObject(this.partState||{}),n.initialSize=this.initialSize,n.bindingsInitialized=this._bindingsInitialized,
n.savedContainerState=he(this),n.containerModel=nu(this.containerModel,this.modelContainsSensitiveData),n.overridesModel=nu(this.overridesModel,!1),n.originalPartLocator=this.originalPartLocator,t=this.adapter,i=this.bindings,n.adapterBindings=t&&t.bindings,n.bindings=t?i.filter(function(n){return n.source.scope===ui.DetailsContainer}):i,n},a.prototype.cloneAs=function(n){var i=this,u=st(),t,r=this.widget?this.widget.options:null,f=[this.awaitComposed(),this.getInputPropertyBindings().awaitAllBound],e=this.adapter;return e&&f.push(e.inputPropertyBindings.awaitAllBound),vt.when.apply(vt,f).done(function(){var s=i.getNonDetailsContainerPropertyBindings(),e={},o,f;s.forEach(function(n){var t=ht(n.targetModel,n.targetProperty).value;yt.setModelValue(e,n.sourceProperty,fi(t))});o=fi(i.overridesModel);t=n(e,o);t.widgetState(vt.extend(!0,{},i.widgetState()));r&&r.size&&(t.initialSize=r.size(),t.initialSize===ri.Custom&&(t.initialWidth=r.gridWidth(),t.initialHeight=r.gridHeight()));f=i._partSettingsManager;
f&&f.saveIdentityPartSettings(t.containerModel);u.resolveWith(i,[t])}).fail(function(){u.rejectWith(i)}),u.promise()},a.prototype.clone=function(){var n=this;return this.cloneAs(function(t,i){return gu(n.services,n.locator,null,t,i)})},a.fromJSON=function(n,t){return p.createCompositionFromJSON(t,function(){var i=new a(n,ti.fromJSON(t.locator),t.widgetState,t.id);return i.loadPropertiesFromJson(t),i},function(i,r){var u=new a(n,i,null,t.id);return u.unrecoverableErrorMessage=r,u})},a.prototype.getAssetInstanceMetadataAsync=function(){var n=this,t=st();return this._registrationDeferred.then(function(){var i;n.isDisabled||n.isDisposed()?t.resolve(i):n.getAssetId().then(function(t){i={id:t,type:n.assetType}}).finally(function(){t.resolve(i)})},function(){t.reject()}),t.promise()},Object.defineProperty(a.prototype,"assetType",{get:function(){var n=this.assetInstanceDefinition;return n&&n.assetType},enumerable:!0,configurable:!0}),a.prototype.addWidgetToUI=function(n){var t=this.widget;n.parentElement.
addChild(t);t.addChild(this._partContainer)},a.prototype.recompose=function(n){this._compose(n,st(),!0)},a.prototype._compose=function(n,t,i,r){var u=this,o,e,h;i===void 0&&(i=!1);var f,c=this._getPrimaryExtensionName(),v=pi(this.locator),s=function(n,t){return u._completeTraceWithState(n,t)};r=r||{};o=function(n){return gt.startTrace({extension:c,source:ur,action:n,name:v})};this.calledOnInputsSet.subscribe(this,function(n){n&&(u._onInputsSetResolvedMarker=o(ai.OnInputsSetResolved))});this._onInputsSetCompleted.promise.then(function(){var t=u._readyMarker,n;t&&(u.readyTime=s(t,u._perfData),u._readyMarker=null);n=u._onInputsSetResolvedMarker;n&&(s(n,u._perfData),u._onInputsSetResolvedMarker=null)});this._contentRevealed.promise.then(function(n){var t=u._revealedMarker;t&&(u._perfData.contentRevealedCalled=n,u.revealedTime=s(t,u._perfData),u._revealedMarker=null)});this._registrationDeferred.then(function(){du(u,u.services.assetManager.deletedAssets);t.resolve()},function(){t.reject()});
this._clearLoadingReactor();this.widget&&i?(this._partContainer=this.widget.element.find("."+vu),f=this.widget.options,f.commands.splice(0,f.commands.length),f.actionBarViewModel.update()):(this._partContainer=vt("<div class='"+vu+"'><\/div>"),f=new ut.ViewModel(this.id,this.widgetState()),f.inLockedContext=n.options.locked(),f.size()===undefined&&f.size(this.initialSize),f.size()===ri.Custom&&(f.gridWidth(Math.max(1,this.initialWidth)),f.gridHeight(Math.max(1,this.initialHeight))),f.largeInitialSize(this.largeInitialSize),(ei==="fade"||ei==="none")&&f.locked(n.options.locked()),this.widget=ut.createTileWidget(vt("<section/>"),f,this._getActions.bind(this)),this.widgetState(this.widget.saveViewSettings()),this.addWidgetToUI({parentElement:n,doNotSaveSettings:!0}));e=this.widget.element;this._recomposeHandler&&e.off(yr,this._recomposeHandler);e.on(yr,this._recomposeHandler=function(){var i=u.partDefinition;i&&i.partKind===dt.Frame&&t.finally(function(){u._registrationDeferred=st();u._compose(
n,st(),!0)})});ei==="delay"?(this._clearSpinnerTimeout(),f.isInBlockingLoadingState(!1),this._showSpinnerAfterTimeout(f)):ei==="fade"?f.isInBlockingLoadingState(!0):n.options.locked()||f.isInBlockingLoadingState(!0);e.data(p.CompositionInstanceDataName,this);h=function(n,t){u._menu=t};e.on(ot.fxregistermenu,h);this.registerForDispose(function(){e.off(ot.fxregistermenu,h)});var l=function(){if(u._loadedMarker=o(ai.PartLoaded),u._readyMarker=o(ai.PartReady),u._revealedMarker=o(ai.PartRevealed),u.unrecoverableErrorMessage&&u.unrecoverableErrorMessage.length>0)u._createErrorPart(u._partContainer[0],at.UnrecoverableError,u.unrecoverableErrorMessage);else{u._locateDefinitionAndStartCompose(f);u._perfData.srcExtension=u._getSecondaryExtensionName(c);var t=u.createChildLifetime();n.options.locked.subscribe(t,function(n){u._toggleShellCommands(!n,f.commands)});u._toggleShellCommands(!n.options.locked(),f.commands)}},y=r.delayLoad||function(n){return!rt.isElementFullyInViewport(n,0,!0).fullyVisible}
,a=r.delayLoadPromise;a&&y(e[0])?(this._loadDelayed=!0,a.finally(l)):l()},a.prototype._getPrimaryExtensionName=function(){var n=this.getPartsContainer(),i,t;return n&&(i=n.getCompositionType(),i===si.Blade)?n.locator.getExtensionLocator().name:(t=this.locator,t&&t.getExtensionLocator().name)},a.prototype._getSecondaryExtensionName=function(n){var t=this.locator,i=this.extension,r=t&&t.getExtensionLocator().name,u=i&&i.name;return r!==n?r:u!==n?u:undefined},a.prototype._completeTraceWithState=function(n,t){var i=this,r=function(){return i._menu&&(t=vt.extend({},t,i._menu.getTelemetryInfo())),gt.completeTrace(n,t)};return this._creationState?ci.usingState(r,this._creationState):r()},a.prototype._locateDefinitionAndStartCompose=function(n){var t=this,u=new bt,r,i=this._createErrorPart.bind(this);return this.services.finder.locateAsync(this.locator).then(function(n){return t._perfData.instanceExtensionLoad=u.millisecondsElapsed,r=new bt,t._processLocatedDefinitionAsync(n)}).then(function(n)
{return le().then(function(){return n})}).then(function(u){var s,f,o,e;if(t._perfData.referenceExtensionLoad=r.millisecondsElapsed,u){if(t._isRestoredPartLackingBinding(u))if(t.eligibleForBinding)t._bindingsInitialized=!1,t.bindings=[];else if(!u.canUseOldInputVersions){et.warning("[Definition Change] Bindings for part '{0}' have been changed in the definition in an incompatible way.".format(t));s={reason:ct(wr.isDevelopmentMode?h.PartError.titleSettingsDevMode:h.PartError.titleSettings),clickable:!1};i(t._partContainer[0],at.OldInputsNotHandled,"Bindings for part have been changed in the definition in an incompatible way. Locator: {0}.".format(t.locator),s);return}if(f=t.adapter,t._restoredFromJson&&t._bindingsInitialized!==!1){var c=f?f.bindings:t.bindings,l=f?f.inputDefinitions:u.inputDefinitions,a=ni.inferInitialBindingsForInputDefinitions(t,l),v=a.filter(function(n){return c.every(function(t){return t.targetProperty!==n.targetProperty})});[].push.apply(c,v)}else f?f.bindings=t._constructAdaptedBindings(
):t._setBindings(u),t.assetInstanceDefinition={assetType:u.assetType,assetIdInputProperty:u.assetIdInputProperty},f&&((f.assetType||f.adaptedPart.assetType)&&(t.assetInstanceDefinition.assetType=f.assetType||f.adaptedPart.assetType),f.assetIdInputProperty&&(t.assetInstanceDefinition.assetIdInputProperty=f.assetIdInputProperty)),o=t._partInstanceDefinition,e=o&&o.reference,e&&e.assetType&&(t.assetInstanceDefinition.assetType=e.assetType),t._bindingsInitialized=!0,t.save();t.partDefinition=u;ie(t)?i(t._partContainer[0],at.CustomPartWithMissingTemplate,h.UiCompositionPart.missingTemplateMessage):t._composeCommandsAndPart(n,t._partContainer)}else i(t._partContainer[0],at.PartDefinitionNotFound,"Unable to find the definition for the part. Locator: {0}.".format(t.locator))}).then(null,function(n){i(t._partContainer[0],at.ErrorLocatingPartDefinition,n)})},a.prototype._setBindings=function(n){var r,t=this._partInstanceDefinition,i;t&&(r=t.inline?t.inline.bindings:t.reference.bindings);i=this._resolveInstanceAndTypeBindings(
r,n.bindings);oe(this,i)&&(this.bindings=this.bindings.concat(br(i,this)));this.bindings.length<=0&&this.locator.type===wt.PartType&&(this.bindings=ni.inferInitialBindingsForInputDefinitions(this,n.inputDefinitions))},a.prototype._resolveInstanceAndTypeBindings=function(n,t){var r={},i;return(n&&t&&(t.forEach(function(n){n.isIdentityInput&&!!n.property&&(r[n.property]=!0)}),n.forEach(function(n){n.isIdentityInput=!!r[n.property]})),n&&t)?(i=n.slice(0),t.forEach(function(t){t.valuesFrom&&t.valuesFrom.length&&t.valuesFrom[0].referenceType===kt.Constant&&(n.some(function(n){return n.property===t.property})||i.push(t))}),i):n||t||[]},a.prototype._constructAdaptedBindings=function(){var n=this.adapter;return n.bindings.length<=0&&this.locator.type===wt.PartType?ni.inferInitialBindingsForInputDefinitions(this,n.inputDefinitions):br(n.adaptedPart.bindings,this)},a.prototype._isRestoredPartLackingBinding=function(n){if(this._restoredFromJson){var t=this.adapter,i=t?this._constructAdaptedBindings(
):br(n.bindings||[],this),r=t?t.bindings:this.bindings,u=function(n){return!n.optional&&r.firstIndex(function(t){return t.targetProperty===n.targetProperty})<0};return!!i.some(u)}return!1},a.prototype._getActions=function(){var n=this.services,t=new it.UnpinFromStartboard(n).createAction(this),i=new it.OpenContextMenu(n,h.ContextMenu.ariaLabel).createAction(this);return[i,t]},a.prototype.resetLayout=function(){var n=this.initialSize,r=nr.AllSizes[n>=0?n:nr.getDefaultSize().name],t=r.size,i=this.widget;i.element.trigger(ot.fxsizechange,[i.options.id,t.width,t.height])},a.prototype.clearIdentitySettings=function(){var n=this._partSettingsManager;n&&n.clearIdentityPartSettings()},a.prototype._processLocatedDefinitionAsync=function(n){var u=this,f=this.services.finder,r=n,t,i;switch(this.locator.type){case wt.PartInstance:case wt.StartboardPartInstance:this._partInstanceDefinition=n;break;case wt.PartType:t=n;t&&t.reference&&(this._partInstanceDefinition={reference:{partTypeName:t.name,bindings:
t.bindings,assetType:t.assetType,initialSize:t.initialSize}})}if(i=this._partInstanceDefinition,i){if(i.reference){var e=i.reference.extension||this.locator.getExtensionLocator().name,o=ti.forExtension(e,this.locator.getExtensionLocator().cloudName),s=o.withPartType(i.reference.partTypeName);return f.locateAsync(o).then(function(n){return u._setExtension(n),f.locateAsync(s)}).then(function(n){return n&&n.reference?u._processAdapterAsync(n,e,u.locator.getExtensionLocator().cloudName):n})}r=i.inline}return this.initialSize===ri.Custom&&(this.initialWidth=r.initialWidth,this.initialHeight=r.initialHeight),this._setExtension(f.locate(this.locator.getExtensionLocator())),st().resolve(r).promise()},a.prototype._processAdapterAsync=function(n,t,i){var r=this,u=ti.forExtension(n.reference.extension||t,i),e=u.withPartType(n.reference.partTypeName),f=this.services.finder;return f.locateAsync(u).then(function(t){var u="{0} (AdapterPart. Extension: {1}, ViewModel: {2})".format(r.toString(),r.extension.
name,n.viewModel),i;return r.adapter={extension:r.extension,viewModel:null,viewModelName:n.viewModel,viewModelId:u,bindings:r._adapterBindings||[],inputDefinitions:n.inputDefinitions,adaptedPart:r._partInstanceDefinition.reference,allInputsSet:ct(!1),calledOnInputsSet:ct(!1),failedOnInputsSet:ct(!1),inputPropertyBindings:new hu(u,{},!1),assetType:n.assetType,assetIdInputProperty:n.assetIdInputProperty},r._partInstanceDefinition={name:r._partInstanceDefinition.name,reference:n.reference},i=r.adapter.adaptedPart.assetType,i&&(r._partInstanceDefinition.reference.assetType=i),r._setExtension(t),f.locateAsync(e)}).then(function(i){var u=st();return i&&i.reference?(et.error("Error processing the part defintion for part '{0}'. Adapted part definition '{0}:{1}' cannot reference another adapted part definition '{2}:{3}'.".format(r.toString(),r.adapter.extension.name,n.reference.partTypeName,i.reference.extension||t,i.reference.partTypeName)),u.reject()):(r._setBindings(i),u.resolve(i)),u.promise(
)})},a.prototype.getTitle=function(){var t=this.getViewModel(),n;return t&&(n=t.container,n)?n.partTitle&&n.partTitle()||"":""},a.prototype._composeCommands=function(n){var t=this,i=y.getCommandGroupForDefinitionItem(this.services.finder,this.extension.name,this.partDefinition,this.extension.cloudName),r=[],u={viewModelName:this.toString()+yu,viewModel:this.containerModel};i&&(i.commands.forEach(function(n){if(t._canPopulateCommand(n)){var i=new y.ExtensionCommandMenuItemImpl(t.extension,t,n,t.partDefinition,t.services,u);r.push(i)}}),n.splice.apply(n,[0,0].concat(r)))},a.prototype._canPopulateCommand=function(n){var t=this.parent&&this.getPartsContainer();return t?n.details&&t.openInContextPane?(et.error("Part '{0}' cannot have the open blade command '{1}', because it is inside the context blade.".format(this.toString(),n.name||n.text)),!1):!0:!0},a.prototype.disableForAssetDeleted=function(n,t){var i,f,r,u;this._disabled=!0;i=this._vm;i&&i.container&&(f=this._getNotFoundMessage(),f(cf.
deletedTitle));r=this.widget;r&&r.options&&(u=this.widget.options.commands,u.splice(0,u.length,new it.UnpinFromStartboard(this.services)));this.save();et.warning("Part '{0}' disabled because asset was deleted. {1}".format(this,t))},a.prototype._composeCommandsAndPart=function(n,t){this._composeCommands(n.commands);this._composePart(t,n);this._attachEventHandlers(t)},a.prototype._attachEventHandlers=function(n){var i=this,u=function(n,t){i.widgetState(t);i.save();n.stopPropagation()},f=function(n,t){i._setPartViewModelSize(t)},e=function(){i._setPartContainerSize(n.width(),n.height())},o=function(n,t){i._handleRightClick(n,t)},s=function(n,t){t.masterPartId=i.id},h=function(n,t){n.stopPropagation();var r=i.locator.getExtensionLocator();i.services.desktop.pinMultipleParts(t.partReferences,r.name,r.cloudName)},t=this.widget.element;t.on(ft.Widget.viewSettingsChanged,u);t.on(ot.fxsizechanged,f);t.on(ot.fxwidthchanged,e);t.on(ot.fxrightclick,o);t.on(ot.fxensurebladevisible,s);t.on(r.fxpinmultipleparts,
h);this.registerForDispose(function(){t.off(ft.Widget.viewSettingsChanged,u);t.off(ot.fxsizechanged,f);t.off(ot.fxwidthchanged,e);t.off(ot.fxrightclick,o);t.off(ot.fxensurebladevisible,s);t.off(r.fxpinmultipleparts,h)})},a.prototype._removeEventHandlers=function(){var n=this.widget&&this.widget.element;this._onControlError&&(n.off(ot.fxportalcontrolloadfailed,this._onControlError),this._onControlError=null);this._onErrorClick&&(n.off(ot.fxerrorpartclicked,this._onErrorClick),this._onErrorClick=null);this._recomposeHandler&&(n.off(yr,this._recomposeHandler),this._recomposeHandler=null);this._disposeOpenInTabListeners()},a.prototype._toggleShellCommands=function(n,t){this._showShellCommands=n;d.composeShellCommands(this,t,this._showShellCommands,this.services)},a.prototype._getPartContext=function(){var n,t=this.getPartsContainer(),r=!1,u=!1,i;return t&&(i=t.getCompositionType(),i===si.Blade&&(n=t,r=!0),u=i===si.Startboard),n=n||{},{id:pi(this.locator),instanceId:this.instanceId,bladeId:
pi(n.locator),bladeInstanceId:n.instanceId,onBlade:r,onStartBoard:u,bladeCustomized:n.isCustomized&&n.isCustomized(),loadDelayed:!!this._loadDelayed}},a.prototype._updateRebindSequenceNumber=function(){this.instanceId="Part_"+wr.sessionId+"_"+this._sequence+"_"+this._rebindCount++},a.prototype._getPartViewModelAsync=function(n,t,r,u,f,e,o){var h=this,c=b.needContainerSelectable(this.partDefinition.details),l=s.needInternalProperty(this.extension.name,this.partDefinition.details),a=new bt,v=ci.provideContext(function(){h._creationState=ci.getState();var i=h.parent&&h.getPartsContainer(),o=i?i.getCompositionType():si.Unknown,s=i?o===si.Startboard?vr.Dashboard:vr.Blade:vr._Internal_None,u=i&&i.bladeDefinition,a=u&&u.templateBlade?1:0;return h.extension.getPartViewModel(n,{initialState:fi(h.partState),createSelectable:c,createHubsInternalCloudNameProperty:l,partSize:t,partLocation:s,collapsed:r,onInputsSetParameters:f,onViewModelAcquired:e&&function(n){rf(n&&n.content)||e(n)},locator:h.locator,
containerType:a})},uu.Part,this._getPartContext());return v.then(function(n){var r,t,u=n&&n.content,f,c,s;return rf(u)?(t=au(n),t.content=u.chrome,f=st(),i.resolveWhen(f,h,u.viewModel),r=f.then(function(t){var i=au(n);return i.content=t,e&&e(i),i}),h._setupLoadingReactor(o,n.container.operations)):r=t=n,h.partDefinition.shareVmWithParentBlade&&(c=h.parent,s=c.parent,s.setViewModelForTemplateOrMenuBlade(t),s.setInputsSetPromise(h._onInputsSetCompleted.promise)),r}).then(function(n){var r=h.services.finder,t=r.locate(h.locator),e=new bt,i=n&&n.content;return f&&lt.notifyOnInputsSetCalled(u,f,n&&n.onInputsSetPromise),t&&t.reference&&t.reference.extenderViewModel?(h._extenderVMExtn=r.locate(h.locator.getExtensionLocator()),h._extenderVMExtn.getViewModel(t.reference.extenderViewModel).then(function(r){return r&&r.content?i&&er(i.extenderViewModel)?(h._extenderVM=r,i.extenderViewModel(r.content)):et.error("Part '{0}' defines extender view model '{1}' but the referenced part is not marked as extensible.".
format(h.toString(),t.reference.extenderViewModel)):et.error("Extender view model '{0}' for part '{1}' must be an object.".format(t.reference.extenderViewModel,h.toString())),n}).finally(function(){h._perfData.extenderViewModelLoad=e.millisecondsElapsed})):n}).finally(function(){h._perfData.partViewModelLoad=a.millisecondsElapsed})},a.prototype._getAdapterViewModelAsync=function(){var n=this;if(!this.adapter)return st().resolve(null).promise();this._registerAdapterInputPropertyBindings();var t=sr(this._getAdapterAllInputsSetWatcherConfig()),r=lt.loadOnInputsSetParameters(t),i=this.adapter;return r.then(function(r){n._earlyAdapterOnInputsSet=!!r;n._perfData.earlyOnInputsSetAdapter=n._earlyAdapterOnInputsSet;var u=new bt;return i.extension.getViewModel(i.viewModelName,{onInputsSetParameters:r}).then(function(n){return i.viewModel=n,r&&lt.notifyOnInputsSetCalled(t,r,n&&n.onInputsSetPromise),t}).finally(function(){n._perfData.adapterViewModelLoad=u.millisecondsElapsed})})},a.prototype._bindAssetNameFromAdapter=
function(){var i=this,n,t;this.adapter&&(n=ht(this.adapter.viewModel,"content.assetName"),n.exists)&&(er(n.value)?(t=n.value,yi(this,function(){var r=t(),n=i._vm;!rr(r)&&n&&n.container&&yt.setModelValue(n,"container.assetName",r)})):et.error("Failed to bind the asset name from the adapter view model for Part '{0}', because the asset name needs to be an observable.".format(this.adapter.viewModelId)))},a.prototype._composePart=function(n,t){var i=this,o;if(!this.isDisposed()){var s=this.locator,l=this.partDefinition,p=l.partKind,u=c.getPartFactory(this._extensionName,l,this.extension.definition.htmlTemplates),r,f,a;if(u){t.supportedSizes(u.supportedSizes);this._inputBindings=null;this.getInputPropertyBindings();var v=this._getAdapterViewModelAsync(),e=this.services.finder.locate(s),w=e&&e.reference&&e.reference.extenderViewModel,y=this.bindings||[],b=y.some(function(n){return n.source&&n.source.scope===ui.DetailsContainer}),k=this.adapter&&y.some(function(n){return n.source&&n.source.modelType===
hi});w||b||!this.extension.canUseInputsSetParameters(s)?f=st().resolve(null).promise():(o=function(){return i.isDisposed()?st().resolve(null).promise():(i._registerInputPropertyBindings(),r=sr(i._getAllInputsSetWatcherConfig()),lt.loadOnInputsSetParameters(r))},f=k?v.then(o):o());f=ce(f);this._vmPromise=f.then(function(f){if(i.isDisposed()){i._releaseResources();return}i._earlyOnInputsSet=!!f;i._perfData.earlyOnInputsSetPart=i._earlyOnInputsSet;var e=i.partDefinition,l=e.partKind===dt.ResourceSummary?i._getSummaryPartViewModelState():null,c=i.widget,o=c&&c.options,s=o?o.size():i.initialSize,a=i._getPartViewModelAsync(e.viewModel,s,l,r,f,r&&i._setupInvocationProperties.bind(i,u.viewStateProperties),t);return vt.when(a,v).fail(function(t){i._createErrorPart(n[0],at.ErrorAcquiringViewModel,t)}).done(function(f,c){var l=new bt;if(i._vm=f,f){if(i.isDisposed())i._releaseResources();else if(!i.isDisabled){i._bindAssetNameFromAdapter();i.widget.element.on(ot.fxportalcontrolloadfailed,i._onControlError=
function(n,t){i._createErrorPart(i._partContainer[0],at.ErrorLoadingControl,t)});e.partKind===dt.ResourceSummary&&i._autoOpenSettingsFromSummary();var a=o?o.size():i.initialSize,v=a!==s,y=e.partKind===dt.Provisioning;v&&i._setPartViewModelSize(a);tf(f.content)||i._setupLoadingReactor(t,f.container.operations);t.userResizable((!bu||i.getCompositionType()===si.StartboardPart)&&oi.ResizeMode[e.resizeMode]===oi.ResizeMode[oi.ResizeMode.User]);v?i.extension.processMessages().finally(function(){i.isDisposed()||i._setupPartWidget(n,u,r,c,s,y,l)}):i._setupPartWidget(n,u,r,c,s,y,l)}}else i._createErrorPart(n[0],at.ViewModelMissing,h.UiCompositionPart.viewModelRequired)})})}else a="Incorrect part type '{0}'.".format(p),this._createErrorPart(n[0],at.IncorrectPartType,a)}},a.prototype._setupPartWidget=function(n,t,i,r,u,e,o){var s=this,h=this.widget,v=this.getViewModel(),l,c,a;this._perfData.prepareViewModel=o.millisecondsElapsed;l=new bt;nr.isAdaptiveWidth(u)||(c=h.element.width(),a=h.element.height(
));f.setSelectableContext(this,this._vm,this._partContainer);this._createPartWidget(t,v,e).then(function(){var f,u;if(!s.isDisposed()&&(s.partDefinition.shareVmWithParentBlade||or(s,function(){var n=s._getNotFoundMessage()();s._part.notFoundMessage(n)}),c||(c=h.element.width(),a=h.element.height()),s._setPartContainerSize(n.width(),n.height()),s.register(t.viewStateProperties,i,r),se(s),s._ensureAssetAffinity(),s._perfData.finalizePartCompose=l.millisecondsElapsed,s.partDefinition.resizeMode===oi.ResizeMode.Programmatic)){if(f=s.extension&&s.extension.name,f!=="AppInsightsExtension"&&f!=="SamplesExtension")return;u=hf(s._vm.container);u.autoSize.subscribe(s,function(n){if(n){u.autoSize(!1);var i=s.widget,t=i.element,r=t.find(".fxs-part-content"),f=r.find("> div");if(f.length!==1)return;var e=f[0],o=r[0],h=t.outerWidth()+Math.floor(e.clientWidth-o.clientWidth),c=t.outerHeight()+Math.floor(e.clientHeight-o.clientHeight);t.trigger(ot.fxsizechange,[i.options.id,h,c])}});u.resize.subscribe(
s,function(n){if(n&&n.width&&n.height){var t=nr.getGridPixelSize(n.width,n.height);s.widget.element.trigger(ot.fxsizechange,[h.options.id,t.width,t.height])}})}},function(t){s._createErrorPart(n[0],at.ErrorCreatingWidget,t)})},a.prototype.register=function(t,i,r){var u=this,o=this.parent&&this.getPartsContainer(),s,h,f,e;this._removeOutputArgumentValuesFromContainerModel();(this.bindings||[]).forEach(function(n){var t=n.source.modelType;u._hasRebindableInputs||n.source.scope!==ui.CurrentContainer||t!==kt.BladeInput&&t!==hi&&t!==ki||(u._hasRebindableInputs=!0)});this._listenForPartMutation();this.adapter&&!r&&this._registerAdapterInputPropertyBindings();i||(this._registerInputPropertyBindings(),this._setupInvocationProperties(t,this._vm));this._partSettingsManager.configureInstanceProperties(this._viewStateProperties);this._partSettingsManager.initialize();tr(this,"./UI.Composition.SelectableRegistration",function(n){n.listenForRegistrationChanges(u,u._vm,u)},n);pe(this,function(n){n.autoRegisterSelectables(
u,u._vm,u);var t=n.RestoreContextMenuSelectableStatePipeline.createPipeline(u,{viewModel:u._vm},u);t.startTask(undefined)});s=this.getInputPropertyBindings();this._setupBladeRebindingHandlers(o);h=new bt;f=function(){u._finishCompose(o,s,h)};this.partDefinition.shareVmWithParentBlade?setTimeout(f):this.extension.processMessages().finally(f);this.save();i||(i=sr(this._getAllInputsSetWatcherConfig()));i.bindableTarget.viewModel=this._vm;e=i.onInputsSetCoordinatorState;i.onInputsSetCoordinatorState=yi(this,function(){return u._containerInputsChanging()?0:e()});lt.setupAllInputsSetWatcherFromExtendedConfig(i);this.adapter&&(r||(r=sr(this._getAdapterAllInputsSetWatcherConfig())),r.bindableTarget.viewModel=this.adapter.viewModel,lt.setupAllInputsSetWatcherFromExtendedConfig(r));ni.listenForConfigurationChanges(this,r&&r.onInputsSetCoordinatorState,e)},a.prototype._finishCompose=function(n,t,i){var r=this,u,f;this.isDisabled||this.isDisposed()||(n&&n.notifyPartComposed(this),this._registrationDeferred.
resolve(),u=[t.awaitAllBound],this.adapter&&u.push(this.adapter.inputPropertyBindings.awaitAllBound),f=i.millisecondsElapsed,vt.when.apply(vt,u).done(function(){var n=r._perfData;r._allInputPropertyBindingsBound.resolve();n.allInputBindingsBoundPreprocess=f;n.allInputBindingsBound=i.millisecondsElapsed;r._loadedMarker&&(r.loadTime=r._completeTraceWithState(r._loadedMarker,n),gt.trace({source:ur,action:ai.PartLoadedNoExtensionDerived,actionModifier:ou.ActionModifier.Complete,name:pi(r.locator),duration:r.loadTime-n.referenceExtensionLoad-n.instanceExtensionLoad,data:n}),r._loadedMarker=null)}).fail(function(){r._allInputPropertyBindingsBound.reject()}),this.save())},a.prototype._registerInputPropertyBindings=function(){var n=this,i=[],r=[],u=[],t;this._journey=this.services.desktop.getActiveJourney();(this.bindings||[]).forEach(function(n){n.source.scope===ui.DetailsContainer?u.push(n):r.push(n);!n.isIdentityInput||i.push(n.targetProperty)});this._partSettingsManager.configure(this._getPartSettingsManagerConfig(
i,this._viewStateProperties));t=this.getInputPropertyBindings();fr(this,t,u);fr(this,t,r,function(t){return n.adapter?n.adapter?n.bindAdaptedInput(t):void 0:n.bindAgainstOverridesOrContainerModel(t)});this._setEditScope();this._setupJourneyEditScopeReactor()},a.prototype.bindAdaptedInput=function(n){var t=n.source,i=t&&t.modelType;switch(i){case hi:return{sourceModel:this.adapter.viewModel,sourceModelName:this.toString()+yf};case ki:return{sourceModel:this.adapter.inputPropertyBindings.targetModel,sourceModelName:this.toString()+pf}}},a.prototype._registerAdapterInputPropertyBindings=function(){var t=this,n=this.adapter,i=n.inputPropertyBindings,r=i.targetModel;fr(this,n.inputPropertyBindings,n.bindings,function(n){return r[n.targetProperty]=ct(),t.bindAgainstOverridesOrContainerModel(n)})},a.prototype.getNonDetailsContainerPropertyBindings=function(n){n===void 0&&(n=!0);var t=this.adapter,r=n&&t?t.inputPropertyBindings:this.getInputPropertyBindings(),i=[];return r.properties.forEach(function(
n){var t=n.compositionBindingDefinition,r=t&&t.source&&t.source.scope;r!==ui.DetailsContainer&&i.push(n)}),i},a.prototype.bindAgainstOverridesOrContainerModel=function(n){var t,r,i,u;if(n.source.id!==this.id){if(uf(n))return null;if(t=n.source.property,r=this.overridesModel,ht(r,t).exists)return{overridesConstantBindings:!0,sourceModelName:this.toString()+af,sourceModel:r};if(i=this.containerModel,i&&ht(i,t).exists)return{sourceModelName:this.toString()+yu,sourceModel:i};if(iu(n.source))return u={},yt.setModelValue(u,t,undefined),{sourceModelName:this.toString()+vf,sourceModel:u}}},a.prototype._setupInvocationProperties=function(n,t){var r=this,i=this.partDefinition;(this._vm=t,!this._vm||this.isDisposed()||this.isDisabled)||(this._setViewStateProperties(i.viewStateProperties,n),this.setBladeOpener(new hr.BladeOpener(this._getBladeOpenerConfig())),fe(this,this.partDefinition,this._restoredFromJson)&&i.details&&i.details.length&&(i.details.forEach(function(n){ee(r,n)&&r._registerInvocationProperty(
n)}),this._setupOpenInTabListenerForSelectables()))},a.prototype.selectOnReady=function(n,t){var i=this;return Q(this.awaitComposed().then(function(){return i._allInputPropertyBindingsBound.promise()}).then(function(){var r=st(),u=i._part.selectOnReady(n||function(){return!0},t);return u.then(r.resolve,r.reject),r.promise()}))},a.prototype.activateSelection=function(n,t,i){var u=this,r,f,e;return i=i||function(){return!0},r=b.getSelectablePath(n),e=this.awaitComposed().then(function(){var n={selectablePath:r,execute:function(n){var i=ht(n,r);if(!i.exists){et.error("Part '{0}': Model '{1}' does not contain value under the selectable path '{2}'.".format(u.toString(),JSON.stringify(fi(n)),r?r:"NULL"));f=Q.resolve(!1);return}f=t(pt(i.value))}};return u._part.selectOnReady(i,n)}),Q.all([e,f]).then(function(n){return n[0]&&n[1]},function(n){return et.error("Fail to activate the selection for part '{0}'. The reason is {1}.".format(u.toString(),n.stack||n.message||n)),!1})},a.prototype.getSelectableAsync=
function(n){return this.getViewModelAsync().then(function(t){var r=typeof n=="string"?n:b.getSelectablePath(n),i=ht(t,r);return i.exists?pt(i.value):null})},a.prototype._getBladeOpenerConfig=function(){var n=this;return{services:this.services,masterModelId:di(this),masterModel:this.getViewModel(),referenceComposition:this,referenceExtension:this.extension,invocationThrottleDuration:this.invocationThrottleDuration,isBladeOpenedByMaster:function(t){return t.masterPartId===n.id&&rr(t.masterCommandName)},onBladeOpened:function(t){Q(t.awaitComposed()).then(function(){return Q.allSettled(t.children.map(function(n){return n.awaitChildrenOnInputsSetsResolved()}))}).finally(function(){var t=n._menu;t&&t.onDetailBladeReady()})},addOutputBindings:function(t,i){re(n,t,i)},removeOutputBindings:function(t){ue(n,t)},configureBladeDescriptor:function(t){t.masterPartId=n.id;t.bindings&&t.bindings.forEach(function(i){i.source&&i.source.id===n.id&&(t.model[i.targetProperty]=fi(ht(n._vm,i.source.property).
value))})},initialViewModelState:fi(this.partState)}},a.prototype.loadState=function(n){var i=this;this.partDefinition&&n&&this._vm&&this._vm!==t.EmptyViewModel&&this._viewStateProperties.forEach(function(t){var r=ht(n,t);r.exists&&t.substr(0,pu.length)!==pu&&yt.setModelValue(i._vm,t,r.value)})},a.prototype._setupLoadingReactor=function(n,t){var i=this,r;this.partDefinition.partKind!==dt.Provisioning&&(this._loadingReactorLifetime=this.createChildLifetime(),or(this._loadingReactorLifetime,function(){var r=t.inProgress();n.hasOngoingOperation(r&&!n.locked());i.triggeringLockedBladeSpinner(r&&n.locked())}),r=this.getBindableContainer(),r&&r.bladeDefinition&&r.bladeDefinition.templateBlade&&(or(this._loadingReactorLifetime,function(){r.shieldType&&r.shieldType(i._vm.container.operations.shieldType())}),or(this._loadingReactorLifetime,function(){r.isUiBlocked&&r.isUiBlocked(i._vm.container.operations.blockingUi())})),t.blockingUi.subscribe(this._loadingReactorLifetime,function(t){var r,u;ei===
"delay"?(i._clearSpinnerTimeout(),t?n.isInBlockingLoadingState()||i._showSpinnerAfterTimeout(n):n.isInBlockingLoadingState(!1)):ei==="fade"?n.isInBlockingLoadingState(t):(r=i._vm.container.operations.shieldType()===ef.Translucent||n.locked(),n.isInBlockingLoadingState(t&&!r));t||(u=n.hasOngoingOperation(),i._contentRevealed.resolve(u),i._contentRevealedTime=i._contentRevealedTime||bi.getTimestamp())}),t.blockingUi()||(this._contentRevealed.resolve(t.inProgress()),this._contentRevealedTime=bi.getTimestamp(),this._clearSpinnerTimeout(),n.isInBlockingLoadingState(!1)))},a.prototype._traceRevealed=function(n){if(!this._revealTraced&&(this._revealTraced=!0,lr.messageContext)){var s=lr.messageContext,r=ur,u=this._getPrimaryExtensionName(),f=pi(this.locator),e=n||bi.getTimestamp(),o=s.initiatingTimestamps,t=o.operations[bi.ON_INPUTS_SET_CALLED],i=o.operations[bi.CONTENT_REVEALED];t&&i&&(gt.trace({timestamp:i.end,extension:u,source:r,action:"ExtPartInitialDataLoaded",name:f,actionModifier:gt.ActionModifier.
Complete,duration:i.end-t.begin}),gt.trace({timestamp:e,extension:u,source:r,action:"ExtPartInitialDataReceived",name:f,actionModifier:gt.ActionModifier.Complete,duration:e-t.begin}))}},a.prototype._showSpinnerAfterTimeout=function(n){this._spinnerTimeout=setTimeout(function(){n.isInBlockingLoadingState(!0)},this._showSpinnerTimeoutMillis)},a.prototype._removeOutputArgumentValuesFromContainerModel=function(){var n=this.partDefinition,t=this.containerModel;t&&n&&n.details&&n.details.forEach(function(n){n.outputArguments&&n.outputArguments.forEach(function(n){n.valuesFrom&&n.valuesFrom.forEach(function(n){ht(t,n.property).exists&&yt.setModelValue(t,n.property,undefined)})})})},a.prototype._getPartSettingsManagerConfig=function(n,t){return{services:this.services,part:this,instanceProperties:t,partViewModelId:di(this),partStateDefinition:this.partDefinition&&this.partDefinition.partState,identityInputs:n}},a.prototype._listenForPartMutation=function(){var n=this,r=this.partDefinition,t,u=this.
_vm.container,i;u.mutate&&!r.shareVmWithParentBlade&&(i=this.createChildLifetime(),u.mutate.subscribe(i,function(u){var f=n.locator.getExtensionLocator(),e;if(u.partName)t=u.extensionName?ti.forExtension(u.extensionName,f.cloudName).withPartType(u.partName):f.withPartType(u.partName);else{if(e=r.assetTypeDefinition,!e){et.error("Mutate function on part {0} was called with an object but the mutating part doesn't have an asset type definition.".format(n.locator.toString()));return}t=ti.forExtension(f.name,f.cloudName).withPartType(e.partName)}var o=n.getPartsContainer(),s=o&&o.locator&&o.locator.type===wt.Blade,h={newPartContainerModel:u.containerModel,preventNewPartActivation:u.preventActivation||s,caller:"mutation"};n.services.desktop.replacePart(n,t,h).fail(function(){var i="Unable to replace provisioning part '{0}' with the part for the created asset defined by the locator '{1}'.".format(n.locator.toString(),t.toString());et.error(i)}).finally(function(){n._disposeEditScope();i.dispose(
)})}))},a.prototype._updateForHasPermissions=function(n){var i=this;return this._vmPromise.then(function(){var r=i._vm,u,f;r===t.EmptyViewModel||i.isDisposed()?et.warning("Part '{0}' has not retrieved view model when checking permissions.".format(i.locator.toString())):(u=r.container,f=i.widget,n?u.unauthorizedMessage(null):(f&&f.options.isInBlockingLoadingState(!1),u.unauthorized(),r.updatePartForUnauthorized()))})},a.prototype._getAllInputsSetWatcherConfig=function(){var n=this,t=this.widget,i={bindableTarget:{viewModelName:di(this)},propertyBindings:this.getInputPropertyBindings(),allInputsSet:this.allInputsSet,calledOnInputsSet:this.calledOnInputsSet,failedOnInputsSet:this.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0,inputsSetCalled:function(i,r){r.finally(function(){n._onInputsSetCompleted.resolve();te||n._traceRevealed(n._contentRevealedTime);n._contentRevealed.resolve(!1);n._lastRebindOnInputsSetProperties&&(vt.isEmptyObject(n._lastRebindOnInputsSetProperties)||
p.deepSubset(i,n._lastRebindOnInputsSetProperties))&&t&&t.options.isInBlockingLoadingState(!1)})},beforeViewModelPropertyUpdate:function(t){if(n.partDefinition.permissions){var i=st(),r=new bt,u=n.locator.toString();return tt.checkPermissions(n.partDefinition.permissions,ff.All,t,n.partDefinition.assetType,n.extension.name,n.services,n.extension.cloudName,u).then(function(t){n._updateForHasPermissions(t).then(null,function(n){et.error(n)});i.resolve(t)}).catch(function(n){i.reject(n)}).finally(function(){n._perfData.checkPermissions=r.millisecondsElapsed}),i.promise()}return st().resolve(!0).promise()},getInputsMetadata:function(){var t=ni.getConfigurableInputsMetadata(n);return Object.keys(t).forEach(function(n){var i=t[n];(i&&i.bindingSources||[]).forEach(function(n){delete n.sourceReference})}),t},onInputsSetCoordinatorState:ct(1)};return this.partDefinition&&this.partDefinition.partState&&this._partSettingsManager&&(i.getStateAsync=function(){var t=Q.defer();return n._partSettingsManager.
getPartSettingsAsync().then(function(i){n._part&&n._part.partSettingFailed(!1);t.resolve(i)},function(i){et.error("Failed to retrieve part settings for part '{0}'.".format(n.toString()));n._part&&n._part.partSettingFailed(!0);t.reject("Failed to retrieve part settings for part '{0}'. Details: {1}".format(n.toString(),i))}),t.promise}),i},a.prototype._getAdapterAllInputsSetWatcherConfig=function(){var n=this.adapter;return{bindableTarget:{viewModelName:n.viewModelId},propertyBindings:n.inputPropertyBindings,allInputsSet:n.allInputsSet,calledOnInputsSet:n.calledOnInputsSet,failedOnInputsSet:n.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0,onInputsSetCoordinatorState:ct(1)}},a.prototype.notifyDetailBladesRehydrated=function(n){!this.isComposed||this.isDisabled||this.isDisposed()||this._bladeOpener.notifyDetailBladesOpened(n)},a.prototype.notifyDetailBladeClosed=function(n){var t=this;this.awaitComposed().done(function(){var r=n.masterCommandName,i=t._vm.
container;t.isDisabled||t.isDisposed()||!rr(r)||t._bladeOpener.notifyDetailBladeClosed(n);i&&i.selectable&&!rr(r)&&i.selectable.isCommandSelected(!1)})},a.prototype.beforeActivateCommandMenuItems=function(n){n.isControlContextMenu||(this._contextMenuViewModels=null)},a.prototype._handleRightClick=function(t,i){var r=this,u=i&&i.listData&&i.listData.selectableSet,f,o;this.isDisabled||this.isDisposed()||(u instanceof e.SelectableSet2&&u.commandGroupProvider?(f=kf.peekObservable(i.viewModel.data),u.commandGroupProvider(f).then(function(n){var u=lu(i,!1,!1);u.viewModel=f;u.commandGroupOwner=n[0].owner;u.commandGroup=n[0].id;r._determineExtensionAndTriggerContextMenu(t,u)})):(o=e.isSelectableSet2(u)?undefined:u,o&&o._msPortalFxSupplyCommands?tr(this,"./UI.Composition.ContextMenuV2",function(n){var u={partComposition:r,services:r.services},f=n.OpenContextMenuPipeline.createPipeline(r,u,r);f.startTask({dataItem:i.viewModel,extension:r.extension,contextMenuArgs:i,evt:t})},n):this._determineExtensionAndTriggerContextMenu(
t,i)))},a.prototype._determineExtensionAndTriggerContextMenu=function(t,i){var r=this,f=this.services,u=this.extension,o=function(n){var t=Q(f.finder.locateAsync(ti.forExtension(n.commandGroupOwner,u.cloudName)));return t.fail(function(){et.error("Could not find extension '{0}' for commandGroup {1} from part in extension {2}.".format(n.commandGroupOwner,n.commandGroup,u.name))}),t},e=function(n,u){r._contextMenuViewModels=n.fireContextMenuEvent(f,r,u,t,i,r._showShellCommands,r._bladeOpener)};tr(this,"./UI.Composition.ContextMenuContainer.DemandLoad",function(n){i.commandGroupOwner&&i.commandGroupOwner!==u.name?o(i).then(function(t){e(n,t)}):e(n,u)},n)},a.prototype.isSelected=function(){var t=pt(this._vm.container).selectable,n=pt(t);return n&&pt(n.isSelected)},a.prototype.awaitComposed=function(){return this._registrationDeferred.promise()},a.prototype.awaitOnInputsSetComplete=function(){return this._onInputsSetCompleted.promise},a.prototype.awaitContentRevealed=function(){return this.
_contentRevealed.promise},a.prototype._createErrorPart=function(n,t,i,r){var l=c.getPartFactory(this._extensionName,{partKind:dt.Error}),e=this.locator,o=this.extension,s=fu.composePartViewModel(function(){return r=r||{},r.title=ct(e&&e.name),r.subtitle=ct(o&&o.name),r}),h=of.getLogFriendlyMessage(i),u,f;return this._traceErrorTelemetry(t,h),et.error("Error composing part '{0}'. Details: {1}".format(this.toString(),h),1),u=this._savedContainerState,f=s.container,u&&(f.partTitle(u.partTitle),f.assetName(u.assetName)),this._registrationDeferred.reject(i),this._createPartWidget(l,s,!0)},a.prototype._clearSpinnerTimeout=function(){this._spinnerTimeout&&(pr.clearTimeout(this._spinnerTimeout),this._spinnerTimeout=null)},a.prototype._createPartWidget=function(n,t,i){var r=this,u=this.locator,f={size:this.widget.options.size,locator:u,getDebugId:function(){return di(r)},traceErrorTelemetry:function(n){r._traceErrorTelemetry(at.TransitionedToErrorState,n)}};return i&&(this._clearSpinnerTimeout(
),this.widget.options.isInBlockingLoadingState(!1)),n.createPart(this._partContainer[0],t,f,this.services).then(function(n){var t,i,f;r._part=n;t=r.partDefinition;n.setupContent({extensionName:r._extensionName,uniqueName:u.toFriendlyString("_"),styleSheets:t&&t.styleSheets});yi(r,function(){var n=r.parent,t=n&&n.widget,i=t&&t.options.locked();r.widget&&r.widget.options.locked(i);r._part&&r._part.lockedUiContext(i)});i=r.widget;f=i&&i.element;f&&f.on(ot.fxerrorpartclicked,r._onErrorClick=function(){r.services.desktop.replacePart(r,u,{newPartContainerModel:r.containerModel,newPartOverridesModel:r.overridesModel,doNotSaveSettings:!0})})})},a.prototype.loadPropertiesFromJson=function(n,t){t===void 0&&(t=!1);var i=n.partState;this.assetInstanceDefinition=n.assetInstanceDefinition;this.bindings=lt.bindingsFromJSON(n.bindings)||[];this.initialSize=n.initialSize;this._bindingsInitialized=n.bindingsInitialized;this._restoredFromJson=!0;this.loadFromJson(n);this._savedContainerState=n.savedContainerState;
this.containerModel=tu(n.containerModel);this.overridesModel=tu(n.overridesModel)||{};this.partState=li.isSerializedObject(i)?li.fromSerializableObject(i):i;t&&this._removeSelectablesFromPartState(this.partState);n.originalPartLocator&&(this.originalPartLocator=ti.fromJSON(n.originalPartLocator));this._adapterBindings=lt.bindingsFromJSON(n.adapterBindings)},a.prototype._removeSelectablesFromPartState=function(n){var t=this;n&&typeof n=="object"&&ku(n,function(i,r){df[i]?delete n[i]:typeof r=="object"&&t._removeSelectablesFromPartState(r)})},a.prototype.calculateInitialSize=function(){var n,s,h,v,y,i={},l=this.services.finder,u=this.locator,f=u.type,e,t,r,p,w,a,o;f===wt.PartInstance||f===wt.StartboardPartInstance?l.tryLocate(u,i)&&(e=i.value,e&&(t=e.inline,r=e.reference,s=t?t.initialSize:r.initialSize,h=t?t.largeInitialSize:r.largeInitialSize,v=t?t.initialWidth:r.initialWidth,y=t?t.initialHeight:r.initialHeight,t?n=t:(p=ti.forExtension(r.extension||u.getExtensionLocator().name,u.getExtensionLocator(
).cloudName),w=p.withPartType(r.partTypeName),i={},l.tryLocate(w,i)&&(n=i.value)))):f===wt.PartType?(i={},l.tryLocate(u,i)&&(n=i.value)):et.error("Unable to create Part composition. Invalid locator type: '{0}'".format(f));this._bindingsInitialized=!1;a=c.getPartSizeOrDefault(n);ri[s]?this.initialSize=s:n&&ri[n.initialSize]?this.initialSize=n.initialSize:n?(o=c.getPartFactory(this._extensionName,n,{}),this.initialSize=o&&o.defaultSize!==undefined?o.defaultSize:a):this.initialSize=a;ri[h]?this.largeInitialSize=h:n&&ri[n.largeInitialSize]&&(this.largeInitialSize=n.largeInitialSize);this.initialSize===ri.Custom&&(this.initialWidth=v||n&&n.initialWidth,this.initialHeight=y||n&&n.initialHeight)},a.prototype.getDiagnosticsData=function(){return vt.extend(o.prototype.getDiagnosticsData.call(this),{bindings:lt.mapBindingsToFriendlyObjects(this.bindings)})},a.prototype._setPartViewModelSize=function(n){var t="content.size",i=this._vm,r=ht(i,t);r.exists&&er(r.value)&&yt.setModelValue(i,t,n)},a.prototype.
_getSummaryPartViewModelState=function(){var n=ot.fxsummarycollapsed,t=vt.Event(n);return this.widget.trigger(n,t),t.result},a.prototype._autoOpenSettingsFromSummary=function(){var t=this,n;gf==="true"&&(this._restoredFromJson||(n=this.getPartsContainer(),Q.all([n.getPermissionPromise(),this.awaitComposed()]).then(function(){var u=ht(t._vm,"content.hasSettings"),i,r,f;u.exists&&pt(u.value)&&(i=ht(t._vm,"content.settingsSelectable"),i.exists&&(r=pt(i.value),f=n.detailContainers,r&&(f||[]).length<=0&&n.canAutoOpenSettings()&&(t.widget.element.trigger(ot.fxautosettings,{masterBladeId:n.instanceId,masterPartId:t.instanceId}),r.isSelected(!0))))})))},a.prototype._setPartContainerSize=function(n,t){var i=this._vm&&this._vm.container;i&&(i.width&&i.width(n),i.height&&i.height(t))},a.prototype._getEditScopeIdFromSettings=function(){var n=this._journey,t=n&&n.ambientSettings.getItem(this.journeyPath),i=t&&t.value,r=i&&i.editScope;return r&&r.editScopeId},a.prototype._setupJourneyEditScopeReactor=
function(){var n=this.partDefinition,t=this._journey;n&&n.editScopeType&&t&&t.observeEditScopeChanges(this,{editScopeId:this.editScopeId,ownerType:this.locator.type,ownerLocatable:this})},a.prototype._setEditScope=function(){var r=this.partDefinition,n,t,u,i;if(r&&r.editScopeType){if(n=this._getEditScopeIdFromSettings(),n)this.editScopeId(n);else{this.editScopeId(ii.getUniqueId());this.services.editScopeManager.onEditScopeCreated(this.editScopeId())}t=this.getInputPropertyBindings();u=t.properties.some(function(n){return n.targetProperty===vi});u||(i={},i[vi]=this.editScopeId,t.mapProperty(vi,vi).bind(this.toString()+"-[EditScopeId]",i,!0))}},a.prototype._getCommands=function(){if(!this.isComposed||!this.widget)throw new Error("Part '{0}' needs to be composed before retrieving its commands.".format(this.toString()));var n=this.widget;return n.options.commands},a.prototype._setupBladeRebindingHandlers=function(n){var u=this;if(n&&n.onRebind){var t=this._beforeBladeRebind.bind(this),i=this.
_afterBladeRebind.bind(this),r=function(){u._containerInputsChanging(!1)};n.onRebind(t,i,r);this.registerForDispose(function(){n.offRebind(t,i,r)})}},a.prototype._ensureAssetAffinity=function(){var t=this,n=this.parent&&this.getPartsContainer(),i=this.assetType;if(!n||!n.assetType||!i||n.assetType!==i||!er(n.assetId))return this._part.inContainerOfSameAsset(!1);yi(this,function(){var i=n.assetId(),r=t.assetId(),u=i&&r&&l.compareAssetId(i,r);t._part.inContainerOfSameAsset(u)})},a.prototype._ensureAdapterAtomicityForBindings=function(){var t=this.adapter,n;t&&(n=[],this.bindings.forEach(function(t){var i=t.source;i.modelType===hi&&n.push(i.property)}),n.forEach(function(n){yt.setModelValue(t.viewModel,n,undefined)}))},a.prototype._setupAdaptedInputsReboundReactor=function(){var n=this,t=this.adapter;t&&!t.allOutputsReboundComputed&&(t.allOutputsReboundComputed=yi(this,function(){var u=n.bindings.filter(function(n){var t=n.source.modelType;return t===hi||t===ki}).every(function(t){var i=n.
bindAdaptedInput(t).sourceModel,r=ht(i,t.source.property).value;return pt(r)!==undefined}),i,r;u&&(i=nt.mapSourceModelToTargetModel(t.viewModel,n.bindings,hi,n.toString()),r=nt.mapSourceModelToTargetModel(t.inputPropertyBindings.targetModel,n.bindings,ki,n.toString()),n._lastRebindOnInputsSetProperties=vt.extend(i,r))}))},a.prototype._beforeBladeRebind=function(n){var i=this,r,t,u,f,e,o;if(this._containerInputsChanging(!0),this._updateRebindSequenceNumber(),ci.provideContext(function(){i._creationState=ci.getState()},uu.Part,this._getPartContext()),r=this.editScopeId()&&this.services.editScopeManager.getStateObservable(this.editScopeId()),t=this.widget,this._onInputsSetCompleted.reject("Part binding canceled due to rebinding for part '{0}'".format(this.toString())),this._contentRevealed.reject("Part reveal canceled due to rebinding for part '{0}'".format(this.toString())),this._onInputsSetCompleted=Q.defer(),this._contentRevealed=Q.defer(),this._hasRebindableInputs&&(ei==="delay"||ei===
"fade"?t&&t.options.isInBlockingLoadingState(!0):(u=(this.parent.parent||this.parent).widget,!t||u&&u.options.locked()||t.options.isInBlockingLoadingState(!0)),this._lastRebindOnInputsSetProperties=nt.mapSourceModelToTargetModel(n,this.bindings,kt.BladeInput,this.toString()),this._setupAdaptedInputsReboundReactor()),r&&r()===cu.NotDirty)this.services.editScopeManager.onEditScopeDisposed(this.editScopeId());this.editScopeId(undefined);this._ensureAdapterAtomicityForBindings();this.bindings.forEach(function(n){if(n.source.scope===ui.DetailsContainer){var t=ht(i._vm,n.targetProperty);t.exists&&yt.setModelValue(i._vm,n.targetProperty,undefined)}});this._vm.container.unauthorizedMessage(null);this.partDefinition.shareVmWithParentBlade?(f=this.parent,e=f.parent,e.setInputsSetPromise(this._onInputsSetCompleted.promise)):(o=this._getNotFoundMessage(),o(null))},a.prototype._afterBladeRebind=function(){this.isComposed&&(this._setEditScope(),this.partDefinition.partKind===dt.ResourceSummary&&this.
_autoOpenSettingsFromSummary())},a.prototype._disposeEditScope=function(){var t=this.editScopeId(),n;if(t){this.services.editScopeManager.onEditScopeDisposed(t);n=this._journey;n&&n.ambientSettings.removeItem(this.journeyPath)}},a.prototype._setViewStateProperties=function(n,t){var f=this,e=n||[],i=t||[],r,u;i=i.filter(function(n){var t=n.split(".");return t.length>1?(t.pop(),typeof ht(f._vm,t.join(".")).value=="object"):!0});this._viewStateProperties=e.concatUnique(i);r=this._vm;u=r&&r.container;u&&u.selectable&&(this._viewStateProperties=this._viewStateProperties.concatUnique([wf,bf]))},a.prototype._registerInvocationProperty=function(n){var u=this,t=this._bladeOpener,i,f=b.detailsIsPartContainer(n),r;f&&(i=ko.pureComputed(function(){return!u._vm.container.isSelectable()}));r=t.registerInvocationProperty(n,i);this._viewStateProperties=t.modifyViewStateProperties(this._viewStateProperties,r)},a.prototype._setupOpenInTabListenerForSelectables=function(){var n=this;this.widget.element.on(
ot.fxopeninnewtab,this._onOpenTab=function(t,i){var r=i.selectable,f=b.getAssociatedDetailDefinition(r||i.selectableSet,n.getViewModel(),n.partDefinition),e,o;f&&(e=r?r.selectedValue():d.createSelection(i.selectableSet,i.item),o=Q(e).then(function(t){var i=n._bladeOpener.createBladeModelForSelectedItem(f,t),r=i&&i.locator;return r?u.getBladeDeepLink(r.getExtensionLocator(),r.name,pr.location.href,i.model):null}),n.services.openWindow(o))})},a.prototype._disposeOpenInTabListeners=function(){this._onOpenTab&&(this.widget.element.off(ot.fxopeninnewtab,this._onOpenTab),this._onOpenTab=null)},a.prototype._getNotFoundMessage=function(){var n=this._vm.container;return n.notFoundMessage},a.prototype._traceErrorTelemetry=function(n,t){var i=this.locator;gt.trace({extension:this._getPrimaryExtensionName(),source:ur,action:ai.PartErrored,actionModifier:at[n],name:pi(i),data:{details:t}})},a}(w.Instance);t.Instance=gr;t.prepareContainerModel=cr;t.getSerializableContainerModel=nu;t.createContainerModel=
tu;t.create=gu;t.setBladeOpenerModule=ae;t.setDynamicPartBinderModule=ve;t.inferredReferenceType=-999;t.createOverridesOrContainerModelSourceReference=ye;t.isOverridesOrContainerModelSourceReference=iu;t.isDynamicBindingWithNonLocalSource=uf}(et||(et={})),et});define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){var f=jQuery,t={pending:"pending"},r=function(){function n(n,t){this.deferred=i.Helpers.Deferred();this.targetId=n;this.isSource=t}return n}(),u=function(){function n(n){this._awaitableCompositions=[];this.resolvedCompositions=[];this._trackResolvedCompositions=n}return n.prototype.await=function(n,i){var f=this,u=new r(n&&n.toString(),i),e=this.resolvedCompositions.firstIndex(function(n){return i(n)});if(e>=0)u.deferred.resolve(this.resolvedCompositions[e]);else if(this._awaitableCompositions.push(u),n)n.onDispose(function(){var n;u.deferred.state()===t.pending&&(u.deferred.reject(
),n=f._awaitableCompositions.indexOf(u),n>=0&&f._awaitableCompositions.splice(n,1))});return u.deferred.promise()},n.prototype.resolve=function(n){var r=this,t,i;if(this._trackResolvedCompositions){this.resolvedCompositions.push(n);n.onDispose(function(){var t=r.resolvedCompositions.indexOf(n);t>=0&&r.resolvedCompositions.splice(t,1)})}for(t=this._awaitableCompositions.length-1;t>=0;t--)i=this._awaitableCompositions[t],i.isSource(n)&&(i.deferred.resolve(n),this._awaitableCompositions.splice(t,1))},Object.defineProperty(n.prototype,"waitingCompositions",{get:function(){return this._awaitableCompositions.map(function(n){return n.targetId})},enumerable:!0,configurable:!0}),n}();n.CompositionAwaiter=u}(r||(r={})),r});define("MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart",["require","exports","f","../../Extension/Extension.Definition.Locator","./UI.Composition","./UI.Composition.CompositionBinder","./UI.Composition.ContextMenuContainer","./UI.Composition.Part","../../Services/Services.Settings",
"../../Services/Services.EditScopeManagement"],function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return function(t){function nt(n,i,r,u){u=u||{};var f=new c(n,i,null,u.id);return f.calculateInitialSize(),f.modelContainsSensitiveData=u.modelContainsSensitiveData,f.containerModel=o.prepareContainerModel(r||{}),f.overridesModel=o.prepareContainerModel(u.overridesModel||{}),f.validateBindings(r)||(t.log.error("Unable to create instance of startboard part '{0}', check log for errors.".format(i.toString())),f.locator.name="##INVALID##"),u.doNotSaveSettings||f.save(),f}var l=r.Locator,v=r.LocatorType,y=i.Base,p=y.Diagnostics,w=i.Parts.PartKind,b=s.SettingStore,k=u.CompositionType,d=f.CompositionBinder,a=h.EditScopeState,g=window,tt=g.fx.environment,c;t.startboardPartName="StartboardPart";t.log=p.createLog(n);c=function(n){function i(i,r,u,f){n.call(this,i,r,u,f,null,100);this.dontSetupWidget=!1;this.containerModel={};this._name=t.startboardPartName;this._store=b.Startboard}return __extends(i,n),
i.fromJSON=function(n,t){return u.createCompositionFromJSON(t,function(){var r=new i(n,l.fromJSON(t.locator),t.widgetState,t.id);return r.loadPropertiesFromJson(t,!0),r._storedEditScopeId=t.editScopeId,r.dontSetupWidget=t.dontSetupWidget,r.defaultMenuItemId=t.defaultMenuItemId,r.containerModel=r.containerModel||{},r.deepLink=t.deepLink,r},function(r,u){var f=new i(n,r,null,t.id);return f.unrecoverableErrorMessage=u,f})},i.prototype.getCompositionType=function(){return k.StartboardPart},i.prototype.register=function(t,i,r){var f=this,u,e;n.prototype.register.call(this,t,i,r);var o,s=this.deepLink,h=this._part,c=this.services;s&&(u=h.getSelectable(),o={isClickable:u.isClickable,isSelected:u.isSelected,value:u.value,onClick:function(){c.router.route(s)}});h.configure({onStartboard:!0,selectable:o});e=this.editScopeId();e&&this.partDefinition.partKind===w.Provisioning&&c.editScopeManager.getStateObservable(e).subscribe(this,function(n){var t=n===a.Dirty||n===a.DirtyAndSaving;t&&(f.dontSetupWidget=
!1,f.addWidgetToUI({parentElement:f.getPartsContainer().widget}))})},i.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this);return t.editScopeId=this.editScopeId(),t.dontSetupWidget=this.dontSetupWidget,t.defaultMenuItemId=this.defaultMenuItemId,t.deepLink=this.deepLink,t},i.prototype.isOrganizable=function(){return!0},i.prototype.validateBindings=function(n){var r=this,t,i;return this.bindings&&this.bindings.length>0?(t=this.bindings.filter(function(n){return n.source.id!==r.id}),i=t.map(function(n){return n.source.property}),d.modelHasProperties(this.toString(),i,n)):!0},i.prototype.matchesLocatorAndModel=function(n,t,i,r){return!this.locator.equals(t)&&!this._matchesPartReferenceLocator(n,t)?!1:this.defaultMenuItemId!==r?!1:u.deepSubset(this.containerModel,i||{})},i.prototype.addWidgetToUI=function(t){if(!this.dontSetupWidget){var i=this.widget;e.composeShellCommands(this,i.options.commands,!0,this.services);n.prototype.addWidgetToUI.call(this,t);t.doNotSaveSettings||this.
save()}},i.prototype.save=function(t){return this.dontSetupWidget?n.prototype.save.call(this,t):Q()},i.prototype._forceSave=function(t){return n.prototype.save.call(this,t)},i.prototype._getEditScopeIdFromSettings=function(){return this._storedEditScopeId},i.prototype._setupJourneyEditScopeReactor=function(){},i.prototype._disposeEditScope=function(){var n=this.editScopeId();if(n)this.services.editScopeManager.onEditScopeDisposed(n)},i.prototype._getBladeOpenerConfig=function(){var i=this,r=n.prototype._getBladeOpenerConfig.call(this),u=function(){var n=i.getPartsContainer().detailContainers;return n&&n.length>0&&n[0]};return r.onBladesOpening=function(){i.isDisposed()&&i.dontSetupWidget&&t.log.error("Cannot open new blades for part '{0}', it has already been disposed and removed from the starboard.".format(i.toString())+" If this part was created from a Hub action, make sure it doesn't change the target blade after it has been opened.")},r.getCloseOwnedDetailBladesHandler=function(n){
var r,f=n&&n.source&&n.source.property,t=u();return t&&t.masterPartId===i.id&&t.masterInvocationProperty===f&&!t.masterCommandName&&(r=function(){var n=i.services.desktop,t=n.getActiveJourney();return t?n.tryDiscardJourney(t.id):n.tryDeactivateJourney()}),r},r.getCloseOtherDetailBladesHandler=function(n){var r,f=n&&n.source&&n.source.property,t=u();return t&&(t.masterPartId!==i.id||t.masterInvocationProperty!==f)&&(r=function(){var n=i.services.desktop,t=n.getActiveJourney();return t.isStartedWithContextBlade()?n.tryDiscardJourney(t.id):n.tryDeactivateJourney()}),r},r},i.prototype._matchesPartReferenceLocator=function(n,t){var u=!1,f={},r,i,e,o;return this.locator.type===v.StartboardPartInstance&&n.tryLocate(this.locator,f)&&(r=f.value,i=r&&r.reference,i&&(e=i.extension?l.forExtension(i.extension,this.locator.getExtensionLocator().cloudName):this.locator.getExtensionLocator(),o=e.withPartType(i.partTypeName),u=t.equals(o))),u},i}(o.Instance);t.Instance=c;t.create=nt}(c||(c={})),c});define(
"_generated/Templates/WidgetsStartboard",["require","exports"],function(){"use strict";return function(){return'<div class="fxs-startboard-loadanimation"> <div class="fxs-splashscreen-loader-container"> <div><\/div><div><\/div><div><\/div><div><\/div><div><\/div> <\/div> <\/div> <div class="fxs-startboard-header"> <div class="fxs-startboard-title fxs-startboard-title-next fxs-br-default" id="startboard-title"><\/div> <div class="fxs-startboard-dropdown"><\/div> <input type="text" class="fxs-startboard-title-edit fxs-hide-in-normal" maxlength="200"> <div class="fxs-startboard-migration" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-migrate"><\/button> <\/div> <div class="fxs-startboard-actions" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-new"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-edit"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-share"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-fullscreen"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-clone"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-delete"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-filter"><\/button> <\/div> <\/div> <div class="fxs-startboard-layout"><\/div> <div class="fxs-startboard-message-container"><\/div>'}
});define("MsPortalImpl/Widgets/Widgets.StartBoard",["require","exports","f","../Base/Base.Events","../Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.RightClick","../Generated/SvgDefinitions","../Base/Telemetry","./Widgets.DropMenu","./Widgets.FlowLayout","./Widgets.LayoutBase","../../_generated/Templates/WidgetsStartboard","./Widgets.Tile","./Widgets.UIElementBase","../../_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";var p;return function(t){var st=i.Base,ht=st.Diagnostics,ct=ht.Telemetry,lt=st.EventTypes,d=o.Content.SvgLibrary,b=d.Shell,at=s.Source,vt=s.Action,ii=window,yt=jQuery,ri=ht.createLog(n),p=f.Dashboard,pt="fxs-theme-context-start",nt,ni,ti;t.widgetClass="fxs-startboard";var it=t.widgetClass+"-header",ui=t.widgetClass+"-layout",wt=t.widgetClass+"-title",fi=t.widgetClass+"-title-next",bt=t.widgetClass+"-title-edit";t.headerButtonClass=
t.widgetClass+"-button";var k=t.widgetClass+"-dropdown",rt=t.headerButtonClass+"-text",ut=t.headerButtonClass+"-icon",ei=t.headerButtonClass+"-new",kt=t.headerButtonClass+"-filter",oi=t.headerButtonClass+"-clone",si=t.headerButtonClass+"-delete",hi=t.headerButtonClass+"-share",ci=t.headerButtonClass+"-edit",li=t.headerButtonClass+"-fullscreen",ai=t.headerButtonClass+"-migrate",dt=t.headerButtonClass+"-browse",ft=it+"-normal",et=it+"-migration",vi=t.widgetClass+"-notfound",yi=t.widgetClass+"-loading",ot=t.widgetClass+"-message",pi=ot+"-container",wi=ot+"-title",bi=ot+"-body",tt=k+"-item",ki=k+"-dashboard",di=k+"-browseall",gi=k+"-subscriptions",nr=ii.fx.environment.features,tr=nr.filterdashboard==="true",w=ko.observable,gt=ko.observableArray,g=ko.reactor;t.fxstartboardtitlechanged="fxstartboardtitlechanged";t.fxmigratestartboard="fxmigratestartboard",function(n){n[n.Unknown=0]="Unknown";n[n.Normal=1]="Normal";n[n.Migration=2]="Migration"}(t.HeaderMode||(t.HeaderMode={}));nt=t.HeaderMode;
ni=function(n){function t(t,i){n.call(this,t);this.commands=[];this.filterButtonText=w("");this.title=w(f.NavBar.home);this.dashboardList=gt([]);this.loading=w(!1);this.notFound=w(!1);this.notFoundMessage=w("");this.subscriptionsInfo=w("");this.locked(!1);var r=this.flowLayoutOptions=new c.ViewModel("fxs-flowlayout-instanceid");r.allowReorder=!0;r.allowOverflow=!0;r.allowGaps=!0;r.allowMaximized=!1;r.resolutionGuides=!0;r.resolutionGuidesOffset.y=-88;r.orientation=l.Orientation.Horizontal;r.childWidgetType=v.Widget;r.minColumns(4);r.minRows(4);r.maxRows(4);r.locked(!1);this.headerMode=w(nt.Unknown);this.applyViewSettings(i)}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{layoutSettings:this.flowLayoutOptions.getViewSettings()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.layoutSettings&&this.flowLayoutOptions.applyViewSettings(n.NormalState.layoutSettings)},t}(y.ViewModel);t.ViewModel=ni;ti=function(n){function i(i,r){var u,
f;n.call(this,i,r);this._layout=null;u=this.lifetimeManager;i.addClass(pt).addClass(t.widgetClass).html(a());g(u,function(){var n=r.title();i.findByClassName(wt).text(n);i.findByClassName(bt).val(n)});g(u,function(){var t=r.headerMode(),n=i.findByClassName(it);switch(t){case nt.Normal:n.addClass(ft).removeClass(et);break;case nt.Migration:n.removeClass(ft).addClass(et);break;case nt.Unknown:default:n.removeClass(ft).removeClass(et)}});g(u,function(){var n=r.notFound();i.toggleClass(vi,n)});g(u,function(){var n=r.loading();i.toggleClass(yi,n)});g(u,function(){var n=r.title();document.title=n});this._layout=new c.Widget(i.findByClassName(ui),r.flowLayoutOptions);this._initializeCommands(u,i);f=i.findByClassName(pi);f.html('<div class="'+wi+'">'+p.NotFound.title+"<\/div>"+('<div class="'+bi+'" data-bind="text: data.notFoundMessage"><\/div>'));ko.applyBindings({data:r},f[0]);this._attachEventHandlers(i);u.registerForDispose(e.setup(i,gt(r.commands)))}return __extends(i,n),i.prototype.dispose=
function(){this._layout.dispose();this._cleanElement(t.widgetClass,pt);n.prototype.dispose.call(this)},i.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");this._layout.addChild(n)},i.prototype.removeChild=function(n){return this._layout.removeChild(n)},i.prototype.moveChild=function(n,t,i,r){this._layout.moveChild(n,t,i,r)},i.prototype.setFocus=function(){var t=this._layout.element.findFirstTabbable(),n;t.length===1?t.focus():(n=this._selectorMenu,n&&n.setFocus())},i.prototype.saveViewSettings=function(){return this.options.getViewSettings()},i.prototype.discardStateOfUnusedChildren=function(){return ri.assert(!!this._layout,"FlowLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:!1}},i.prototype._attachEventHandlers=function(n){var i=this,t=function(t){n.trigger(y.Widget.viewSettingsChanged,i.saveViewSettings());t.stopPropagation()};n.on(l.Widget.layoutUpdatedEventName,t);this.lifetimeManager.registerForDispose({dispose:
function(){n.off(l.Widget.layoutUpdatedEventName,t)}})},i.prototype._initializeCommands=function(n,i){var ht="title",c="aria-disabled",pt=p.create,gt=p.delete,ni=p.edit,ti=p.filter,ii=p.share,w=p.fullscreen,ri=p.clone,f=this.options,g=function(n,t){n.attr(ht,t).findByClassName(rt).html(t)},ui='<div class="fxs-startboard-button-container">'+('<div class="'+ut+'"><\/div>')+('<div class="'+rt+'"><\/div>')+"<\/div>",e=function(n,t,r,u){var f=i.findByClassName(n).html(ui);g(f,t);f.findByClassName(ut).html(r.data);f.on(lt.click,function(n){n.stopPropagation();yt(n.currentTarget).attr(c)!=="true"&&u(n)});return f},nt=e(ci,ni,b.customize,function(){ct.trace({source:at.Dashboard,action:vt.CustomizeModeEntered});ct.trace({source:at.Dashboard,action:vt.DashboardEditCommandClicked});f.addPartsCommand.execute(!1)}),l,s,v,y,it,vi,ft,pi;ko.computed(n,function(){var n=f.addPartsCommand,t=n&&n.enabled();t?nt.removeAttr(c):nt.attr(c,"true")});tr||i.findByClassName(kt).remove();l=i.findByClassName(bt);l.
on(lt.change,function(){f.title(l.val());i.trigger(t.fxstartboardtitlechanged)});var wi=i.findByClassName(k),a=new h.ViewModel('<div class="fxs-startboard-button-container">'+('<div class="'+wt+'"" data-bind="text: data.title, attr: { title: data.title }"><\/div>')+('<div class="'+ut+'">'+d.caretDown.data+"<\/div>")+"<\/div>","<div class='fx-dropmenu-dropdown'><ul class=\"fxs-dropmenu-list-system\"><!-- ko ifnot: data.dashboardList -->"+("<li class='"+tt+'\'><div class="fxs-tile-progress-transparent"><div><\/div><div><\/div><div><\/div><div><\/div><div><\/div><\/div><\/li>')+"<!-- /ko --><!-- ko if: data.dashboardList --><!-- ko ifnot: data.dashboardList().length -->"+("<li class='"+tt+"'>")+("<a><div class='fxs-dropmenu-list-content'>"+p.emptynext+"<\/div><\/a>")+"<\/li><!-- /ko --><!-- ko foreach: data.dashboardList -->"+("<li class='"+tt+" "+ki+" fxs-has-hover'>")+'<a href="" data-bind=\'attr: { title: title, id: id }, click: $parent.func.clickHandler\'><div class=\'fxs-dropmenu-list-content fxs-startboard-item-container\'><div class="fxs-startboard-item-icon"><!-- ko if: id.indexOf("private") === -1 -->'+
(""+d.Shell.share.data)+"<!-- /ko --><\/div><div class=\"fxs-startboard-item-title\" data-bind='text: title'><\/div><\/div><\/a><\/li><!-- /ko --><!-- /ko -->"+('<li class="'+tt+" "+di+' fxs-has-hover">')+('<div class="'+gi+'" data-bind="text: data.subscriptionsInfo"><\/div>')+('<a href="#" class="'+dt+'">'+p.browseAll+"<\/a>")+"<\/li><\/ul><\/div>"),o=i.findByClassName(k);a.alignMenu=0;s=this._selectorMenu=new h.Widget(o,a);a.isMenuOpen.subscribe(n,function(n){n&&f.refreshDashboardList?(v=new u.KeyboardNavigation(s.element),f.dashboardList(undefined),f.refreshDashboardList(function(n){f.dashboardList(n)}).then(function(){})):v&&v.dispose()});y=".fxs-dropmenu-content";o.find(y).width("");it=function(n,t){t.preventDefault();t.stopPropagation();i.findByClassName(fi).text(n.title);f.switchDashboard&&f.switchDashboard(n).then(function(){var n=Math.min(Math.max(o.outerWidth()+50,400),560);o.find(y).css({minWidth:n})});s.hide()};ko.applyBindings({data:f,func:{clickHandler:it}},s.element[0]);
vi=e(ei,pt,b.add,function(){f.newCommand.execute(!1)});f.filterButtonText(ti);ft=e(kt,f.filterButtonText(),b.filter,function(){f.filterCommand.execute(!1)});f.filterButtonText.subscribe(n,function(n){ft.findByClassName(rt).html(n)});var bi=e(oi,ri,d.clone,function(){f.cloneCommand.execute(!1)}),nr=e(hi,ii,b.share,function(){f.shareCommand.execute(!1)}),ir=e(si,gt,b.trashOutline,function(){f.deleteCommand.execute(!1)}),yi=e(li,w,b.fullscreen,function(){f.fullscreenCommand.execute(!1)}),et=function(){var n=r.isFullscreen()?p.exitFullscreen:w;g(yi,n)},ot=yt(document),st=r.fullscreen;ot.on(st,et);n.registerForDispose(function(){ot.off(st,et)});pi=e(ai,p.migrate,d.clone,function(){i.trigger(t.fxmigratestartboard)});i.findByClassName(dt).click(function(n){n.preventDefault();f.browseCommand.execute(!1)})},i}(y.Widget);t.Widget=ti}(p||(p={})),p});define("MsPortalImpl/UI/Compositions/UI.Composition.StartBoard",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../../Services/Services.Settings.Schema",
"../../Services/Services.Settings","../../Generated/SvgDefinitions","../../Base/Telemetry","../Commands/UI.Commands","./UI.Composition","./UI.Composition.Base","./UI.Composition.CompositionAwaiter","./UI.Composition.PartSettingsManager","./UI.Composition.PropertyBinding","./UI.Composition.StartboardPart","../Commands/UI.ShellCommands","../../Widgets/Widgets.StartBoard","../../Widgets/Widgets.UIElementBase"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";var k;return function(t){function ut(n){return n!==u.desktopSettingsKey&&n!==u.startBoardSettingsKey&&!i.startsWith(n,a.partIdentityStatePrefix)}function lt(n){var t=new g(n);return t.save(),t}var k=i.Base,nt=k.Diagnostics,ft=nt.Telemetry,tt=k.EventTypes,it=k.Utilities,et=i.Extension,d=et.ReferenceType,ot=i.Parts.PartSize,st=f.SettingStore,ht=h.CompositionType,ct=v.ReferenceScope,rt=nt.createLog(n),g;t.startboardName="Startboard";t.fxstartboardsettingchanged="fxstartboardsettingchanged";t.isStartboardPartKey=ut;g=function(n)
{function f(i,r,f){n.call(this,i,null,r,f,u.startBoardSettingsKey);this._partAwaiter=new l.CompositionAwaiter(!0);this._containerAwaiter=new l.CompositionAwaiter;this.masterContainer=null;this.detailContainers=[];this.notFound=ko.observable(!1);this._name=t.startboardName;this._store=st.Startboard}return __extends(f,n),f.prototype.getCompositionType=function(){return ht.Startboard},f.prototype.setGetDashboard=function(n){if(this._getDashboard)throw new Error("GetDashboard can only be set once by DashboardManager");this._getDashboard=n},f.prototype.removeGetDashboard=function(){this._getDashboard=null},f.prototype.getDashboard=function(){var n=this._getDashboard;return n?n():null},f.prototype.onDetailContainersChanged=function(){},f.prototype.getDeepLink=function(){return Q("")},f.fromJSON=function(n,t,i){return h.createCompositionFromJSON(i,function(){return f._fromJSON(n,t,i)},function(t,i){var r=new f(n);return r.unrecoverableErrorMessage=i,r})},f.prototype.toJSON=function(){var t=n.
prototype.toJSON.call(this),i=this._getDashboard?this._getDashboard():null,r;return i&&(t.dashboardId=i.id,t.dashboardTitle=i.title,r=i.model,t.dashboardModel=r?{model:ko.toJS(r.model),metadata:it.clone(r.metadata,!0)}:undefined),delete t.children,t},Object.defineProperty(f.prototype,"eligibleForBinding",{get:function(){return!1},enumerable:!0,configurable:!0}),f.prototype.getInputPropertyBindings=function(){throw new Error("Unreachable code");},f.prototype.getViewModel=function(n){var i,t;if(n=it.isNullOrUndefined(n)?d.Dashboard:n,n===d.Dashboard){if(t=this._getDashboard&&this._getDashboard().model,!t)throw new Error("There is no current Dashboard.");i=t.model}return i||{}},f.prototype.getViewModelAsync=function(n){return $.Deferred().resolve(this.getViewModel(n)).promise()},f.prototype.getCompatibleSourceReferences=function(n){var r=this._getDashboard&&this._getDashboard().model,t=r&&r.metadata,i,u;return t&&(i=n.type,i)?(u=Object.keys(t).filter(function(n){var r=t[n];return r===i}),
u.map(function(n){return{property:n,modelType:d.Dashboard,scope:ct.CurrentContainer,cardinality:v.ReferenceCardinality.OneToOne}})):null},f.prototype.logChildren=function(){this.children.forEach(function(n){var t=n&&n.widgetState(),i=t&&t.NormalState?ot[t.NormalState.size]:"";ft.trace({extension:n.locator.getExtensionLocator().name,source:o.Source.StartBoardPart,action:o.Action.StartBoardPartLoaded,name:n.locator.toFriendlyString(),data:i})})},f._fromJSON=function(n,t,i){var u=Object.keys(t).map(function(i){return ut(i)?y.Instance.fromJSON(n,t[i]):null}).filter(function(n){return!!n}),r=new f(n,u,i.widgetState);return r.logChildren(),r.loadFromJson(i),r},f.prototype._compose=function(n,r){var o=this,u=new w.ViewModel(this.id,this.widgetState()),f=this.services,e,c;ko.utils.arrayPushAll(u.commands,this._getShellCommands());var a=u.addPartsCommand=i.find(u.commands,function(n){return n.commandName===p.CommandNames.AddParts}),v=u.newCommand=new p.NewDashboard(f),y=u.cloneCommand=new p.CloneDashboard(
f),k=u.filterCommand=new p.FilterDashboard(f,this),d=u.fullscreenCommand=new p.FullscreenDashboard(f),g=u.deleteCommand=new p.DeleteDashboard(f),nt=u.shareCommand=new p.ShareDashboard(f),it=u.browseCommand=new p.OpenBrowseDashboardsPane(f),l=this._getDashboard?this._getDashboard().title:null;l&&u.title(l);this.widget=new w.Widget(n.getStartBoardArea(),u);e=this.widget.element;c=function(n,t){n.bind(new s.CompositionInstanceCommandContext(e.findByClassName(t)[0],null,o))};c(a,w.widgetClass+"-title");[[v,"new"],[y,"clone"],[k,"filter"],[d,"fullscreen"],[g,"delete"],[nt,"share"],[it,"browse"],].forEach(function(n){var t=n[0],i=n[1];c(t,w.headerButtonClass+"-"+i)});e.data(h.CompositionInstanceDataName,this);e.on(b.Widget.viewSettingsChanged,this._viewSettingsUpdateHandler=function(n,i){n.stopPropagation();o.widgetState(i);e.trigger(t.fxstartboardsettingchanged)});e.on(tt.fxunpin,this._tileUnpinHandler=function(n,t){var i=o.children.first(function(n){return n.id===t.tileId});i&&(rt.warning(
"Part '{0}' is about to be removed due to user unpin operation.".format(i)),o.services.desktop.removeTile(i.id));setTimeout(function(){var n=o.widget;n&&n.setFocus()},50)});r.resolve()},f.prototype.matchesLocatorAndModel=function(){return!1},f.prototype.resetLayout=function(){this.services.desktop.resetStartBoard()},f.prototype.dispose=function(){var t=this.widget.element;this._viewSettingsUpdateHandler&&t.off(b.Widget.viewSettingsChanged,this._viewSettingsUpdateHandler);this._tileUnpinHandler&&t.off(tt.fxunpin,this._tileUnpinHandler);this._viewSettingsUpdateHandler=null;this._tileUnpinHandler=null;rt.warning("UI.Composition.Startboard.dispose() has been called.");n.prototype.dispose.call(this,!0)},Object.defineProperty(f.prototype,"journeyPath",{get:function(){return[]},enumerable:!0,configurable:!0}),f.prototype.getComposedParts=function(){return this._partAwaiter.resolvedCompositions},f.prototype.awaitComposedPart=function(n,t){return this._partAwaiter.await(n,t)},f.prototype.notifyPartComposed=
function(n){this._partAwaiter.resolve(n)},f.prototype.awaitContainer=function(n,t){return this._containerAwaiter.await(n,t)},f.prototype.notifyContainer=function(n){this._containerAwaiter.resolve(n)},f.prototype.onInvocationStarted=function(){},f.prototype.getDiagnosticsData=function(){return $.extend(n.prototype.getDiagnosticsData.call(this),{detailBlades:this.detailContainers.map(function(n){return n.toString()})})},f.prototype._getShellCommands=function(){var n=[],t=new p.AddParts(this.services);return t.text(r.Dashboard.edit),t.icon(e.Content.SvgLibrary.Shell.customize),n.push(new p.ResetStartBoardCommand(this.services)),n.push(t),n.push(new p.ExitOrganizeMode(this.services)),n},f}(c.Instance);t.Instance=g;t.create=lt}(k||(k={})),k});define("MsPortalImpl/UI/Dashboard/DashboardRepository",["require","exports"],function(){"use strict";var n;return function(n){n.ArmDashboardRepository="ArmDashboardRepository";n.PrivateDashboardRepository="PrivateDashboardRepository";n.RecommendedDashboardRepository=
"RecommendedDashboardRepository";n.SessionDashboardRepository="SessionDashboardRepository"}(n||(n={})),n});define("MsPortalImpl/UI/Dashboard/ArmDashboardRepository",["require","exports","f","./DashboardRepository","MsPortalImpl/Resources/ImplScriptResources"],function(n,t,i,r,u){"use strict";var f;return function(t){function h(n){try{return k.parseResourceDescriptor(n)}catch(t){return c.error(t,0,"Failed to parse ARM dashboard id '"+n+"'."),null}}function f(n){var t=n.substr(s.length);return i.ensurePrefix(t,"/")}function v(n){return n.startsWith("/")&&(n=n.substr(1)),""+s+n}function y(n){return i.startsWith(n,s)}function g(n,t){return t.length?n.filter(function(n){if(!y(n.id))return!0;var r=f(n.id),i=h(r);return i?t.indexOf(i.subscription)>-1:!1}):n}var o=i.Base,w=o.Diagnostics,b=o.Utilities,e=o.Constants.DefaultCloudName,k=i.ViewModels.Services.ResourceTypes,d="Dashboard$DashboardViewModel",c=w.createLog(n),s="arm/",l="hidden-title",a=u.Dashboard.NotFound,p;t.getArmDashboardId=f;t.buildDashboardId=
v;t.filterDashboards=g;p=function(){function n(n,t,i,r){var u=this;this._lifetime=n;this._extensionManager=t;this._permissionsManager=i;this._compressor=r;this._isDisposed=!1;this._isConnected=!1;this._lifetime.registerForDispose(function(){u._dispose()})}return n.prototype.getTypeName=function(){return r.ArmDashboardRepository},n.prototype.createDashboard=function(n){var t=this;return this._connect().then(function(){var r=t._compressor.compress({id:"",title:"",settings:n.settings}),u={name:i.getUniqueId(),model:r.model,parts:r.parts,subscriptionId:n.extras.subscriptionId,resourceGroupName:n.extras.resourceGroupName,tags:t._createTagsWithTitle(n.title)};return t._provider.createDashboard(u,e)}).then(function(n){return t._convertToDashboard(n)})},n.prototype.readDashboard=function(n){var t=this;return this._connect().then(function(){var i=f(n);return t._provider.readDashboard(i,e)}).then(function(n){return t._convertToDashboard(n)})},n.prototype.updateDashboard=function(n,t){var i=this,
r=f(n);return this._connect().then(function(){return t.title?i._provider.readDashboard(r,e).then(function(n){return n.tags}):Q()}).then(function(n){var u=i._compressor.compress({id:"",title:"",settings:t.settings}),f={model:u.model,parts:u.parts,tags:!t.title?undefined:i._createTagsWithTitle(t.title,n)};return i._provider.updateDashboard(r,f,e)}).then(function(n){return i._convertToDashboard(n)})},n.prototype.deleteDashboard=function(n){var t=this;return this._connect().then(function(){var i=f(n);return t._provider.deleteDashboard(i,e)})},n.prototype.readDashboards=function(){var n=this;return this._connect().then(function(){return n._provider.readDashboards(e)}).then(function(t){return t.map(function(t){return n._convertToDashboard(t)})})},n.prototype.isDashboardWritable=function(n){return this._permissionsManager.hasPermission(f(n),["Microsoft.Portal/dashboards/write"],e)},n.prototype.identifyDashboard=function(n){return y(n)},n.prototype.getDashboardProperties=function(n){var t=n.id,
u=n.title,i=f(t),r=h(i)||{subscription:"",resourceGroup:""};return{id:t,title:u,originalId:i,subscription:r.subscription,resourceGroup:r.resourceGroup}},n.prototype.getNotFoundMessage=function(n){var r=n.id,i=n.title,u=f(r),t=h(u);return t?a.armMessageFormat.format(i,t.resourceGroup,t.subscription):a.defaultMessageFormat.format(i)},n.prototype._dispose=function(){this._isDisposed||(this._isDisposed=!0,this._isConnected=!1,b.disposeViewModelProperties(this._viewModel),this._extension&&this._viewModel&&this._extension.releaseViewModel(this._viewModel),this._extension=null,this._viewModel=null)},n.prototype._connect=function(){var n=this;return this._isConnected?Q(!0):this._extensionManager.getHubsExtension().then(function(t){return n._extension=t,Q(t.getViewModel(d))}).then(function(t){return n._viewModel=t,n._provider=t.content,n._isConnected=!0,n._isConnected}).catch(function(t){return c.error(t,0,"Failed to connect ARM dashboard repository to its data provider from hubs extension."),n.
_isConnected})},n.prototype._convertToDashboard=function(n){var f=v(n.id),e=n.tags&&n.tags[l]||n.name,t=n.properties,r=t&&t.metadata,o=r&&r.model||{},i=t&&t.lenses,u=i&&i["0"]&&i["0"].parts||{};return this._compressor.uncompress(f,{title:e,model:o,parts:Object.keys(u).map(function(n){return u[n]})})},n.prototype._createTagsWithTitle=function(n,t){var i={};return i[l]=n,$.extend({},t||{},i)},n}();t.ArmDashboardRepository=p}(f||(f={})),f});define("MsPortalImpl/UI/Dashboard/DashboardCompressor",["require","exports","f","../../Extension/Extension.Definition.Locator","../Compositions/UI.Composition","../Compositions/UI.Composition.Base","../Compositions/UI.Composition.PropertyBinding","../Compositions/UI.Composition.Part","./../Compositions/UI.Composition.StartBoard","../Compositions/UI.Composition.PartSettingsManager","../../Services/Services.Settings.Schema"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return function(t){function st(n,t){var w=t[y],b=w.widgetState,k=b.NormalState.layoutSettings.
positions,f=k.first(function(t){return t.id===n}),a,e;if(!f)return tt.warning("Cannot compress part '"+n+"', because it does not have position in startboard."),null;var i=t[n],d=i.adapterBindings||i.bindings,s=ko.toJS(it(i.containerModel)),g=ko.toJS(it(i.overridesModel)),c=(d||[]).map(function(n){var t=n.source,u=t&&t.property,f=n.targetProperty,e=t&&t.modelType,r,i,h,c;if(o.isDynamicBindingWithNonLocalSource(n))if(e===l.Dashboard)r={name:f,binding:u};else return tt.error("For binding for property '{0}', encountered unsupported reference type '{1}'.".format(f,l[e])),null;else i=void 0,h=p.getModelValue(g,u),h.exists?i=nt(h.value):e===l.Constant?i=t.constantValue:(c=p.getModelValue(s,u),c.exists&&(i=nt(c.value))),r={name:f,value:i};return!n.optional||(r.isOptional=!0),r});if(c.firstIndex(function(n){return!n})>=0)return null;a=s[u.PartContainerModelIdProperty];e={};e[u.PartContainerModelIdProperty]=a;var rt=r.Locator.fromJSON(i.locator),ut=h.buildIdentitySettingKey(rt,e),ft=t[ut]||undefined,
et=ct(i.locator),ot=at(i.partState),st=yt(i.assetInstanceDefinition);return{position:{x:f.position.col,y:f.position.row,colSpan:v(f.colSpan),rowSpan:v(f.rowSpan)},metadata:{inputs:c,type:et,settings:ft,isAdapter:i.adapterBindings?!0:undefined,viewState:ot,asset:st,defaultMenuItemId:i.defaultMenuItemId}}}function ht(n,t,i,e){var o=n.metadata,y=lt(o.type),g=vt(o.viewState),nt=pt(o.asset),p=ut.getDefaultSize().name,tt={NormalState:{size:p}},s={},b;s[u.PartContainerModelIdProperty]=et(t);var w=r.Locator.fromJSON(y),it=f.createIdentifier(ft.StartboardPart,w,i),c={locator:y,partState:g,assetInstanceDefinition:nt,initialSize:p,widgetState:tt,id:it,bindingsInitialized:!0,dontSetupWidget:!1,defaultMenuItemId:o.defaultMenuItemId,childSettings:{},children:[],containerModel:a.toSerializableObject(s),overridesModel:undefined,editScopeId:undefined,bindings:undefined,adapterBindings:undefined,errorMessage:undefined,originalPartLocator:undefined},v=[];return o.inputs.forEach(function(n){var r=n.name,t,
i=n.binding,u;i?t={property:i,modelType:l.Dashboard,cardinality:k.OneToOne,scope:d.CurrentContainer}:(u=n.value,t={property:r,constantValue:u,modelType:l.Constant,cardinality:k.OneToOne,scope:d.CurrentContainer});v.push({source:t,targetProperty:r,optional:!!n.isOptional,isDynamicBinding:i?!0:undefined})}),o.isAdapter?c.adapterBindings=v:c.bindings=v,o.settings&&(b=h.buildIdentitySettingKey(w,s),e(b,o.settings)),c}function ct(n){var u=encodeURIComponent,e=[],t=n,i,f,o;do i=u(r.LocatorType[t.type]),f=t.cloudName?u(t.cloudName):undefined,f&&(i=i+"["+f+"]"),o=[i,u(t.name)],e.unshift(o.join("/")),t=t.parent;while(t);return e.join("/")}function lt(n){var i=decodeURIComponent,f=[],u=[],t;return n.split("/").forEach(function(n,t){u.push(n);t%2==1&&(f.push(u),u=[])}),f.forEach(function(n){var s=i(n.pop()),u=n.pop(),e,o=u.match(/\[(.*?)\]/),f;o&&(u=u.substring(0,u.lastIndexOf(o[0])),e=i(o[1]));u=i(u);f={name:s,type:r.LocatorType[u]};e&&(f.cloudName=e);t&&(f.parent=t);t=f}),t}function at(n){n=a.isSerializedObject(
n)?a.fromSerializableObject(n):n;var r=Object.keys(n).filter(function(n){return n!=="container"&&n!=="internal"}),t={};return i.shallowCopyFromObject(t,n,r),g(t)?undefined:t}function vt(n){return a.toSerializableObject(n||{})}function yt(n){return g(n)?undefined:{idInputName:n.assetIdInputProperty,type:n.assetType}}function pt(n){return n?{assetIdInputProperty:n.idInputName,assetType:n.type}:{}}function wt(n){if(!n)return undefined;var t=n.model,r=n.metadata,i={};return Object.keys(t).forEach(function(n){i[n]={value:t[n],type:r[n]}}),i}function bt(n){if(!n)return undefined;var t={},i={};return Object.keys(n).forEach(function(r){var u=n[r];t[r]=u.value;i[r]=u.type}),{model:t,metadata:i}}var w=i.Base,b=w.Utilities,a=b.Internal.Serialization,rt=w.Diagnostics,p=e.PropertyBinding,k=e.ReferenceCardinality,d=e.ReferenceScope,l=i.Extension.ReferenceType,ut=i.Parts.PartSizeHelper,ft=u.CompositionType,g=i.isEmpty,nt=ko.unwrap,tt=rt.createLog(n),et=ko.observable,kt=h.partIdentityStatePrefix,v=function(
n){return Math.min(Math.max(n,1),25)},it=o.createContainerModel,dt=p.getModelValue,y=c.startBoardSettingsKey,ot=function(){function n(){}return n.prototype.compress=function(n){var t=n.settings,i=n.title,r=t[y],u=wt(r.dashboardModel),f=Object.keys(t).filter(function(n){return s.isStartboardPartKey(n)}).map(function(n){return st(n,t)}).filter(function(n){return!!n});return{title:i,model:u,parts:f}},n.prototype.uncompress=function(n,t,i,r){var u={},f=[];t.parts.forEach(function(n,t){var h=i?i(t):b.getUniqueId(),c=r?r(t):undefined,o=ht(n,h,c,function(n,t){u[n]=t}),e,s;u[o.id]=o;e=n.position;s={id:o.id,colSpan:v(e.colSpan),rowSpan:v(e.rowSpan),position:{col:e.x,row:e.y}};f.push(s)});var e={NormalState:{layoutSettings:{positions:f,maxPositions:f}}},o=bt(t.model),s={id:y,childSettings:{},locator:null,errorMessage:undefined,widgetState:e,dashboardId:n,dashboardTitle:t.title,dashboardModel:o};return u[y]=s,{id:n,title:t.title,settings:u}},n}();t.DashboardCompressor=ot}(l||(l={})),l});define("MsPortalImpl/UI/Dashboard/PrivateDashboardRepository",
["require","exports","f","./DashboardRepository","MsPortalImpl/Resources/ImplScriptResources","../../Services/Services.Settings","../../Services/Services.Settings.Schema"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function a(n){var e=f.dashboardStoreQuota,i=Object.keys(n);if(i.length>=e)throw new Error("There are no more dashboard stores available.");for(var r=function(n){return f.createDashboardStoreName(n)},o=i.map(function(t){return n[t].storeName}),u=0,t=r(u);o.indexOf(t)>-1;)t=r(++u);return t}function p(n){for(var u=Object.keys(n).map(function(t){return n[t].title.toLowerCase()}),f=function(n){return u.indexOf(n.toLowerCase())>=0},i=function(n){return n<=1?l:l+" ("+n+")"},r=1,t=i(r);f(t);)t=i(++r);return t}function w(n,t,i,r){var u=r.settings[e.startBoardSettingsKey];u.dashboardId=i;n.setSetting(s[t],i,r);n.setSetting(o,i,{storeName:t,id:r.id,title:r.title});n.flushSettings()}function b(){var n=i.getUniqueId();return""+v+n}function k(n,t){return n[t]&&n[t].storeName}
function d(n){return i.startsWith(n,f.dashboardStoreNamePrefix)}function g(n){return n.queryStore(o).then(function(n){return n||{}})}var tt=i.Base,it=tt.Diagnostics,s=f.SettingStore,h=u.Dashboard,rt=it.createLog(n),v="private/",c="recentDashboards",y=10,o=s.DashboardInventory,l=h.defaultTitle,ut=i.forEachKey,nt;t.buildNextStoreName=a;t.createDashboardTitle=p;nt=function(){function n(n){this._settingsManager=n}return n.prototype.getTypeName=function(){return r.PrivateDashboardRepository},n.prototype.createDashboard=function(n){var r=this,t=n.extras&&n.extras.id||b(),i={id:t,title:n.title,settings:n.settings};return this._getDashboards().then(function(n){return w(r._settingsManager,a(n),t,i),i})},n.prototype.readDashboard=function(n){var t=this;return this._getDashboards().then(function(i){var r=k(i,n);if(r)return t._settingsManager.querySetting(s[r],n)})},n.prototype.updateDashboard=function(n,t){var r=this;return this.readDashboard(n).then(function(u){if(u){var f={};return i.shallowCopyFromObject(
f,u),i.shallowCopyFromObject(f,t),r._getDashboards().then(function(t){var i=k(t,n)||a(t);return w(r._settingsManager,i,n,f),f})}return r.createDashboard({title:t.title,settings:t.settings,extras:{id:n}})})},n.prototype.deleteDashboard=function(n){var t=this._settingsManager;return g(t).then(function(i){var u=i[n],r,f,e;r=u?u.storeName:Object.keys(i).filter(d).first(function(t){return(i[t]||{}).id===n});r&&t.deleteSettings({store:s[r],keys:[n]});f=r&&i[r]&&i[r].id===n;e=f?[r,n]:[n];t.deleteSettings({store:o,keys:e});t.flushSettings()})},n.prototype.readDashboards=function(){return this._getDashboards().then(function(n){return Object.keys(n).map(function(t){return n[t]})})},n.prototype.identifyDashboard=function(n){return i.startsWith(n,v)},n.prototype.isDashboardWritable=function(){return Q(!0)},n.prototype.getNotFoundMessage=function(n){return h.NotFound.privateMessageFormat.format(n.title)},n.prototype.canCreateNewDashboard=function(){return this._getDashboards().then(function(n){return Object.
keys(n).length<f.dashboardStoreQuota})},n.prototype.cloneDashboard=function(n,t){return this.createDashboard({settings:n,title:h.cloneTitleFormat.format(t)})},n.prototype.getRecentDashboards=function(){return this._settingsManager.querySetting(o,c).then(function(n){var t=(n||[]).slice(0,y).filter(function(n){return!!n.id});return i.unique(t,function(n,t){return n.id.toLowerCase()===t.id.toLowerCase()})})},n.prototype.addToRecent=function(n){var t=this;return this.getRecentDashboards().then(function(r){var u=i.findIndex(r,function(t){return t.id.toLowerCase()===n.id.toLowerCase()});return u===0?r:(u>0&&r.splice(u,1),r.unshift({id:n.id,title:n.title}),r=r.slice(0,y),t._settingsManager.setSetting(o,c,r),r)})},n.prototype.removeFromRecent=function(n){var t=this;return this.getRecentDashboards().then(function(r){var u=i.findIndex(r,function(t){return t.id.toLowerCase()===n.toLowerCase()});return u>=0&&(r.splice(u,1),t._settingsManager.setSetting(o,c,r)),r})},n.prototype.createDefaultDashboard=
function(n){var t;return t=n?Q(n):this._getDashboards().then(function(n){return p(n)}).catch(function(n){return rt.error(n,0,"Failed to generate a dashboard title with index."),l}),t.then(function(n){var t=b();return{id:t,title:n}})},n.prototype._getDashboards=function(){var n=this;return g(this._settingsManager).then(function(t){var i={};return ut(t,function(t,r){if(r){var u;n.identifyDashboard(t)?(u=r,i[u.id]=u):d(t)&&(u=r,i[u.id]||(i[u.id]=u))}}),i})},n}();t.PrivateDashboardRepository=nt}(o||(o={})),o});define("MsPortalImpl/UI/Dashboard/DashboardClient",["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){function e(n){return new t(new r(n))}var u=i.Base,f=u.Utilities,r=function(){function n(n){this._extensionManager=n}return n.prototype.connect=function(n,t,i,r){var u,e;return this._extensionManager.getExtensionByName(n,t).then(function(n){return u=n,Q(u.getViewModel(i(u)))}).then(function(n){return e=n,Q(r(n.content))}).finally(function(){f.disposeViewModelProperties(
e);u&&e&&u.releaseViewModel(e)})},n}(),t;n.ViewModelConnectorImpl=r;n.create=e;t=function(){function n(n){this._connector=n}return n.prototype.getDashboard=function(n,t,i){return this._connector.connect(t,i,function(n){return n.definition.dashboardProvider.viewModel},function(t){return t.getDashboard(n)})},n}();n.DashboardClientImpl=t}(r||(r={})),r});define("MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository",["require","exports","f","i","./DashboardRepository"],function(n,t,i,r,u){"use strict";var f;return function(n){function e(n){var i=n.substr(f.length),u=t.getCloudNameFromId(i),r;return i=t.removeCloudNameFromId(i),r=i.split("/"),{cloudName:u,dashboardParam:r.slice(1).join("/"),extensionName:r[0]}}var t=r.Extension,f="recommended/",o;n.parseDashboardId=e;o=function(){function n(n,t){this._dashboardClient=n;this._compressor=t}return n.prototype.createDashboard=function(){return Q.reject(new Error("Cannot create a recommended dashboard"))},n.prototype.readDashboard=function(n)
{var i=this,t=e(n);return this._dashboardClient.getDashboard(t.dashboardParam,t.extensionName,t.cloudName).then(function(t){return i._compressor.uncompress(n,t)})},n.prototype.updateDashboard=function(){return Q.reject(new Error("Cannot update a recommended dashboard"))},n.prototype.deleteDashboard=function(){return Q()},n.prototype.readDashboards=function(){return Q([])},n.prototype.getTypeName=function(){return u.RecommendedDashboardRepository},n.prototype.identifyDashboard=function(n){return i.startsWith(n,f)},n.prototype.isDashboardWritable=function(){return Q(!1)},n}();n.RecommendedDashboardRepository=o}(f||(f={})),f});define("_generated/Templates/WidgetsBreadCrumb",["require","exports","f"],function(){"use strict";return function(){return'<div class="fxs-breadcrumb-wrapper"> <div class="fxs-breadcrumb-dropmenu"><\/div> <!-- ko foreach: data.breadCrumbsVisible --> <a href="" class="fxs-breadcrumb-crumb fxs-has-hover" data-bind="attr: { \'data-blade-id\': $data.bladeId }, text: $data.bladeTitle"><\/a> <div class="fxs-breadcrumb-divider fxs-fill-secondary" data-bind="image: MsPortalFx.Base.Images.CaretUp()"><\/div> <!-- /ko --> <\/div>'}
});define("_generated/Templates/WidgetsBreadCrumbOverFlow",["require","exports"],function(){"use strict";return function(){return'<ul class="fxs-breadcrumb-overflow"> <!-- ko foreach: breadCrumbsOverFlow --> <li> <a href="" class="fxs-breadcrumb-crumb" data-bind="attr: { \'data-blade-id\': $data.bladeId }, text: $data.bladeTitle"><\/a> <\/li> <!-- /ko --> <\/ul>'}});define("MsPortalImpl/Widgets/Widgets.BreadCrumb",["require","exports","f","../Base/Telemetry","./Widgets.WidgetBase","../../_generated/Templates/WidgetsBreadCrumb","../../_generated/Templates/WidgetsBreadCrumbOverFlow","./Widgets.DropMenu","../../_generated/Less/MsPortalImpl/Widgets/Widgets.BreadCrumb.css"],function(n,t,i,r,u,f,e,o){"use strict";var s;return function(n){var l=i.Base,y=l.Diagnostics.Telemetry,t=l.EventTypes,a=window,s=jQuery,p=r.Source.Desktop,w=r.Action,b=y.trace,h="fxs-breadcrumb",k=h+"-wrapper",d=h+"-divider",g=h+"-dropmenu",nt="&#171",c=ko.observableArray,tt=function(n){function t(){n.apply(this,arguments);
this.breadCrumbs=c([]);this.breadCrumbsVisible=c([]);this.breadCrumbsOverFlow=c([])}return __extends(t,n),t}(u.ViewModel),v;n.ViewModel=tt;v=function(n){function i(t,i){var c=this,u,s,h,r;n.call(this,t,i);u=this.element;s=this.options;u.html(f());this._attachEventHandlers();this._bindDescendants();h=this.lifetimeManager;r=this._dropMenuElement=u.findByClassName(g);this._dropMenuViewModel=new o.ViewModel(nt,e(),!0);this._dropMenuViewModel.alignMenu=0;this._dropMenuWidget=new o.Widget(r,this._dropMenuViewModel);this._visibleBreadCrumbs=u.findByClassName(k);ko.applyBindings({breadCrumbsOverFlow:s.breadCrumbsOverFlow},r[0]);s.breadCrumbs.subscribe(h,function(){c._distributeBreadCrumbs()});ko.reactor(h,function(){var n=s.breadCrumbsOverFlow();n.length?r.show():r.hide()})}return __extends(i,n),i.prototype.dispose=function(){n.prototype.dispose.call(this);this._dropMenuWidget.dispose()},i.prototype._attachEventHandlers=function(){var u=this,n=this.element,i,r;n.on(t.click,"a",i=function(i){var
r=s(i.target),u=r.data("blade-id");i.preventDefault();b({source:p,action:w.BreadCrumbClicked});n.trigger(t.fxbreadcrumbclick,{bladeId:u})});s(a).on(t.resize,r=function(){u._resizeBreadCrumb()});this.lifetimeManager.registerForDispose(function(){n.off(t.click,"a",i);s(a).off(t.resize,r)})},i.prototype._distributeBreadCrumbs=function(){var n=this.options;n.breadCrumbsVisible([]);n.breadCrumbsOverFlow([]);n.breadCrumbs().forEach(function(t){n.breadCrumbsVisible.push(t)});this._moveToOverFlow()},i.prototype._resizeBreadCrumb=function(){this._visibleBreadCrumbs.width()>=this.element.width()?this._moveToOverFlow():this._moveToVisible()},i.prototype._moveToOverFlow=function(){var n;this.options.breadCrumbsVisible().length&&this._visibleBreadCrumbs.width()>=this.element.width()&&(n=this.options.breadCrumbsVisible.shift(),this.options.breadCrumbsOverFlow.unshift(n),this._moveToOverFlow())},i.prototype._moveToVisible=function(){var t,n=this.options,i=this.element;if(n.breadCrumbsOverFlow().length)
{var r=this._visibleBreadCrumbs.width(),u=i.findByClassName(d).width(),f=this._dropMenuElement.find("li:first a").width();i.width()>r+u+f&&(t=n.breadCrumbsOverFlow.shift(),n.breadCrumbsVisible.unshift(t))}},i}(u.Widget);n.Widget=v}(s||(s={})),s});define("_generated/Templates/WidgetsJourneysMenu",["require","exports"],function(){"use strict";return function(){return'<div class="fx-dropmenu-dropdown"> <!-- ko ifnot: data.journeysList && data.journeysList() && data.journeysList().length --> <div tabindex="0" class="fxs-journeysmenu-journey-nodata"> <div class="fxs-journeysmenu-journey-nodata-content" data-bind="text: data.text.noJourneys"><\/div> <\/div> <!-- /ko --> <!-- ko if: data.journeysList && data.journeysList() && data.journeysList().length --> <div class="fxs-dropmenu-list-system"> <ul> <!-- ko foreach: data.journeysList --> <li class="fxs-journeysmenu-list fxs-has-hover"> <a href="" class="fxs-journeysmenu-journey-wrapper" data-bind="attr: { \'data-journey-id\': $data.journeyId }"> <div class="fxs-has-hover fxs-journeysmenu-journey"> <!-- ko foreach: $data.breadCrumbs --> <div class="fxs-journeysmenu-journey-content" data-bind="attr: { \'data-blade-id\': $data.bladeId, title: $data.bladeTitle }, text: $data.bladeTitle"><\/div> <div class="fxs-breadcrumb-divider fxs-fill-secondary" data-bind="image: $root.data.icons.caretUp"> <\/div> <!-- ko if: $parent.isOverflow() && $index() === 0 --> <div class="fxs-journey-breadcrumb-overflow fxs-text-title" data-bind="image: $root.data.icons.ellipsis"><\/div> <div class="fxs-breadcrumb-divider fxs-fill-secondary" data-bind="image: $root.data.icons.caretUp"><\/div> <!-- /ko --> <!-- /ko --> <\/div> <\/a> <button class="fxs-journeysMenu-discardButton fxs-has-hover" data-bind="attr: { \'data-journey-id\': $data.journeyId, title: $root.data.text.discardButton }, image: $root.data.icons.Shell.close"><\/button> <\/li> <!-- /ko --> <\/ul> <\/div> <!-- /ko --> <\/div>'}
});define("_generated/Templates/WidgetsJourneysMenuButton",["require","exports"],function(){"use strict";return function(){return'<div class="fxs-topbar-button fxs-has-hover fxs-topbar-journey-icon" data-bind="image: data.icons.caretDown"><\/div>'}});define("MsPortalImpl/Widgets/Widgets.JourneysMenu",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.KeyboardNavigation","../Generated/SvgDefinitions","../Base/Telemetry","./Widgets.WidgetBase","./Widgets.DropMenu","../../_generated/Templates/WidgetsJourneysMenu","../../_generated/Templates/WidgetsJourneysMenuButton"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return function(n){function nt(n){var i=t(n.target);return i.closest("[data-journey-id]").data(st)}var v=i.Base,it=v.Diagnostics.Telemetry,rt=v.EventTypes,y=window,t=jQuery,ut=e.Source.TopBar,ft=e.Action,et=it.trace,p="fxs-breadcrumb",lt=p+"-wrapper",w="fxs-dropmenu-content",a="fxs-journeysmenu",ot=a+"-content",b="."+a+"-journey-wrapper",
at="."+a+"-list",k=".fxs-journeysMenu-discardButton",st="journeyId",ht=ko.observable,d=ko.observableArray,g="resize",l=rt.click,ct=function(n){function t(){n.apply(this,arguments);this.journeysMetadata=d([]);this.text=r.JourneysMenu;this.icons=f.Content.SvgLibrary}return __extends(t,n),t}(o.ViewModel),tt;n.ViewModel=ct;tt=function(n){function i(t,i){var u=this,r,l;n.call(this,t,i);var f=this.element,e=this.lifetimeManager,o=this.options;this._breadCrumbsBar=f.parent().findByClassName(p);r=new s.ViewModel(c(),h());r.menuWidth=this._breadCrumbsBar.width();r.alignMenu=0;l=this._dropMenuWidget=new s.Widget(f,r);l.options.isMenuOpen.subscribe(e,function(n){n?u._openMenu():u._closeMenu()});ko.computed(e,function(){o.journeysList=o.journeysMetadata.map(function(n){var t=[];return n.journeyBlades().forEach(function(n){var i={bladeId:n.id,bladeTitle:n.title};t.push(i)}),{journeyId:n.id,breadCrumbs:d(t),isOverflow:ht(!1)}})});this._bindDescendants()}return __extends(i,n),i.prototype.getDropMenuWidget=
function(){return this._dropMenuWidget},i.prototype.dispose=function(){n.prototype.dispose.call(this);this._closeMenu();this._dropMenuWidget&&(this._dropMenuWidget.dispose(),this._dropMenuWidget=null);this._detachHandlers()},i.prototype._handleJourneyOverflow=function(n,i){n.breadCrumbs().length>1&&t(i).width()>=this._dropMenuWidget.element.findByClassName(w).width()-62&&(n.isOverflow(!0),n.breadCrumbs.splice(1,1),this._handleJourneyOverflow(n,i))},i.prototype._attachHandlers=function(){var n=this,i=this.element,r=this.options;if(!this._onClick)i.on(l,b,this._onClick=function(n){var t=nt(n);n.preventDefault();r.activateJourney(t)});if(!this._onDiscard)i.on(l,k,this._onDiscard=function(n){var t=nt(n);n.preventDefault();r.discardJourney(t)});if(!this._onResize)t(y).on(g,this._onResize=function(){n._journeysMenu.width(n._breadCrumbsBar.width())})},i.prototype._detachHandlers=function(){var n=this.element;this._onClick&&(n.off(l,b,this._onClick),this._onClick=null);this._onDiscard&&(n.off(
l,k,this._onDiscard),this._onDiscard=null);this._onResize&&(t(y).off(g,this._onResize),this._onResize=null)},i.prototype._openMenu=function(){var r=this,n=this.element,t,i;et({source:ut,action:ft.JourneyMenuOpen});this._dropMenuWidget.setFocus();t=this._journeysMenu=n.findByClassName(w);t.width(this._breadCrumbsBar.width());t.addClass(ot);this._attachHandlers();i=0;this.options.journeysList().forEach(function(t){var u=n.findByClassName("fxs-journeysmenu-journey")[i];r._handleJourneyOverflow(t,u);i++});this._keyboardNav=new u.KeyboardNavigation(n)},i.prototype._closeMenu=function(){this._keyboardNav&&(this._keyboardNav.dispose(),this._keyboardNav=null)},i}(o.Widget);n.Widget=tt}(l||(l={})),l});define("_generated/Templates/WidgetsTopBar",["require","exports"],function(){"use strict";return function(){return'<div class="fxs-topbar-exit-customize"> <div class="fxs-topbar-exit-customize-message" data-bind="text: data.text.exitCustomizeText"><\/div> <button type="button" class="fxs-topbar-exit-customize-button fxs-button fxs-button-primary" data-bind="text: data.text.exitCustomizeButton"><\/button> <\/div> <div class="fxs-topbar-content fxs-hide-in-customize" role="banner"> <div class="fxs-topbar-internal msportalfx-bg-warning" data-bind="visible:data.isInternalOnly, text: data.text.internalText"><\/div> <a href="#" class="fxs-topbar-home fxs-has-hover" role="button" data-bind="text: data.productName, attr: { title: data.dashboardTooltip }"><\/a> <div class="fxs-topbar-journeysmenu" role="button" data-bind="stopBindings: true, attr: { title: data.journeysTooltip }"><\/div> <div class="fxs-breadcrumb" data-bind="stopBindings: true"><\/div> <!-- ko if: data.inDevMode --> <a class="fxs-topbar-exitdevmode fxs-has-hover msportalfx-bg-warning" href="#" role="button" data-bind="text: data.text.exitDevModeLinkText, click: func._exitDevMode"><\/a> <!-- /ko --> <!-- ko if: data.canReportBug --> <a href="#" class="fxs-topbar-reportbug fxs-has-hover msportalfx-bg-warning" role="button" data-bind="text: data.text.reportBug, click: func._reportBug, attr: { title: data.text.reportBugTitle, \'aria-label\': data.text.reportBug }"><\/a> <!-- /ko --> <div class="fxs-topbar-search" data-bind="stopBindings: true, attr: { title: data.searchTooltip }"><\/div> <div class="fxs-topbar-notifications" data-bind="stopBindings: true"><\/div> <a href="#" class="fxs-topbar-settings fxs-topbar-button fxs-has-hover" role="button" data-bind="attr: { title: data.text.settings }, image: data.settingsIcon"><\/a> <!-- ko if: data.showFeedbackButton --> <a href="#" class="fxs-topbar-feedback fxs-topbar-button fxs-has-hover" role="button" data-bind="attr: { title: data.text.feedback }, image: data.feedbackIcon, click: func._feedbackButtonClick"><\/a> <!-- /ko --> <div class="fxs-topbar-helpmenu" role="button" data-bind="stopBindings: true, attr: { title: data.helpTooltip }"><\/div> <div class="fxs-topbar-avatarmenu" role="button" data-bind="stopBindings: true"><\/div> <\/div> <div class="fxs-topbar-dashboard"> <div class="fxs-topbar-dashboard-message" data-bind="text: data.dashboardMessage"><\/div> <button type="button" class="fxs-button fxs-topbar-dashboard-done-customize" data-bind="text: data.text.exitCustomizeButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-view" data-bind="text: data.text.viewDashboardButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-save" data-bind="text: data.dashboardSaveButtonText"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-discard" data-bind="text: data.text.discardDashboardButton"><\/button> <\/div>'}
});define("MsPortalImpl/Widgets/Widgets.TopBar",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../Generated/SvgDefinitions","../Base/Telemetry","./Widgets.BreadCrumb","./Widgets.WidgetBase","./Widgets.JourneysMenu","../../_generated/Templates/WidgetsTopBar","../../_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return function(n){var p=i.Base,ft=p.Diagnostics.Telemetry,l=p.EventTypes,et=p.Images,ot=p.Utilities,g=u.Content.SvgLibrary,nt=g.Shell,st=window,k=st.fx.environment,tt=jQuery,ht="fxs-breadcrumb",t="fxs-topbar",ct=t+"-exit-customize-button",lt=t+"-home",at=t+"-journeysmenu",vt=t+"-settings",ti=t+"-feedback",yt=t+"-devmode",a=t+"-dashboard",pt=a+"-visible",wt=a+"-changed",bt=a+"-save",kt=a+"-discard",dt=a+"-view",it=a+"-done-customize",gt=f.Source.TopBar,v=f.Action,ni=ft.trace,w=r.KeyboardShortcuts,d=w.tooltipFormat,b=r.TopBar,c=ko.observable,y,rt,ut;n.fxfinishdashboardedit="fxfinishdashboardedit",function(
n){n[n.Unknown=0]="Unknown";n[n.Save=1]="Save";n[n.SaveACopy=2]="SaveACopy";n[n.Discard=3]="Discard";n[n.Cancel=4]="Cancel"}(n.FinishDashboardEditAction||(n.FinishDashboardEditAction={}));y=n.FinishDashboardEditAction;rt=function(n){function t(){n.apply(this,arguments);this.journeysMenu=new s.ViewModel;this.productName=ot.htmlEncode(k.branding.productName);this.customizeIcon=nt.customize;this.isInternalOnly=c(k.features.internalonly!=="false");this.text=r.TopBar;this.dashboardTooltip=d.format(w.toggleHomeAndJourneyMode,"D");this.journeysTooltip=d.format(w.active,"A");this.searchTooltip=d.format(w.search,"/");this.helpTooltip=r.HelpMenu.supportLabel;this.canReportBug=c(!1);this.reportBug=tt.noop;this.showFeedbackButton=k.features.feedback==="true";this.inDevMode=c(!1);this.exitDevMode=tt.noop;this.exitDevModeIcon=et.Discard();this.settingsIcon=nt.settings;this.feedbackIcon=g.smileyHappy;this.dashboardMessage=c("");this.dashboardSaveButtonText=c("");this.dashboardChanged=c(!1);this.dashboardWritable=
c(!1);this.dashboardVisible=c(!1);this.isInOrganizeMode=c(!1)}return __extends(t,n),t}(o.ViewModel);n.ViewModel=rt;ut=function(i){function r(n,r){i.call(this,n,r);n.addClass(t).html(h());this._breadCrumbWidget=new e.Widget(n.findByClassName(ht),new e.ViewModel);this._journeysMenuWidget=new s.Widget(n.findByClassName(at),this.options.journeysMenu);this._feedbackButtonClick=function(){r.feedbackButtonClick()};var u=this.lifetimeManager;ko.reactor(u,function(){n.toggleClass(yt,!!r.inDevMode()).toggleClass("msportalfx-bg-warning",!!r.inDevMode())});ko.reactor(u,function(){var n=r.dashboardWritable(),i=n?b.saveDashboardButton:b.saveDashboardCopyButton,t;r.dashboardSaveButtonText(i);t=n?b.saveMessage:b.saveCopyMessage;r.dashboardMessage(t)});ko.reactor(u,function(){n.toggleClass(wt,!!r.dashboardChanged());n.toggleClass(pt,!!r.dashboardVisible());n.findByClassName(it).toggle(!!r.isInOrganizeMode());var t="fxs-button-primary",i="fxs-button-default",u=n.findByClassName(a).find(".fxs-button:visible");
u.removeClass(t).addClass(i);u.eq(0).removeClass(i).addClass(t)});this._bindDescendants();this._attachEventHandlers(n)}return __extends(r,i),r.prototype.dispose=function(){this._breadCrumbWidget&&(this._breadCrumbWidget.dispose(),this._breadCrumbWidget=null);this._journeysMenuWidget&&(this._journeysMenuWidget.dispose(),this._journeysMenuWidget=null);this._cleanElement(t);i.prototype.dispose.call(this)},r.prototype.getBreadCrumbWidget=function(){return this._breadCrumbWidget},r.prototype.getJourneysMenuWidget=function(){return this._journeysMenuWidget},r.prototype._reportBug=function(n,t){t.preventDefault();n.data.reportBug()},r.prototype._exitDevMode=function(n,t){t.preventDefault();n.data.exitDevMode()},r.prototype._attachEventHandlers=function(t){function i(n,i){var r=i&&{action:i}||undefined;t.trigger(n,r)}function r(n,i){t.on(l.click,n,i)}function u(n,t){ni({source:gt,action:n,data:t})}function f(n,t,r){return function(f){f.preventDefault();t&&u(t,r);i(n)}}var e=this.options;r("."+
ct+", ."+it,f(l.fxexitorganizemode,v.CustomizeModeExited,{dashboardChanged:!!e.dashboardChanged(),onDashboard:!!e.dashboardVisible()}));r("."+lt,f(l.fxhomebuttonclick,v.HomeButtonClicked));r("."+vt,f(l.fxsettingsbuttonclick));r("."+bt,function(){var t=e.dashboardWritable(),r=t?y.Save:y.SaveACopy,f=t?v.DashboardPublish:v.DashboardSaveACopy;u(f);i(n.fxfinishdashboardedit,r);r===y.Save&&i(l.fxexitorganizemode)});r("."+kt,function(){u(v.DashboardDiscard);i(n.fxfinishdashboardedit,y.Discard);i(l.fxexitorganizemode)});r("."+dt,function(){u(v.DashboardView);i(l.fxhomebuttonclick)})},r}(o.Widget);n.Widget=ut}(c||(c={})),c});define("MsPortalImpl/UI/Dashboard/DashboardManager",["require","exports","f","i","./../../Base/Base.Router","./ArmDashboardRepository","./DashboardCompressor","./DashboardRepository","../../Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","./PrivateDashboardRepository","../../Services/Services.SelectedSubscriptions","../../Services/Services.Settings",
"../../Services/Services.Settings.Schema","../../Base/Telemetry","../Compositions/UI.Composition","../Compositions/UI.Composition.Base","../Compositions/UI.Composition.CompositionBinder","../Compositions/UI.Composition.Part","../Compositions/UI.Composition.PartSettingsManager","../Compositions/UI.Composition.StartBoard","../Compositions/UI.Composition.StartboardPart","./DashboardClient","./RecommendedDashboardRepository","../UI.DesktopManager","../../Widgets/Widgets.Common","../../Widgets/Widgets.StartBoard","../../Widgets/Widgets.TopBar"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et){"use strict";var ot;return function(t){function bi(n){var i=n||{},r=i.model,u=i.metadata;return{model:$.extend({},t.defaultDashboardModelJson.model,r),metadata:$.extend({},t.defaultDashboardModelJson.metadata,u)}}function ot(n,t,i){return new ii(n,t||new Error,i)}function lr(n){var t=n.services,o=new gi(t.settings),s=new fi(n.services),i=new e.DashboardCompressor,r=new ei(o,n.services.
desktop.portalWidget.getTopBarWidget(),n.lifetime,s,i,n.services.storageService),h=new nr(n.lifetime,t.extensionManager,t.permissionsManager,i),u,f;return r.addRepository(h),u=tt.create(t.extensionManager),f=new it.RecommendedDashboardRepository(u,i),r.addRepository(f),r}function ki(n){return n.id.toLowerCase().replace(/\/\/+/g,"/")}function ct(n,t){return ki(n)===ki(t)}function ri(n){return Q(n)}function ui(n,t){return d.buildIdentitySettingKey(n,t)}function wt(n,t){return gt.startTrace({source:rr.Dashboard,action:n,actionModifier:ci.Start,data:t})}function vt(n,t,i){gt.endTrace(n,ci.Complete,$.extend({success:t},i))}function ar(n){var t={},u=n[at],e=u.widgetState,r=e.NormalState.layoutSettings,f=[];return Object.keys(n).filter(function(n){return g.isStartboardPartKey(n)}).forEach(function(u){var e=n[u],c=s.Locator.fromJSON(e.locator),v=vi(e.containerModel),b=ui(c,v),y=ko.toJS(v),l,o,a,p,h;y[ni]=i.getUniqueId();l=ti(y);e.containerModel=k.getSerializableContainerModel(l,!1);o=w.createIdentifier(
kt.StartboardPart,c);e.id=o;t[o]=e;a=n[b];a&&(p=ui(c,l),t[p]=a);h=(r.positions||[]).first(function(n){return n.id===u});h&&(h.id=o,f.push(h))}),r.positions=f,r.maxPositions=[],t[at]=u,JSON.parse(JSON.stringify(t))}function vr(n){var r=n&&n.relative,f=n&&n.absolute,t="",i,u;if(r){i=r.duration;u=r.timeUnit;switch(u){case dt.Week:i===1&&(t=yt.pastWeek);break;case dt.Hour:i===1?t=yt.pastHour:i===24&&(t=yt.past24Hours)}}else f&&(t=yt.custom);return t}function yr(n){var t=n&&n.model&&n.model.model;return t&&t.timeRange}function ht(n,t){er&&n&&u.updateDashboardUri(n.id,t)}function rt(n,t){n._startboard.widget.options.loading(t)}var bt=i.Base,oi=bt.Diagnostics,di=i.Hubs.Notifications.NotificationStatus,gi=c.PrivateDashboardRepository,nr=f.ArmDashboardRepository,tr=a.SettingStore,kt=p.CompositionType,si=i.Composition.Configuration,ir=b.CompositionBinder,dt=si.TimeUnit,gt=oi.Telemetry,rr=y.Source,hi=y.Action,ci=gt.ActionModifier,ur=window,li=ur.fx.environment,ai=li.features,fr=ai.addsessiondashboardrepository===
"true",er=ai.deeplinkdashboard==="true",lt=oi.createLog(n),at=v.startBoardSettingsKey,or=10,ni=p.PartContainerModelIdProperty,sr=d.partIdentityStatePrefix,st=h.Dashboard,yt=h.Filter.Option,hr=h.NavBar.home,pt=bt.Constants.DefaultCloudName,ti=ir.createObservableModel,vi=k.createContainerModel,yi="create",pi="clone",wi="unpublish",cr=ko.observable,ii,fi,ei;t.defaultDashboardModelJson={model:{timeRange:{relative:{duration:24,timeUnit:dt.Hour}}},metadata:{timeRange:si.TimeRangeValueType}};t.backfillDashboardModel=bi;ii=function(n){function t(t,i,r){n.call(this,{code:t,data:r||{},message:i.message,stack:i.stack,innerErrors:i})}return __extends(t,n),t.TypeName="MsPortalImpl.UI.DashBoardError",t}(i.Errors.Error);t.create=lr;t.isSameDashboard=ct;t.startTrace=wt;fi=function(){function n(n){this._desktopManager=n.desktop;this._settingsManager=n.settings;this._notificationManager=n.notificationManager}return n.prototype.collectDashboardSettings=function(n){var i=this,t={},r=n.toJSON(),u=n.children.
filter(function(n){return!n.dontSetupWidget&&!n.isDisposed()}).map(function(n){return i.getPartSettings(n)});return Q.allSettled(u).then(function(n){return n.forEach(function(n){$.extend(t,n.value)}),t[at]=r,JSON.parse(JSON.stringify(t))})},n.prototype.getPartSettings=function(n){var t=this;return Q(n.awaitComposed()).then(function(){var f;if(n.isDisposed())return{};var e={},r=n.toJSON(),u=n.containerModel;return u[ni]||(f=ko.toJS(vi(r.containerModel)),f[ni]=i.getUniqueId(),u=ti(f),r.containerModel=k.getSerializableContainerModel(u,!1)),e[r.id]=r,t.getPartIdentitySettings(n,u).then(function(n){return $.extend(e,n)})}).catch(function(t){return lt.error(t,8,"part: '"+n.id+"'."),{}})},n.prototype.getPartIdentitySettings=function(n,t){var r=n.partDefinition,i;return!r||!r.partState?Q({}):(i=ui(n.locator,t),n.getPartSettingsManager().getStartboardPartIdentitySettings().then(function(n){if(!n)return{};var t={};return t[i]=n,t}).catch(function(t){return lt.error(t,9,"Failed to get part '"+n.id+
"' identify settings for key '"+i+"'."),{}}))},n.prototype.clearStartboard=function(n){var t=this._desktopManager;n.children.filter(function(n){return!n.dontSetupWidget}).forEach(function(n){return t.removeTile(n.id,!0)})},n.prototype.renderStartboard=function(n,t,r,u){var o=this._settingsManager,f=Object.keys(t),s=function(n,t){var r={};return i.shallowCopyFromObject(r,n,t),r},h=f.filter(function(n){return i.startsWith(n,sr)}),e;o.setSettings({store:tr.Part,settings:s(t,h)});e=t[at];n.widget.options.applyViewSettings(e.widgetState);f.filter(function(n){return g.isStartboardPartKey(n)}).forEach(function(i){var o=t[i],f=nt.Instance.fromJSON(n.services,o),e=f.locator.getExtensionLocator(),s=n.services.extensionManager.getExtension(e.name,e.cloudName);(s||!u)&&(n.addChild(f),r||(f.compose(n.widget),f.save()))});r||n.save()},n.prototype.readDashboardsOfMaxCount=function(n,t,i,r){n=n.slice();i=i.slice();var u=[],e=i.map(function(n){return n.id.toLowerCase()}),f=function(){var i=n.shift();return i.
readDashboards().then(function(n){return r(n,i.getTypeName()),n.filter(function(n){return e.indexOf(n.id.toLowerCase())<0}).slice(0,t-u.length)}).catch(function(n){var t=i.getTypeName();return lt.error(n,10,"Failed to read dashboards from '"+t+"' repository."),[]}).then(function(i){return u.push.apply(u,i),u.length>=t||!n.length?Q():f()})};return f().then(function(){return u})},n.prototype.enterOrganizeMode=function(n){var t=this._desktopManager;t.mode(1);n&&t.portalWidget.options.sideBar.isCollapsed(!n)},n.prototype.isStartboardReady=function(){return this._desktopManager.startBoardPartsLoaded()},n.prototype.getStartboardReadyPromise=function(){return this._desktopManager.getStartboardPartsLoadedPromise()},n.prototype.popNotification=function(n,t,i){i===void 0&&(i=di.Error);this._notificationManager.addClientNotification({title:n,description:t,cloudName:pt,status:i,timestamp:new Date})},n}();t.DashboardHelperImpl=fi;ei=function(){function n(n,t,i,r,u,f){this.currentDashboardId=cr("");
this._privateRepo=n;this._topbarWidget=t;this._lifetime=i;this._helper=r;this._compressor=u;this._storage=f;this._otherRepos=[];this._isStartboardChanging=!1;this._isMigrated=!1;this._armDashboardCache=[]}return n.prototype.resetLayout=function(n){var i=this._helper,t=li.defaultDashboard||{},r;t.parts=t.parts||[];r=this._compressor.uncompress(st.defaultTitle,t);i.clearStartboard(n);i.renderStartboard(n,r.settings,!1,!0)},n.prototype.isCurrentDashboardShared=function(){var n=this._findOwningRepo(this._curDashboard.id);return n&&n.getTypeName()===o.ArmDashboardRepository},n.prototype.isCurrentDashboardWritable=function(){return this._isWritable(this._curDashboard.id)},n.prototype.getCurrentDashboardProperties=function(){var n=this._curDashboard,t=this._findOwningRepo(n.id);return t&&t.getDashboardProperties?t.getDashboardProperties(n):{id:n.id,title:n.title}},n.prototype.initializeDashboard=function(n,t,r){var f=this;this._startboard=n;this._registerEventHandlers(this._lifetime);var o=fr?
i.require("MsPortalImpl/UI/Dashboard/SessionDashboardRepository").then(function(n){var t=new n.SessionDashboardRepository(f._storage);f.addRepository(t)}):Q(),s=u.getStoredJourneyId(this._storage),e=o.then(function(){return t?(f._isMigrated=!0,f._initDashboard(t)):f._migrateStartboard()}).then(function(){!s&&u.isDashboardUri()&&ht(f._curDashboard,!0)}).catch(function(n){f._handleError(n,"initializeDashboard")}).finally(function(){f._endDashboardRevealedTrace(r,"PortalLoad")});return e.finally(function(){f._preloading()}),e},n.prototype.addRepository=function(n){this._otherRepos.push(n)},n.prototype.readDashboardsForType=function(n){return this._getRepositoryByType(n).readDashboards()},n.prototype.startNewDashboard=function(){var n=this;return this._privateRepo.canCreateNewDashboard().then(function(n){if(n)return Q();throw ot(6,null,{action:yi});}).then(function(){return rt(n,!0),n._addToRecent(n._curDashboard)}).then(function(){return n._privateRepo.createDefaultDashboard()}).then(function(
t){return n._setCurDashboard(t,!0),ht(t),n._isStartboardChanging=!0,n._helper.clearStartboard(n._startboard),n._isStartboardChanging=!1,n._startboard.save(),n._saveDashboard(n._curDashboard)}).then(function(){n._helper.enterOrganizeMode(!0)}).catch(function(t){n._handleError(t,"startNewDashboard")}).finally(function(){rt(n,!1)})},n.prototype.saveCurrentDashboard=function(){var n=this;return this._saveDashboard(this._curDashboard).catch(function(t){n._handleError(t,"saveCurrentDashboard")})},n.prototype.cloneCurrentDashboard=function(n){var t=this;return n===void 0&&(n=!0),this._privateRepo.canCreateNewDashboard().then(function(n){if(n)return Q();throw ot(6,null,{action:pi});}).then(function(){return t._isStartboardChanging=!0,rt(t,!0),t._collectDashboardSettings(n,!0)}).then(function(n){return t._addToRecent(t._curDashboard).then(function(){return n})}).then(function(n){return t._privateRepo.cloneDashboard(n,t._curDashboard.title)}).then(function(n){return ht(n),t._loadDashboard(n,!1,!0)}
).then(function(){t._helper.enterOrganizeMode()}).catch(function(n){t._handleError(n,"cloneCurrentDashboard")}).finally(function(){t._isStartboardChanging=!1;rt(t,!1)})},n.prototype.deleteCurrentDashboard=function(){var n=this,t="deleteCurrentDashboard";return this._isStartboardChanging=!0,rt(this,!0),this._readNextDashboards(1).then(function(n){if(n.length<=0)throw ot(2);return n[0]}).then(function(i){return n._deleteDashboard(n._curDashboard).catch(function(i){return n._handleError(i,t)}).then(function(){return i})}).then(function(t){return ht(t,!0),n._loadDashboard(t)}).catch(function(i){n._handleError(i,t)}).finally(function(){n._isStartboardChanging=!1;rt(n,!1)})},n.prototype.restoreCurrentDashboard=function(){var n=this;return this._isStartboardChanging=!0,rt(this,!0),this._loadDashboard(this._curDashboard).catch(function(t){n._handleError(t,"restoreCurrentDashboard")}).finally(function(){n._isStartboardChanging=!1;rt(n,!1)})},n.prototype.switchDashboard=function(n,t){var i=this,
r;return ct(this._curDashboard,n)?Q():(r=wt("DashboardRevealed"),ht(n),rt(this,!0),this._switchDashboard(n,!1).finally(function(){rt(i,!1);i._endDashboardRevealedTrace(r,t)}))},n.prototype._endDashboardRevealedTrace=function(n,t){var i=this._curDashboard.id;return Q.allSettled(this._startboard.children.map(function(n){return Q(n.awaitComposed()).then(function(){return n.awaitOnInputsSetComplete()}).then(function(){return n},function(){return n})})).then(function(r){vt(n,!0,{dashboardId:i,parts:r.map(function(n){var t=n.value;return{name:t.locator.toFriendlyString(),visible:ut.isElementFullyInViewport(t.widget.element[0]).fullyVisible}}),interactionSource:t})})},n.prototype.populateQuickDashboards=function(n){var t=this;return this._readNextDashboards(or,function(i){i=t._curDashboard.id?[t._curDashboard].concat(i):i;n(i)})},n.prototype.shareCurrentDashboard=function(n,t,i){var r=this,u=this._curDashboard;return rt(this,!0),this.shareCurrentDashboardToArm(n,t,i).then(function(n){return ht(
n,!0),r._switchDashboard(n,!0)}).then(function(){return r._deleteDashboard(u)}).finally(function(){rt(r,!1)})},n.prototype.unshareCurrentDashboard=function(){var n=this,i="unshareCurrentDashboard",t=this._curDashboard;return this._privateRepo.canCreateNewDashboard().then(function(t){if(t)return Q();var r=ot(6,null,{action:wi});n._handleError(r,i);throw r;}).then(function(){return rt(n,!0),n._shareCurrentDashboard(o.PrivateDashboardRepository,t.title)}).then(function(t){return ht(t,!0),n._switchDashboard(t)}).then(function(){return n._deleteDashboard(t)}).finally(function(){rt(n,!1)})},n.prototype.shareCurrentDashboardToArm=function(n,t,i){var r=this,u=wt(hi.DashboardPublishNew);return this._shareCurrentDashboard(o.ArmDashboardRepository,n,{subscriptionId:t,resourceGroupName:i}).then(function(n){return vt(u,!0,{dashboardId:n.id}),n}).catch(function(f){vt(u,!1);var e=ot(7,f,{dashboardId:r._curDashboard.id,dashboardTitle:n,subscriptionId:t,resourceGroupName:i});r._handleError(e,"shareCurrentDashboardToArm");
throw e;})},n.prototype.shareCurrentDashboardToSession=function(n){var t=this;return this._shareCurrentDashboard(o.SessionDashboardRepository,n).catch(function(i){var r=ot(7,i,{dashboardId:t._curDashboard.id,dashboardTitle:n});t._handleError(r,"shareCurrentDashboardToSession");throw r;})},n.prototype._registerEventHandlers=function(n){var t=this,u=this._startboard,y=this._topbarWidget.element,w=this._topbarWidget.options,o=u.widget,i=o.element,s,h,e,c,a,v,f;u.setGetDashboard(function(){return $.extend({},t._curDashboard)});ko.reactor(n,function(){var u=t.currentDashboardId(),n=yr(t._curDashboard),i=vr(n&&n()),r;i&&(r=st.filterButtonTextFormat.format(i),o.options.filterButtonText(r))});s=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()};i.on(g.fxstartboardsettingchanged,s);h=function(n,i){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&i.part.getCompositionType()===kt.StartboardPart&&t._notifyDashboardChanged(
)};i.on(p.fxreplacedpartcomposing,h);e=function(n,i){var r,u;n.stopPropagation();r=i.part;r.getCompositionType()===kt.StartboardPart&&(u=r.getViewModel(),u&&!u.container.operations.inProgress.peek()&&t._notifyDashboardChanged())};i.on(d.fxpartsettingchanged,e);i.on(k.fxpartinputchanged,e);c=function(n){n.stopPropagation();var i=o.options;i.title().length===0&&(u.services.desktop.mode(1),i.title(st.untitled));t._notifyDashboardChanged()};i.on(ft.fxstartboardtitlechanged,c);a=function(n,i){if(n.stopPropagation(),w.dashboardChanged(!1),!u.notFound()){var r=et.FinishDashboardEditAction;switch(i.action){case r.Save:t.saveCurrentDashboard();break;case r.SaveACopy:t.cloneCurrentDashboard(!1);break;case r.Discard:t.restoreCurrentDashboard()}}};y.on(et.fxfinishdashboardedit,a);v=function(n){n.stopPropagation();t._migrateStartboard()};i.on(ft.fxmigratestartboard,v);f=o.options;f.refreshDashboardList=function(n){return t.populateQuickDashboards(n)};f.switchDashboard=function(n){return t.switchDashboard(
n,"RecentList")};f.title.subscribe(n,function(n){t._curDashboard.title=n});u.notFound.subscribe(n,function(n){f.notFound(n)});l.selectedSubsUpdateTriggered.subscribe(n,function(){var n=r.Azure.getAllSubscriptions(bt.Rpc.Internal.client,pt),t=l.getSelectedSubscriptions(pt);Q.all([n,t]).spread(function(n,t){var i=n.length,r=t.length;f.subscriptionsInfo(r>=i?st.browseForAllSubs.format(i):st.browseForSelectedSubs.format(r,i))})}).callback(null);n.registerForDispose(function(){u.removeGetDashboard();i.off(g.fxstartboardsettingchanged,s);i.off(p.fxreplacedpartcomposing,h);i.off(d.fxpartsettingchanged,e);i.off(k.fxpartinputchanged,e);i.off(ft.fxstartboardtitlechanged,c);i.off(ft.fxmigratestartboard,v);y.off(et.fxfinishdashboardedit,a)})},n.prototype._notifyDashboardChanged=function(){if(!this._startboard.notFound()){var n=this._privateRepo.identifyDashboard(this._curDashboard.id);n?this.saveCurrentDashboard():this._topbarWidget.options.dashboardChanged(!0)}},n.prototype._setCurDashboard=function(
n,t,i){var r,u,f,e;i===void 0&&(i=!1);n=n||{id:"",title:hr};n&&(u=n.settings,f=u&&u[at],r=f&&f.dashboardModel);r=bi(r);e={model:ti(r.model),metadata:r.metadata};this._curDashboard={id:n.id,title:n.title,isWritable:t,model:e};this._startboard.widget.options.title(n.title);this._topbarWidget.options.dashboardWritable(t);this.currentDashboardId(n.id);this._startboard.notFound(i)},n.prototype._switchDashboard=function(n,t){var i=this;return this._isStartboardChanging=!0,this._addToRecent(this._curDashboard).then(function(){return i._loadDashboard(n,!1,t)}).catch(function(n){i._handleError(n,"switchDashboard")}).finally(function(){i._isStartboardChanging=!1})},n.prototype._findOwningRepo=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first(function(t){return t.identifyDashboard(n)})},n.prototype._getRepositoryByType=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first(function(t){return t.getTypeName()===n})},n.prototype._readDashboard=function(
n){var t=n.id;return ri(this._findOwningRepo(t)).then(function(n){return n.readDashboard(t)}).then(function(n){if(!n)throw new Error("It succeeded in reading dashboard '"+t+"'. But the result is "+n+".");return n}).catch(function(i){throw ot(1,i,{dashboardId:t,dashboardTitle:n.title});})},n.prototype._collectDashboardSettings=function(n,t){var i=this,r=n?this._readDashboard(this._curDashboard):Q(null);return r.catch(function(){return null}).then(function(n){return n?n.settings:i._helper.collectDashboardSettings(i._startboard)}).then(function(n){return t?ar(n):n})},n.prototype._saveDashboard=function(n){var r=this,t=n.id,i=n.title;return this._collectDashboardSettings().then(function(n){return ri(r._findOwningRepo(t)).then(function(r){return r.updateDashboard(t,{settings:n,title:i})})}).catch(function(t){throw ot(5,t,{dashboardId:n.id,dashboardTitle:i});})},n.prototype._deleteDashboard=function(n){var u=this,t=n.id,r;return i.remove(this._armDashboardCache,function(n){return n.id.toLowerCase(
)===t.toLowerCase()}),r=wt(hi.DashboardDelete,{dashboardId:t}),this._removeFromRecent(t).then(function(){var n=u._findOwningRepo(t);return n.deleteDashboard(t)}).then(function(){return vt(r,!0)}).catch(function(i){vt(r,!1);throw ot(4,i,{dashboardId:t,dashboardTitle:n.title});})},n.prototype._readNextDashboards=function(n,t){var r=this;t||(t=function(){});var u=function(t,i){return t=i?f.filterDashboards(t,i):t,t.filter(function(n){return!ct(n,r._curDashboard)}).slice(0,n)},e=l.getSelectedSubscriptions(pt).catch(function(){return[]}),s=this._privateRepo.getRecentDashboards().catch(function(){return[]});return Q.all([e,s]).spread(function(f,e){var s=f.map(function(n){return n.subscriptionId});return(e=u(e,s),e.length>=n)?(t(e),Q(e)):r._privateRepo.readDashboards().catch(function(){return[]}).then(function(f){var h=i.union(e,f,ct);return(h=u(h),h.length>=n)?(t(h),h):(h=i.union(h,r._armDashboardCache,ct),h=u(h,s),t(h),h.length>=n)?h:r._helper.readDashboardsOfMaxCount(r._otherRepos,n-h.length,
h,function(n,f){f===o.ArmDashboardRepository&&(r._armDashboardCache=n);h=i.union(h,n,ct);h=u(h);t(h)}).then(function(){return h})})})},n.prototype._preloading=function(){var n=this;return this.readDashboardsForType(o.ArmDashboardRepository).then(function(t){n._armDashboardCache=t})},n.prototype._isWritable=function(n){return ri(this._findOwningRepo(n)).then(function(t){return t.isDashboardWritable(n)}).catch(function(){return!0})},n.prototype._addToRecent=function(n){return this._startboard.notFound()?Q():this._privateRepo.addToRecent(n).catch(function(){})},n.prototype._removeFromRecent=function(n){return this._privateRepo.removeFromRecent(n).catch(function(){})},n.prototype._loadDashboard=function(n,t,i){var r=this,f=n.id,e=i?Q(n):this._readDashboard(n),u=this._helper;return Q.all([this._removeFromRecent(f),this._isWritable(f),e]).spread(function(n,i,f){r._setCurDashboard(f,i);u.clearStartboard(r._startboard);u.renderStartboard(r._startboard,f.settings,t)}).catch(function(t){r._setCurDashboard(
n,!0,!0);u.clearStartboard(r._startboard);r._startboard.save();throw t;})},n.prototype._migrateStartboard=function(){var n=this,t=this._startboard.widget.options,i=h.NavBar.home;return this._helper.getStartboardReadyPromise().then(function(){return n._privateRepo.createDefaultDashboard(i)}).then(function(t){return n._setCurDashboard(null,!0),n._startboard.save(),n._saveDashboard(t).then(function(){return t})}).then(function(i){t.headerMode(ft.HeaderMode.Normal);n._setCurDashboard(i,!0);n._startboard.save();n._isMigrated=!0}).catch(function(n){throw ot(3,n);})},n.prototype._initDashboard=function(n){var t=this,i=this._startboard.widget.options;return i.headerMode(ft.HeaderMode.Normal),this._loadDashboard(n,!0).then(function(){t._startboard.logChildren()})},n.prototype._shareCurrentDashboard=function(n,t,i){var r=this._getRepositoryByType(n);return this._collectDashboardSettings(!0,!0).then(function(n){return r.createDashboard({title:t,settings:n,extras:i})})},n.prototype._handleError=function(
n,t){var o=this,e=this._startboard.widget.options,r=this._helper,u=st.Notification.errorTitle,i=st.Error,f=function(n,i){lt.error(n,n.code,t+": "+i)},s=function(n){var r=n.data,t=r.dashboardId,u=r.dashboardTitle;f(n,"Failed to find dashboard '"+t+"'.");var i=o._findOwningRepo(t),s={id:t,title:u},h=i&&i.getNotFoundMessage?i.getNotFoundMessage(s):st.NotFound.defaultMessageFormat.format(u);e.notFoundMessage(h)},h=function(){r.popNotification(u,i.cannotDelete)},c=function(n){f(n,"Failed to migrate startboard.");e.headerMode(ft.HeaderMode.Migration)},l=function(n){var t=n.data;f(n,"Failed to delete dashboard '"+t.dashboardId+"'");r.popNotification(u,i.failToDeleteFormat.format(t.dashboardTitle,n.message))},a=function(n){var t=n.data;f(n,"Failed to save dashboard '"+t.dashboardId+"'.");r.popNotification(u,i.failToSaveFormat.format(t.dashboardTitle))},v=function(n){var f=n.data.action,t="";switch(f){case yi:t=i.cannotCreate;break;case pi:t=i.cannotClone;break;case wi:t=i.cannotUnpublish}r.popNotification(
u,t)},y=function(n){var t=n.data,e=t.dashboardId,o=t.dashboardTitle,s=t.resourceGroupName,h=t.subscriptionId;f(n,"Failed to publish dashboard '"+e+"'");r.popNotification(u,i.failToPublishFormat.format(o,s,h,n.message))},p=function(){lt.error(n,0,t);r.popNotification(u,i.unknown)};if(n instanceof ii)switch(n.code){case 1:s(n);break;case 2:h();break;case 3:c(n);break;case 4:l(n);break;case 5:a(n);break;case 6:v(n);break;case 7:y(n)}else p()},n}();t.DashboardManagerImpl=ei}(ot||(ot={})),ot});define("MsPortalImpl/UI/UI.DesktopManagerView",["require","exports","f","i","../Extension/Extension.Definition.Locator","../Base/Telemetry","./UI.DesktopManager"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function c(n,t){e.isTraceEnabled&&w.verbose("[DesktopManager] {0}\n  {1}\n  Model: {2}.".format(n,t.toString(),ko.toJSON(t.getInputsOnlyViewModel())))}function b(n,t){var i=new l(n,t),r=[o.fxhubclicking,o.fxavatarmenutoggling].join(" ");n.element.on(r,function(n){var i=t.close();i||
n.preventDefault()});return i}var a=u.LocatorType,v=r.Extension,s=i.Base,h=s.Diagnostics,y=h.Telemetry,o=s.EventTypes,p=window,w=h.createLog(n),k=jQuery,l=function(){function n(n,t){var i=this;this._portalWidget=n;this._panoramaWidget=n.getPanorama();this._contextPane=t;this._portalWidget.element.on(o.fxautosettings,function(n,t){i._autoOpenedBy=t})}return Object.defineProperty(n.prototype,"portalWidget",{get:function(){return this._portalWidget},enumerable:!0,configurable:!0}),n.prototype.composeJourney=function(n){n&&(n.compose(this._panoramaWidget),n.isStartedWithContextBlade()||this._portalWidget.showJourney())},n.prototype.composeStartBoard=function(n){n&&n.compose(this._panoramaWidget)},n.prototype.addPartToStartBoard=function(n){n.compose(this._panoramaWidget.getStartBoardWidget())},n.prototype.addBlade=function(n,t){var i,r,u;return(c("Adding blade to desktop.",n),i=n.parent,r=i.blades,y.trace({action:"JourneyLength",source:f.Source.Desktop,journeyId:i.id,data:{count:r.length,blades:
r.map(function(n){var t=n.locator;return{bladeName:t.name,extension:v.getWindowId(t.getExtensionLocator())}})}}),n.openInContextPane)?this._contextPane.tryOpen(n).then(function(){}):(this._autoOpenedBy&&(u=n.masterContainer,u&&u.instanceId===this._autoOpenedBy.masterBladeId&&(t||(t={}),t.autoOpenedByBlade=this._autoOpenedBy.masterBladeId,t.autoOpenedByPart=this._autoOpenedBy.masterPartId),this._autoOpenedBy=null),n.compose(this._panoramaWidget.getJourneyWidget(),t),t&&t.focus&&n.awaitWidgetReadyToDisplay().done(function(){var i=n.containerWidget;i.element.trigger(o.fxensureviewportvisible,{widget:i,alignStart:t.alignToStart})}),Q())},n.prototype.removeBlade=function(n){c("Removing blade from desktop.",n);var t=this._contextPane;t.hasContent(n)?t.close(!0):this._panoramaWidget.removeChild(n.id)},n.prototype.removeAllBlades=function(n){this._panoramaWidget.getJourneyWidget().removeChildren(n);var t=this._contextPane,i=t.getContent(),r=i&&i.locator;r&&r.type===a.Blade&&t.close(!0)},n.prototype.
showConfirmDialog=function(n){return!!p.confirm(n)},n}();t.DesktopManagerViewImpl=l;t.create=b}(o||(o={})),o});define("MsPortalImpl/Extension/ViewModelManager",["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){function o(n,i,r){t[n]={name:n,modulePath:i,factory:r}}function s(n,t,i){r[n]={name:n,modulePath:t,factoryWithState:i}}function h(n,t,i){u[n]={name:name,modulePath:t,factoryWithPrefix:i}}function c(n,o,s){var h=null,c=null,l=i.Helpers.Deferred();return(o in t?(h=t[o].modulePath,c=t[o].factory):o in r&&(h=r[o].modulePath,c=function(n){return r[o].factoryWithState(n,s)}),e(u,function(t,i){o.startsWith(t)&&(h=i.modulePath,c=function(t){return i.factoryWithPrefix(t,s,o,n)})}),h)?(f.loadAsync(h).then(function(n){l.resolve(c(n))},function(n){l.reject(n.message)}),l.promise()):null}var f=i.Base.Amd,t={},r={},u={},e=i.forEachKey;n.register=o;n.registerWithState=s;n.registerPrefix=h;n.resolve=c}(r||(r={})),r});define("MsPortalImpl/UI/UI.DesktopManagerImpl",["require",
"exports","f","../Base/Base.Events","../Base/Base.Router","../Extension/DefinitionPreprocessor","../Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.Settings","../Services/Services.Settings.Schema","../Services/Services.EditScopeManagement","../Base/Telemetry","./Compositions/UI.Composition","./Compositions/UI.Composition.Base","./Compositions/UI.Composition.JourneySettingSerializer","./Compositions/UI.Composition.Part","./Compositions/UI.Composition.StartBoard","./Compositions/UI.Composition.StartboardPart","./Dashboard/DashboardManager","./UI.DesktopManager","./UI.DesktopManagerView","../Extension/ViewModelManager","./Compositions/UI.Composition.Base"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){"use strict";var tt;return function(t){function wt(t){return nr(t,n)}function ei(){return nr("MsPortalImpl/UI/UI.Desktop.Actions")}function nu(n,t){var i=g.create(n,t.contextPane);return new si(i,t)}function tu(){sr&&v.debug(
sr.getDiagnosticsData())}function iu(){return null}function ru(n,t){var i=[],r={},u=bi[a.CompositionType.StartboardPart];return dr(n,function(n,t){var f=w.isStartboardPartKey(n),e=ri(n,u+"-"+gt)||ri(n,u+"-"+ni);!f||e?r[n]=t:i.push(n)}),i.length&&t.deleteSettings({store:ct.Startboard,keys:i}),r}function uu(n){var t=n[h.startBoardSettingsKey]||{},i=t.dashboardId;return!i?null:{id:i,title:t.dashboardTitle||o.NavBar.home}}function hr(n,t,i){if((i===void 0&&(i=kr),!i)||!t)return n;if(n){var r=t.toLowerCase(),u=(n.id||"").toLowerCase()===r;return u?n:{id:r,title:r}}return null}function oi(n,t){n.removeChild(t,!1,!t.dontSetupWidget)}function lt(n){return n&&n.locator&&n.locator.toFriendlyString()}function fu(t){var i=ar.composePartViewModel,r=nt.registerWithState;r("Shell$BladeLauncherViewModel",n.normalize("./UI.BladeLauncher"),function(n,t){return i(function(i){return new n.BladeLauncher(i,t)},{initialState:t,createSelectable:!0})});r("Shell$AssetBladeLauncherViewModel",n.normalize("./UI.AssetBladeLauncher"),
function(n,r){return i(function(i){return new n.AssetBladeLauncher(i,r,t)},{initialState:r,createSelectable:!0})})}var cr=e.Locator,at=e.LocatorType,bt=FxImpl,vt=bt.Extension,hi=vt.CloudName,lr=bt.TriggerableLifetimeManager,ar=bt.ViewModels.Part,ot=i.Base,vr=ot.Amd,ci=ot.Constants,li=ci.ExtensionNames,kt=li.Hubs,ai=ot.Diagnostics,vi=ai.Telemetry,dt=ot.EventTypes,st=ot.Utilities,yi=st.Internal.Serialization,yr=i.Parts.PartSize,pi=i.ViewModels.Dialogs,wi=pi.DialogResult,pr=pi.MessageBoxButtons,ct=s.SettingStore,bi=a.CompositionType,it=d.DesktopManagerEvents,ki=c.EditScopeState,ut=i.Helpers,yt=e.DefinitionFinderImpl,gt="AssetBladeLauncher",ni="BladeLauncher",wr=window,v=ai.createLog(n),eu=vi.trace,ft=l.Source.Desktop,ht=l.Action,pt=o.Desktop,rt={noActiveJourney:"Desktop has no active journey.",noBladeInJourney:"Blade '{0}' does not exist in the current journey.",noTileInDesktop:"Tile with id '{0}' was not found on the desktop."},ou=h.startBoardSettingsKey,ti=h.desktopSettingsKey,tt=vi,di=
wr.fx.environment,ii=ct.JourneySession,br=ct.Startboard,gi=di.features.multidashboards==="true",kr=di.features.deeplinkdashboard==="true",dr=i.forEachKey,ri=i.startsWith,nr=i.require,et=ko.observable,gr=ko.observableArray,tr=cr.forExtension,ir=it.journeyDeactivated,rr=it.journeyActivated,ur=it.journeyDiscarded,ui=it.journeyCreated,fr=it.settingsLoaded,er="./Compositions/UI.Composition.Journey",or="./Compositions/UI.Composition.Blade",fi="BladePairManager",sr,si;t.organizeModeModules={dragDrop:"MsPortalImpl/UI/UI.DragDropCompositionManager"};t.createDesktopManager=nu;t.logDiagnosticsData=tu;t.getCurrent=iu;t.resolveInitialDashboard=hr;si=function(){function n(n,t){var i=this;this._savedJourneys=[];this._previousActiveJourney="";this._startboardPartsLoadedDeferred=Q.defer();this._loadedStartBoardPartIds={};this._mode=et(0);this._lifetime=new lr;this._hubsCloudName=vt.getHubsCloudName();this._dashboardManagerDefer=Q.defer();this.activeJourney=et(null);this.cachedJourneys=new ot.LruMap;this.
cachedJourneysCapacity=10;this.commandsEnabled=et(!0);this._loadingJourneyGuid=null;this._view=n;this._services=t;this._initDeferred=ut.Deferred();this._sharedSettings=t.settings;this._portalServices=t;fu(this._services.assetTypeService);$(this).on([ir,rr,ur,ui,fr].join(" "),function(){i.populateJourneysInJourneysMenu()})}return n.prototype.startBoardPartsLoaded=function(){return Q.isFulfilled(this.getStartboardPartsLoadedPromise())},n.prototype.getStartboardPartsLoadedPromise=function(){return this._startboardPartsLoadedDeferred.promise},Object.defineProperty(n.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"initializationPromise",{get:function(){return this._initDeferred.promise()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isJourneyLoading",{get:function(){return this._loadingJourneyGuid!==null},enumerable:!0,configurable:!0}),n.prototype.initialize=function(n,i){var r=this;this._setupOrganizeModeComponents(
t.organizeModeModules);this._extensionMetadataList=n;this._services.assetManager.onAssetDeleted(function(n,t,i,u){ei().then(function(f){f.handleAssetDeleted(r,n,t,i,u)})});var h=k.startTrace("DashboardRevealed"),f,o,c=u.getDashboardIdFromUri(),e,s=this._dashboardManager=k.create({services:this._services,lifetime:this._lifetime});i.then(function(n){var t=tt.startTrace({source:ft,action:"LoadDesktop"}),i=n&&n[ii]||{};f=n&&n[br]||{};o=uu(f);f[ti]?(e=hr(o,c),r.load(i,f,e&&e.id)):(r._startBoard=w.create(r._createCompositionServices()),r._view.composeStartBoard(r._startBoard),r._populateStartBoardFromManifests().then(function(){r._startboardPartsLoadedDeferred.resolve()}),r._initDeferred.resolve());tt.completeTrace(t)}).catch(function(n){v.error("Error during the composition of startboard. The error is "+(n.stack||n.message||n)+".");r._startBoard||(r._startBoard=w.create(r._createCompositionServices()));r._startBoard.widget||r._view.composeStartBoard(r._startBoard);r._startboardPartsLoadedDeferred.
resolve();r._initDeferred.resolve()}).then(function(){if(gi)return s.initializeDashboard(r._startBoard,e,h).finally(function(){r._dashboardManagerDefer.resolve(s);r._initDeferred.resolve()})})},n.prototype.resetStartBoard=function(n){var t=this,i;return i=n?Q(wi.Yes):this._services.getService("DialogManager").then(function(n){return n.showModalDialog({title:o.Startboard.resetConfirmationTitle,description:o.Startboard.resetConfirmationText,buttons:pr.YesNo})}),i.then(function(n){var r,i;if(n===wi.Yes){for(r=t.startBoard.children,i=r.length-1;i>=0;i--)t.removeTile(r[i].id,!0);t._populateStartBoardFromManifests()}})},n.prototype._populateStartBoardFromManifests=function(){var n=this,t;return this._dashboardManager.resetLayout(this._startBoard),this.save(),t=this._services.extensionManager.getExtensions().map(function(t){var r=n._extensionMetadataList.first(function(n){return vt.isEqualDescriptor(n,t)}),i=r.startBoardParts;if(r.isTestExtension||i&&i.length)return t.getManifest().then(function(
t){n._addStartBoardPartsFromManifest(t,i);n.save()})}).filter(function(n){return!!n}),Q.allSettled(t)},n.prototype._getExtensionEmailAddress=function(n){var t=this._extensionMetadataList.first(function(t){return t.name===n});return t&&t.feedbackEmail},n.prototype.getCurrentBladeInfo=function(){var n=this._getBreadCrumb(),i=this._getExtensionEmailAddress(kt),r=n[n.length-1],t=r&&r.extensionName||"",u=t?this._getExtensionEmailAddress(t):i;return{extensionName:t,feedbackTo:u,feedbackCC:i,breadcrumb:n.map(function(n){return n.title}).join(" > ")}},n.prototype._getBreadCrumb=function(){var t=this.getActiveJourney(),n;return t?(n=t.children,!n||!n.length)?[]:n.map(function(n){return{title:n.isDefaultTitle()?n.id:n.title(),extensionName:n.locator.getExtensionLocator().name,id:n.id}}):[]},n.prototype.createJourney=function(n,t,i){var r=this,f=this._startBoard.children.first(function(t){return t.id===n}),u;return f?(u=ut.Deferred(),i||(i=st.getUniqueId(),this._loadingJourneyGuid=i,this._createNewJourneyPromise=
u.promise()),u.promise().finally(function(){r._loadingJourneyGuid===i&&(r._loadingJourneyGuid=null,r._createNewJourneyPromise=null)}),f.awaitComposed().then(function(){if(r.tryDeactivateJourney(i)){$(r).trigger(it.journeyCreating,t);var e=new yt(r._services.extensionManager),n=r._createCompositionServices(e),o=tt.startTrace({source:ft,action:ht.JourneyOpened,name:lt(f)}),s=n.getService(fi);wt(er).then(function(i){return s.then(function(e){return r.setActiveJourney(i.create(n,e,f)),wt(or).then(function(i){var s=i.create(n,e,t,r._startBoard),f=r._activeJourney;f.addChild(s);r._view.composeJourney(f);r._startBoard.detailContainers=[s];r._view.addBlade(s,{assetType:t.originAssetType,focus:!0,reusableWidget:t.reusableWidget}).catch(function(n){v.error(n)});r._savedJourneys=r.getJourneysJson();r.cachedJourneys.getOrAdd(f.id,function(){return!0});r._trimSavedJourneys();r._triggerActiveJourneyChanged();r.save();u.resolve(f);$(r).trigger(ui);tt.completeTrace(o);Q.nextTick(function(){r._savedJourneys=
r.getJourneysJson();r.save()})})})}).catch(function(n){u.reject(n)})}else u.reject("tryDeactivateJourney returned false")}),u.promise()):(v.error(rt.noTileInDesktop.format(n)),v.verbose(ko.toJSON(this.getDiagnosticsData(),null,2)),ut.Deferred().reject())},n.prototype.createJourneyForBlade=function(n,t){var i=this;return this._services.extensionManager.getHubsExtension().then(function(){if(i._loadingJourneyGuid===t){var r=tt.startTrace({source:ft,action:ht.JourneyOpened,name:ni});return hi.addToModel(n.cloudName,n),i._createJourneyWithHiddenPart(kt,ni,n,t,r,i._hubsCloudName,n.defaultMenuItemId)}})},n.prototype.createJourneyForAsset=function(n,t,i){var u=this,r=Q.defer(),s=this._services.extensionManager.getHubsExtension();r.promise.finally(function(){u._loadingJourneyGuid===t&&(u._loadingJourneyGuid=null)});var e=n.extension,f=n.assetType,o={extensionName:e,assetType:f,assetId:i};return s.then(function(){if(u._loadingJourneyGuid!==t){r.resolve();return}var s=tt.startTrace({source:ft,action:
ht.JourneyOpened,assetType:f,name:gt});hi.addToModel(n.cloudName,o);u._createJourneyWithHiddenPart(kt,gt,o,t,s,u._hubsCloudName,n.defaultMenuItemId).then(function(){r.resolve()}).catch(function(n){v.error("Failed to select part to start journey from asset. \nExtension: {0}. \nAsset: {1}. \nAsset Id: {2}. \nReason: {3}".format(e,f,i,n));r.reject()})},function(){r.reject()}),r.promise},n.prototype.createJourneyForAssetType=function(n,t,i,r,u){var e=this,f=Q.defer(),o=this._services.extensionManager.getExtension(n,r);return f.promise.finally(function(){e._loadingJourneyGuid===i&&(e._loadingJourneyGuid=null)}),o.getManifest().then(function(o){var s,h;if(!o.assetTypes){v.verbose("Failed creating journey for asset type: {0}. No assetTypes property defined for extension {1}".format(t,n));f.reject();return}if(s=o.assetTypes.first(function(n){return n.name===t}),!s||!s.partName||!s.bladeName){v.verbose("Failed creating journey for asset type: {0}. No assetType matched in extension {1}".format(t,
n));f.reject();return}if(e._loadingJourneyGuid!==i){f.resolve();return}h=tt.startTrace({source:ft,action:ht.JourneyOpened,assetType:s.name,name:s.bladeName});e._createJourneyWithHiddenPart(n,s.partName,u,i,h,r).then(function(){f.resolve()}).catch(function(i){v.error("Failed to select part to start journey from asset. \nExtension: {0}. \nAsset: {1}. \nPart Name: {2}. \nReason: {3}".format(n,t,s.partName,i));f.reject()})},function(){f.reject()}),f.promise},n.prototype._createJourneyWithHiddenPart=function(n,t,i,r,u,f,e){var o=this,h=tr(n,f).withPartType(t),s=this.addPartToStartBoard({originPartLocator:h,model:i,defaultMenuItemId:e,reuseExistingPart:!1,dontSetupWidget:!0});return s.isComposed&&s.isSelected()&&this._activeJourney&&this._activeJourney.originTile===s?(this.portalWidget.showJourney(),Q.resolve(undefined)):s.selectOnReady(function(){return o._loadingJourneyGuid!==r?!1:!s.isSelected()&&o.tryDeactivateJourney(r)},{timeoutInMilliseconds:9e4}).then(function(n){n&&(o._savedJourneys=
o.getJourneysJson(),o.save(),$(o).trigger(ui),tt.completeTrace(u))})},n.prototype.openSingleBlade=function(n,t){return this._openBlade(n,t,function(n,i){return i===0&&n.locator.equals(t.locator)})},n.prototype.openMultipleBlades=function(n,t){var u=this,i=ut.Deferred(),r;return t&&t.length!==0?(r=t.map(function(t){return u._openBlade(n,t,function(n){return n.locator.equals(t.locator)&&t.model&&n.getViewModel()&&a.deepSubset(n.getViewModel(),t.model)})}),$.when.apply($,r).done(function(){for(var t=[],n=0;n<arguments.length;n++)t[+n]=arguments[n];i.resolve(t)}).fail(function(){i.reject()})):i.resolve([]),i.promise()},n.prototype.confirmBladesCanClose=function(n){var r=this,u=(n||[]).first(function(n){return!r.canCloseBlade(n)}),t,i;return u?(t=this._view.showConfirmDialog(pt.confirmEditScopeDiscard),i=this._getBreadCrumb().some(function(n){return n.extensionName===li.Marketplace||n.id===ci.BladeNames.Hubs.CreateHubBlade}),t&&this._activeJourney&&i&&this.portalWidget.element.trigger(dt.fxcreateabandoned,
JSON.stringify(this.getCurrentBladeInfo())),t):!0},n.prototype.forceCloseBlade=function(n,t){var f,i,r=this._activeJourney,u,e,o;if(!r)throw new Error(rt.noActiveJourney);f=this._findFirstItemIndex(r.children,n,rt.noBladeInJourney.format(n));i=r.children[f];this._startBoard.detailContainers.length===1&&this._startBoard.detailContainers[0].id===i.id?this.forceDiscardJourney(r.id):(u=i.masterContainer,u&&(e=u.detailContainers,o=e.indexOf(i),o>=0&&(e.splice(o,1),t&&t.openBlade||u.onDetailContainersChanged())),this._closeBladeRecursive(i,f),i.pairManager().update(r.blades,!!t&&!!t.openBlade));this._triggerActiveJourneyChanged();this.save()},n.prototype.tryCloseBlade=function(n){var t=this.confirmBladesCanClose([n]);return t&&this.forceCloseBlade(n),t},n.prototype.closeChildBlades=function(n){var i=this.discardEditsOfBlade(n,{includeSelf:!1,includeDescendants:!0}),t;if(i.successful)for(t=n.detailContainers.length-1;t>=0;t--)this.forceCloseBlade(n.detailContainers[t].id);return i},n.prototype.
discardEditsOfPart=function(n,t){var i=n.getPartsContainer(),r=n.journeyPath;return this._discardEditsOfContainer(i,t.force,function(r){var o=r.path,c=n.journeyPath,f=i.journeyPath,s=st.deepEquals(o,c),h=!1,u,e;if(!s&&o.length>f.length){try{u=st.parseSortedString(r.path[f.length])}catch(l){v.error("Failed to parse journey path segment for blade '{0)'. Path: '{1}'. Error: '{2}'.".format(i.toString(),JSON.stringify(f),l.message))}h=u&&u.master&&u.master.part===n.id}return e=r.value,e&&e.editScope&&(t.includeSelf&&s||t.includeDescendants&&h)})},n.prototype.discardEditsOfBlade=function(n,t){return this._discardEditsOfContainer(n,t.force,function(i){var r=i.value,u=i.path,f=n.journeyPath,e=st.deepEquals(u,f),o=!e&&(r.type===at.Blade||u.length>=f.length+2);return r&&r.editScope&&(t.includeSelf&&e||t.includeDescendants&&o)})},n.prototype._discardEditsOfContainer=function(n,t,i){var o=this,u=[],s=n,h=n instanceof w.Instance||s.isInitialized,r={confirmationRequired:!1,successful:!1},e=this._activeJourney,
f;if(!e)throw new Error(rt.noActiveJourney);return f=e.ambientSettings,h&&(u=f.getItemsInPath(n.journeyPath).filter(i)),r.confirmationRequired=!t&&u.filter(function(n){var t=n.value.editScope;return t.dirty&&!t.saving}).length>0,(!r.confirmationRequired||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(r.successful=!0,u.forEach(function(n){f.removeItem(n.path);o._services.editScopeManager.onEditScopeDisposed(n.value.editScope.editScopeId)})),r},n.prototype.canCloseBlade=function(n){var u,i,t=this._activeJourney,r;if(!t)throw new Error(rt.noActiveJourney);return r=this._startBoard.detailContainers,u=this._findFirstItemIndex(t.children,n,rt.noBladeInJourney.format(n)),i=t.children[u],r.length===1&&r[0].id===i.id?this._canDiscardJourney(t.id):this._canCloseBladeRecursive(i)},n.prototype.addPartToStartBoard=function(n){var i,r;if(!n){v.error("options should be specified for adding a part to the startboard.");return}if(!n.originPartLocator){v.error("options.originPartLocator should be specified for adding a part to the startboard.");
return}var u=new yt(this._services.extensionManager),e=this._createCompositionServices(u),t,f=n.model;return n.reuseExistingPart!==!1&&(t=this._startBoard.children.first(function(t){return t.matchesLocatorAndModel(u,n.originPartLocator,f,n.defaultMenuItemId)})),t||(t=b.create(e,n.originPartLocator,f,{modelContainsSensitiveData:n.modelContainsSensitiveData}),t.dontSetupWidget=!!n.dontSetupWidget,i=n.defaultMenuItemId,i&&(t.defaultMenuItemId=i),yr[n.initialSize]&&(t.initialSize=n.initialSize),r=t.id,this._isStartBoardPartLoaded(r)||(this._isStartBoardPartLoaded(r,!0),this._startBoard.addChild(t,undefined,!t.dontSetupWidget),this._view.addPartToStartBoard(t),t.save(),this.save())),t},n.prototype.pinMultipleParts=function(n,t,i,r){var u=this;return ei().then(function(f){f.pinMultipleParts(u,n,t,i,r)})},n.prototype.removeTile=function(n,t){var o=this._startBoard,i=o.children.first(function(t){return t.id===n}),r,u,f;if(i){r=void 0;u=this._activeJourney;u&&u.isStartedWithContextBlade()&&u.originTile===
i?r=u.id:(f=this.getJourneysJson().first(function(n){return n.originPartId===i.id}),r=f&&f.id);var e=i.editScopeId()&&this._services.editScopeManager.getStateObservable(i.editScopeId()),h=!e||e()===ki.NotDirty||e()===ki.DirtyAndSaving,c=!r||this._canDiscardJourney(r),s=t||h&&c;(s||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(r&&this.forceDiscardJourney(r),i.clearIdentitySettings(),oi(o,i),s||i.dontSetupWidget||v.warning("Part '{0}' is removed from the start board.".format(i)),this.save())}},n.prototype.replacePart=function(n,t,i){var o=this,r,s=this.getJourneysJson().first(function(t){return n&&n.id===t.originPartId}),v=new yt(this._services.extensionManager),h=this._createCompositionServices(v),f=ut.Deferred(),c=!0,u,l,e;return i=i||{},this._validateReplacePartArgs(n,t,i.newPartContainerModel,function(n){l=n})?(n instanceof b.Instance?(r=b.create(h,t,i.newPartContainerModel,{id:n.id,doNotSaveSettings:i.doNotSaveSettings,overridesModel:i.newPartOverridesModel}),e=n,r.dontSetupWidget=
e.dontSetupWidget,c=!e.dontSetupWidget):r=p.create(h,t,n.id,i.newPartContainerModel,i.newPartOverridesModel),r.originalPartLocator=n.originalPartLocator||n.locator,u=n.getPartsContainer(),n.dispose(!0),n.parent.replaceChild(n,r),r instanceof b.Instance&&s?this.tryDiscardJourney(s.id):u.getPartsContainer().detailContainers.slice(0).reverse().forEach(function(t){t.masterPartId===n.id&&o.tryCloseBlade(t.id)}),r.widgetState(n.widgetState()),r.save(),c?(r.widget=n.widget,r.recompose(n.parent.widget)):r.compose(n.parent.widget),r.widget.element.trigger(a.fxreplacedpartcomposing,{part:r}),r.awaitComposed().then(function(){f.resolve(r);u.getCompositionType()===bi.Blade&&(tt.trace({source:ft,action:"ReplacePartOnBlade",name:i.caller,data:{newPart:lt(r),oldPart:lt(n),blade:lt(u)}}),i.doNotSaveSettings||u.saveTemplate());!i.preventNewPartActivation&&r.partDefinition.details&&r.partDefinition.details.length>0&&r.selectOnReady(function(){return!o._activeJourney},{timeoutInMilliseconds:15e3})},function(
){f.reject("Unable to compose the mutated part.")})):f.reject(l),f.promise()},n.prototype._validateReplacePartArgs=function(n,t,i,r){var u,f="Unable to replace part '{0}', ".format(n&&n.toString());return n&&t?n.isDisposed()?u=f+"it has already been disposed.":n.getPartsContainer()?n.widget&&n.parent&&n.parent.widget||(u=f+"the part or its parent have not been composed."):u=f+"it is not a child of a PartsContainerComposition.":u="Replace part requires a part and a new locator.",u&&r&&r(u),!!u==!1},Object.defineProperty(n.prototype,"portalWidget",{get:function(){return this._view.portalWidget},enumerable:!0,configurable:!0}),n.prototype.getDashboardManager=function(){return this._dashboardManagerDefer.promise},n.prototype.getSettingCollections=function(){var i={},r={},n=this._activeJourney,t=[];return i[ti]=JSON.parse(JSON.stringify(this)),t.push({store:ct.Startboard,settings:i}),n&&n.children&&(r[n.id]=JSON.parse(JSON.stringify(n)),t.push({store:ii,settings:r})),t},n.prototype.dispose=
function(){this._lifetime&&(this._lifetime.dispose(),this._lifetime=null);this._onShowStartBoard&&(this.portalWidget.element.off(dt.fxshowstartboard,this._onShowStartBoard),this._onShowStartBoard=null);this._sharedSettings&&(this._sharedSettings.dispose(),this._sharedSettings=null);$(this).off({journeyActivated:"journeyActivated",journeyDeactivated:"journeyDeactivated",journeyDiscarded:"journeyDiscarded",journeyCreated:"journeyCreated",settingsLoaded:"settingsLoaded"})},n.prototype.save=function(){var n=this;this.initializationPromise.finally(function(){n.getSettingCollections().forEach(function(t){n._services.settings.setSettings(t)})})},n.prototype.load=function(n,t,i){var r=this,h,e,o;n=n||{};var s=this._createCompositionServices(),u=t[ti],f=!1;u&&u.startBoardId&&t[u.startBoardId]?(h=t[u.startBoardId],f=!!(gi&&i),f&&(t=ru(t,this._sharedSettings)),this._startBoard=w.Instance.fromJSON(s,t,h)):(v.error("Unable to load StartBoard state from user settings, setting does not exist. Creating a default StartBoard."),
this._startBoard=w.create(s));this._savedJourneys=(u&&u.savedJourneyIds||[]).map(function(t){var i=n[t];if(i)try{i.ambientSettings=y.deserializeAmbientSettings(i.ambientSettings)}catch(r){v.error(r,0,"Unable to load state for saved Journey '{0}' from user settings.".format(t))}else v.verbose("Unable to load state for saved Journey '{0}' from user settings, setting does not exist.".format(t),0);return i}).filter(function(n){return n&&r.cachedJourneys.addOrUpdate(n.id,!0),!!n});this._trimSavedJourneys();this._removeOrphanedStartboardParts();this._view.composeStartBoard(this._startBoard);f||this._initDeferred.resolve();e=this._view.portalWidget.element;o=dt.fxshowstartboard;e.on(o,this._onShowStartBoard=function(){var n=r._startBoard.children.slice();n.forEach(function(n){r._displayPartOnStartBoardIfAvailable(n)});r._startBoard.discardWidgetStateOfUnusedChildren();r._startboardPartsLoadedDeferred.resolve();e.off(o,r._onShowStartBoard);r._loadingJourneyGuid=null});$(this).trigger(fr)},n.prototype.
_removeOrphanedStartboardParts=function(){var t={},n;this._savedJourneys.forEach(function(n){t[n.originPartId]=!0});n=this.startBoard;n.children.slice(0).forEach(function(i){i.dontSetupWidget&&!t[i.id]&&oi(n,i)})},Object.defineProperty(n.prototype,"startBoard",{get:function(){return this._startBoard},enumerable:!0,configurable:!0}),n.prototype.getActiveJourney=function(){return this._activeJourney},n.prototype.setActiveJourney=function(n){this.activeJourney(n);this._activeJourney=n;this.portalWidget.hasActiveJourney=!!n;n&&r.isFullscreen()&&r.exitFullscreen()},n.prototype.getJourneysMetadata=function(){var t=[],i,r=!1,u=function(n,t){return n.id===t.id||n.originPartId&&n.originPartId===t.originPartId},n=this._activeJourney;return n&&(i=n.toJSON()),this._savedJourneys.forEach(function(f){if(i&&!i.firstBladeInContextPane&&u(i,f))t.push(n),r=!0;else{var e=gr([]),o=f.bladeTitles;o&&o.forEach(function(n){var t={id:n.bladeId,title:et(n.bladeTitle),icon:et(),subtitle:et("")};e.push(t)});e().length&&
(e().first().openInContextPane=f.firstBladeInContextPane);t.push({id:f.id,journeyBlades:e,ambientSettings:f.ambientSettings,lastModifiedTime:et(f.lastModifiedTime)})}}),n&&!r&&t.push(n),t},n.prototype.populateJourneysInJourneysMenu=function(){var n=this._activeJourney,t=this.getJourneysMetadata().filter(function(t){var r=n&&n.id===t.id,i=t.journeyBlades().first();return i&&!i.openInContextPane&&!r}).sort(function(n,t){return t.lastModifiedTime()-n.lastModifiedTime()});this.portalWidget.getTopBarWidget().options.journeysMenu.journeysMetadata(t)},n.prototype.getJourneysJson=function(){var u=this,i=this._savedJourneys.slice(0),t,r,n=this._activeJourney;return n&&!n.isStartedWithContextBlade()&&(n.originTile&&n.originTile.partState&&n.originTile.getViewModel()!==p.EmptyViewModel&&(n.originPartStateWhenActive=ko.toJS(n.originTile.partState)),t=n.toJSON(),r=i.firstIndex(function(n){var i=n.id;return i===t.id?!0:n.originPartId===t.originPartId?(u.cachedJourneys.remove(i),u._deleteJourneySettings(
i),!0):!1}),r>=0?i[r]=t:i.push(t)),i},n.prototype.getSavedJourneys=function(){return this._savedJourneys},n.prototype.setSavedJourneys=function(n){this._savedJourneys=n},n.prototype.generateLoadingJourneyGuid=function(){return this._loadingJourneyGuid=st.getUniqueId(),this._loadingJourneyGuid},n.prototype.tryDeactivateJourney=function(n){var t=this._activeJourney,i,r;return t?(i=t.id,r=tt.startTrace({source:ft,action:ht.JourneyDeactivated,name:lt(t.originTile)}),this._savedJourneys=this.getJourneysJson(),t.save(),this._closeActiveJourney(!0),this.cachedJourneys.addOrUpdate(i,!0),this._trimSavedJourneys(),this.save(),$(this).trigger(ir),tt.completeTrace(r)):this._startBoard&&(this._startBoard.detailContainers=[]),this._loadingJourneyGuid=n||null,!0},n.prototype.tryDiscardJourney=function(n){var t=!1;return(this._canDiscardJourney(n)||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(this.forceDiscardJourney(n),t=!0),t},n.prototype._triggerActiveJourneyChanged=function(){var n=
this._activeJourney,t=n?JSON.stringify(n):"";this._previousActiveJourney!==t&&($(this).trigger(it.activeJourneyChanged),this._previousActiveJourney=t)},n.prototype._trimSavedJourneys=function(){var t=this,n;this.cachedJourneys.trim(this.cachedJourneysCapacity);n=this._savedJourneys;n.length>this.cachedJourneysCapacity&&n.filter(function(n){return!t.cachedJourneys.contains(n.id)}).forEach(function(n){return t.forceDiscardJourney(n.id)})},n.prototype._canDiscardJourney=function(n){var t=this.getJourneysMetadata().first(function(t){return t.id===n}),i=t&&t.ambientSettings.getItems().some(function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving&&t.disposeOnJourneyDiscard});return!t||!i},n.prototype.forceDiscardJourney=function(n){var r=this._savedJourneys,t=r.first(function(t){return t.id===n}),u=!1,f,i,e;this.cachedJourneys.remove(n);this._deleteJourneySettings(n);t&&(f=r.indexOf(t),r.splice(f,1),u=!0,this._activeJourney&&this._activeJourney.id===n||(i=t.originPartId&&this.
startBoard.getChildById(t.originPartId),e=t.ambientSettings.getItems().reduce(function(n,t){var i=t.value,r=i&&i.editScope;return r&&n.push(r),n},[]),this._disposeEditScopes(e),i&&i.dontSetupWidget&&this.removeTile(i.id)));this._activeJourney&&this._activeJourney.id===n&&(this.isJourneyLoading||this.portalWidget.showStartBoard(),this._closeActiveJourney(),u=!0);u&&(this._triggerActiveJourneyChanged(),this.save(),$(this).trigger(ur))},n.prototype._deleteJourneySettings=function(n){this._sharedSettings.deleteSettings({store:ct.JourneySession,keys:[n]})},n.prototype._disposeEditScopes=function(n){var t=this;(n||[]).forEach(function(n){if(n.disposeOnJourneyDiscard)t._services.editScopeManager.onEditScopeDisposed(n.editScopeId)})},n.prototype.activateJourney=function(n){var i=this,h=this._savedJourneys.first(function(t){return t.id===n}),t=ut.Deferred(),f,e,u=this.generateLoadingJourneyGuid(),s=function(){i._journeySettingsPromise=f=i._services.settings.querySettings({store:ii});f.then(function(
r){i._loadingJourneyGuid!==u?t.reject("Another journey started loading. Aborted loading journey '{0}'".format(n)):i._journeySettingsPromise!==f?t.reject("Aborted retrieval of settings for journey '{0}'.".format(n)):i._activateJourneyFromSettings(n,r,u).then(function(r){i._loadingJourneyGuid!==u?t.reject("Another journey started loading. Aborted loading journey '{0}'".format(n)):t.resolve(r)}).catch(function(n){t.reject(n)})})},r,o;return t.promise().finally(function(){i._loadingJourneyGuid===u&&(i._loadingJourneyGuid=null)}),r=this._activeJourney,o=r&&r.id,r&&o===n?(t.resolve(r),r.isStartedWithContextBlade()||this.portalWidget.showJourney()):h?r&&r.isStartedWithContextBlade()?this.tryDiscardJourney(o)?s():t.reject("Unable to discard current journey."):this.tryDeactivateJourney(u)?s():t.reject("Unable to deactivate current journey."):(e="Unable to activate journey '{0}', not found in saved journeys.".format(n),v.error(e),t.reject(e)),t.promise()},n.prototype._activateJourneyFromSettings=
function(n,t,i){var r=this,o=this._createCompositionServices(),e=t&&t[n],u=ut.Deferred(),f,s,h;return e?(s=tt.startTrace({source:ft,action:ht.JourneyRehydrated,name:e.originPartId}),h=o.getService(fi),wt(er).then(function(c){return h.then(function(h){var a,l;r.setActiveJourney(c.Instance.fromJSON(o,h,t,e,r._startBoard));r._activeJourney?($(r).trigger(it.journeyActivating),r._view.composeJourney(r._activeJourney),a=r._activeJourney.children.slice(),a.forEach(function(n,t){var i=t===r._activeJourney.children.length-1;r._view.addBlade(n,{assetType:undefined,focus:i}).catch(function(n){v.error(n)})}),l=r._activeJourney.originTile,l&&(r._displayPartOnStartBoardIfAvailable(l),l.notifyDetailBladesRehydrated(r._activeJourney.blades),l.awaitComposed().done(function(){if(r._loadingJourneyGuid===i||r._activeJourney&&r._activeJourney.id===n){var t=e.originPartStateWhenActive;yi.isSerializedObject(t)&&(t=yi.fromSerializableObject(t));l.loadState(t)}})),r._triggerActiveJourneyChanged(),r.save(),u.resolve(
r._activeJourney),$(r).trigger(rr)):(f="Unable to activate journey '{0}', deserialization of journey settings failed.".format(n),v.error(f),u.reject(f));tt.completeTrace(s)})}).catch(function(n){u.reject(n)})):(f="Unable to activate journey '{0}', settings for this journey are not found in user settings.".format(n),v.error(f),u.reject(f)),u.fail(function(){r.forceDiscardJourney(n)}),u.promise()},n.prototype.toJSON=function(){var n={startBoardId:this._startBoard?this._startBoard.id:null,savedJourneyIds:(this._savedJourneys||[]).map(function(n){return n.id})},i=this._activeJourney,t=i&&i.id;return t&&n.savedJourneyIds.indexOf(t)<0&&n.savedJourneyIds.push(t),n},n.prototype._addStartBoardPartsFromManifest=function(n,t){var r=this,i=n.startBoardParts,u=tr(n.name,n.cloudName);t||(t=i.map(function(n){return n.name}));i&&i.length&&t.forEach(function(n){var t=i.first(function(t){return t.name===n}),f;t&&(f=u.withStartboardPartInstance(t.name),r.addPartToStartBoard({originPartLocator:f,initialSize:
t.initialSize}))})},n.prototype._createCompositionServices=function(n){var t=$.extend({},this._services);return t.finder=n||new yt(this._services.extensionManager),t.desktop=this,t.sharedSettings=this._sharedSettings,t},n.prototype._findPartContainer=function(n){var t,i=this._startBoard;if(i&&i.id===n)t=i;else if(this._activeJourney)t=this._findFirstItem(this._activeJourney.children,n,rt.noBladeInJourney.format(n));else throw new Error(rt.noActiveJourney);return t},n.prototype._openBlade=function(n,t,i){var f=this,u=this._findPartContainer(n),c=u instanceof w.Instance,e=ut.Deferred(),r,o,l=this._createCompositionServices(),s,h;return u?((u.detailContainers||[]).forEach(function(n,u){n.locator.equals(t.locator)&&n.masterPartId===t.masterPartId&&n.masterInvocationProperty===t.masterInvocationProperty&&i(n,u)&&(r=n,e.resolve(r))}),r?(h=r.containerWidget,h&&h.setFocus(),d.isTraceEnabled&&v.verbose("[DesktopManager] Found a previously opened detail blade."+"\n  Existing blade: {0}. Model: {1}.".
format(r.toString(),ko.toJSON(r.getInputsOnlyViewModel()))+"\n  Requested Descriptor: {0}.".format(ko.toJSON(t)))):($(this).trigger(it.bladeOpening,{masterContainerId:n,bladeDescriptor:t}),s=function(){if(c&&u.detailContainers.length===0)f.createJourney(t.masterPartId,t).finally(function(n){n&&n.children&&n.children.length>0?e.resolve(n.children[0]):e.reject()});else{var n=l.getService(fi);wt(or).then(function(i){return n.then(function(n){r=i.create(l,n,t,u);u.detailContainers.unshift(r);u.onDetailContainersChanged();o=c?0:1+f._findFirstItemIndex(f._activeJourney.children,u.id,rt.noBladeInJourney.format(u.id));f._activeJourney.addChild(r,o);f._view.addBlade(r,{assetType:t.originAssetType,alignToStart:t.masterDetailsDefinition&&t.masterDetailsDefinition.asSubJourney,index:o,reusableWidget:t.reusableWidget,focus:!t.reusableWidget}).catch(function(n){v.error(n)});f._triggerActiveJourneyChanged();f.save();e.resolve(r)})}).catch(function(n){e.reject(n)})}},this._createNewJourneyPromise?this.
_createNewJourneyPromise.always(function(){s()}):s())):e.reject(),e.promise()},n.prototype._canCloseBladeRecursive=function(n){var i=this._activeJourney.ambientSettings,t=function(n){if(n.isInitialized&&i.getItemsInPath(n.journeyPath).some(function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving}))return!0;var r=n.detailContainers;return r&&r.length!==0?(r||[]).some(function(n){return t(n)}):!1};return!t(n)},n.prototype._closeBladeRecursive=function(n,t,i){this._removeBladesFromUIRecursive(n);this._disposeBladesRecursive(n,t,i);i||n.parent.save()},n.prototype._removeBladesFromUIRecursive=function(n){for(var i=n.detailContainers,t=i.length-1;t>=0;t--)this._removeBladesFromUIRecursive(i[t]);this._view.removeBlade(n)},n.prototype._disposeBladesRecursive=function(n,t,i){var f=this,r=n.parent,u=r.children.indexOf(n,t);i?n.dispose(!0):r.removeChildAt(u,undefined);n.detailContainers.forEach(function(n){f._disposeBladesRecursive(n,u,i)})},n.prototype._closeActiveJourney=function(
n){var i=this,t=this._activeJourney;this.setActiveJourney(null);this._startBoard.detailContainers=[];t&&(t.children.slice(0).forEach(function(t){t.isDisposed()||i._closeBladeRecursive(t,0,n)}),t.originTile&&t.originTile.dontSetupWidget&&!n&&this.removeTile(t.originTile.id),t.dispose(n));this._view.removeAllBlades(function(n){v.error("DesktopManager: Found un-tracked blade '{0}' in view after closing active journey. It will be forcefully removed.".format(n))})},n.prototype._findFirstItem=function(n,t,i){var r=this._findFirstItemIndex(n,t,i);return n[r]},n.prototype._findFirstItemIndex=function(n,t,i){var r=n.firstIndex(function(n){return n.id===t});if(r===-1){v.verbose(ko.toJSON(this.getDiagnosticsData(),null,2));throw new Error(i);}return r},n.prototype.pinPartComposition=function(n){n.save();this._startBoard.addChild(n);this._view.addPartToStartBoard(n);this.save()},n.prototype._isStartBoardPartLoaded=function(n,t){return typeof t=="boolean"?this._loadedStartBoardPartIds[n]=t:!!this._loadedStartBoardPartIds[
n]},n.prototype._displayPartOnStartBoardIfAvailable=function(n){var r=this;if(!this._isStartBoardPartLoaded(n.id)){this._isStartBoardPartLoaded(n.id,!0);var t=n.locator,i=t.getExtensionLocator(),u=function(t,i){if(v.warning(t.format(n)),i){var u=r._startBoard;oi(u,n);u.removeChildWidget(n.id)}},e=function(t,i){var f=!1;return t===0?(i||r._view.addPartToStartBoard(n),f=!0):t===1&&(u("[Definition Change] Part '{0}' is not working because it no longer exists in pre-loaded extension definition"),f=!0),f},o=function(i,f){(i.startBoardParts||[]).some(function(n){return n.name===t.name})?f||r._view.addPartToStartBoard(n):u("[Definition Change] Part '{0}' is not working because it no longer exists in force-loaded extension definition.")};this._extensionMetadataList.some(function(n){return vt.isEqualDescriptor(n,i)})?e(n.definitionExists(),n.isComposed||n.dontSetupWidget)||(this._view.addPartToStartBoard(n),t.type===at.StartboardPartInstance?this._services.extensionManager.getManifestByName(i.name,
i.cloudName).then(function(n){o(n,!0)}):this._services.extensionManager.getExtensionByName(i.name,i.cloudName).then(function(n){var r=f.PinPrefix,u=t.name,e,i;if(ri(u,r))return e=u.substr(r.length),n.getBladeDefinition(e);for(i=t;i;i=i.parent)if(i.type===at.Blade)return n.getBladeDefinition(i.name);if(t.type===at.PartType)return n.getPartDefinition(t.name)}).then(function(){e(n.definitionExists(!0),!0)})):u("[Definition Change] Part '{0}' will be removed because the extension it belongs to is no longer known by the portal.",!0)}},n.prototype.getDiagnosticsData=function(){var n=this._startBoard,t=this._activeJourney;return{startboard:n&&n.getDiagnosticsData(),activeJourney:t&&t.getDiagnosticsData()}},n.prototype.getAssetDiagnosticsData=function(){var n=this._activeJourney;return n?ei().then(function(t){return t.dumpCompositionAssets(n)}):Q.resolve("No journey")},n.prototype._setupOrganizeModeComponents=function(n){var t=this,i=this._lifetime,r=i.createChildLifetime(),u=this.mode.subscribe(
r,function(u){u===1&&vr.loadAsync(n.dragDrop).then(function(n){n.create(i,t,t.portalWidget.element);r.dispose()})})},n}();t.DesktopManagerImpl=si}(tt||(tt={})),tt});define("MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop",["require","exports","f","../Interactions/Interactions.DismissHandler","../Widgets/Widgets.WidgetBase","../Widgets/Widgets.FlowLayout","../Widgets/Widgets.UIElementBase"],function(n,t,i,r,u,f,e){"use strict";var o;return function(n){function at(n,i){var e=n.target,u=h(e),a;o&&o.htmlTarget!==e||(o={htmlTarget:e,elementObject:u,width:u.outerWidth(!1),height:u.outerHeight(!1)},o&&o.htmlTarget!==e)||(c=v=t=d(u.closest(nt),f.Widget),l.appendTo(u.parent()),a=l.parent(),i.helper.css({position:"fixed",top:i.offset.top,left:i.offset.left,marginTop:0-a.scrollTop(),marginLeft:0-a.scrollLeft(),pointerEvents:"none"}),u.hide(),w=s=k(i.helper),r.register(ft,!0))}function vt(n,i){var u=o.elementObject,f=u.draggable("option","revert");r.unregister(ft);f&&u.draggable({revert:
!1});tt();f?ot():et(i.helper);u.show();t?t===v?kt(i.helper):dt(i.helper):bt();l.remove();st()}function yt(){o.elementObject.draggable({revert:!0}).trigger(p.mouseup)}function pt(n,i){var r;(et(i.helper),t)&&(r=k(i.helper),r.col!==s.col||r.row!==s.row)&&(tt(),s=r,(c!==t||t.dropPlaceholder===null)&&(c&&c.disposeDropPlaceholder(),t.createDropPlaceholder(o.width,o.height),c=t),t.moveDropPlaceholder(r),y=it.setTimeout(function(){y=null;o.elementObject.show();t.moveChild(o.elementObject,s.col,s.row,!1);o.elementObject.hide()},ct))}function tt(){y&&(it.clearTimeout(y),y=null)}function et(n){var i=wt(n);t&&t!==i&&ot();t=i}function ot(){t&&(tt(),t.refreshLayout(!0))}function wt(n){var t="z-index",i=n.offset(),r=l.parent(),o=r.scrollTop(),s=r.scrollLeft(),c=i.left-s+Math.floor(b*a.GridSpacingWidth),v=i.top-o+Math.floor(b*a.GridSpacingHeight),y=l.css(t),u,e;return l.css(t,-1),u=h(document.elementFromPoint(c,v)),l.css(t,y),e=u.closest(nt),d(e,f.Widget)}function k(n){var i=t.element,r=i.offset(),u=
n.offset(),f=u.left-r.left+i.scrollLeft(),e=u.top-r.top+i.scrollTop(),o=Math.floor((f+b*a.GridSpacingWidth)/a.GridSpacingWidth),s=Math.floor((e+b*a.GridSpacingHeight)/a.GridSpacingHeight);return{col:o,row:s}}function bt(){v.moveChild(o.elementObject,w.col,w.row,!0)}function kt(n){s=k(n);v.moveChild(o.elementObject,s.col,s.row,!0)}function dt(n){t.refreshLayout(!0);s=k(n);var i=e.Widget.getId,r=i(o.elementObject),u=v.element.closest(ut),f=t.element.closest(ut),h=i(u),c=i(f);t.element.trigger(p.fxrearrange,{partId:r,sourceId:h,targetId:c,col:s.col,row:s.row})}function st(){c&&c.disposeDropPlaceholder();v=null;t=null;w=null;s=null;c=null;o=null}function ht(){var t=h(nt),n=[];return t.each(function(t,i){var r=d(h(i),f.Widget),u=r.options;u.allowReorder&&!u.locked()&&n.push(r.element.findByClassName("fxs-flowlayout-childcontainer"))}),n}var p=i.Base.EventTypes,a=i.Widgets.AzureGrid,it=window,h=jQuery,d=u.Widget.getWidget,rt="fxs-drag-disableTouchAction",g=".fxs-tile:not(.fxs-tilesize-herowidefitheight):not(.fxs-tilesize-fullwidthfitheight):not(.fxs-tilesize-fittocontainer)",
nt=".fxs-flowlayout",ut=".fxs-lens",ft={dismissFn:function(){yt()},shouldDismissOnMouseDownFn:h.noop,shouldDismissOnMouseWheelFn:h.noop,logName:"flowlayoutdragdrop"},o,v,t,c,w,s,y,ct=250,b=.33,l=h("<div class='fxs-drag-surface'><\/div>"),lt={start:at,drag:pt,stop:vt,cursor:"move",helper:"clone",appendTo:l,opacity:.65,distance:3,cancel:"input,textarea,button,select,option,.fxs-tile-actionbar-contextmenu"},gt=function(){function n(){if(n._singleton)throw new Error("FlowLayoutDragDrop operates as a singleton.");n._singleton=this}return n.prototype.dispose=function(){this.disableDragDropTargets();st();n._singleton=null},Object.defineProperty(n,"Instance",{get:function(){return n._singleton||(n._singleton=new n),n._singleton},enumerable:!0,configurable:!0}),n.prototype.enableDragDropOnSingleTarget=function(n){n.draggable("instance")||n.filter(g).addClass(rt).draggable(lt)},n.prototype.enableDragDropTargets=function(){var n=this;ht().forEach(function(t){t.on(p.mouseenter,g,function(t){var i=
h(t.currentTarget);if(i.draggable("instance")){i.draggable("option","handle",!1);return}n.enableDragDropOnSingleTarget(i)})})},n.prototype.disableDragDropTargets=function(){ht().forEach(function(n){n.off(p.mouseenter,g)});h(".ui-draggable:not(.ui-draggable-dragging)").removeClass(rt).draggable("destroy")},n}();n.FlowLayoutDragDrop=gt}(o||(o={})),o});define("_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css",["require","exports","module"],function(n,t,i){"use strict";var r;return function(){window.fx.injectCss(i,'.fxs-desktop-organize .fxs-bladeActionBar::after{display:block;background-color:rgba(14,18,37,.65)}.fxs-desktop-organize .fxs-tile .fxs-tile-content{z-index:0}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay{display:block;-ms-touch-action:none;touch-action:none}.fxs-desktop-normal .fxs-hide-in-normal,.fxs-desktop-normal .fxs-portal-contextpane-left,.fxs-desktop-organize .fxs-contextpane .fxs-bladeActionBar::after,.fxs-desktop-organize .fxs-contextpane .fxs-tile .fxs-tile-overlay,.fxs-desktop-organize .fxs-sidebar,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-actions,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-dropdown,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-migration{display:none}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay:hover{border-width:1px;border-style:solid;box-sizing:border-box}.fxs-desktop-organize .fxs-tile.fxs-tilesize-hero.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herotall.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herowide.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-large.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-mini.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-normal.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-small.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-tall.fxs-tile-selected .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-wide.fxs-tile-selected .fxs-tile-overlay{cursor:move}.fxs-desktop-organize .fxs-blade-locked .fxs-tile .fxs-tile-overlay:hover{border:none}.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-context .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-help .fxs-tile div.fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-blade-summary-container::after{content:"";position:absolute;left:0;right:0;top:0;bottom:0}.fxs-desktop-organize .fxs-hide-in-customize{visibility:hidden}.fxs-desktop-organize .fxs-startboard-layout>.fxs-flowlayout-childcontainer{min-height:2155px;min-width:3865px}.fxs-desktop-organize .fxc-hotspot-customclick{z-index:1}')}
(r||(r={})),r});define("MsPortalImpl/UI/UI.DesktopModeManager",["require","exports","f","../Base/Base.Events","MsPortalImpl/Base/Base.PartGallery","../Interactions/Interactions.DismissHandler","../Interactions/Interactions.FlowLayoutDragDrop","../Widgets/Widgets.WidgetBase","../Widgets/Widgets.Tile","../../_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css"],function(n,t,i,r,u,f,e,o,s){"use strict";var h;return function(n){function it(n,i,r){var f=n.desktop,u=new l(f,i,n,r),v=function(n){var t=h(n.target).closest(d);return o.Widget.getWidget(t,s.Widget)},p=i.element,a=tt?i.getPanorama().getStartBoardArea():i.element;p.on(t.fxexitorganizemode,function(){f.mode(0)});a.on(t.fxenterorganizemode,function(n){var t=v(n),i=t?0:1;u.startPartManagment({trigger:i});t&&(t.options.selected(!0),u.updateTileSelection(t),t.showTileManagementContextMenu())});a.on(t.click,k,function(n){var i=v(n),t=i&&i.options;t&&!t.locked()&&(t.selected(!t.selected()),u.updateTileSelection(i))});a.on(t.click,c,function(
n){if(f.mode()===1){var i=v(n),t=i&&i.options;!t||t.locked()||t.selected()||(t.selected(!0),u.updateTileSelection(i))}});a.on(t.mouseenter,c,function(n){var r,u,i;if(f.mode()!==1&&(r=v(n),u=r&&r.options,u&&!u.locked()&&!u.selected())){i=r.element;e.FlowLayoutDragDrop.Instance.enableDragDropOnSingleTarget(i);i.hasClass(y)&&i.draggable("option","handle",c);i.one(t.mouseleave,function(){f.mode()!==1&&e.FlowLayoutDragDrop.Instance.disableDragDropTargets()})}});a.on(t.dragstart,g,function(n){f.mode()!==1&&(f.mode(1),h(n.target).draggable("option","handle",!1));var t=v(n),i=t&&t.options;i&&!i.selected()&&(i.selected(!0),u.updateTileSelection(t))});a.on(t.fxaddparts,function(n,t){n.stopPropagation();t.expandTileGallery=!0;u.startPartManagment(t)});a.on(t.fxpartcreated,function(n,t){n.stopPropagation();var i=t.widget;i.options.selected(!0);u.updateTileSelection(i)});return u}var p=i.Base,t=p.EventTypes,w=MsPortalImpl.Resources.Images,b=window,h=jQuery,a=o.Widget.widgetRemoveEvent,k="."+s.overlayClassName,
d="."+s.widgetClassName,c="."+s.actionBarContainerClassName,v="fxs-desktop-normal",y="ui-draggable",g="."+y,nt="fxs-partgallery-container",tt=b.fx.environment.features.disablebladecustomization==="true",l;(function(){var t=w.getFlowLayout().gridShadow,i=".fxs-desktop-organize .fxs-flowlayout-childcontainer {"+("background: url("+t+");")+"}",n=document.createElement("style");n.setAttribute("type","text/css");n.appendChild(document.createTextNode(i));document.head.appendChild(n)})();n.organizeModeClassName="fxs-desktop-organize";n.createDesktopModeManager=it;l=function(){function t(n,t,i,r){var u=this;this._dismissHandle={dismissFn:function(){u._desktop.mode(0)},shouldDismissOnMouseDownFn:h.noop,shouldDismissOnMouseWheelFn:h.noop,logName:"desktopmodemanager"};this._desktop=n;this._portalWidget=t;this._services=i;this._lifetime=r;this._userSettingsManager=i.settings;this._contextPane=i.leftContextPane;this._partMgmtStarted=!1;this._selectedTile=null;this._handleModeChange(n,r)}return Object.
defineProperty(t.prototype,"selectedTile",{get:function(){return this._selectedTile},enumerable:!0,configurable:!0}),t.prototype.updateTileSelection=function(n){var t=this;if(this._deselectCurrentTile(),n.options.selected()&&(this._selectedTile=n),this._selectedTile)this._selectedTile.element.on(a,this._tileRemoveHandler=function(n){n.target===t._selectedTile.element[0]&&t._deselectCurrentTile()})},t.prototype.startPartManagment=function(n){var t=this,r;return this._partMgmtStarted?Q():(this._partMgmtStarted=!0,this._desktop.mode(1),r=this._contextPane,Q.all([i.require("MsPortalImpl/UI/UI.PartGalleryManager"),r.tryOpen(this)]).spread(function(i){var o=n&&n.assetId,f=t._partGalleryManager,e=t._partGallery;f?o&&f.load(u.PivotType.ResourceGroup,n):(f=t._partGalleryManager=i.createPartGalleryManager(t._lifetime.createChildLifetime(),t._services,e),f.load(u.PivotType.General,n));(n.trigger===1||n.trigger===2)&&e.setFocus();n.expandTileGallery&&r.collapsed(!1)}))},t.prototype.onAddingContent=
function(n){var t=this;return i.require("MsPortalImpl/Widgets/Widgets.PartGallery").then(function(i){t._partGallery||(t._partGallery=i.create(h("<div class='"+nt+"'><\/div>")),n.addChild(t._partGallery.element))})},t.prototype.onRemovingContent=function(){this._partMgmtStarted=!1},t.prototype.canRemoveContent=function(){return!0},t.prototype._enterOrganizeMode=function(){var i=this._portalWidget,r=i.element,t;return(r.addClass(n.organizeModeClassName),r.removeClass(v),t=i.getTopBarWidget(),t&&t.options.isInOrganizeMode(!0),f.register(this._dismissHandle),e.FlowLayoutDragDrop.Instance.enableDragDropTargets(),this._contextPane&&!this._partMgmtStarted)?this.startPartManagment({}):Q()},t.prototype._exitOrganizeMode=function(){var i=this._portalWidget,r=i.element,t;e.FlowLayoutDragDrop.Instance.disableDragDropTargets();r.removeClass(n.organizeModeClassName);r.addClass(v);t=i.getTopBarWidget();t&&t.options.isInOrganizeMode(!1);this._contextPane&&this._contextPane.close(!0);this._deselectCurrentTile(
);this._userSettingsManager.flushSettings();f.unregister(this._dismissHandle)},t.prototype._handleModeChange=function(n,t){var i=this;n.mode.subscribe(t,function(n){switch(n){case 1:i._services.getService("DialogManager").then(function(n){n.dismissOpenDialog()});i._enterOrganizeMode();r.isFullscreen()&&r.exitFullscreen();break;case 0:default:i._exitOrganizeMode()}})},t.prototype._deselectCurrentTile=function(){this._selectedTile&&(this._selectedTile.element.off(a,this._tileRemoveHandler),this._tileRemoveHandler=null,this._selectedTile.options.selected(!1),this._selectedTile=null)},t}();n.DesktopModeManagerImpl=l}(h||(h={})),h});define("MsPortalImpl/UI/Compositions/UI.Composition.Services",["require","exports","f","../../Base/Base.Router","../../Services/Services.AssetManagement","../../Services/Services.AssetTypes","../../Services/Services.Permissions","../../Base/Themes","../Hubs/UI.BrowseManager","../Commands/UI.CommandManager","../UI.ContextPane","../UI.DesktopManagerImpl","../UI.DesktopModeManager",
"../Hubs/UI.NotificationManager"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y;return function(t){function k(t,p,k,d,g,nt,tt){var ht=w.client,rt=p.extensionManager,ut=f.createAssetTypeService(rt),ct=u.createAssetManager(rt,p.settings,ut),et=e.createPermissionsManager(rt,ut),lt=s.createBrowseManager(rt,ut,et,d),ft=o.createManager(t,b,k["fxs-theme"]),ot=c.create(g.getRightContextPane(),t,ft),at=c.create(g.getLeftContextPane(),t,ft),vt=g.getNotificationMenuWidget().getToastWidget(),it={rpcClient:ht,storageService:p.storageService,themeManager:ft,redirect:nt,settings:p.settings,editScopeManager:p.editScopeManager,extensionManager:rt,extensionVersionCache:p.extensionVersionCache,hubsMetadata:p.hubsMetadata,openWindow:p.openWindow,assetManager:ct,permissionsManager:et,assetTypeService:ut,browseManager:lt,desktop:null,modeManager:null,portalFormTarget:null,contextPane:ot,leftContextPane:at,getService:null,router:null,notificationManager:null},st=it.desktop=l.createDesktopManager(g,
it),yt=it.getService=i.memoize(function(t){switch(t){case"DialogManager":return tt();case"ResourceMapManager":return y("../Hubs/UI.ResourceMapManager",n).then(function(n){return n.createResourceMapManager(rt,ut)});case"BladePairManager":return y("./UI.Composition.BladePair",n).then(function(n){return n.createBladePairManager()});case"FeedbackPane":return y("../../Widgets/Widgets.FeedbackPane",n).then(function(n){return{amdModule:n,widget:new n.FeedbackPane(ot,vt,function(){return st.getCurrentBladeInfo()})}})}throw new Error("Invalid service type '{0}' specified.".format(t));}),pt=it.portalFormTarget=h.createCommandManager(it.desktop).startListeningForEvents();return it.notificationManager=v.createNotificationManager(it),it.router=r.createRouter(it),it.modeManager=a.createDesktopModeManager(it,g,t),t.registerForDispose([st,pt,it.router,yt,]),it}function d(){return y("MsPortalImpl/UI/UI.DialogManager")}var p=i.Base,w=p.Rpc.Internal,y=i.require,b=$("body");t.initialize=k;t.getDialogManagerModule=
d}(y||(y={})),y});define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager",["require","exports","f","./CodeComponentSideLoadModels","MsPortalImpl/Resources/ImplScriptResources","../Services/Services.Settings","../Services/Services.Storage","../UI/Compositions/UI.Composition.Services"],function(n,t,i,r,u,f,e,o){"use strict";var s;return function(t){var v=i.Base,y=v.Diagnostics,a=i.ViewModels.Dialogs,p=a.DialogResult,w=a.MessageBoxButtons,b=f.SettingStore,k=jQuery,h=y.createLog(n),s=u.Shell.Dialogs,c=b.General,l=e.Lifetime.Session,d=function(){function n(n,t,i,r,u,f,e,o,s,h,c,l){this._temporaryTestCodeComponents=[];this._trustedCodeComponents=n;this._normalizeCodeComponents(this._trustedCodeComponents);this._settingsManager=t;this._storageService=i;this._getDialogManager=r;this._dialogContainer=u;this._canModifyCodeComponents=f;this._acceptWithoutPrompt=e;this._storageServiceKey=o;this._hashQueryStringKey=s;this._createFunction=h;this._componentType=c;this._settingsKey=l}
return n.prototype.getCodeComponentsMetadata=function(){var n=this,t=null,i=null;return Q().then(function(){var i=JSON.parse(JSON.stringify(n._trustedCodeComponents));return t=i.map(function(t){return n._createFunction(t)}),n.loadFromServer(t)}).then(function(i){return i.length>0&&n._merge(t,i),t},function(){return t}).then(function(t){return i=t,n._loadUntrustedCodeComponentsIfAllowed()}).then(function(t){if(t.length>0){var r=function(n){n.logUsageWarning()};n._merge(i,t,r)}return i}).then(function(n){return n.filter(function(n){return n.isValid()})})},n.prototype.loadFromServer=function(){throw new Error("This is an abstract method that must be overridden by all subclasses.");},n.prototype.listTestCodeComponents=function(){var t=this,n=this._temporaryTestCodeComponents.slice(0);return this._settingsManager.querySetting(c,this._settingsKey).then(function(i){return i=i&&i.map(function(n){return t._createFunction(n)}),Array.isArray(i)&&(n=n.concatUnique(i,function(n,t){return n.isEqual(
t)})),n.filter(function(n){return n.isValid()})}).then(null,function(n){return h.error("Error listing code components",r.ErrorCodes.ListCodeComponentsFailed,n),[]})},n.prototype.registerTestCodeComponent=function(n,t){var i=this;return n.isValid()?t?(this._addOrUpdateCodeComponent(this._temporaryTestCodeComponents,n),Q.resolve(null)):this.listTestCodeComponents().then(function(t){return i._addOrUpdateCodeComponent(t,n),i._settingsManager.setSetting(c,i._settingsKey,t),i._settingsManager.flushSettings()}).catch(function(t){h.error("Error registering code component",r.ErrorCodes.RegisterCodeComponentFailed,{codeComponent:n,error:t})}):Q.reject()},n.prototype.unregisterTestCodeComponent=function(n){var t=this;return this._removeCodeComponent(this._temporaryTestCodeComponents,n),this.listTestCodeComponents().then(function(i){if(t._removeCodeComponent(i,n))return t._settingsManager.setSetting(c,t._settingsKey,i),t._settingsManager.flushSettings()}).catch(function(n){h.error("Error unregistering code component.",
r.ErrorCodes.UnregisterCodeComponentFailed,{name:name,error:n})})},n.prototype.unregisterAll=function(){return this.clearTemporaryTestCodeComponents(),this._settingsManager.deleteSettings({store:c,keys:[this._settingsKey]}),this._settingsManager.flushSettings().catch(function(n){h.error("Error registering all code components",r.ErrorCodes.UnregisterAllCodeComponentsFailed,n)})},n.prototype.clearTemporaryTestCodeComponents=function(){this._temporaryTestCodeComponents.splice(0,this._temporaryTestCodeComponents.length)},n.prototype._loadUntrustedCodeComponentsIfAllowed=function(){var n=this;return this._canModifyCodeComponents?this.listTestCodeComponents().then(function(t){return t.length===0?(n._canModifyCodeComponents&&h.verbose("No untrusted code components were found. Will load the portal in normal mode.",r.ErrorCodes.NoModifiedCodeComponentsFound),[]):n.prompt().then(function(i){return i?(t.forEach(function(t){n._componentType===r.SideLoadComponentTypeEnum.Extension&&t.markAsTestExtension(
)}),t):[]})}):Q([])},n.prototype.prompt=function(){var h=this,i=e.ComponentName.ExtensionManager,u=this._storageServiceKey,f=this._storageService,c=f.getValue(i,u,l),n,t;if(c||this._acceptWithoutPrompt)return Q(!0);n=null;t=null;switch(this._componentType){case r.SideLoadComponentTypeEnum.Extension:n=s.untrustedExtensionsTitle;t=s.untrustedExtensionsDescriptionFmt.format(s.loadOnlySafeExtensionsButtonText);break;case r.SideLoadComponentTypeEnum.GalleryPackage:n=s.untrustedGalleryPackageTitle;t=s.untrustedGalleryPackageDescriptionFmt.format(s.loadOnlySafeExtensionsButtonText);break;default:throw new Error("This componentType is not supported");}return o.getDialogManagerModule().then(function(r){var e=k("<div />"),o=new r.MessageBox(n,t,w.OKCancel);return h._dialogContainer.prepend(e),o.defaultButtonText=s.loadOnlySafeExtensionsButtonText,o.cancelButtonText=s.loadUnsafeExtensionsButtonText,h._getDialogManager().then(function(n){return n.showDialog(e,o,null).then(function(t){var r=t===p.Cancel;
return n.dismissOpenDialog(),e.remove(),r?f.setValue(i,u,"true",l):f.clearValue(i,u,l),r})})})},n.prototype._registerTestCodeComponentFromUri=function(n){return n.isValid()?this.registerTestCodeComponent(n,!0):null},n.prototype._removeCodeComponent=function(n,t){this._componentType===r.SideLoadComponentTypeEnum.Extension&&t.normalizeCloudName();var i=-1;return i=n.firstIndex(function(n){return n.isEqual(t)}),i>=0?(n.splice(i,1),!0):!1},n.prototype._normalizeCodeComponents=function(n){var t=this;n.forEach(function(n){t._componentType===r.SideLoadComponentTypeEnum.Extension&&n.normalizeCloudName()})},n.prototype._merge=function(n,t,i){var r=this;n!==null&&t!==null&&t.forEach(function(t){i&&i(t);r._addOrUpdateCodeComponent(n,t)})},n.prototype._addOrUpdateCodeComponent=function(n,t){this._componentType===r.SideLoadComponentTypeEnum.Extension&&t.normalizeCloudName();var i=n.first(function(n){return n.isEqual(t)});i?i.updateWith(t):n.push(t)},n}();t.CodeComponentSideLoadManagerImpl=d}(s||(s=
{})),s});define("_generated/Less/MsPortalImpl/Base/Base.Images.css",["require","exports","module"],function(n,t,i){"use strict";var r;return function(){window.fx.injectCss(i,".msportalfx-svg-c01{fill:#fff}.msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-c03{fill:#a0a1a2}.msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-c08{fill:#ba141a}.msportalfx-svg-c09{fill:#dd5900}.msportalfx-svg-c10{fill:#ff8c00}.msportalfx-svg-c11{fill:#fcd116}.msportalfx-svg-c12{fill:#fee087}.msportalfx-svg-c13{fill:#b8d432}.msportalfx-svg-c14{fill:#7fba00}.msportalfx-svg-c15{fill:#59b4d9}.msportalfx-svg-c16{fill:#3999c6}.msportalfx-svg-c17{fill:#804998}.msportalfx-svg-c18{fill:#ec008c}.msportalfx-svg-c19{fill:#0072c6}.msportalfx-svg-c20{fill:#68217a}.msportalfx-svg-c21{fill:#00188f}.msportalfx-svg-c22{fill:#e81123}.msportalfx-svg-c97{fill:#ffb900}.msportalfx-svg-c98{fill:#00a4ef}.msportalfx-svg-c99{fill:#f25022}.fxs-sidebar-bar .msportalfx-svg-c05,.fxs-theme-dark .msportalfx-svg-c05,.msportalfx-inverted-theme .msportalfx-svg-c05{fill:#777}.fxs-sidebar-bar .msportalfx-svg-c07,.fxs-theme-dark .msportalfx-svg-c07,.msportalfx-inverted-theme .msportalfx-svg-c07{fill:#f2f2f2}.msportalfx-svg-palette-white>*,.msportalfx-svg-palette-white>g>*{fill:#fff}.msportalfx-svg-palette-blue>*,.msportalfx-svg-palette-blue>g>*{fill:#3999c6}.msportalfx-svg-palette-black>*,.msportalfx-svg-palette-black>g>*{fill:#1e1e1e}.msportalfx-svg-palette-green>*,.msportalfx-svg-palette-green>g>*{fill:#7fba00}.msportalfx-svg-palette-gray>*,.msportalfx-svg-palette-gray>g>*{fill:#a0a1a2}.msportalfx-svg-palette-inherit>*,.msportalfx-svg-palette-inherit>g>*{fill:inherit}.msportalfx-svg-badge{position:absolute;left:0;bottom:0;min-height:12px;min-width:12px}.msportalfx-svg-disabled .msportalfx-svg-c01,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c01{fill:#fff}.msportalfx-svg-disabled .msportalfx-svg-c02,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-disabled .msportalfx-svg-c03,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c03{fill:#a1a1a1}.msportalfx-svg-disabled .msportalfx-svg-c04,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-disabled .msportalfx-svg-c05,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-disabled .msportalfx-svg-c06,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-disabled .msportalfx-svg-c07,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-disabled .msportalfx-svg-c08,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c08{fill:#676767}.msportalfx-svg-disabled .msportalfx-svg-c09,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c09{fill:#6f6f6f}.msportalfx-svg-disabled .msportalfx-svg-c10,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c10{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c11,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c11{fill:#898989}.msportalfx-svg-disabled .msportalfx-svg-c12,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c12{fill:#c3c3c3}.msportalfx-svg-disabled .msportalfx-svg-c13,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c13{fill:#838383}.msportalfx-svg-disabled .msportalfx-svg-c14,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c14{fill:#5d5d5d}.msportalfx-svg-disabled .msportalfx-svg-c15,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c15{fill:#999}.msportalfx-svg-disabled .msportalfx-svg-c16,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c16{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c17,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c17{fill:#717171}.msportalfx-svg-disabled .msportalfx-svg-c18,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c18{fill:#767676}.msportalfx-svg-disabled .msportalfx-svg-c19,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c19{fill:#636363}.msportalfx-svg-disabled .msportalfx-svg-c20,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c20{fill:#4e4e4e}.msportalfx-svg-disabled .msportalfx-svg-c21,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c21{fill:#484848}.msportalfx-svg-disabled .msportalfx-svg-c22,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c22{fill:#7d7d7d}.msportalfx-svg-disabled .msportalfx-svg-c97,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c97{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c98,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c98{fill:#787878}.msportalfx-svg-disabled .msportalfx-svg-c99,.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c99{fill:#8a8a8a}.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c02,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c03,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c04,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c05,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c06,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c07,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c08,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c09,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c10,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c11,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c12,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c13,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c14,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c15,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c16,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c17,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c18,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c19,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c20,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c21,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c22,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c97,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c98,.msportalfx-svg-palette-gray.msportalfx-svg-disabled-until-hover svg:not(:hover) .msportalfx-svg-c99{fill:#a0a1a2}.msportalfx-svg-loading-ellipsis-square rect{-webkit-animation:ProgressFlagAnimation 1.45s infinite ease-in-out;animation:ProgressFlagAnimation 1.45s infinite ease-in-out}.msportalfx-svg-loading-ellipsis-square rect:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.msportalfx-svg-loading-ellipsis-square rect:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.msportalfx-svg-loading-ellipsis-square rect:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}@keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}.msportalfx-svg-flip-horizontal>svg,svg.msportalfx-svg-flip-horizontal{transform:scalex(-1)}.msportalfx-svg-rotate360{-webkit-animation:ImageRotation 1.45s infinite linear;animation:ImageRotation 1.45s infinite linear}@-webkit-keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}")}
(r||(r={})),r});define("_generated/Less/MsPortalImpl/Widgets/HighContrastMode.css",["require","exports","module"],function(n,t,i){"use strict";var r;return function(){window.fx.injectCss(i,"@media screen and (-ms-high-contrast:active){.azc-balloon-content,.azc-slider-marker,.azc-slider-slider,.fxc-actionbarbase-button,.fxs-avatarmenu-dropdown,.fxs-avatarmenu-header,.fxs-blade,.fxs-commandBar-item,.fxs-contextpane.fxs-contextpane-visible,.fxs-hubpane,.fxs-navbar,.fxs-part,.fxs-progress div,.fxs-splashscreen-loader-container div,.fxs-tile-actionbar-action,.fxs-tile-actionbar-actionlist,.fxs-tile-progress-transparent div{border:1px solid}svg,text{fill:#fff!important}.azc-br-focused,.azc-filterCombo-focus,.azc-input:focus{outline:solid 2px}.fxs-blade-locked .fxs-part{border:none}.fxs-tile-overlay{background:0 0}.azc-noRadio li.azc-itemlist-selected{border:4px solid;box-sizing:border-box}tr:not(.azc-grid-groupheader):hover td{border-top:4px solid;border-bottom:4px solid;border-collapse:collapse}}@media screen and (-ms-high-contrast:black-on-white){svg,text{fill:#000!important}}@media screen and (-ms-high-contrast:white-on-black){svg,text{fill:#fff!important}}")}
(r||(r={})),r});define("_generated/Less/MsPortalImpl/Themes/Themes.Universal.css",["require","exports","module"],function(n,t,i){"use strict";var r;return function(){window.fx.injectCss(i,".fxs-bg-white{background-color:#fff}.fxs-button-default{background:#acacac;border-color:#acacac;color:#fff}.fxs-button-default:hover:after{border-color:#949494}.fxs-button-default:focus:after{border-color:#eee}.fxs-button-default:active{background-color:#868686;border-color:#868686;outline-color:#868686}.fxs-button-primary{background:#00bcf2;border-color:#00bcf2;color:#fff}.fxs-button-primary:hover:after{border-color:#00a0ce}.fxs-button-primary:focus:after{border-color:#ccf2fc}.fxs-button-primary:active{background-color:#00a0ce;border-color:#00a0ce;outline-color:#00a0ce}.fxs-button-disabled{background:#e4e4e4;border-color:#e4e4e4;color:#b3b3b3}.fxs-button-disabled:active{background-color:#e4e4e4;border-color:#e4e4e4;outline-color:#e4e4e4}.fxs-overlay{background:rgba(0,0,0,.7)}.fxs-highlight{color:#000;background-color:#fff100}.fxs-tile-actionbar{background-color:#9cd5f4}.fxs-tile-actionbar .fxs-tile-actionbar-action svg{fill:#fff}.fxs-tile-actionbar-action.fxs-tile-actionbar-action-pressed,.fxs-tile-actionbar-action:hover{background:#00bcf2}.fxs-tile-actionbar-action.fxs-tile-actionbar-command-unpinfromstartboard:hover{background:#ba141a}.fxs-portal .fxs-accent,.fxs-portal .fxs-popup{box-shadow:0 10px 20px -5px rgba(58,58,58,.25)}.fxs-portal .fxs-text-info{color:#0072c6}.fxs-portal .fxs-text-success{color:#7fba00}.fxs-portal .fxs-text-dirty{color:#9b4f96}.fxs-portal .fxs-text-error,.fxs-portal .fxs-text-invalid{color:#e81123}.fxs-portal .fxs-text-warning{color:#ff8c00}.fxs-portal .fxs-br-success{border-color:#7fba00}.fxs-portal .fxs-br-dirty{border-color:#9b4f96}.fxs-portal .fxs-br-error{border-color:#e81123}.fxs-portal .fxs-br-warning{border-color:#ff8c00}.fxs-portal .fxs-br-info{border-color:#0072c6}.fxs-portal .fxs-fill-info svg{fill:#0072c6}.fxs-portal .fxs-fill-success svg{fill:#7fba00}.fxs-portal .fxs-fill-dirty svg{fill:#9b4f96}.fxs-portal .fxs-fill-error svg,.fxs-portal .fxs-fill-invalid svg{fill:#e81123}.fxs-portal .fxs-fill-warning svg{fill:#ff8c00}.fxs-portal .fxs-portal-main .fxs-br-dirty{border-color:#9b4f96}.fxs-portal .fxs-portal-main .fxs-br-error{border-color:#e81123}.fxs-portal .fxs-portal-main .fxs-bg-error{background-color:#e81123}.fxs-portal .fxs-portal-main .fxs-bg-dirty{background-color:#9b4f96}.fxs-portal .fxs-portal-main .azc-is-edited .azc-dockedballoon-validation{border-color:#9b4f96}.fxs-portal .fxs-portal-main .azc-has-focus .azc-dockedballoon-validation,.fxs-portal .msportalfx-br-info{border-color:#0072c6}.fxs-portal .fxs-portal-main .fxs-bg-info,.fxs-portal .fxs-portal-main .fxs-bg-info:hover{background-color:#0072c6}.fxs-portal .fxs-portal-main .fxs-bg-success,.fxs-portal .fxs-portal-main .fxs-bg-sucess:hover{background-color:#7fba00}.fxs-portal .fxs-portal-main .fxs-bg-dirty,.fxs-portal .fxs-portal-main .fxs-bg-dirty:hover,.fxs-portal .fxs-portal-main .fxs-bg-upsell,.fxs-portal .fxs-portal-main .fxs-bg-upsell:hover{background-color:#9b4f96}.fxs-portal .fxs-portal-main .fxs-bg-error,.fxs-portal .fxs-portal-main .fxs-bg-error:hover{background-color:#e81123}.fxs-portal .fxs-portal-main .fxs-bg-warning,.fxs-portal .fxs-portal-main .fxs-bg-warning:hover{background-color:#ff8c00}.fxs-portal .fxs-dirty-before::before{background-color:#9b4f96}.fxs-portal .fxs-bg-error-before::before{background-color:#e81123}.fxs-portal .fxs-bladestyle-create .msportalfx-form .fxs-dirty-before::before{background-color:transparent}.fxs-portal .fxs-bladestyle-create .msportalfx-form .fxs-bg-dirty{background-color:#00bcf2}.fxs-portal .fxs-bladestyle-create .msportalfx-form .fxs-bg-error-before::before{background-color:#e81123}.fxs-portal .msportalfx-bg-info{background-color:#0072c6}.fxs-portal .msportalfx-bg-success{background-color:#7fba00}.fxs-portal .msportalfx-bg-dirty{background-color:#9b4f96}.fxs-portal .msportalfx-bg-error{background-color:#e81123}.fxs-portal .msportalfx-bg-warning{background-color:#ff8c00}.fxs-portal .msportalfx-text-info{color:#0072c6}.fxs-portal .msportalfx-text-success{color:#7fba00}.fxs-portal .msportalfx-text-dirty{color:#9b4f96}.fxs-portal .msportalfx-text-error{color:#e81123}.fxs-portal .msportalfx-text-warning{color:#ff8c00}.fxs-portal .msportalfx-br-success{border-color:#7fba00}.fxs-portal .msportalfx-br-dirty{border-color:#9b4f96}.fxs-portal .msportalfx-br-error{border-color:#e81123}.fxs-portal .msportalfx-br-warning{border-color:#ff8c00}.fxs-portal .msportalfx-fill-info{fill:#0072c6}.fxs-portal .msportalfx-fill-success{fill:#7fba00}.fxs-portal .msportalfx-fill-dirty{fill:#9b4f96}.fxs-portal .msportalfx-fill-error{fill:#e81123}.fxs-portal .msportalfx-fill-warning{fill:#ff8c00}.fxs-text-white{color:#fff}.fxs-fill-white{fill:#fff}.fxs-bg-primary{background-color:#00bcf2}.fxs-br-primary{border-color:#00bcf2}.fxs-tile-selected .fxs-tile-overlay{background-color:transparent}.fxs-bg-overlay-dark{background:rgba(0,0,0,.7)}.fxs-bg-primary-10{background-color:rgba(0,188,242,.1)}")}
(r||(r={})),r});define("_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css",["require","exports","module"],function(n,t,i){"use strict";var r;return function(){window.fx.injectCss(i,".fxpart-itemsummary{height:100%;background:#00f;display:block;color:#fff}.fxpart-itemsummary-name{font-size:19px;padding:20px;text-transform:uppercase}.fxpart-itemsummary-sourceControl{font-size:16px;padding:0 20px}")}(r||(r={})),r});define("_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css",["require","exports","module"],function(n,t,i){"use strict";var r;return function(){window.fx.injectCss(i,'.msportalfx-specpicker{width:175px;height:320px;position:relative;border-color:inherit}.msportalfx-specpicker ul{list-style-type:none;padding:0}.msportalfx-specpicker .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-specpicker .msportalfx-specpicker-star{width:14px;height:14px;float:right;margin-right:4px;margin-top:1px}.msportalfx-specpicker .msportalfx-specpicker-header{color:#fff;font-size:14px;height:26px;line-height:26px}.msportalfx-specpicker .msportalfx-specpicker-header .msportalfx-specpicker-header-specCode{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;text-transform:uppercase;padding-left:11px}.msportalfx-specpicker .msportalfx-specpicker-header .msportalfx-specpicker-header-title{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;opacity:.8;padding-left:6px}.msportalfx-specpicker .msportalfx-specpicker-footer-container .msportalfx-specpicker-footer .msportalfx-specpicker-footer-value,.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-feature-name,.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-specpicker .msportalfx-specpicker-header-text{width:161px;position:absolute}.msportalfx-specpicker .msportalfx-specpicker-mediumBlue .msportalfx-specpicker-shade1{background-color:#4668c5}.msportalfx-specpicker .msportalfx-specpicker-mediumBlue .msportalfx-specpicker-shade2{background-color:rgba(70,104,197,.2)}.msportalfx-specpicker .msportalfx-specpicker-mediumBlue .msportalfx-specpicker-shade3{background-color:rgba(70,104,197,.1)}.msportalfx-specpicker .msportalfx-specpicker-darkOrchid .msportalfx-specpicker-shade1{background-color:#9b4f96}.msportalfx-specpicker .msportalfx-specpicker-darkOrchid .msportalfx-specpicker-shade2{background-color:rgba(155,79,150,.2)}.msportalfx-specpicker .msportalfx-specpicker-darkOrchid .msportalfx-specpicker-shade3{background-color:rgba(155,79,150,.1)}.msportalfx-specpicker .msportalfx-specpicker-yellowGreen .msportalfx-specpicker-shade1{background-color:#7fba00}.msportalfx-specpicker .msportalfx-specpicker-yellowGreen .msportalfx-specpicker-shade2{background-color:rgba(127,186,0,.2)}.msportalfx-specpicker .msportalfx-specpicker-yellowGreen .msportalfx-specpicker-shade3{background-color:rgba(127,186,0,.1)}.msportalfx-specpicker .msportalfx-specpicker-orange .msportalfx-specpicker-shade1{background-color:#ffb900}.msportalfx-specpicker .msportalfx-specpicker-orange .msportalfx-specpicker-shade2{background-color:rgba(255,185,0,.2)}.msportalfx-specpicker .msportalfx-specpicker-orange .msportalfx-specpicker-shade3{background-color:rgba(255,185,0,.1)}.msportalfx-specpicker .msportalfx-specpicker-table{table-layout:auto;width:100%;border-collapse:collapse}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-feature-name{font-size:12px;margin-left:6px}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-size:17px}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-row td{white-space:nowrap;padding:0}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-row td .msportalfx-specpicker-cell{height:30px;line-height:30px}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-row td.msportalfx-specpicker-right{overflow:hidden;text-overflow:ellipsis;max-width:1px;width:100%}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-row.msportalfx-specpicker-promotedFeatures td{padding-bottom:1px}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-row.msportalfx-specpicker-borderBottom td{border-bottom:1px solid #e9e9f3}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-row .msportalfx-specpicker-left{text-align:center;min-width:39px}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-value{font-size:12px;padding-top:6px;margin-left:6px;line-height:normal}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-name{font-size:10px;line-height:normal;margin-top:-3px}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-mutipleline .msportalfx-specpicker-feature-value{padding-top:1px}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{min-width:29px;text-align:center}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell img{width:22px;height:22px;margin-top:8px}.msportalfx-specpicker .msportalfx-specpicker-table .msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell div{width:20px;height:20px;padding-top:5px;padding-left:0;display:inline-block}.msportalfx-specpicker .msportalfx-specpicker-footer-container{position:absolute;bottom:0;left:0;right:0;height:46px;text-align:right}.msportalfx-specpicker .msportalfx-specpicker-footer-container .msportalfx-specpicker-footer{margin-right:10px;margin-bottom:8px;background-color:inherit}.msportalfx-specpicker .msportalfx-specpicker-footer-container .msportalfx-specpicker-footer .msportalfx-specpicker-footer-value{margin-top:6px;text-transform:uppercase;font-size:22px;line-height:22px;letter-spacing:-.025em}.msportalfx-specpicker .msportalfx-specpicker-footer-container .msportalfx-specpicker-footer .msportalfx-specpicker-footer-details{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:10px;line-height:14px;text-transform:uppercase;color:#8f9ca8}.msportalfx-specpicker .msportalfx-specpicker-footer-container .msportalfx-specpicker-footer .msportalfx-specpicker-footer-channelMessage,.msportalfx-specpicker .msportalfx-specpicker-footer-container .msportalfx-specpicker-footer .msportalfx-specpicker-footer-statusMessage{color:#8f9ca8;margin-left:5px;margin-right:5px;font-size:11px;text-align:left}.msportalfx-specpicker .msportalfx-specpicker-footer-container .msportalfx-specpicker-footer .msportalfx-specpicker-footer-statusMessage{margin-top:25px}.msportalfx-specpicker .msportalfx-specpicker-footer-container .msportalfx-specpicker-footer .msportalfx-specpicker-footer-channelMessage{margin-top:10px;position:absolute;background-color:inherit;white-space:normal;overflow:hidden;text-overflow:ellipsis;max-height:32px}.msportalfx-specpicker .msportalfx-specpicker-footer-container .msportalfx-specpicker-footer .msportalfx-specpicker-footer-channelMessage::after,.msportalfx-specpicker .msportalfx-specpicker-footer-container .msportalfx-specpicker-footer .msportalfx-specpicker-footer-channelMessage::before{position:absolute;background-color:inherit}.msportalfx-specpicker .msportalfx-specpicker-footer-container .msportalfx-specpicker-footer .msportalfx-specpicker-footer-channelMessage::before{content:\'\\02026\';top:16px;right:0}.msportalfx-specpicker .msportalfx-specpicker-footer-container .msportalfx-specpicker-footer .msportalfx-specpicker-footer-channelMessage::after{content:\'\';height:100%;width:100%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker{background-color:rgba(189,189,189,.05)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker .msportalfx-specpicker-header{background-color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.2)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-right .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.1)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker .msportalfx-specpicker-footer-container{background-color:#dedede}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker .msportalfx-specpicker-feature-name,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker .msportalfx-specpicker-feature-value,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker .msportalfx-specpicker-footer-value{color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker .msportalfx-specpicker-disable-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker .msportalfx-specpicker-disable-message-anchor{position:absolute;text-align:center;left:15px;right:15px;top:40%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container{display:inline-block;background-color:rgba(50,56,63,.8);margin-top:20px;padding:15px 10px;width:100%;box-sizing:border-box}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container .msportalfx-specpicker-disable-message{display:inline;color:#fff}.ext-hubs-specPicker-container{width:100%;min-height:100%}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer{height:25px;padding-top:5px;padding-right:15px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer .msportalfx-specpicker-viewOptions{font-family:az_ea_font,wf_segoe-ui_normal,"Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:14px;float:right}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer .msportalfx-specpicker-viewOptions .msportalfx-specpicker-recommendationsIcon{width:14px;height:14px;display:inline-block}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-selected{cursor:default;background-color:inherit}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-clickable{color:#00bcf2;fill:#00bcf2}.ext-hubs-specPicker-container .ext-hubs-specPicker-message{margin-top:0;border-left:6px solid #ffb900;padding:15px}.ext-hubs-specPicker-container .ext-hubs-specPicker-listView{margin-left:19px}.ext-hubs-specPicker-container .fxc-hotspot{outline:0;padding:5px}.ext-hubs-specPicker-container .fxc-hotspot:focus{outline-style:dotted;outline-width:1px}')}
(r||(r={})),r});define("_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css",["require","exports","module"],function(n,t,i){"use strict";var r;return function(){window.fx.injectCss(i,".msportalfx-pricingTier .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-pricingTier .msportalfx-pricingTier-normal-iconContainer,.msportalfx-pricingTier .msportalfx-pricingTier-wide-iconContainer{height:55px;border-bottom:1px solid #dcdfe2}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:10px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-specCode{float:left;margin-right:8px;max-width:100px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-promotedFeatures{line-height:12px;padding-top:4px}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon{width:30px;height:30px;margin-top:1.7em}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon.msportalfx-pricingTier-icon-small{margin-top:-.15em}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:10px}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:30px;height:30px;margin-right:15px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:18px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:20px;height:20px;margin-right:5px}.fxs-tilesize-small .msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:-12px}.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specCode,.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specTitle{text-align:center;float:initial}")}
(r||(r={})),r});define("MsPortalImpl/Parts/Parts.Intrinsics",["require","exports","f","./Parts","../../_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css","../../_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","../../_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css"],function(n,t,i,r){"use strict";var u;return function(n){var w=i.Parts,t=w.PartKind,u=w.PartSize,h=u.Mini,o=u.Small,e=u.Normal,f=u.Wide,c=u.Large,l=u.Tall,a=u.HeroWide,v=u.HeroTall,b=u.HeroWideFitHeight,y=u.FullWidthFitHeight,k=u.FitToContainer,s="<div data-bind='{0}: $root'><\/div>",p={defaultSize:y,supportedSizes:[y],viewStateProperties:["content.selection.selectedItems","content.selection.activatedItems"]};n.parts=[{kind:t.Asset,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Asset",function(n,t,i,r,u){return new n.AssetPart(t,i,r,u)},{defaultSize:o,supportedSizes:[h,o,e]})},{kind:t.Button,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.ButtonPart",function(n,t,i,r,u){return new n.
ButtonPart(t,i,r,u)},{supportedSizes:[h,o,e,f]})},{kind:t.Chart,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Chart",function(n,t,i,r,u){return new n.Chart(t,i,r,u)},{supportedSizes:[o,e,l,f,c,a,v,b,y,k]})},{kind:t.Collection,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Collection",function(n,t,i,r,u){return new n.CollectionPart(t,i,r,u)},{supportedSizes:[h,o,e,f,l,c,a,v,b,k,y]})},{kind:t.CollectionSummary,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.CollectionSummary",function(n,t,i,r,u){return new n.Part(t,i,r,u)},{supportedSizes:[h,o,e,f]})},{kind:t.DiffEditor,factory:r.createPartFactory(s.format("pcDiffEditor"))},{kind:t.Donut,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Donut",function(n,t,i,r,u){return new n.Donut(t,i,r,u)},{supportedSizes:[e,a,f,c,l,v,]})},{kind:t.Editor,factory:r.createPartFactory(s.format("pcEditor"))},{kind:t.Grid,factory:r.createPartFactory(s.format("pcGrid"),{viewStateProperties:["content.selectableData.selectedItems",
"content.selectableData.activatedItems","content.selectableData.itemsWithChildEdits"]})},{kind:t.InfoList,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.InfoList",function(n,t,i,r,u){return new n.InfoListPart(t,i,r,u)},p)},{kind:t.ItemSummary,factory:r.createPartFactory("<div class='fxpart-itemsummary'><div class='fxpart-itemsummary-name' data-bind='text: name'><\/div><\/div>")},{kind:t.LogStream,factory:r.createPartFactory(s.format("pcLogStream"))},{kind:t.Properties,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Properties",function(n,t,i,r,u){return new n.PropertiesPart(t,i,r,u)},p)},{kind:t.Provisioning,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.Provisioning",function(n,t,i,r,u){return new n.ProvisioningPart(t,i,r,u)},{supportedSizes:[e,f]})},{kind:t.QuickStart,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuickStart",function(n,t,i,r,u){return new n.QuickStartPart(t,i,r,u)},{defaultSize:o,supportedSizes:[h,o,e,f]})},{kind:t.QuotaGauge,factory:
r.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuotaGauge",function(n,t,i,r,u){return new n.QuotaGauge(t,i,r,u)},{supportedSizes:[e,c,f,l,v,a]})},{kind:t.ResourceSummary,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.ResourceSummary",function(n,t,i,r,u){return new n.ResourceSummaryPart(t,i,r,u)},p)},{kind:t.Settings,factory:r.createPartFactory(s.format("pcSettings"),{defaultSize:f,supportedSizes:[f]})},{kind:t.SingleSetting,factory:r.createPartFactory(s.format("pcSingleSetting"))},{kind:t.SingleValueGauge,factory:r.createAmdPartFactory("MsPortalImpl/Parts/Parts.SingleValueGauge",function(n,t,i,r,u){return new n.SingleValueGauge(t,i,r,u)},{supportedSizes:[e,c,f,l]})},{kind:t.Unavailable,factory:r.createPartFactory("<div><\/div>")}];n.parts.forEach(function(n){r.registerFactory(t[n.kind],n.factory)})}(u||(u={})),u});define("MsPortalImpl/Interactions/Interactions.ContextMenuTouch",["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){var t=i.Base.EventTypes,
u=window,r=jQuery,f=function(){function n(t){this._hintTemplate="<div class='"+n.HintClassIdentifier+"' style='position: fixed;border: 2px solid grey;box-sizing: border-box;background-color: rgba(255, 255, 255, 0.2);pointer-events: none;'><\/div>";this._showHintEndCss={width:n._HintSizePixels,height:n._HintSizePixels,top:"-={0}".format(n._HintSizePixels/2),left:"-={0}".format(n._HintSizePixels/2)};this._hideHintEndCss={width:0,height:0,top:"+={0}".format(n._HintSizePixels/2),left:"+={0}".format(n._HintSizePixels/2)};this._hint=r(this._hintTemplate);this._gestureArgs={startTime:0,target:null,targetX:0,targetY:0};this._element=t;this._attachHandlers()}return n.prototype.dispose=function(){this._removeHandlers();this._resetGesture(!1)},n.prototype._attachHandlers=function(){var n=this;this._element.on(t.touchstart,this._startHandle=function(t){n._touchStartHandler(t)});this._element.on(t.remove,this._removeHandler=function(){n.dispose()})},n.prototype._removeHandlers=function(){this._startHandle&&
(this._element.off(t.touchstart,this._startHandle),this._startHandle=null);this._moveHandle&&(this._element.off(t.touchmove,this._moveHandle),this._moveHandle=null);this._cancelHandle&&(this._element.off(t.touchcancel,this._cancelHandle),this._cancelHandle=null);this._endHandle&&(this._element.off(t.touchend,this._endHandle),this._endHandle=null);this._removeHandler&&(this._element.off(t.remove,this._removeHandler),this._removeHandler=null)},n.prototype._touchStartHandler=function(i){var r=this,f=this._getSingleTouch(i);if(!f){this._resetGesture(!0);return}if(!this._gestureArgs||this._gestureArgs.startTime===0){this._gestureArgs={startTime:Date.now(),target:i.target,targetX:f.clientX,targetY:f.clientY};this._hintShowTimeoutHandle=u.setTimeout(function(){r._showHint()},n.ReactionDelayMillis);this._element.on(t.touchmove,this._moveHandle=function(n){r._touchMoveHandler(n)}).on(t.touchcancel,this._cancelHandle=function(n){r._touchCancelHandler(n)}).on(t.touchend,this._endHandle=function(n)
{r._touchEndHandler(n)})}},n.prototype._touchEndHandler=function(i){var f=this._getSingleTouch(i),u;if(!f){this._resetGesture(!0);return}this._gestureArgs.startTime&&(u=Math.abs(Date.now()-this._gestureArgs.startTime),u>=n.ReactionDelayMillis&&r(this._gestureArgs.target).trigger(t.contextmenu));this._resetGesture(!1)},n.prototype._touchMoveHandler=function(t){var i=this._getSingleTouch(t),r,u;if(!i){this._resetGesture(!0);return}r=Math.abs(this._gestureArgs.targetX-i.clientX);u=Math.abs(this._gestureArgs.targetY-i.clientY);(r>n.MoveTolerancePixels||u>n.MoveTolerancePixels)&&this._resetGesture(!0)},n.prototype._touchCancelHandler=function(){this._resetGesture(!0)},n.prototype._getSingleTouch=function(n){var i=n.originalEvent,t=i&&i.touches,r=t&&t.length===1,u=t&&t[0];return r?u:null},n.prototype._showHint=function(){var n={width:0,height:0,top:this._gestureArgs.targetY,left:this._gestureArgs.targetX};this._hint.css(n);r(this._gestureArgs.target).append(this._hint);this._hint.animate(this.
_showHintEndCss,75,"easeOutQuint")},n.prototype._hideHint=function(n){var t=this;n&&this._hint.animate({opacity:.2},25).animate({opacity:1},25).animate({opacity:.2},25).animate({opacity:1},25);this._hint.animate(this._hideHintEndCss,75,"easeOutQuint",function(){t._hint.detach()})},n.prototype._resetGesture=function(n){this._moveHandle&&(this._element.off(t.touchmove,this._moveHandle),this._moveHandle=null);this._cancelHandle&&(this._element.off(t.touchcancel,this._cancelHandle),this._cancelHandle=null);this._endHandle&&(this._element.off(t.touchend,this._endHandle),this._endHandle=null);u.clearTimeout(this._hintShowTimeoutHandle);this._hideHint(n);this._gestureArgs={startTime:0,target:null,targetX:0,targetY:0}},n.ReactionDelayMillis=550,n.MoveTolerancePixels=10,n.HintClassIdentifier="fxs-contextMenuTouchHint",n._HintSizePixels=90,n}();n.ContextMenuTouch=f}(r||(r={})),r});define("_generated/Templates/WidgetsAvatarMenu",["require","exports","f"],function(){"use strict";return function(){
return'<div class="fxs-avatarmenu-dropdown" role="menu"> <ul class="fxs-avatarmenu-list-system"> <li class="fxs-has-hover" role="menuitem"> <a href="" class="fxs-avatarmenu-signout" data-bind=\'attr: { title: text.signOutLabel }\'> <div class="fxs-dropmenu-list-content" data-bind="text: text.signOutLabel"><\/div> <div class="fxs-dropmenu-image fxs-fill-invalid" data-bind="image: data.icons.signout"><\/div> <\/a> <\/li> <\/ul> <div class="fxs-avatarmenu-scrollviewer"> <div class="fxs-avatarmenu-list-system"> <ul> <li class="fxs-has-hover" data-bind="visible: changePasswordLink" role="menuitem"> <a class="fxs-avatarmenu-changepassword" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: changePasswordLink, title: text.changePasswordLabel }\'> <div class="fxs-dropmenu-list-content" data-bind="text: text.changePasswordLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="image: data.icons.launchCurrent"><\/div> <\/a> <\/li> <li class="fxs-has-hover" data-bind="visible: !!data.links.accessDetails" role="menuitem"> <a class="fxs-avatarmenu-myaccess" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.accessDetails, title: data.text.myAccessLabel }\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.myAccessLabel"><\/div> <div class="fxs-dropmenu-image msportalfx-svg-c07" data-bind="image: MsPortalFx.Base.Images.Person({ palette: MsPortalFx.Base.ImagePalette.Inherit })"><\/div> <\/a> <\/li> <li class="fxs-has-hover" data-bind="visible: !!data.links.giveFeedback" role="menuitem"> <a class="fxs-avatarmenu-feedback" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.giveFeedback, title: data.text.feedbackLabel }\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.feedbackLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="image: data.icons.feedback"><\/div> <\/a> <\/li> <li class="fxs-has-hover" role="menuitem" data-bind="visible: data.links.accountPortal"> <a class="fxs-avatarmenu-billing" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: {href: data.links.accountPortal || ""}\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.billingLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="visible: data.links.accountPortal && !data.links.accountPortal.startsWith(\'#\'), image: MsPortalFx.Base.Images.LaunchCurrent()"><\/div> <\/a> <\/li> <\/ul> <\/div> <div class="fxs-avatarmenu-list-tenant fxs-has-border fxs-dropmenu-line-separator" data-bind="visible: listOfTenants().length"> <!-- ko if: listOfTenants().length --> <div class="fxs-avatarmenu-dropdown-title" data-bind="text: text.tenant"><\/div> <ul data-bind="foreach: listOfTenants"> <li class="fxs-has-hover" role="menuitem"> <a data-bind="css: { \'fxs-avatarmenu-current-tenant fxs-is-selected\': $index() === 0 }, attr: { href: $index() === 0 ? \'#\' : \'\' }"> <div class="fxs-avatarmenu-tenant-name" data-bind="text: displayName, attr: { title: displayName }"><\/div> <div data-bind="text: domainName, attr: { title: domainName }" class="fxs-avatarmenu-tenant-uri"><\/div> <\/a> <\/li> <\/ul> <!-- /ko --> <\/div> <\/div> <\/div>'}
});define("_generated/Templates/WidgetsAvatarMenuButton",["require","exports"],function(){"use strict";return function(){return'<div class="fxs-avatarmenu-header" data-bind="attr: { title: tooltip }"> <div class="fxs-avatarmenu-tenant-container"> <div class="fxs-avatarmenu-username" data-bind="text: displayName"><\/div> <div class="fxs-avatarmenu-tenant" data-bind="text: currentTenantDisplayName"><\/div> <\/div> <img class="fxs-avatarmenu-tenant-image" data-bind="attr: { src: avatarUri }" alt=""/> <\/div>'}});define("MsPortalImpl/Widgets/Widgets.AvatarMenu",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.KeyboardNavigation","../Generated/SvgDefinitions","../Base/Telemetry","../../_generated/Templates/WidgetsAvatarMenu","../../_generated/Templates/WidgetsAvatarMenuButton","./Widgets.WidgetBase","./Widgets.DropMenu","../../_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return function(
n){function p(n){n.preventDefault()}function l(n){return(n||"").toLowerCase()}function a(n,t,i){var r=n.element.findByClassName(t);if(i)r.on(v.click,i);return r}function gt(n){var t=n.userIdentity(),i=t&&(t.displayName||ni(t));return i||n.text.defaultDisplayName}function ni(n){var t=n.firstName||"",i=n.lastName||"";return!t&&!i?"":it.test(t)&&it.test(i)?"":r.AvatarMenu.displayNameFormat.format(t,i)}function ti(n,t){return t().first(function(t){return n().tenantId===t.id})}function ii(n,t){return b(function(){var u=n(),r=u&&l(u.tenantId),i=t();return i.length===1&&i[0]&&l(i[0].id)===r?[]:i.sort(function(n,t){var e=l(n.id),f,i,u;return e===r?-1:(f=l(t.id),f===r)?1:(i=n.displayName,u=t.displayName,i<u?-1:i>u?1:0)})})}var rt=i.Base,at=rt.Diagnostics.Telemetry,v=rt.EventTypes,vt=MsPortalImpl.Resources.Images,yt=window,w=yt.fx.environment.links,k=jQuery,d=e.Source.TopBar,g=e.Action,nt=at.trace,pt=vt.getAvatarMenu().defaultAvatarSmall,t="fxs-avatarmenu",wt=t+"-header",ri=t+"-dropdown",ui=t+"-list-system",
ut=t+"-list-tenant",tt=t+"-signout",ft=t+"-billing",et=t+"-feedback",ot=t+"-myaccess",bt="fxs-menu-account",y=ko.observable,kt=ko.observableArray,b=ko.pureComputed,st="signOut",ht="switchedTenant",ct="showDiagnostics",dt=function(n){function t(){n.apply(this,arguments);this.userIdentity=y();this.userInfo=y();this.hideTenant=y();this.listOfTenants=kt();this.showDiagnostics=null;this.signOut=null;this.signedOut=null;this.switchTenant=null;this.switchedTenant=null;this.text=r.AvatarMenu;this.links=w;this.icons=f.Content.SvgLibrary;this.avatarImage=y();this.showDiagnosticsDelay=3e3}return __extends(t,n),t}(h.ViewModel),it,lt;n.ViewModel=dt;it=/^(f(irst)?|l(ast)?)\s?name$/i;lt=function(n){function i(i,r){var f=this,u,e,h;n.call(this,i,r);this._lastTouchMillis=0;u=this.element;e=this.lifetimeManager;u.addClass(t);h=this._dropMenu=new c.ViewModel(s(),o());h.buttonClass=bt;this._dropMenuWidget=new c.Widget(u,h);var p=b(function(){return gt(r)}),w=b(function(){var n=r.userInfo();return r.hideTenant(
)||!n?"":n.uniqueDirectoryName}),k=b(function(){var n=r.userIdentity(),i,f,e;if(!n)return"";var u=r.text.Tooltip,o=u.tenant,t=[];return(n.firstName||n.lastName)&&t.push(u.name.format(n.firstName||"",n.lastName||"")),n.displayName&&t.push(u.email.format(n.displayName)),i=ti(r.userIdentity,r.listOfTenants),i&&!r.hideTenant()&&(t.push(o.format(i.displayName,i.id)),f=i.domainName||"",e=n.tenantDomain,t.push(e&&l(f)!==l(e)?o.format(f,e):u.domain.format(f))),t.join("\n")}),a=y(pt),v=y();ko.reactor(e,function(){var n=r.userIdentity(),t;n&&(v(n.changePasswordUri),n.isAnonymous||(a(n.defaultAvatarUri),t=r.avatarImage(),t&&t.then(function(n){a(n)})))});ko.applyBindingsToDescendants({data:r,func:this,displayName:p,listOfTenants:ii(r.userIdentity,r.listOfTenants),text:r.text,currentTenantDisplayName:w,tooltip:k,avatarUri:a,changePasswordLink:v},u[0]);ko.reactor(e,function(){f._dropMenuWidget.options.isMenuOpen()?f._openMenu():f._closeMenu()});this._attachEventHandlers()}return __extends(i,n),i.prototype.
dispose=function(){this._removeEventHandlers();this._dropMenuWidget.dispose();this._cleanElement(t);n.prototype.dispose.call(this)},i.prototype.getDropMenuWidget=function(){return this._dropMenuWidget},i.prototype._signOut=function(n){var t=k.Event(st),i=this.trigger(st,t,{completed:!!n});(nt({source:d,action:g.AvatarMenuSignOut}),i)&&this.trigger("signedOut")},i.prototype._switchTenant=function(n){var t=this.options.userIdentity(),i=t&&l(t.tenantId);if(l(n.id)!==i){var r=k.Event(ht),u=this.trigger("switchTenant"),f={tenant:n};if(nt({source:d,action:g.AvatarMenuSwitchTenant}),!u)return;this.trigger(ht,r,f)}},i.prototype._attachEventHandlers=function(){var n=this,t=this.options,i;this._holdStartHandler=function(){n._lastTouchMillis=Date.now()};this._holdEndHandler=function(i){var r,u;n._lastTouchMillis&&(r=Math.abs(Date.now()-n._lastTouchMillis),n._lastTouchMillis=0,r>t.showDiagnosticsDelay&&(u=k.Event(ct),n.trigger(ct,u),p(i)))};this._accountPortalHandler=function(n){t.openAccountPortal(
);w.accountPortal.startsWith("#")&&p(n)};this._feedbackHandler=function(n){t.giveFeedback();w.giveFeedback.startsWith("#")&&p(n)};i=a(this,wt);i.on([v.touchstart,v.mousedown].join(" "),this._holdStartHandler);i.on([v.touchend,v.mouseup].join(" "),this._holdEndHandler);a(this,ft,this._accountPortalHandler);a(this,et,this._feedbackHandler)},i.prototype._removeEventHandlers=function(){var t=this,n=function(n,i){n&&a(t,i).off(v.click,n)};n(this._signOutHandler,tt);this._signOutHandler=null;n(this._accountPortalHandler,ft);this._accountPortalHandler=null;n(this._feedbackHandler,et);this._feedbackHandler=null;n(this._tenantHandler,ut);this._tenantHandler=null;n(this._myAccessHandler,ot);this._myAccessHandler=null},i.prototype._openMenu=function(){var n=this,t=a(this,tt);if(t[0].focus(),nt({source:d,action:g.AvatarMenuOpen}),this._signOutHandler||a(this,tt,this._signOutHandler=function(t){n._signOut(!1);p(t)}),!this._tenantHandler)a(this,ut).on(v.click,"a",this._tenantHandler=function(t){p(t);
n._switchTenant(ko.dataFor(t.target))});this._myAccessHandler||a(this,ot,this._myAccessHandler=function(t){w.accessDetails.startsWith("#")&&p(t);n.options.showMyAccessBlade()});this._keyboardNavigation=new u.KeyboardNavigation(this.element)},i.prototype._closeMenu=function(){this._removeEventHandlers();this._keyboardNavigation&&(this._keyboardNavigation.dispose(),this._keyboardNavigation=null)},i}(h.Widget);n.Widget=lt}(l||(l={})),l});define("MsPortalImpl/Widgets/Widgets.ContextPane",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Generated/SvgDefinitions","./Widgets.Common","./Widgets.UIElementBase","../../_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css"],function(n,t,i,r,u,f,e){"use strict";var o;return function(n){var o=i.Base.EventTypes,c=r.ContextPane,t="fxs-contextpane",b=t+"-visible",k=t+"-loading",h=t+"-close",s=t+"-expand",l=t+"-button-inner",a="fxs-contextpane-content",v="fxs-trim",y="fxs-blade-color-trim",p=ko.observable,d=function(
n){function t(){n.call(this,"fxs-contextpane-identifier");this.opened=p(!1);this.loading=p(!1)}return __extends(t,n),t}(e.ViewModel),w;n.ViewModel=d;w=function(n){function i(i,r){n.call(this,i,r);var f='<button type="button" class="'+s+'"><div class="'+l+'">'+u.Content.SvgLibrary.hamburger.data+"<\/div><\/button>"+('<button type="button" class="'+h+'" title="'+c.close+'"><div class="'+l+'">'+u.Content.SvgLibrary.Shell.close.data+"<\/div><\/button>")+'<div class="fxs-progress-dots"><div><\/div><div><\/div><div><\/div><\/div>';i.addClass(t).addClass(v).addClass(y).attr("role","complementary").append(f);this._init();this._attachEventHandlers(r)}return __extends(i,n),i.prototype.dispose=function(){this._cleanElement(t,v,y);this.element.removeAttr("role");n.prototype.dispose.call(this)},i.prototype.hasContent=function(){return!!this._$content},i.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");this.hasContent()&&this.removeChild(null);var i=this.element,t=this._$content=
n.element?n.element:n;t.addClass(a).insertBefore(i.find(".fxs-progress-dots"));i.findByClassName(h).toggle(!t.hasClass("fxs-blade")&&!t.hasClass("fxs-partgallery-container"));i.findByClassName(s).toggle(t.hasClass("fxs-partgallery-container"))},i.prototype.insertChild=function(n){this.addChild(n)},i.prototype.removeChild=function(n,t){return this._$content?(t?this._$content.detach():this._$content.remove(),this._$content.removeClass(a),this._$content=null,!0):!0},i.prototype.clear=function(n){return this.removeChild(null,n)},i.prototype.setFocus=function(){var n=this._$content;n&&f.waitForBindings(this.element[0]).then(function(){n.findFirstTabbable().focus()})},i.prototype._init=function(){var n=this.lifetimeManager,t=this.element,i=this.options;ko.reactor(n,function(){var n=i.opened();t.toggleClass(b,n)});ko.reactor(n,function(){var n=i.loading();t.toggleClass(k,n)})},i.prototype._attachEventHandlers=function(n){var i=this.element,t=i.findByClassName.bind(i),r,u;t(h).on(o.click,r=function(
){i.trigger(o.fxcontextpaneclosing)});t(s).on(o.click,u=function(){n.collapsed(!n.collapsed())});n.collapsed&&n.collapsed.subscribe(this.lifetimeManager,function(n){t(s).attr({title:n?c.expand:c.collapse,"aria-expanded":!n})}).callback(n.collapsed());this.lifetimeManager.registerForDispose(function(){t(h).off(o.click,r);t(s).off(o.click,u)})},i}(e.Widget);n.Widget=w}(o||(o={})),o});define("_generated/Templates/WidgetsHelpMenu",["require","exports"],function(){"use strict";return function(){return'<div class="fx-dropmenu-dropdown" role="menu"> <div class="fxs-dropmenu-list-system"> <ul> <li class="fxs-has-hover" data-bind="visible: !!data.links.createSupportRequest"> <a class="fxs-helpmenu-support-request" href="" target="_blank" data-bind=\'attr: {href: data.links.createSupportRequest || "", title: data.text.newSupportRequestLabel }\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.newSupportRequestLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="image: data.icons.add"><\/div> <\/a> <\/li> <li class="fxs-has-hover" data-bind="visible: !!data.links.manageSupportRequests"> <a class="fxs-helpmenu-manage-support-requests" href="" target="_blank" data-bind=\'attr: {href: data.links.manageSupportRequests || "", title: data.text.manageSupportRequestsLabel }\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.manageSupportRequestsLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="visible: data.links.manageSupportRequests && !data.links.manageSupportRequests.startsWith(\'#\'), image: data.icons.hyperlink"><\/div> <\/a> <\/li> <li class="fxs-has-hover" data-bind="visible: !!data.links.helpAndSupport"> <a class="fxs-helpmenu-support" href="" target="_blank" data-bind=\'attr: {href: data.links.helpAndSupport || "", title: data.text.supportLabel}\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.supportLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="visible: data.links.helpAndSupport && !data.links.helpAndSupport.startsWith(\'#\'), image: data.icons.hyperlink"><\/div> <\/a> <\/li> <li class="fxs-has-hover"> <a href="" class="fxs-helpmenu-keyboardshortcuts" data-bind="attr: { title: data.text.keyboardshortcutsPaneLabel, \'aria-haspopup\': true }"> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.keyboardshortcutsPaneLabel"><\/div> <\/a> <\/li> <li class="fxs-has-hover" data-bind="visible: !!data.links.privacyAndTerms, css: { \'fxs-has-border fxs-dropmenu-line-separator\': !!data.links.createSupportRequest || !!data.links.manageSupportRequests || !!data.links.helpAndSupport }"> <a class="fxs-helpmenu-legal" href="" target="_blank" data-bind=\'attr: {href: data.links.privacyAndTerms || "", title: data.text.legalLabel}\'> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.legalLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="visible: data.links.privacyAndTerms && !data.links.privacyAndTerms.startsWith(\'#\'), image: data.icons.hyperlink"><\/div> <\/a> <\/li> <li class="fxs-has-hover"> <a href="" class="fxs-helpmenu-show-diagnostics" data-bind="attr: { title: data.text.showDiagnosticsLabel, \'aria-haspopup\': true }"> <div class="fxs-dropmenu-list-content" data-bind="text: data.text.showDiagnosticsLabel"><\/div> <div class="fxs-dropmenu-image" data-bind="image: data.icons.hyperlink"><\/div> <\/a> <\/li> <\/ul> <\/div> <\/div>'}
});define("_generated/Templates/WidgetsHelpMenuButton",["require","exports"],function(){"use strict";return function(){return'<div class="fxs-topbar-button fxs-has-hover" data-bind="image: data.icons.Shell.help"><\/div>'}});define("MsPortalImpl/Widgets/Widgets.HelpMenu",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.KeyboardNavigation","../Generated/SvgDefinitions","../Base/Telemetry","./Widgets.WidgetBase","./Widgets.DropMenu","../../_generated/Templates/WidgetsHelpMenu","../../_generated/Templates/WidgetsHelpMenuButton"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return function(n){function v(n,t){(!t||t.startsWith("#"))&&n.preventDefault()}function tt(n,t){t.openKeyboardShortcutsPane();n.preventDefault()}var p=i.Base,ut=p.Diagnostics.Telemetry,w=p.EventTypes,ft=window,a=ft.fx.environment.links,et=jQuery,ot=e.Source.TopBar,st=e.Action,ht=ut.trace,t=w.click,b="fxs-dropmenu",l="fxs-helpmenu",k=l+"-legal",d=l+"-support",ct=l+"-keyboardshortcuts",
y=l+"-support-request",g=l+"-manage-support-requests",nt=l+"-show-diagnostics",it,rt;n.preventDefaultIfHash=v;it=function(n){function t(){n.apply(this,arguments);this.legal=null;this.text=r.HelpMenu;this.links=a;this.icons=f.Content.SvgLibrary}return __extends(t,n),t}(o.ViewModel);n.ViewModel=it;rt=function(n){function i(t,i){var r=this,u,f;n.call(this,t,i);u=this.element;u.addClass(b);this._dropMenuViewModel=new s.ViewModel(c(),h());et(document).on(w.fxopenshortcutslegend,function(n){tt(n,r.options)});f=this._dropMenuWidget=new s.Widget(u,this._dropMenuViewModel);this._bindDescendants();ko.reactor(this.lifetimeManager,function(){f.options.isMenuOpen()?r._openMenu():r._closeMenu()})}return __extends(i,n),i.prototype.dispose=function(){this._removeEventHandlers();this._dropMenuWidget.dispose();this._cleanElement(b);n.prototype.dispose.call(this)},i.prototype.getDropMenuWidget=function(){return this._dropMenuWidget},i.prototype._removeEventHandlers=function(){var i=this.element,n=i.findByClassName.
bind(i);this._legalHandler&&(n(k).off(t,this._legalHandler),this._legalHandler=null);this._supportRequestHandler&&(n(y).off(t,this._supportRequestHandler),this._supportRequestHandler=null);this._helpBladeHandler&&(n(d).off(t,this._helpBladeHandler),this._helpBladeHandler=null);this._manageRequestsHandler&&(n(g).off(t,this._manageRequestsHandler),this._manageRequestsHandler=null);this._diagnosticsHandler&&(n(nt).off(t,this._diagnosticsHandler),this._diagnosticsHandler=null)},i.prototype._openMenu=function(){var r=this.element,i=this.options,n=r.findByClassName.bind(r),f=n(y);if(f[0].focus(),ht({source:ot,action:st.HelpMenuOpen}),!this._legalHandler)n(k).on(t,this._legalHandler=function(n){i.openPrivacyAndTerms();v(n,a.privacyAndTerms)});n(ct).on(t,function(n){tt(n,i)});n(y).on(t,this._supportRequestHandler=function(n){i.openSupportRequestBlade();v(n,a.createSupportRequest)});n(g).on(t,this._manageRequestsHandler=function(n){i.openManageSupportRequestsBlade();v(n,a.manageSupportRequests)}
);n(d).on(t,this._helpBladeHandler=function(n){i.openHelpAndSupport();v(n,a.helpAndSupport)});n(nt).on(t,this._diagnosticsHandler=function(n){i.showDiagnostics();n.preventDefault()});this._keyboardNavigation=new u.KeyboardNavigation(r)},i.prototype._closeMenu=function(){this._removeEventHandlers();this._keyboardNavigation&&(this._keyboardNavigation.dispose(),this._keyboardNavigation=null)},i}(o.Widget);n.Widget=rt}(l||(l={})),l});define("_generated/Templates/WidgetsNotificationMenu",["require","exports","f"],function(){"use strict";return function(){return'<!-- ko if: data.menuOpen --> <div class="fxs-notificationmenu-dropdown"> <!-- ko ifnot: data.notifications && data.notifications() && data.notifications().length --> <div tabindex="0" class="fxs-notificationmenu-notification-nodata"> <div class="fxs-notificationmenu-notification-nodata-content" data-bind="text: data.text.noNewNotifications, title: data.text.noNewNotifications"/> <\/div> <!-- /ko --> <!-- ko if: data.notifications && data.notifications() && data.notifications().length --> <div class="fxs-notificationmenu-list-system"> <ul class="fxs-notificationmenu-list" data-bind="foreach: data.notifications"> <li> <a href="" role="button" class="fxs-has-hover fxs-notificationmenu-notificationclick"> <!-- ko if: status === MsPortalFx.Hubs.Notifications.NotificationStatus.InProgress --> <div class="fxs-notificationmenu-notification"> <div class="fxs-notificationmenu-notification-title"> <div class="fxs-notificationmenu-notification-title-icon" data-bind="image: $root.func._getIcon($data)"/> <div class="fxs-notificationmenu-notification-title-progresstext msportalfx-tooltip-overflow" data-bind="text: title"><\/div> <div data-bind="if: $data.percentComplete"> <div class="fxs-notificationmenu-notification-title-subtitle fxs-text-secondary" data-bind="text: $root.func._getPercentCompleteStr($data.percentComplete)"><\/div> <\/div> <\/div> <div class="fxs-notificationmenu-notification-progressbar" data-bind="pcProgressBar: $root.func._getProgressBarViewModel($data.percentComplete)"><\/div> <\/div> <!-- /ko --> <!-- ko ifnot: status === MsPortalFx.Hubs.Notifications.NotificationStatus.InProgress --> <div class="fxs-notificationmenu-notification"> <div class="fxs-notificationmenu-notification-title"> <div class="fxs-notificationmenu-notification-title-icon" data-bind="image: $root.func._getIcon($data)"/> <div class="fxs-notificationmenu-notification-title-text msportalfx-tooltip-overflow" data-bind="text: title"><\/div> <time class="fxs-notificationmenu-notification-title-subtitle fxs-text-secondary" data-bind="attr: { datetime: $root.func._timestampToString(timestamp) }, text: $root.func._timestampToString(timestamp)"><\/time> <\/div> <div class="fxs-notificationmenu-notification-description fxs-text-secondary msportalfx-tooltip-overflow" data-bind="text: description"><\/div> <\/div> <!-- /ko --> <\/a> <\/li> <\/ul> <\/div> <!-- /ko --> <\/div> <!-- /ko -->'}
});define("_generated/Templates/WidgetsNotificationMenuButton",["require","exports"],function(){"use strict";return function(){return'<div class="fxs-topbar-button fxs-has-hover fxs-notificationmenu-button" data-bind="attr: { title: data.notificationsTooltip }"> <div class="fxs-notificationmenu-icon" data-bind="image: data.icon"><\/div> <!-- ko if: data.unreadNotificationsCount --> <div class="fxs-notificationmenu-button-unreadcount" data-bind="text: data.unreadNotificationsCount, css: data.unreadCountClass"><\/div> <!-- /ko --> <!-- ko if: data.showProgress --> <div class="fxs-notificationmenu-inprogressbar"> <div><\/div> <\/div> <!-- /ko --> <\/div>'}});define("_generated/Templates/WidgetsToast",["require","exports","f"],function(){"use strict";return function(){return'<ul role="presentation" class="fxs-toast" data-bind="visible: data.shouldShowToasts, foreach: data._items"> <li class="fxs-toast-item fxs-popup" role="alert" aria-live="polite" aria-atomic="true" data-bind="attr: { \'aria-label\': descriptiveText }"> <!-- ko ifnot: htmlContent --> <a class="fxs-toast-link" aria-hidden="true" data-bind="href: clickable ? \'#\' : null"> <div class="fxs-toast-header"> <div class="fxs-toast-icon" data-bind="image: icon"/> <div class="fxs-toast-title" data-bind="text: title"><\/div> <div class="fxs-toast-time fxs-text-secondary" data-bind="attr: { datetime: time }, text: time"><\/div> <\/div> <!-- ko ifnot: inProgress --> <div class="fxs-toast-description fxs-text-secondary" data-bind="text: description"><\/div> <!-- /ko --> <!-- ko if: inProgress --> <div class="fxs-toast-progressbar" data-bind="pcProgressBar: progressBar"><\/div> <!-- /ko --> <\/a> <!-- /ko --> <!-- ko if: htmlContent --> <div class="fxs-toast-content" aria-hidden="true" data-bind="unsanitizedHtml: htmlContent"><\/div> <!-- /ko --> <button class="fxs-toast-close" aria-hidden="true" data-bind="image: MsPortalFx.Base.Images.Shell.Close()"><\/button> <\/li> <\/ul> '}
});define("MsPortalImpl/Widgets/Widgets.Toast",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../Base/Telemetry","./Widgets.WidgetBase","../../_generated/Templates/WidgetsToast","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css"],function(n,t,i,r,u,f,e){"use strict";var o;return function(n){var a=i.Base,o=a.EventTypes,b=a.Diagnostics.Telemetry,h=window,tt=jQuery,l=".fxs-toast",s=l+"-item",v=l+"-link",y=l+"-close",k=u.Source.ToastTray,d=u.Action,g=b.trace,t=ko.observable,p=ko.observableArray,c=ko.dataFor,nt=function(n){function i(i){i===void 0&&(i={});n.call(this);this.displayCount=4;this.displayTime=t(5e3);this.shouldShowToasts=t(!0);this._items=p([]);this.displayCount=i.displayCount||this.displayCount;this.displayTime=i.displayTime||this.displayTime;this.shouldShowToasts=i.shouldShowToasts||this.shouldShowToasts}return __extends(i,n),i.prototype.addToast=function(n){var o=this._items(),s=n.icon,h=n.title,c=n.description,l=n.uri,a=n.time,u=n.ids||[],
v=n.inProgress||!1,y=n.progressBar||null,w=n.data||null,f=n.stayOpen||!1,b=n.htmlContent||"",k=n.clickable===undefined?!0:n.clickable,d=n.descriptiveText||r.Toast.description.format(n.title),i,e;u.length>0&&(i=o.first(function(t){var i=t.ids();return n.ids.some(function(n){return i.indexOf(n)>-1})}));i?(i.icon(s),i.title(h),i.description(c),i.uri(l),i.time(a),i.ids(u),i.inProgress(v),i.progressBar(y),i.data(w),i.stayOpen(f),i.clickable(k),i.htmlContent(b),i.descriptiveText(d)):(e={icon:t(s),title:t(h),description:t(c),uri:t(l),time:t(a),ids:p(u),inProgress:t(v),progressBar:t(y),stayOpen:t(f),data:t(w),htmlContent:t(b),timeoutID:t(null),clickable:t(k),onDismissFn:n.onDismissFn,descriptiveText:t(d)},o.length>=this.displayCount&&this._removeLastRemoveableItem(),this._items.unshift(e),f||this.startRemoveTimer(e))},i.prototype._removeLastRemoveableItem=function(){for(var t,i=this._items(),n=i.length-1;n>=0;n--)if(t=i[n],!t.stayOpen()){this.removeToast(t);return}},i.prototype.removeToast=function(
n){h.clearTimeout(n.timeoutID());this._items.remove(n)},i.prototype.removeAllToasts=function(){this._items().forEach(function(n){h.clearTimeout(n.timeoutID())});this._items.removeAll()},i.prototype.startRemoveTimer=function(n){var i=this,t;typeof n.timeoutID=="function"&&(t=h.setTimeout(function(){i._items.remove(n)},this.displayTime()),n.timeoutID(t))},i}(f.ViewModel),w;n.ViewModel=nt;w=function(n){function t(t,i){n.call(this,t,i);this.element.html(e());this._attachEventHandlers();this._bindDescendants()}return __extends(t,n),t.prototype._attachEventHandlers=function(){var n=this.element,t=this.options,i,r,u=function(n){var t=c(n.currentTarget);typeof t.timeoutID=="function"&&h.clearTimeout(t.timeoutID())},f=function(n){var i=c(n.currentTarget);i.stayOpen&&!i.stayOpen()&&t.startRemoveTimer(i)};n.on(o.focusin,s,u);n.on(o.focusout,s,f);n.on(o.mouseenter,s,u);n.on(o.mouseleave,s,f);n.on(o.click,v,i=function(i){var r=c(i.currentTarget);r.clickable()&&(i.preventDefault(),g({source:k,action:
d.ToastClicked}),n.trigger(o.fxtoastclick,r.data()),t.removeToast(r))});n.on(o.click,y,r=function(n){n.preventDefault();var i=c(n.currentTarget);i.onDismissFn&&i.onDismissFn();t.removeToast(i)});this.lifetimeManager.registerForDispose(function(){n.off(o.focusin,s);n.off(o.focusout,s);n.off(o.mouseenter,s);n.off(o.mouseleave,s);n.off(o.click,v,i);n.off(o.click,y,r)})},t}(f.Widget);n.Widget=w}(o||(o={})),o});define("MsPortalImpl/Widgets/Widgets.NotificationMenu",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.KeyboardNavigation","../Services/Services.GeneralSettings","../Generated/SvgDefinitions","../Base/Telemetry","./Widgets.WidgetBase","./Widgets.DropMenu","../../_generated/Templates/WidgetsNotificationMenu","../../_generated/Templates/WidgetsNotificationMenuButton","./Widgets.Toast","../../_generated/Less/MsPortalImpl/Widgets/Widgets.NotificationMenu.css"],function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var v;return function(t){function hi(
n,t){tt({source:ht,action:nt.NotificationMenuNotificationClick});t.trigger(ut.fxnotificationclickinmenu,n)}var b=i.Base,rt=b.Diagnostics,kt=rt.Telemetry,ut=b.EventTypes,p=b.Images.StatusBadge,v=i.Hubs.Notifications.NotificationStatus,ft=i.ViewModels.Controls.Visualization.ProgressBar,et=ft.StatusType,dt=ft.ViewModel,gt=v.Information,ni=v.Warning,ti=v.Error,ii=v.Success,g=v.InProgress,w=r.NotificationMenu,ot=window,ri=jQuery,ui=ot.fx.environment,st=ui.features.rapidtoasts,ht=o.Source.TopBar,nt=o.Action,tt=kt.trace,fi=355,ei=20,k=ko.observable,ct=ut.click,y="fxs-notificationmenu",lt=y+"-dropmenu",at=y+"-dropdown",vt=y+"-menu",yt=y+"-toast",pt=y+"-button-unreadcount",oi=pt+"-oval",si=pt+"-circle",it="a."+y+"-notificationclick",d="msportalfx-bg-",ci=[d+"error",d+"warning",d+"info",d+"success"],wt,bt;t.iconMap={};t.iconMap[gt]=p.Info();t.iconMap[ni]=p.Warning();t.iconMap[ti]=p.Error();t.iconMap[g]=p.Pending();t.iconMap[ii]=p.Success();ot.Intl||rt.createLog(n).warning("Intl polyfill not loaded");
wt=function(n){function t(){n.apply(this,arguments);this.unreadNotificationsCount=k("");this.notificationsTooltip=w.title;this.unreadCountClass=k("");this.text=w;this.icon=e.Content.SvgLibrary.Shell.notifications;this.menuOpen=k(!1);this.toastsEnabled=f.settings.notificationToastEnabledKey;this.showProgress=k(!1)}return __extends(t,n),t}(s.ViewModel);t.ViewModel=wt;bt=function(n){function i(t,i){var r=this,f,u;n.call(this,t,i);this._lastMenuOpenedTime=new Date;t.addClass(lt);t.append("<div class='"+vt+"'><\/div>"+("<div class='"+yt+"' data-bind='stopBindings: true'><\/div>"));this._dropMenuViewModel=new h.ViewModel(l(),c());this._dropMenuViewModel.menuWidth=fi;this._dropMenuWidget=new h.Widget(t.findByClassName(vt),this._dropMenuViewModel);f=ko.computed(this.lifetimeManager,function(){return!i.menuOpen()&&i.toastsEnabled()&&st!=="0"});u=new a.ViewModel({shouldShowToasts:f});st==="true"&&u.displayTime(50);this._toastWidget=new a.Widget(t.findByClassName(yt),u);this._bindDescendants();ko.
reactor(this.lifetimeManager,function(){r._dropMenuWidget.options.isMenuOpen()?r._openMenu():r._closeMenu()});this._setAriaLabel("")}return __extends(i,n),i.prototype.getToastWidget=function(){return this._toastWidget},i.prototype.register=function(n){var u=this,i=this.options,f=this.lifetimeManager;i.notifications=n;n.subscribe(f,function(n){var r=n.filter(function(n){return n.timestamp>u._lastMenuOpenedTime}),t=r.length;u._setAriaLabel(w.overflowTitle.format(t));t>ei?(i.unreadCountClass(oi),i.unreadNotificationsCount(w.overflowCountMessage)):(i.unreadCountClass(si),i.unreadNotificationsCount(t?t.toString():""));i.showProgress(n.some(function(n){return n.status===g}))});n.subscribeArrayAdds(f,function(n){if(i.toastsEnabled()&&n.timestamp>u._lastMenuOpenedTime){var f=u._timestampToString(n.timestamp),e=n.description||"",o=u._getProgressBarViewModel(n.percentComplete),s=n.status===g?!0:!1,h=r.Toast.description.format(n.title),c=n.correlationIds,l={icon:t.iconMap[n.status],title:n.title,
description:e,time:f,ids:c,inProgress:s,progressBar:o,descriptiveText:h,data:n};u._toastWidget.options.addToast(l)}})},i.prototype._getIcon=function(n){return t.iconMap[n.status]},i.prototype._timestampToString=function(n){var t="numeric";return n.toString({hour:t,minute:t})},i.prototype._getProgressBarViewModel=function(n){var u=!0,i=0,r=et.Indeterminate,t;return n&&(u=!1,i=n,r=et.InProgress),t=new dt(this.lifetimeManager),t.valuePercentage(i),t.status(r),t},i.prototype._getPercentCompleteStr=function(n){return this.options.text.percentComplete.format(n)},i.prototype.dispose=function(){this._removeEventHandlers();this._dropMenuWidget.dispose();this._cleanElement(lt);n.prototype.dispose.call(this)},i.prototype.getDropMenuWidget=function(){return this._dropMenuWidget},i.prototype._setAriaLabel=function(n){ri(this.element).findByClassName("fxs-dropmenu-button").attr("aria-label",n||w.overflowTitle.format(0))},i.prototype._removeEventHandlers=function(){var n=this._notificationClickEventHandler;
n&&(this.element.findByClassName(at).off(ct,it,n),this._notificationClickEventHandler=null)},i.prototype._openMenu=function(){var f=this,n=this.element,t=this.options,i,r;if(tt({source:ht,action:nt.NotificationMenuOpen}),i=n.findByClassName(it)[0],i&&i.focus(),t.menuOpen(!0),this._toastWidget.options.removeAllToasts(),r=t.notifications().filter(function(n){return n.isRecommendation&&n.timestamp>f._lastMenuOpenedTime}),r.forEach(function(n){var t=n.additionalProperties||{};b.Utilities.extend(t,{status:v[n.status],correlationId:n.correlationIds&&n.correlationIds.join(",")});tt({source:o.Source.NotificationHub,action:nt.RecommendationSurfaced,data:t})}),this._lastMenuOpenedTime=new Date,t.unreadNotificationsCount(""),this._setAriaLabel(""),!this._notificationClickEventHandler)n.findByClassName(at).on(ct,it,this._notificationClickEventHandler=function(t){t.preventDefault();var i=ko.dataFor(t.currentTarget);hi(i,n)});this._keyboardNavigation=new u.KeyboardNavigation(n)},i.prototype._closeMenu=
function(){this.options.menuOpen(!1);this._removeEventHandlers();var n=this._keyboardNavigation;n&&(n.dispose(),this._keyboardNavigation=null)},i}(s.Widget);t.Widget=bt}(v||(v={})),v});define("_generated/Templates/WidgetsPanorama",["require","exports"],function(){"use strict";return function(){return'<div class="fxs-startboard-target" aria-labelledby="startboard-title"><\/div> <div class="fxs-journey-target"><\/div>'}});define("MsPortalImpl/Widgets/Widgets.Panorama",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","./Widgets.WidgetBase","../Widgets/Widgets.Common","../../_generated/Templates/WidgetsPanorama","./Widgets.StartBoard","./Widgets.UIElementBase","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css"],function(n,t,i,r,u,f,e,o,s){"use strict";var h;return function(n){var c=i.Base,t=c.EventTypes,w=c.Utilities,l=window,b=l.fx.environment.features,a=jQuery,h="fxs-panorama",k=h+"-previewbadge",d=h+"-previewbadge-text",g="fxs-startboard-target",nt="fxs-journey-target",
tt="fxs-journey-layout",v="fxs-blade",it=3,y=w.htmlEncode(r.Portal.preview),rt=function(n){function t(t,i){n.call(this,t);this.rotateThemeEvent=null;this.applyViewSettings(i)}return __extends(t,n),t.prototype.getViewSettings=function(){return{}},t.prototype.applyViewSettings=function(){return},t}(s.ViewModel),p;n.ViewModel=rt;p=function(n){function r(t,i){n.call(this,t,i);t.addClass(h).html(e());t.findByClassName(k).attr("title",y).findByClassName(d).text(y);this._attachEventHandlers();this._scrollBarSize=f.getBrowserScrollbarWidth()}return __extends(r,n),r.prototype.dispose=function(){this._cleanElement(h);n.prototype.dispose.call(this)},r.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");this.getJourneyWidget().addChild(n)},r.prototype.insertChild=function(n,t){if(!n)throw new Error("Can't add null child.");this.getJourneyWidget().insertChild(n,t)},r.prototype.removeChild=function(n){var t=this.getJourneyWidget();return t&&t.removeChild(n)},r.prototype.getStartBoardArea=
function(){return this.element.findByClassName(g)},r.prototype.getJourneyArea=function(){return this.element.findByClassName(nt)},r.prototype.getStartBoardWidget=function(){return u.Widget.getWidget(this.getStartBoardArea(),o.Widget)},r.prototype.getJourneyWidget=function(){var n=u.Widget.getWidgets(this.getJourneyArea());if(n.length>1)throw new Error("The journey target has been initialized with more than one widget.");return n[0]},r.prototype.saveViewSettings=function(){return this.options.getViewSettings()},r.prototype.ensureElementInViewport=function(n,t){var f,r;if(n){if(f=n.element,r=this.element,t){this._snapElementToEdge(f);return}var i=f[0].getBoundingClientRect(),u=r[0].getBoundingClientRect(),e=r.scrollLeft(),o;if(i.left<u.left)o=e+(i.left-u.left);else if(i.right>u.right){var s=this._isRtl(),h=s?"marginRight":"marginLeft",a=s?"marginLeft":"marginRight",c=parseInt(r.css(h),10),l=it;o=Math.min(i.left+e-c,e+(i.right-u.right)+l)}this.element.scrollLeft(o)}},r.prototype._attachEventHandlers=
function(){var r=this,n=this.element,u,f,e,o;n.on(t.doubleclick,u=function(n){var i=a(n.target),u=i.hasClass(h),f=i.hasClass("fxs-startboard-layout"),e=i.hasClass("fxs-flowlayout-childcontainer"),o=i.hasClass(tt);(u||f||e||o)&&(n.preventDefault(),n.stopPropagation(),l.getSelection().removeAllRanges(),r.trigger(t.fxrotatetheme))});n.on(t.fxensureviewportvisible,f=function(n,t){n.stopPropagation();r.ensureElementInViewport(t.widget,t.alignStart)});n.on(t.mousedown,e=function(i){if(i.pageY>=n.outerHeight()-r._scrollBarSize){var u;n.on(t.mouseup,u=function(){n.off(t.mouseup,u);var i=r._tryGetLeftMostBladeInView();i.length>0&&i.trigger(t.fxactivatepairmaster)})}});n.on(t.fxpancomplete,o=function(n,t){n.stopPropagation();r._snapBladeToEdge(t)});b.makethewebweird==="true"&&i.require("MsPortalImpl/Interactions/Interactions.MousePanning").then(function(t){var i=new t.MousePanning(n);r.lifetimeManager.registerForDispose(function(){i.dispose()})});this.lifetimeManager.registerForDispose(function(
){n.off(t.doubleclick,u);n.off(t.fxensureviewportvisible,f);n.off(t.mousedown,e);n.off(t.fxpancomplete,o)})},r.prototype._snapBladeToEdge=function(n){var h=this.element.offset(),r=this._tryGetLeftMostBladeInView(),i,f,e,o;if(r.length!==0){if(n===0){r.trigger(t.fxactivatepairmaster);return}var c=r.outerWidth(!1),l=r.offset(),a=l.left-h.left,s=Math.abs(a/c),y=1-s,u;n===1&&(u=s>=.2?!0:!1);n===2&&(u=y>=.2?!1:!0);i=r;f="."+v;u?(e=r.next(f),i=e.length!==0?e:r):i=r;o=i.next(f).length>0;o?i.trigger(t.fxactivatepairmaster):o||i.prev().trigger(t.fxactivatepairmaster);i.hasClass("fxs-blade-pairdetails")&&i.hasClass("fxs-blade-pair-fullscreen")&&(i=i.prev());this._snapElementToEdge(i)}},r.prototype._snapElementToEdge=function(n){var t=this;n&&n.length!==0&&n.handleTransitionEndOnce("width",200,function(){var i=t.element;if(i.width()>=n.width()){var r=n.offset(),u=i.offset(),f=r.left-u.left,e=i.scrollLeft(),o=e+f;i.scrollLeft(o)}})},r.prototype._tryGetLeftMostBladeInView=function(){var t="."+v,n=this.
element.offset(),i=document.elementFromPoint(n.left,n.top);return a(i).closest(t)},r}(s.Widget);n.Widget=p}(h||(h={})),h});define("_generated/Templates/WidgetsPortal",["require","exports"],function(){"use strict";return function(){return'<div class="fxs-topbar"><\/div> <div class="fxs-portal-main"> <div class="fxs-sidebar fxs-trim"><\/div> <section class="fxs-portal-contextpane-left"><\/section> <main class="fxs-portal-content"><\/main> <section class="fxs-portal-contextpane-right"><\/section> <\/div>'}});define("_generated/Templates/WidgetsSearch",["require","exports","f"],function(){"use strict";return function(){return'<div class="fxs-search" role="search" data-bind="css: { \'fxs-search-expanded\': data.isExpanded(), \'fxs-search-no-journeys\': !data.journeysShown(), \'fxs-auto-expand\': autoExpand }"> <div class="fxs-box-wrapper" data-bind="css: { \'fxs-searching\': data.showSearching() }"> <div class="fxs-icon msportalfx-svg-flip-horizontal" data-bind="image: MsPortalFx.Base.Images.Search()"><\/div> <div class="fxs-searchbox fxs-topbar-input"><\/div> <div class="fxs-indicator"> <div><\/div><div><\/div><div><\/div> <\/div> <div role="presentation" class="fxs-cross">&times;<\/div> <\/div> <a href="" class="fxs-search-icon fxs-topbar-button fxs-has-hover"> <div class="msportalfx-svg-flip-horizontal" data-bind="image: MsPortalFx.Base.Images.Search()"><\/div> <\/a> <div class=\'fxs-menu fxs-popup fxs-dropmenu-content\' data-bind=\'visible: data.showMenu()\' title=\'\'><\/div> <\/div>'}
});define("MsPortalImpl/Widgets/Widgets.Search",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../../Viva.Controls/Controls/Forms/Viva.TextBox","./Widgets.WidgetBase","../../_generated/Templates/WidgetsSearch","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],function(n,t,i,r,u,f,e){"use strict";var o;return function(n){var a=i.Base,o=a.EventTypes,s,l;n.searchClass="fxs-search";n.searchBoxClass=n.searchClass+"box";s=n.searchClass+"-icon";n.autoExpand=!0;var h=r.Search,t=ko.observable,c=ko.observableArray,v=function(n){function i(){n.apply(this,arguments);this.journeysShown=t(!1);this.isExpanded=t(!1);this.showMenu=t(!0);this.showResults=t(!1);this.showSearching=t(!1);this.showExternalColumn=t(!1);this.showAllSubscriptionsSearch=t(!1);this.showChangeSubscriptions=t(!1);this.text=h;this.filter=t();this.searchInFilterText=t();this.subscriptionSummary=t();this.mruItems=c();this.results=c()}return __extends(i,n),i}(f.ViewModel);n.ViewModel=v;l=function(
r){function f(f,c){var a=this,y;r.call(this,f,c);this.isDropdownInitialized=ko.observable(!1);y=n.searchClass;f.addClass(y).html(e());this._bindDescendants({text:c.text,autoExpand:n.autoExpand});var k=f.findByClassName(n.searchBoxClass),p=this._textWidget=new u.Widget(k,{placeholder:t(h.placeholder),readonly:t(!1)}),d=this._textField=$(p._getElementToFocus()),v,w,l=o.focusin,g=o.mousedown,b=f.findByClassName(s);f.on(l,v=function(){f.off(l,v);var n=a._initOptions;(n&&n()||Q(!0)).then(function(){i.require("MsPortalImpl/Widgets/Widgets.SearchDefered").then(function(n){a.isDropdownInitialized(!0);n.initialize(a,d)})})});b.on(l,w=function(n){n.preventDefault();a.setFocus()});this.lifetimeManager.registerForDispose(function(){p.dispose();f.off(l,v);b.off(l,w)})}return __extends(f,r),f.prototype.setFocus=function(){this.options.isExpanded(!0);this._textField.focus()},f.prototype.initOptions=function(n){this._initOptions=n},f}(f.Widget);n.Widget=l}(o||(o={})),o});define("_generated/Templates/WidgetsSideBar",
["require","exports"],function(){"use strict";return function(){return'<div class="fxs-sidebar-bar" role="navigation"> <button class="fxs-sidebar-collapse-button fxs-has-hover" role="button" data-bind="image: data.icons.hamburger"><\/button> <!-- ko if: data.cloudOptions().length > 1 --> <div class="fxs-sidebar-cloudFilter" data-bind=\'formElement: func.cloudDropDown\'><\/div> <!-- /ko --> <button class="fxs-sidebar-create fxs-has-hover fxs-has-border" role="button" data-bind="attr: { title: data.createTooltip }"> <div class="fxs-sidebar-button-flex"> <div class="fxs-sidebar-create-icon fxs-fill-success" data-bind="image: data.icons.plus"><\/div> <div class="fxs-sidebar-create-label fxs-sidebar-show-if-expanded" data-bind="text: data.createText"><\/div> <\/div> <\/button> <ul class="fxs-sidebar-favorites"> <!-- ko foreach: data.favorites --> <!-- ko if: $data && typeof($data) !== "string" && $data.cloudName === $root.data.selectedCloud() --> <li class="fxs-sidebar-item fxs-has-hover fxs-sidebar-draggable fxs-sidebar-droppable fxs-has-border" draggable="true"> <a href="" class="fxs-sidebar-item-link" data-bind="attr: { href: uri, title: label, role: opensExternal ? \'link\' : \'button\' }"> <div class="fxs-sidebar-handle fxs-fill-secondary" data-bind="image: $root.data.icons.ellipsis"><\/div> <div class="fxs-sidebar-icon" data-bind="image: image"><\/div> <div class="fxs-sidebar-label fxs-sidebar-show-if-expanded" data-bind="text: label"><\/div> <div class="fxs-sidebar-external fxs-sidebar-show-if-expanded"> <!-- ko if: $data.opensExternal --> <div class="fxs-fill-secondary" data-bind="image: $root.data.icons.hyperlink"><\/div> <!-- /ko --> <\/div> <\/a> <\/li> <!-- /ko --> <!-- /ko --> <li> <button class="fxs-sidebar-browse fxs-has-hover fxs-menu-browse" data-bind="attr: { title: data.browseTooltip }"> <div class="fxs-sidebar-button-flex"> <div class="fxs-sidebar-browse-label fxs-sidebar-show-if-expanded" data-bind="text: data.browseText"><\/div> <div class="fxs-sidebar-browse-icon" data-bind="image: data.icons.caretUp"><\/div> <\/div> <\/button> <\/li> <\/ul> <\/div> <div class="fxs-sidebar-flyout fxs-popup fxs-sidebar-flyout-is-hidden"> <div class="fxs-sidebar-browse-flyout"> <div class="fxs-sidebar-flyout-header"> <button class="fxs-sidebar-flyout-close fxs-fill-secondary" data-bind="image: data.icons.Shell.close, attr: { title: data.closeText }"><\/button> <\/div> <div class="fxs-sidebar-content"> <div class="fxs-sidebar-hint-text" data-bind="text: data.toggleShortcutHintText"><\/div> <input class="fxs-sidebar-filter-input fxs-input fxs-input-default" role="combobox" data-bind="attr: { placeholder: data.placeholder, \'aria-label\': data.placeholder }, css: { \'fxs-sidebar-filter-categories\': data.showDisplayModePicker() }, valueUpdate: \'input\', value: data.filterInputValue" type="text"/> <div class="fxs-sidebar-dropdown-container" data-bind="stopBindings: true, css: { \'fxs-sidebar-hide\': !data.showDisplayModePicker() }"> <div class="fxs-sidebar-dropdown"><\/div> <\/div> <\/div> <ul tabindex="-1" aria-expanded="true" class="fxs-sidebar-possible-favorites" data-bind="css: { \'fxs-sidebar-adjustment\': data.showDisplayModePicker() }"> <!-- ko foreach: data.visibleCategories --> <!-- ko ifnot: $data.isHidden --> <!-- ko if: $data.showLabel --> <div class="fxs-sidebar-item-category" data-bind="css: { \'fxs-sidebar-hide\': $data.isFilteredOut() }"> <div class="fxs-sidebar-label" data-bind="text: label, attr: { title: label }"><\/div> <\/div> <!-- /ko --> <!-- ko foreach: $data.possibleFavorites --> <!-- ko if: $data.cloudName === $root.data.selectedCloud() --> <!-- ko ifnot: $data.isHidden --> <li tabindex="-1" class="fxs-sidebar-item fxs-has-hover" data-bind="css: { \'fxs-sidebar-hide\': $data.isFilteredOut() || $parent.isFilteredOut() }, attr: { id: labelId }"> <div class="fxs-sidebar-item-content"> <a href="" tabindex="-1" class="fxs-sidebar-item-link" data-bind="attr: { href: uri, role: opensExternal ? \'link\' : \'button\'}"> <div class="fxs-sidebar-icon" data-bind="image: image"><\/div> <div class="fxs-sidebar-label"> <span data-bind="text: label, attr: { title: label }"><\/span> <!-- ko if: $data.matches --> <div class="fxs-sidebar-matches"><span class="fxs-sidebar-matches-prefix" data-bind="text: $root.data.matchesPrefix"><\/span> <span data-bind="text: $data.matches, attr: { title: $data.matches }"><\/span><\/div> <!-- /ko --> <\/div> <!-- ko if: $data.isPreview --> <span class="fxc-preview fxcontrol-preview" data-bind="text: $root.data.previewText, attr: { title: $root.data.previewText }"><\/span> <!-- /ko --> <!-- ko if: $data.opensExternal --> <div class="fxs-sidebar-external"> <div class="fxs-fill-secondary" data-bind="image: $root.data.icons.hyperlink"><\/div> <\/div> <!-- /ko --> <\/a> <div class="fxs-sidebar-star" data-bind="image: $root.data.icons.star, css: {\'fxs-is-favorite\': isFavorite}"><\/div> <\/div> <\/li> <!-- /ko --> <!-- /ko --> <!-- /ko --> <!-- /ko --> <!-- /ko --> <\/ul> <!-- ko if: data.feedbackLabel --> <div class="fxs-popup-feedback"> <a href=\'#\' class=\'fxs-sidebar-feedback-link\' role=\'button\' data-bind="text: data.feedbackLabel, attr: { title: data.feedbackLabel }"><\/a> <\/div> <!-- /ko --> <\/div> <\/div> '}
});define("MsPortalImpl/Widgets/Widgets.SideBar",["require","exports","f","../Base/Base.Router","../Interactions/Interactions.DismissHandler","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","../Services/Services.GeneralSettings","../Generated/SvgDefinitions","../Base/Telemetry","./Widgets.WidgetBase","../../_generated/Templates/WidgetsSideBar","./Widgets.DropMenu","../../_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css"],function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var v;return function(n){function rt(n,t,i){ir.trace({source:h.Source.SideBar,name:t,action:n,data:i})}function bt(n,t,i,r){rt(n,i,wr({view:tu(t)},r||{}))}function kr(n,t,i,r){var u=r?v.expand:v.collapse;n.toggleClass(cr,r);t.attr({title:u,"aria-expanded":!r});n.handleTransitionEndOnce("width",150,function(){p(ii).trigger(b.resize)})}function ai(n,t,i,r){n.removeClass(w);(n.length===0||t.length===0)&&(t=i);var u=d(t[0]);r.attr(li,t.attr("id"));t.addClass(w);t.get(0).scrollIntoView(
!1)}function dr(n){var r=n.isCollapsed(),t=!r,i=n.saveCollapseState;n.getStartboardVisible&&n.getStartboardVisible()&&i&&i(t);n.isCollapsed(t)}function vi(n,t){var i=n.id,r=t.favorites,e=r().firstIndex(function(n){return n.id===i}),u,f,o;n.isFavorite()?e!==-1&&(n.isFavorite(!1),r.splice(e,1),u=k.SideBarUnFavorite,f=t.removeFavoriteFromSettings):e===-1&&(n.isFavorite(!0),o=t.possibleFavorites().first(function(n){return n.id===i}),r.push(o),u=k.SideBarFavorite,f=t.addFavoriteToSettings);u&&rt(u,i,{totalFavorites:r().length});f&&f(i)}function yi(n,t,i){var r=i.favorites,u=r.indexOf(n),f=r.indexOf(t);return rt(k.SideBarFavoriteMoved,t.id,{oldIndex:f,newIndex:u}),r.splice(u,0,r.splice(f,1)[0]),i.moveFavorite(u,f),u}function pi(n,t,i){var r=p(document.activeElement).parent(),u=i?r.next(fi)[0]:r.prev(fi)[0];if(u){var f=d(u),e=yi(f,n,t),o=t.favorites()[e].uri,s=p("."+ri+" [href|='"+o+"']");s.focus()}}function ki(n){return(wi.test(n)||bi.test(n))&&(n+=" "+n.replace(wi,"$1 ").replace(bi,"")),n.toLowerCase(
)}function gr(n){return n.toLowerCase().replace(kt," ").split(" ")}function di(n,t){return ki(n).replace(kt," ").split(" ").map(function(n){return{value:n,keywordHint:t}})}function nu(n,t){var i=!!n.length,r;t.isFiltered(i);r=gr(n);t.possibleFavorites().forEach(function(n){var f=!0,e=[],t,u;i&&(t=dt[n.id],u=n.keywords,t||(t=di(n.label(),!1),u&&t.push.apply(t,di(u,!0)),dt[n.id]=t),f=r.every(function(n){var i=t.filter(function(t){if(t.value.startsWith(n)){if(t.keywordHint){var r=u.split(","),i=r.first(function(t){var i=ki(t).replace(kt," ");return i.startsWith(n)||RegExp(" "+n).test(i)});i=(i||r.first(function(t){return t.indexOf(n)>=0})||"").trim();e.push(i)}return!0}return!1});return i.length>0}));n.isFilteredOut(!f);n.matches(i&&e.first())})}function gt(n){var t=n.findByClassName(w);t.removeClass(w)}function gi(n,t){var i=n.find("."+et+":not("+ot+")").first();i.addClass(w);t.attr(li,i.attr("id"))}function g(n){n.preventDefault()}function ut(n){n.stopPropagation()}function nr(n,t){n.displayModeTitle(
t===0?v.showByCategory:v.showByName)}function tu(n){return n===0?"category":"name"}var st=i.Base,ni=st.Utilities,ir=st.Diagnostics.Telemetry,b=st.EventTypes,rr=i.ViewModels,ti=s.Content.SvgLibrary,ur=rr.Forms.DropDown,fr=ur.ViewModel,ii=window,p=jQuery,t="fxs-sidebar",ri=t+"-bar",ui=t+"-browse",er=t+"-flyout-close",or=t+"-create",sr=t+"-draggable",hr=t+"-droppable",ht="."+hr,it=t+"-entered",ft="."+it,cr=t+"-is-collapsed",w="fxs-is-selected",et=t+"-item",fi="li."+et,lr="."+et+" a",ar=t+"-filter-input",ct=t+"-flyout",ei=ct+"-is-hidden",oi=ct+"-is-open",vr=t+"-collapse-button",lt=ui+"-shown",yr=t+"-hide",ot="."+yr,si=t+"-feedback-link",at=si+"-disabled",pr=t+"-possible-favorites",k=h.Action,v=f.SideBar,hi=f.KeyboardShortcuts.tooltipFormat,y=ko.observable,tt=ko.observableArray,d=ko.dataFor,wr=ni.extend,vt=38,yt=40,nt=b.click,pt=b.keyup,wt=b.keydown,ci=o.settings,li="aria-activedescendant",br=function(n){function t(){n.apply(this,arguments);this.browseText=v.browse;this.closeText=v.close;this.
browseTooltip=hi.format(v.browse,"B");this.createText=v.create;this.createTooltip=hi.format(v.create,"N");this.favorites=tt([]);this.isCollapsed=y(!0);this.isFlyoutOpen=y(!1);this.isFiltered=y(!1);this.possibleFavorites=tt([]);this.categories=tt([]);this.visibleCategories=tt([]);this.showCategories=y(!1);this.showDisplayModePicker=y(!1);this.previewText=v.preview;this.icons=ti;this.placeholder=v.search;this.toggleShortcutHintText=v.toggleShortcutHint;this.cloudOptions=tt([]);this.selectedCloud=y();this.displayModeTitle=y();this.displayModes=tt([]);this.filterInputValue=y();this.feedbackLabel=y(v.feedbackTitle);this.matchesPrefix=y(v.keywords)}return __extends(t,n),t.prototype.openExternal=function(n){window.open(n,"_blank")},t}(c.ViewModel),dt,tr;n.ViewModel=br;var wi=/([a-z](?=[A-Z][^ ]))/g,bi=/[^a-z0-9 ]/gi,kt=/[^a-z0-9]/gi;dt={};tr=function(n){function i(i,r){var o=this,u,tt,f,e,d,yt,nt;n.call(this,i,r);this._validateForDismiss=function(n){var t=o.element[0];return!(t===n)&&!p.contains(
t,n)};this._dismissHandle={dismissFn:function(){o.hideFlyout()},shouldDismissOnMouseDownFn:this._validateForDismiss,shouldDismissOnMouseWheelFn:this._validateForDismiss,logName:"sideBarFlyout"};i.html(l());u=i.findByClassName.bind(i);this._createButton=u(or);this._filterInput=u(ar);this._flyout=u(ct);this._browseLink=u(ui);this._closeButton=u(er);tt=this._collapseButton=u(vr);this._sideBar=u(ri);var it=this._feedbackLink=u(si),rt=ni.getUniqueId(),pt=this._flyout.findByClassName(pr);pt.attr("id",rt);this._filterInput.attr("aria-owns",rt);f=this.lifetimeManager;e=this._displayMode=ci.sideBarBrowseDisplayModeKey();e!==0&&e!==1&&(e=this._displayMode=0);nr(r,e);bt(k.SideBarBrowseMenuViewInitialized,e);var h=[{id:"_",label:"",showLabel:y(!1),isFilteredOut:y(!0),isHidden:y(!1),possibleFavorites:r.possibleFavorites}],ft=r.showCategories,et=r.isFiltered,c=function(){var n=ft()&&!et();r.showDisplayModePicker(n);n=n&&o._displayMode!==1;h.forEach(function(t){t.isFilteredOut(n)});r.categories().forEach(
function(t){t.isFilteredOut(!n)})};r.visibleCategories(h.concat(r.categories()));r.categories.subscribe(f,function(){r.visibleCategories(h.concat(r.categories()))});var ot=r.cloudOptions,wt={label:y(v.cloud),options:ot},kt=this.cloudDropDown=new fr(f,wt),w=kt.value;ot.subscribe(f,function(n){n.length>0&&!w()&&w(n[0].value)});w.subscribe(f,function(n){r.selectedCloud(n)});var s=t+"-dropdown",b=s+"-button",st=s+"-item",ht="fx-dropmenu",lt="data.displayModeTitle",vt=new a.ViewModel('<div class="'+s+'-title" data-bind="text: '+lt+", attr: { title: "+lt+' }"><\/div>'+('<button type="button" tabindex="-1" class="'+b+'">')+('<div class="'+b+'-container">')+('<div class="'+b+'-icon">'+ti.caretDown.data+"<\/div>")+"<\/div><\/button>",'<div class="'+ht+'-dropdown">'+('<ul class="'+ht+'-list-system">')+"<!-- ko foreach: data.displayModes -->"+('<li class="'+st+' fxs-has-hover">')+'<a href="" data-bind="attr: { title: title, id: displayMode }, click: $parent.func.clickHandler">'+('<div class="'+st+
'-title" data-bind="text: title"><\/div>')+"<\/a><\/li><!-- /ko --><\/ul><\/div>");vt.alignMenu=0;d=new a.Widget(u(s),vt);r.displayModes([{displayMode:0,title:v.showByCategory},{displayMode:1,title:v.showByName}]);yt=function(n,t){g(t);ut(t);var i=o._displayMode=n.displayMode;nr(r,i);c();d.hide();ci.sideBarBrowseDisplayModeKey(i);bt(k.SideBarBrowseMenuViewChanged,i)};ko.applyBindings({data:r,func:{clickHandler:yt}},d.element[0]);this._bindDescendants();this._attachEventHandlers(f,i,r);nt=!1;it.addClass(at);r.isFlyoutOpen.subscribe(f,function(n){var t=o._initOptions;n&&!nt&&t&&t().then(function(){nt=!0;it.removeClass(at)})});r.isCollapsed.subscribe(f,function(n){kr(i,tt,r,n)}).callback(r.isCollapsed());ft.subscribe(f,c);et.subscribe(f,c).callback(!0)}return __extends(i,n),i.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanElement();var t=this._dismissHandle;t&&u.unregister(t);this._dismissHandle=null},i.prototype.initOptions=function(n){this._initOptions=n},i.prototype.
showFlyout=function(){var n=this._flyout,t=this._filterInput;n.addClass(oi);n.removeClass(ei);this._filterInput.focus();this.options.isFlyoutOpen(!0);gi(n,t);rt(k.SideBarBrowseMenuOpened);u.register(this._dismissHandle)},i.prototype.hideFlyout=function(){var n=this._flyout,t;n.removeClass(lt);this._browseLink.removeClass(w);n.removeClass(oi);n.addClass(ei);t=this.options;t.filterInputValue("");t.isFlyoutOpen(!1);gt(n);u.unregister(this._dismissHandle)},i.prototype.toggleFlyout=function(){this.options.isFlyoutOpen()?this.hideFlyout():this._flyout.hasClass(lt)?this.showFlyout():this._browseLink.click()},i.prototype.openCreate=function(){rt(k.SideBarNewMenuOpened);this.hideFlyout();this.options.launchBlade(r.getGalleryDeepLink("hub","",this.cloudDropDown.value()))},i.prototype.openFavorite=function(n){var i=this.options,t=i.favorites()[n];t&&(t.opensExternal?ii.open(t.uri,"_blank"):i.launchBlade(t.uri))},i.prototype._attachEventHandlers=function(n,i,r){var f=this,o=this._flyout,s=this._filterInput,
tt=this._sideBar,y=this._feedbackLink,c=o.findByClassName.bind(o),u=function(t,i,r,u){t.on(i,r,u);n&&n.registerForDispose(function(){t.off(i,r,u)})},h,l,a,v;u(this._createButton,nt,null,function(){f.openCreate()});h=this._browseLink;l=function(){h.addClass(w);o.addClass(lt);f.toggleFlyout()};u(h,nt,null,function(){l()});u(h,pt,null,function(n){if(n.keyCode===13)return l(),!1});u(this._closeButton,nt,null,function(){f.hideFlyout()});u(i,nt,lr,function(n){var t=d(n.target),i=t.uri,u=n.ctrlKey,e=n.shiftKey;f.hideFlyout();bt(k.SideBarItemOpened,f._displayMode,t.id,{isFavorite:t.isFavorite()});t.opensExternal?(g(n),r.openExternal(i)):u||e||(g(n),r.launchBlade(i))});u(i,nt,"."+t+"-star",function(n){var i=d(n.target),t;vi(i,r);gt(o);t=p(n.target).closest("li");t.addClass(w);s.focus()});u(this._collapseButton,nt,null,function(){dr(r)});a=e.getModifierKeys;u(tt,wt+" "+pt,null,function(n){var u=a(n),t=n.keyCode,i;(t===yt||t===vt)&&u===5&&(g(n),n.type===wt?f._dragItem=d(n.target):(i=f._dragItem,t===
yt?pi(i,r,1):pi(i,r,0)))});u(s,wt,null,function(n){var e=a(n),u=c(w),t,i;u.length>0&&(t=d(u[0]),i=t.uri);n.keyCode===vt&&g(n);switch(n.keyCode+""+e){case"324":return vi(t,r),ut(n),!1;case"130":i&&(f.hideFlyout(),t.opensExternal?r.openExternal(i):r.launchBlade(i));ut(n)}});v=function(){return c(w)};u(s,pt,null,function(n){var t=v(),r=c(et).not(ot).first(),u=t.nextAll("li").not(ot),i;switch(n.keyCode){case yt:i=u.first();ai(t,i,r,s);ut(n);break;case vt:i=t[0]===r[0]?u.last():t.prevAll("li").not(ot).first();ai(t,i,r,s);ut(n)}});r.filterInputValue.subscribe(n,function(n){nu(n,r);var t=v();t.is(":visible")||(gt(o),gi(o,s))});u(i,b.dragstart,"."+sr,function(n){var i=n.target,t=n.originalEvent.dataTransfer;t.setData("text","foo");t.effectAllowed="move";f._dragItem=d(n.target)});u(i,b.dragover,null,function(n){g(n)});u(i,b.dragenter,null,function(n){var t=p(n.target),i=t.closest(ht),r=t.closest(ft);r.length===0&&(p(ft).removeClass(it),i.length&&i.addClass(it))});u(i,b.dragleave,null,function(n)
{var t=p(n.target),i=t.closest(ht).length===0?!0:!1;i&&p(ft).removeClass(it)});u(i,b.drop,null,function(n){var t=n.target,i=p(t).closest(ht),u=d(t);g(n);p(ft).removeClass(it);i.length&&yi(u,f._dragItem,r)});u(y,nt,null,function(n){g(n);y.hasClass(at)||r.openFeedbackPane()})},i}(c.Widget);n.Widget=tr}(v||(v={})),v});define("MsPortalImpl/Widgets/Widgets.Portal",["require","exports","f","../Interactions/Interactions.ContextMenuTouch","../Interactions/Interactions.OverflowAutoTooltip","../Services/Services.GeneralSettings","../Base/Telemetry","../Base/Base.UriHelper","./Widgets.AvatarMenu","./Widgets.WidgetBase","./Widgets.ContextPane","./Widgets.HelpMenu","./Widgets.NotificationMenu","./Widgets.Panorama","../../_generated/Templates/WidgetsPortal","./Widgets.Search","./Widgets.SideBar","./Widgets.TopBar","../../_generated/Less/MsPortalImpl/Widgets/Widgets.Portal.css"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";var k;return function(t){var g=i.Base,nt=g.Diagnostics,st=nt.Telemetry,
ht=g.EventTypes,tt=window,it=jQuery,rt=ht,ct=tt.fx.environment,ti=nt.createLog(n),ii=it("body"),lt="fxs-topbar-avatarmenu",at="fxs-topbar-helpmenu",vt="fxs-topbar-notifications",yt="fxs-topbar-search",d="fxs-show-journey",ut="fxs-show-startboard",k="fxs-portal",pt=k+"-content",wt=k+"-contextpane-left",bt=k+"-contextpane-right",ft="fxs-desktop-normal",kt="fxs-sidebar",ri=k+"-sidebar-is-hidden",dt=k+"-sidebar-is-visible",ui=k+"-contextpane-visible",gt="fxs-topbar",ni="fxs-fullwidth",fi=ko.observable,ei=i.forEachKey,et,ot;ko.components.register("fxs-progress",{template:'<div class="fxs-progress-dots"><div><\/div><div><\/div><div><\/div><\/div>'});et=function(n){function t(){n.apply(this,arguments);this.topBar=new b.ViewModel;this.sideBar=new w.ViewModel}return __extends(t,n),t}(h.ViewModel);t.ViewModel=et;ot=function(n){function t(t,i){var ut=this,e,nt,h,tt,rt,d,g;n.call(this,t,i);this.hasActiveJourney=!1;e=t.findByClassName.bind(t);t.html(y()).addClass(k).addClass(ft);this._topBarWidget=
new b.Widget(e(gt),this.options.topBar);this._panoramaContainer=e(pt);nt=new v.ViewModel("fxs-panorama-instanceid");this._panorama=new v.Widget(this._panoramaContainer,nt);h=new c.ViewModel;h.collapsed=i.sideBar.isCollapsed;this._leftContextPaneWidget=new c.Widget(e(wt),h);this._rightContextPaneWidget=new c.Widget(e(bt),new c.ViewModel);tt=new r.ContextMenuTouch(t);rt=new u.OverflowAutoTooltip(t);this._avatarMenuWidget=new s.Widget(e(lt),new s.ViewModel);this._helpMenuWidget=new l.Widget(e(at),new l.ViewModel);this._searchWidget=new p.Widget(e(yt),new p.ViewModel);this._notificationMenuWidget=new a.Widget(e(vt),new a.ViewModel);i.sideBar.getStartboardVisible=function(){return ut.isStartBoardVisible()};this._sideBarWidget=new w.Widget(e(kt),i.sideBar);t.addClass(dt);ct.features.fullwidth==="true"&&t.addClass(ni);d=f.settings;g=this.lifetimeManager;ko.computed(g,function(){var n=d.animationEnabledKey&&d.animationEnabledKey(),t=new o.Uri(location.href).getQueryStringValue("enableAnimations");
t||it.enableAnimations(n)});g.registerForDispose(function(){tt.dispose();rt.dispose()})}return __extends(t,n),t.prototype.dispose=function(){this._avatarMenuWidget.dispose();this._panorama.dispose();this._cleanElement(k,ft);n.prototype.dispose.call(this)},t.prototype.getPanorama=function(){return this._panorama},t.prototype.getLeftContextPane=function(){return this._leftContextPaneWidget},t.prototype.getRightContextPane=function(){return this._rightContextPaneWidget},t.prototype.getAvatarMenuWidget=function(){return this._avatarMenuWidget},t.prototype.getHelpMenuWidget=function(){return this._helpMenuWidget},t.prototype.getNotificationMenuWidget=function(){return this._notificationMenuWidget},t.prototype.getSearchWidget=function(){return this._searchWidget},t.prototype.getSideBarWidget=function(){return this._sideBarWidget},t.prototype.getTopBarWidget=function(){return this._topBarWidget},t.prototype.isStartBoardVisible=function(){return!this.element.hasClass(d)},t.prototype.isJourneyVisible=
function(){return this._hasJourneyWithContent()&&this.element.hasClass(d)},t.prototype.showStartBoard=function(){this._sideBarWidget.options.isCollapsed(f.settings.sideBarCollapsedKey());this.element.removeClass(d).addClass(ut);this.options.topBar.dashboardVisible(!0);this.trigger(rt.fxshowstartboard);var n=this.getPanorama().getStartBoardWidget();n&&n.setFocus()},t.prototype.showJourney=function(){if(!this.isJourneyVisible()){this.element.removeClass(ut).addClass(d);this.options.topBar.dashboardVisible(!1);var n=this.getPanorama().getJourneyWidget();n&&n.setFocus()}},t.prototype._hasJourneyWithContent=function(){var n=this.getPanorama(),t=n&&n.getJourneyWidget(),r=t&&t.hasChildren(),i=this.getRightContextPane(),u=i&&i.options.opened();return r||u},t.prototype.handleStartButtonClick=function(){var t=e.ActionModifier.PortalScrolled,i=new o.Uri(tt.location.href),r=i.hash==="#"||!i.hash,n;this.isStartBoardVisible()||(this._hasJourneyWithContent()&&r&&!this.hasActiveJourney?(n=this._panorama.
getJourneyWidget(),n&&n.close()):(this.element.trigger(rt.fxhomebuttonclick),t=e.ActionModifier.StartBoardRestored));st.trace({source:e.Source.Desktop,action:e.Action.HomeButtonClicked,actionModifier:t})},t}(h.Widget);t.Widget=ot}(k||(k={})),k});define("MsPortalImpl/Services/Services.FileUploadInitialization",["require","exports","f","MsPortalImpl/Services/Services.Settings"],function(n,t,i,r){"use strict";var u;return function(n){function o(i){t||(t=!0,n.uploadSettingsManager=i,Q(i.querySettings({store:u.FileUpload})).then(function(n){var t=!1;for(var r in n){t=!0;break}t&&e().then(function(n){return n.init(i)})}))}var u=r.SettingStore,f="MsPortalImpl/Services/Services.FileUploadSettings",e=i.memoize(function(){return i.require(f).then(function(n){return n.fileUploadResumableTrackerInstance()})}),t=!1;n.init=o}(u||(u={})),u});define("MsPortalImpl/Extension/Extension.DefinitionValidator",["require","exports","f","u"],function(n,t,i,r){"use strict";var u;return function(n){function o(n,
t){d(n,function(n,i){i!==r&&t(n,i)})}function g(n,i){var f=new c,r=f.errors;return n?(o(n,function(i,f){switch(i){case"name":t("Extension name",f,r);break;case"version":case"hash":case"schemaVersion":case"sdkVersion":case"buildDescription":t(i,f,r);break;case"isPreview":l(i,f,r);break;case"assetTypes":u(i,f,r);break;case"blades":nt(n,f,r);break;case"startBoardParts":ft(f,r);break;case"partsCatalog":yt(f,r);break;case"commandsCatalog":vt(f,r);break;case"commandGroups":lt(f,r);break;case"htmlTemplates":ot(f,r);break;case"styleSheets":st(f,r);break;case"galleryService":ht(f,r);break;case"dashboardProvider":ct(f,r);break;case"requireConfig":break;default:r.push("Unexpected attribute '{0}' on definition.".format(i))}}),i&&i.hubs&&i.hubs.forEach(function(t){t.htmlTemplate&&(n.htmlTemplates[t.htmlTemplate]||r.push("Html template for hub '{0}' not found.".format(t.name)))}),f):(r.push("Definition is null or undefined."),f)}function t(n,t,i){typeof t!="string"&&i.push("{0} is not a valid string.".
format(n))}function l(n,t,i){typeof t!="boolean"&&i.push("{0} is not a valid boolean.".format(n))}function u(n,t,i){var r=Array.isArray(t);return r||i.push("The '{0}' property is not a valid array.".format(n)),r}function nt(n,t,i){t&&u("blades",t,i)&&t.forEach(function(t,r){a(n,t,r,i)})}function a(n,t,i,r){var f=t.name;t.inputs&&u("Blade: {0}. Property: blades[{1}].inputs".format(f,i),t.inputs,r);t.optionalInputs&&u("Blade: {0}. Property: blades[{1}].optionalInputs".format(f,i),t.optionalInputs,r);u("Blade: {0}. Property: blades[{1}].lenses".format(f,i),t.lenses,r)&&t.lenses.forEach(function(n,t){var e="Blade: {0}. Lens: {1}. Property: blades[{2}].lenses[{3}].".format(f,n.name,i,t);n.partInstances&&u(e,n.partInstances,r)&&n.partInstances.forEach(function(u,e){var o="Blade: {0}. Lens: {1}. Part: {2}. Property: blades[{3}].lenses[{4}].partInstances[{5}]".format(f,n.name,u.name,i,t,e);y(o,u,r)})});t.permissions&&u("Blade: {0}. Property: blades[{1}].permissions".format(f,i),t.permissions,r)&&
t.permissions.forEach(function(n,t){s("Blade: {0}. Property: blades[{1}].permissions[{2}]".format(f,i,t),n,t,r)});tt(t.toolbar,"Blade: {0}. Property: blades[{1}].toolbar".format(f,i),r);it(t.actionBar,"Blade: {0}. Property: blades[{1}].actionBar".format(f,i),r)}function tt(n,t,i){n&&(n.source?v(n.source,t+".source",i):i.push("Source not specified for toolbar. "+t))}function it(n,t,i){n&&n.source&&v(n.source,t+".source",i)}function v(n,i,r){n.property&&t(i+".property",n.property,r);n.optional&&typeof n.optional!="boolean"&&r.push("The attribute 'optional' should be of type boolean. "+i);n.isIdentityInput&&typeof n.isIdentityInput!="boolean"&&r.push("The attribute 'isIdentityInput' should be of type boolean. "+i);u(i+".valuesFrom",n.valuesFrom,r)&&n.valuesFrom.forEach(function(n,t){rt(i+".valuesFrom[{0}]".format(t),n,r)})}function rt(n,i,r){switch(i.referenceType){case f.Part:case f.BladeInput:case f.BladeActionBar:case f.BladeProperty:case f.Command:case f.Constant:case f.SelectedItem:case
f.Adapter:break;default:r.push("Unknown reference type '{0}' found for {1}.referenceType.".format(i.referenceType,n))}t(n+".property",i.property,r);i.part&&t(n+".part",i.part,r)}function ut(n,i,r){switch(i.sourceType){case e.AssetIdSourceType.FromInput:i.providerKey&&r.push("Asset ID source source type of FromInput with provider key (should be null) found for {0}.sourceType.".format(n));break;case e.AssetIdSourceType.FromProvider:i.providerKey||r.push("Asset ID source source type of FromProvider with missing provider key found for {0}.sourceType.".format(n));t(n+".providerKey",i.providerKey,r);break;case e.AssetIdSourceType.FromSourceProvider:i.providerKey||r.push("Asset ID source source type of FromSourceProvider with missing provider key found for {0}.sourceType.".format(n));t(n+".providerKey",i.providerKey,r);break;default:r.push("Unknown asset ID source source type '{0}' found for {1}.sourceType.".format(i.sourceType,n))}t(n+".property",i.property,r)}function s(n,i,r,f){var o,c;switch(
i.permissionType){case e.PermissionType.Permission:o=i;o.extensionName&&t(n+".extensionName",o.extensionName,f);t(n+".assetType",o.assetType,f);o.assetId?ut(n+".assetId",o.assetId,f):f.push("Permission missing assetId found for {0}.assetId.".format(n));t(n+".action",o.action,f);break;case e.PermissionType.PermissionSet:c=i;switch(c.requirement){case h.All:case h.Any:break;default:f.push("Unknown permission set requirement '{0}' found for {1}.requirement.".format(c.requirement,n))}u(n+".permissions",c.permissions,f)&&c.permissions.forEach(function(t,i){s("{0}.permissions[{1}]".format(n,i),t,i,f)});break;default:f.push("Unknown permission type '{0}' found for {1}.permissionType.".format(i.permissionType,n))}}function ft(n,t){u("startBoardParts",n,t)&&n.forEach(function(n,i){y("startBoardParts[{0}]".format(i),n,t)})}function y(n,t,i){t.reference||t.inline?t.reference&&t.inline?i.push("'reference' and 'inline' properties cannot be set at the same time on PartInstanceDefinition. Property: {0}".
format(n)):t.reference&&!t.reference.partTypeName?i.push("'partTypeName' property is required on part reference. Property: {0}".format(n)):t.inline&&p(n,t.inline,i):i.push("'reference' or 'inline' property required on PartInstanceDefinition. Property: {0}".format(n))}function p(n,t,i){t&&(et(n,t.partState,i),t.permissions&&u("{0}.permissions".format(n),t.permissions,i)&&t.permissions.forEach(function(t,r){s("{0}.permissions[{1}]".format(n,r),t,r,i)}))}function et(n,t,i){if(t){var e=t.inputIdentityProperties||[],f=t.sharedProperties||[],o=e.concat(f.map(function(n){return n.property})),s=f.map(function(n){return n.key}),r=w(o),u=w(s);r&&r.length>0&&i.push("Part view model properties cannot be used in multiple part settings. Duplicated properties: '{0}'. Path: '{1}'.".format(JSON.stringify(r),n));u&&u.length>0&&i.push("Shared key settings cannot be used in multiple part settings. Duplicated keys: '{0}'. Path: '{1}'.".format(JSON.stringify(u),n))}}function w(n){var t={},i=[];return(n||[])
.forEach(function(n){!t[n]||i.push(n);t[n]=!0}),i}function ot(n,i){o(n,function(n,r){typeof r!="string"&&(t("htmlTemplates['{0}'].file".format(n),r.file,i),t("htmlTemplates['{0}'].content".format(n),r.content,i))})}function st(n,i){Array.isArray(n)?n.forEach(function(n,r){t("StyleSheet at position {0}".format(r),n,i)}):i.push("Invalid type for 'styleSheets' property on definition.")}function ht(n,i){var r;o(n,function(n,t){switch(n){case"serviceViewModel":r=t;break;default:i.push("Unexpected properties on 'galleryService' property of definition.")}});t("galleryService.serviceViewModel",r,i)}function ct(n,t){var i=n.viewModel;i&&typeof i=="string"||t.push("The view model of dashboard provider must be non-empty string.")}function lt(n,t){n&&u("commandGroups",n,t)&&n.mapMany(function(n){return n.commands}).forEach(function(n){n.reference&&at(n,t)})}function at(n,t){if(n&&n.reference){var i=!1;o(n,function(n){n!=="name"&&n!=="bindings"&&n!=="reference"&&(i=!0)});i?t.push("Command reference can only define 'name' and 'bindings' properties. Definition: {0}".
format(ko.toJSON(n))):n.reference.commandType||t.push("Command reference must specify the 'commandType' property. Definition: {0}".format(ko.toJSON(n)))}}function vt(n,t){n&&u("commandsCatalog",n,t)&&n.forEach(function(n){n.name||t.push("Commands in 'commandsCatalog' must have names.");!n.reference||t.push("Commands in 'commandsCatalog' cannot specify a 'reference' property.")})}function yt(n,t){n&&u("partsCatalog",n,t)&&n.forEach(function(n){b(n,t)})}function pt(n,i){t("name",n.name,i);t("moduleId",n.moduleId,i)}function b(n,t){n.inputDefinitions&&u("PartType: {0}. Property: inputDefinitions".format(n.name),n.inputDefinitions,t);n.reference&&wt(n,t);p("PartType: {0}".format(n.name),n,t)}function wt(n,t){(n.reference.bindings||[]).forEach(function(i){(i.valuesFrom||[]).forEach(function(i){i.referenceType!==f.Adapter&&i.referenceType!==f.AdapterInput&&i.referenceType!==f.Constant&&t.push("Adapted Part: {0} can only have Adapter, AdapterInput and Constant bindings for its referenced part.".
format(n.name))})})}var k=i.Base.Constants.ExtensionNames.Hubs,e=i.Extension,f=e.ReferenceType,h=e.SetRequirement,d=i.forEachKey,bt=[{extension:k,blade:"BrowseAllBladeWithType"}],c=function(){function n(){this.errors=[]}return n.prototype.valid=function(){return!this.errors.length},n}();n.ValidationResult=c;n.validateDefinition=g;n.validateIsString=t;n.validateIsBoolean=l;n.validateIsArray=u;n.validateBlade=a;n.validateControl=pt;n.validatePartType=b}(u||(u={})),u});define("MsPortalImpl/Extension/Extension.Manifest",["require","exports","f","./Extension.DefinitionValidator","../Services/Services.Storage"],function(n,t,i,r,u){"use strict";var f;return function(n){function v(n){var i=new r.ValidationResult,u,f;return n?((typeof n.name!="string"||t.isNullOrWhiteSpace(n.name)||n.name.indexOf("!")>=0)&&(f="The extension manifest should specify a valid name. This name is obtained from the <Extension> tag in PDL. This name should be a string and cannot be empty or whitespace. It also cannot contain the ! character. The recommended naming convention for an extension name is to follow the pattern {Company}_{BrandOrSuite}_{ProductOrComponent} (e.g. Microsoft_Azure_Insights).",
i.errors.push(f)),n.assetTypes&&r.validateIsArray("manifest.assetTypes",n.assetTypes,i.errors)&&n.assetTypes.forEach(function(t){y(t,n.name,i.errors)}),n.hubs&&r.validateIsArray("manifest.hubs",n.hubs,i.errors)&&n.hubs.forEach(function(t){p(t,n.name,i.errors)}),i):(u="Manifest was not specified for the extension. Ensure that you passing a valid manifest to the FxExtension.register/FxExtension.registerAmd call that is used to register your extension with the portal.",i.errors.push(u),i)}function y(n,i,r){if(t.isNullOrWhiteSpace(n.name)&&r.push("The name for the asset type in manifest '{0}' was not specified.".format(i)),n.browseType!==undefined&&typeof n.browseType!="number"&&r.push("The browse type for the asset type '{0}' in manifest '{1}' was not a number.".format(n.name,i)),n.browseServiceViewModel&&typeof n.browseServiceViewModel!="string"&&r.push("The browse service view model for the asset type '{0}' in manifest '{1}' was not a string.".format(n.name,i)),n.browseLinkUri&&typeof n.
browseLinkUri!="string"&&r.push("The browse link URI for the asset type '{0}' in manifest '{1}' was not a string.".format(n.name,i)),n.privateBrowse!==undefined&&typeof n.privateBrowse!="boolean"&&r.push("The private browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.".format(n.name,i)),n.browseRequiresRdfe!==undefined&&typeof n.browseRequiresRdfe!="boolean"&&r.push("The requires RDFE browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.".format(n.name,i)),n.browseRequirements!==undefined&&typeof n.browseRequirements!="number"&&r.push("The browse requirements was present for the asset type '{0}' in manifest '{1}' was not a number.".format(n.name,i)),n.browseType!==undefined){switch(n.browseType){case f.ServiceViewModel:n.browseServiceViewModel||r.push("The browse for the asset type '{0}' in manifest '{1}' is set to use a service view model but there was no service view model.".format(n.name,i));break;case f.ResourceType:
n.browseServiceViewModel&&r.push("The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's resource type but there was a service view model.".format(n.name,i));break;case f.AssetTypeBlade:n.browseServiceViewModel&&r.push("The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's blade but there was a service view model.".format(n.name,i));break;case f.ServiceLink:n.browseLinkUri||r.push("The browse for the asset type '{0}' in manifest '{1}' is set to be a service link but there was no link URI.".format(n.name,i));break;case f.InstanceLink:n.browseLinkUri||r.push("The browse for the asset type '{0}' in manifest '{1}' is set to be an instance link but there was no link URI.".format(n.name,i))}n.privateBrowse!==undefined&&n.browseType===undefined&&r.push("The private browse flag was present for the asset type '{0}' in manifest '{1}' but there was browse type.".format(n.name,i));n.browseType!==f.ServiceViewModel&&n.browseServiceViewModel&&
r.push("The asset type '{0}' in manifest '{1}' has a browse service but doesn't have service view model browse type.".format(n.name,i));t.isNullOrWhiteSpace(n.pluralDisplayName)&&t.isNullOrWhiteSpace(n.text)&&r.push("The pluralDisplayName for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.".format(n.name,i));t.isNullOrUndefined(n.icon)&&r.push("The icon for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.".format(n.name,i))}else n.browseServiceViewModel!==undefined?n.browseType=f.ServiceViewModel:n.privateBrowse!==undefined&&r.push("The asset type '{0}' in manifest '{1}' has a private blade flag but no browse type.".format(n.name,i));n.gridColumnsServiceViewModel&&typeof n.gridColumnsServiceViewModel!="string"&&r.push("The grid columns service view model for the asset type '{0}' in manifest '{1}' was not a string.".format(n.name,i));n.dynamicBladeServiceViewModel&&typeof n.dynamicBladeServiceViewModel!=
"string"&&r.push("The dynamic blade service view model for the asset type '{0}' in manifest '{1}' was not a string.".format(n.name,i));n.propertyProviderServiceViewModel&&typeof n.propertyProviderServiceViewModel!="string"&&r.push("The property provider service view model for the asset type '{0}' in manifest '{1}' was not a string.".format(n.name,i))}function p(n,i,r){t.isNullOrWhiteSpace(n.name)&&r.push("The name for the hub in manifest '{0}' was not specified.".format(i));t.isNullOrWhiteSpace(n.title)&&r.push("The title for the hub in manifest '{0}' was not specified.".format(i));t.isNullOrUndefined(n.icon)&&r.push("The icon for the hub in manifest '{0}' was not specified.".format(i));t.isNullOrWhiteSpace(n.htmlTemplate)&&t.isNullOrUndefined(n.details)&&r.push("The manifest '{1}' must have either the html template or blade details for the hub '{0}'.".format(n.name,i));t.isNullOrWhiteSpace(n.htmlTemplate)&&n.details.length>1&&r.push("The manifest '{1}' must have a single blade action when the html template is not specified for the hub '{0}'.".
format(n.name,i));n.viewModel&&typeof n.viewModel!="string"&&r.push("The view model for the hub '{0}' in manifest '{1}' was not a string.".format(n.name,i))}var t=i.Base.Utilities,c=i.Extension,f=c.BrowseType,e=u.ComponentName.ManifestVersions,s="latest",h="expired",o=u.Lifetime.Default,l=i.forEachKey,a=function(){function n(n){var t,i;this._storage=n;t=n.getValue(e,s,o);this._latestVersions=JSON.parse(t||"{}");i=n.getValue(e,h,o);this._expiredVersions=JSON.parse(i||"{}")}return n.prototype.getLatest=function(n){var t=n.toLowerCase();return this._latestVersions[t]||""},n.prototype.setLatest=function(n){var t=this;l(n,function(n,i){var r=n.toLowerCase(),u=i.manifest,f=(u&&u.pageVersion||"").toLowerCase(),e=t._expiredVersions[r]||[];e.indexOf(f)!==-1||(t._latestVersions[r]=f)});this._storage.setValue(e,s,JSON.stringify(this._latestVersions),o)},n.prototype.expireLatest=function(n){var i=n.toLowerCase(),r=this._latestVersions[i],t;if(r){if(this._latestVersions[i]="",t=this._expiredVersions[
i],t){while(t.length>=5)t.pop();t.splice(0,0,r)}else this._expiredVersions[i]=[r];this._storage.setValue(e,s,JSON.stringify(this._latestVersions),o);this._storage.setValue(e,h,JSON.stringify(this._expiredVersions),o)}},n}();n.ExtensionVersionCache=a;n.validate=v}(f||(f={})),f});define("MsPortalImpl/_generated/Common/Relex.Channel",["require","exports"],function(){"use strict";var n;return function(n){var t,i,r;n.signature="###CHANNEL###",function(n){n[n.None=0]="None";n[n.Auth=1]="Auth";n[n.AuthAck=2]="AuthAck";n[n.ExtensionLoad=3]="ExtensionLoad";n[n.ExtensionReload=4]="ExtensionReload";n[n.ExtensionUnload=5]="ExtensionUnload";n[n.Boot=6]="Boot";n[n.Rpc=7]="Rpc";n[n.Telemetry=8]="Telemetry";n[n.Connection=9]="Connection"}(n.MessageKind||(n.MessageKind={}));t=n.MessageKind,function(n){n[n.Disconnected=1]="Disconnected"}(n.ConnectionEventType||(n.ConnectionEventType={}));i=n.ConnectionEventType,function(n){n[n.None=0]="None";n[n.FetchManifest=1]="FetchManifest";n[n.Proxy=2]="Proxy"}(n.ExtensionHostMode||
(n.ExtensionHostMode={}));r=n.ExtensionHostMode}(n||(n={})),n});define("MsPortalImpl/Extension/Extension",["require","exports","f","i","../UI/Compositions/UI.Composition.CloudName","../Extension/DefinitionPreprocessor","./Extension.DefinitionValidator","../Extension/Extension.Definition.Locator","../Extension/Extension.Manifest","MsPortalFx/Globalization","MsPortalImpl/Resources/ImplScriptResources","../Base/Languages","../Parts/Parts","../_generated/Common/Relex.Channel","../UI/Compositions/UI.Composition.BladeOpenerBase","../UI/Hubs/UI.NotificationManager","../Base/Base.UriHelper","../Extension/ViewModelManager"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";var k;return function(t){function hu(n){si=n;fi={}}function cu(n){var t=fi[n],i;return t||(t=fi[n]=[],i=k.extensionFlags,su(i,function(i,r){var u=i.toLowerCase(),f=n+"_";u.startsWith(f)&&t.push({key:i,featureName:u.substr(f.length),value:r})})),t}function sr(n,t,i,r){n.setParameter(t,r);var u="feature."+i;lt(si.getParameter(
t))&&lt(si.getParameter(u))||(i==="clientoptimizations"&&n.setParameter(i,r),n.setParameter(u,r))}function hi(n){return n&&n.formatCulture===ti&&n.displayLanguage===ni}function ci(n){var i=ri.format(n),t;try{t=JSON.parse(it.localStorage.getItem(i))}catch(r){nt.error(r,4,n)}return t}function lu(n){var t=ri.format(n);try{it.localStorage.removeItem(t)}catch(i){nt.warning(i,4,n)}}function au(n,t,i){var r=i.useRelex(n),u=r?new yr(i):new yi;return new ai(n,t,u,r)}function cr(n,t,i,r){return new vr(n,t,i,r)}function vu(){wt={}}function yu(n,t){ei=n;ur=t}function pu(n){return wt[n]||(wt[n]={})}function wu(){if(fr)return oi;fr=!0;var i=new w.Uri(it.location.href),n=i.getHashQueryStringValue("patch");return n&&(t.canModifyExtensionsEnabled?t.localhostUriRegex.test(n)?oi=n:nt.error("Disallowed location for patch: '{0}'. This method only allows 'localhost'.".format(n)):console.error("The ?feature.canmodifyextensions=true query parameter should be specified to enabling patch.")),oi}function bu(n){var
r=n.toLowerCase(),i=ei[r],t=ei["*"]||[];return i&&(t=t.concat(i)),t}function lr(n,t,i){var u,r,f;return i?t:(u=pu(n),r=u[t],r?r:(r=u[t]=[],t&yt.ExtensionScripts&&r.push.apply(r,bu(n)),t&yt.PostScripts&&(f=wu(),f&&r.push(f),r.push.apply(r,ur)),r))}function ar(n){var t=gt("<iframe/>").addClass("fxs-extension-frame").attr({tabindex:-1,"aria-hidden":!0});return n||t.attr({sandbox:"allow-same-origin allow-scripts"}),t.appendTo(gr),t}function ku(n,t,i){for(var r=[],u=Q(),f=function(){r.length<t&&(u=u.then(function(){if(r.length<t)return i().then(function(n){r.push(n)}).catch(function(n){nt.error(n,6)})}))},e=0;e<t;e++)f();return{getItem:function(){return Q.delay(eu).then(f),r.pop()},size:function(){return r.length}}}var rt=r.Extension,pr=r.TelemetryContext,ut=i.Base,ct=ut.Constants,wr=ct.ExtensionNames.Hubs,bt=ut.Diagnostics,br=bt.Telemetry,kt=ut.Rpc.Internal,wi=ut.Utilities,kr=i.Hubs.Notifications.NotificationStatus,dt=ut.Promises,bi=ut.tryParseVersion,ki=i.Helpers.Deferred,yt,hr,li,d,g,pt,
wt,ai,ht,vi,vr,yi,yr,pi;t.frameRemovalDelay=1e3;var gt=jQuery,it=window,ot=it.fx.getTimestamp,ft=kt.client,lt=i.isNullOrUndefined,dr=gt("head"),gr=gt("body"),nt=bt.createLog(n),k=it.fx.environment,st=k.cdn,di="FxCdnIndex"+st.index,nu=k.features,ni=h.displayLanguage,ti=h.formatCulture,tu=ni+l.localeDelimiter+ti,iu=!!k.trace.extensionmanager,du=iu?function(n){nt.verbose(n)}:i.noop,gi=ut.getVersionFromString,at=gi(k.sdkVersion),nr=nu.extloadtimeout,ii=nr&&parseInt(nr)||9e4,tr=c.Shell,ru="data-extensionname",et="ExtensionManager",ri="EXTENSIONMANIFEST_{0}",ui=3,vt=(ui+1)*2,tt=br,uu=pr,fu=k.bootReturnConst,ir=2e4,eu=4e3;t.localhostUriRegex=/^(https?:)?\/\/localhost(\:\d+)?(\/|$)/;t.canModifyExtensionsEnabled=k.features.canmodifyextensions==="true";var fi={},rr=ko.observable,ei=k.extensionScripts,ur=k.postScripts,fr=!1,oi,er=0,or=0,ou=ot(),su=i.forEachKey,si=new ut.QueryStringBuilder(it.location.search);t._resetStateForTests=hu;t.canUseManifest=hi;t.getCachedManifestFromLocalStorage=ci,function(
n){n[n.None=0]="None";n[n.ExtensionScripts=1]="ExtensionScripts";n[n.PostScripts=2]="PostScripts"}(t.RequiredScripts||(t.RequiredScripts={}));yt=t.RequiredScripts;t.initialRetryDelay=ii;hr=i.find,function(n){function t(t){return hr(n.loadedExtensions,function(n){return rt.isEqualDescriptor(n.extension,t.extension)})}function i(i){var r=t(i);r||n.loadedExtensions.push(i)}function r(i){var r=t(i);r&&n.loadedExtensions.remove(r)}n.loadedExtensions=[];n.addLoadedExtension=i;n.removeLoadedExtension=r}(li=t.LoadedExtensions||(t.LoadedExtensions={})),function(n){n[n.NotLoaded=0]="NotLoaded";n[n.FirstResponseReceived=1]="FirstResponseReceived";n[n.ManifestReceived=2]="ManifestReceived";n[n.Initialized=3]="Initialized";n[n.Error=4]="Error"}(t.ExtensionReadyState||(t.ExtensionReadyState={}));d=t.ExtensionReadyState,function(n){n[n.None=0]="None";n[n.FirstResponseNotReceived=1]="FirstResponseNotReceived";n[n.ManifestNotReceived=2]="ManifestNotReceived";n[n.InvalidExtensionName=3]="InvalidExtensionName";
n[n.InvalidManifest=4]="InvalidManifest";n[n.InvalidDefinition=5]="InvalidDefinition";n[n.FailedToInitialize=6]="FailedToInitialize";n[n.TooManyRefreshes=7]="TooManyRefreshes";n[n.TooManyBootGets=8]="TooManyBootGets";n[n.TimedOut=9]="TimedOut";n[n.MaxRetryAttemptsExceeded=10]="MaxRetryAttemptsExceeded";n[n.HomePageTimedOut=11]="HomePageTimedOut"}(g||(g={})),function(n){n[n.Default=0]="Default";n[n.Part=1]="Part"}(t.ViewModelType||(t.ViewModelType={}));pt=t.ViewModelType;t.create=au;t.createInitializedExtension=cr;wt={};t._clearScriptUris=vu;t._setExtensionScripts=yu;t.getScriptUris=lr;ai=function(){function n(n,t,i,r){var nt=this,e,h;this._readyState=d.NotLoaded;this._errorState=g.None;this._initializedInternal=Q.defer();this._initializedDeferred=Q.defer();this._manifestLoaded=Q.defer();this._initializeRequired=!1;this._bootGetCount=0;this._scriptErrors=[];this._bladeRedirectMap={};this._metadata=n;this._hostingContext=i;this._useRelex=r;var c=n.name,o=new ut.UriBuilder(n.uri),u=o.query,
s=n.cacheability||0,f=[];if(o.fragment=k.sessionId,k.passThroughVariables&&(f=f.concat(k.passThroughVariables)),s===0?f.push(k.clientSessionIdName):s===2?t=k.pageVersion:u.setParameter("cacheability",s),k.extensionQueryParameters&&(f=f.concat(k.extensionQueryParameters)),f.forEach(function(n){var t=k[n];lt(t)||u.setParameter(n,t)}),e=c.toLowerCase(),k.flightNames.forEach(function(n){var t=k.features[n];t&&u.setParameter(e+"_"+n,t)}),k.passThroughFeatureNames.forEach(function(n){var t=k.features[n];t&&sr(u,e+"_"+n,n,t)}),cu(e).forEach(function(n){n.featureName.toLowerCase()==="clean"&&n.value.toLowerCase()==="true"&&(nt._clean=!0);sr(u,n.key,n.featureName,n.value)}),h=k.userTypeHint,h){var a="usertype",v=e+"_"+a,y=u.getParameter(v),p=h+(y?"("+y+")":""),w=p.substr(1,p.length-2);u.setParameter(v,w);u.setParameter("feature."+a,w)}u.setParameter("pageVersion",t);u.setParameter(l.localeQueryStringName,tu);var b=k.relex.portalUri,tt=this._useRelex&&b?b:it.location.href,ft=new ut.UriBuilder(tt).
getAuthority();u.setParameter("trustedAuthority",ft);u.setParameter("extensionName",c);rt.multiCloudEnabled&&u.setParameter("cloudName",this.cloudName);st.forceDisable||this._useRelex?u.setParameter(st.disableParameter,!0):st.forceIndex&&u.setParameter(st.indexParameter,st.forceIndex);this._uri=o.toString()}return Object.defineProperty(n.prototype,"cloudName",{get:function(){return this._metadata.cloudName},enumerable:!0,configurable:!0}),n.prototype.getVersion=function(){return this._extVersion},Object.defineProperty(n.prototype,"initializeRequired",{get:function(){return this._initializeRequired},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"unloaded",{get:function(){return!this._currentWindow},enumerable:!0,configurable:!0}),n.prototype.useRelex=function(){return this._useRelex},n.prototype.isPreview=function(){var n=this._manifest,t,i;return n&&!lt(n.isPreview)?!!n.isPreview:(t=this._metadata.features,i=t&&t.preview,i&&i.toLowerCase()==="true")},Object.defineProperty(
n.prototype,"name",{get:function(){return this._metadata.name},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isTestExtension",{get:function(){return!!this._metadata.isTestExtension},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isTestStamp",{get:function(){return!!this._metadata.isTestStamp},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"readyState",{get:function(){return this._readyState},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"uri",{get:function(){return this._uri},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"manifest",{get:function(){return this._manifest},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"extensionLoadedInternal",{get:function(){return this._initializedInternal.promise},enumerable:!0,configurable:!0}),n.prototype.getBladeRedirect=function(n){return this._bladeRedirectMap[n.toLowerCase()]},n.prototype.onManifestReceived=function(n){var t=this,
i=function(){t._startExtensionLoadListener&&(it.removeEventListener("message",t._startExtensionLoadListener),t._startExtensionLoadListener=null)};i();(n.redirects||[]).forEach(function(n){var i=n.fromBlade;i&&(t._bladeRedirectMap[i.toLowerCase()]=n)});this.getWindow().postMessage({boot:fu,stopListening:!0,scripts:lr(n.name,yt.PostScripts,this.useRelex())},this.getTrustedHost());this._startExtensionLoadListener=function(r){if(r.data){var u=r.data,f=u.signature===v.signature&&u.kind===v.MessageKind.Boot&&u.windowId===t.getWindowId()&&u.data&&u.data.kind===3,e=r.data.kind===3&&t.getWindow()===r.source;(f||e)&&(t._acceptManifestAndInitializeIfRequired(n),i())}};it.addEventListener("message",this._startExtensionLoadListener,!1)},n.prototype.ensureInitialize=function(){this._initializeRequired=!0},n.prototype.getManifest=function(){return this._manifestLoaded.promise},n.prototype.isExtensionLoadedAsync=function(){return this._initializedDeferred.promise},n.prototype.resolveExtensionLoaded=function(
){var n=this._initializedExtension;n&&this._initializedDeferred.resolve(n);this._initializedExtension=null},n.prototype._acceptManifestAndInitializeIfRequired=function(n){var t=this._validateAndSetManifest(n,!1);t&&(this._addManifestToCache(),this._initializeRequired?this._initialize():this.dispose(),this._initializeRequired=!0)},n.prototype._initialize=function(){var n=this,t=this.getWindowId(),i,r;this._initializeCancelationToken&&this._initializeCancelationToken.cancel();this._initializeCancelationToken=new dt.CancelationToken;i=rt.initializeEndPoint.invoke(ft,t,undefined);r=dt.wrapWithCancelablePromise(i,this._initializeCancelationToken);r.then(function(i){var f=wi.getUniqueId(),r=function(t,i){tt.trace({source:et,action:t,actionModifier:tt.ActionModifier.Complete,name:n.name,duration:i,data:f})},u;return r("ExtensionPageLoadTime",i.fxScriptsBegin),r("MsPortalFxScripts",i.fxScriptsEnd-i.fxScriptsBegin),u=rt.getDefinitionEndPoint.invoke(ft,t,undefined),dt.wrapWithCancelablePromise(u,
n._initializeCancelationToken)}).then(function(t){var i,u,o,r;n._transitionStateTo(d.Initialized);i=n._manifest;u=e.validateDefinition(t,i);u.valid()?(o=f.preprocessDefinition(t,i),r=cr(n,i,o,n._loadTime),r.injectStyles(document),n._initializedExtension=r,n._initializedInternal.resolve(n._initializedExtension),n._postInitialize(),n.resolveExtensionLoaded(),n._initializedDeferred.promise.isFulfilled()&&li.addLoadedExtension(r)):n._onError(g.InvalidDefinition,"The extension definition has validation errors. Errors: {0}".format(JSON.stringify(u.errors)))}).catch(function(t){n._reloadFrame("message: {0}, stack: {1}".format(t.message,t.stack),g.FailedToInitialize)})},n.prototype._postInitialize=function(){this._clearExtensionReloadHandle();this._extensionInitializedTraceKey=tt.startTrace({source:et,action:"ExtensionInitialized",name:this.name})},n.prototype.getOrLoadWindow=function(){var n=this;if(!this._currentWindow){this._bootGetCount=0;this._retryAttempt=0;this._initialResponseTraceKey=
tt.startTrace({source:et,action:"InitialExtensionResponse",name:this.name});this._loadTraceKey=tt.startTrace({source:et,action:"LoadExtensions",name:this.name});var t=this._metadata,i=t.features,u=k.trace.nonsecure||i&&i.nonsecure==="true",r=0;this._currentWindow=this._hostingContext.createRpcWindow({getWindowId:function(){return rt.getWindowId(t)},trustedHost:t.trustedHost,frameUri:this._uri,createIframe:function(){return ar(u)},onLoad:function(){return n._readyState=d.NotLoaded,n._errorState=g.None,r++,r>vt?(n._onError(g.TooManyRefreshes,"The iframe for extension '{0}' refreshed/reloaded more than '{1}' times and has been unloaded.".format(n.name,vt)),!1):!0},onError:function(){n._reloadFrame("Extension Index page failed to load timed out in '{0}'ms.".format(ir),g.HomePageTimedOut)}});this._currentWindow.onDispose(function(){var t,i;n._clearExtensionReloadHandle();t=n._initializedDeferred.promise;t.isFulfilled&&t.then(function(n){li.removeLoadedExtension(n)});n._initializedInternal=Q.
defer();n._initializedDeferred=Q.defer();tt.trace({source:et,action:"ExtensionUnloaded",name:n.name,data:{currentState:n._readyState}});n._extensionInitializedTraceKey&&(tt.completeTrace(n._extensionInitializedTraceKey),n._extensionInitializedTraceKey=null);i="style[{0}='{1}']".format(ru,n.name);dr.remove(i);n._currentWindow=null});this._extensionLoadStartTime=ot();this._extensionReloadHandle=it.setTimeout(function(){n._reloadFrame()},ii)}return this._currentWindow},n.prototype.noteScriptError=function(n){this._scriptErrors.push(n)},n.prototype._reloadFrame=function(n,t){var r=this,i;if(!this.unloaded&&this._readyState!==d.Initialized){if(!n&&!t){t=g.None;n="Failed to load extension after {1} attempts over {0} secs.";switch(this._readyState){case d.NotLoaded:t=g.FirstResponseNotReceived;n="First response was not received after a time of {0} secs.";case d.FirstResponseReceived:t=g.ManifestNotReceived;n="Manifest not received after {0} secs.";break;case d.ManifestReceived:t=g.TimedOut;n=
"Manifest was received, however failed to initialize the extension after {0} secs."}}this._retryAttempt>=ui&&(t=g.MaxRetryAttemptsExceeded);n=n.format(Math.round(ot()-this._extensionLoadStartTime)/1e3,this._retryAttempt+1);this._clearExtensionReloadHandle();this._retryAttempt<ui?(this._extensionLoadStartTime=ot(),i=new ut.UriBuilder(this._uri),this._retryAttempt++,i.query.setParameter(k.retryAttemptName,this._retryAttempt),this._currentWindow.refresh(i.toString()),this._onExtensionLoadingRetry&&this._onExtensionLoadingRetry(),this._extensionReloadHandle=it.setTimeout(function(){r._reloadFrame()},ii),nt.warning("Reloading extension '{0}' from '{1}'. Retry attempt: {4}. ErrorState: {2}. Error: {3}.".format(this.name,this.uri,g[t],n,this._retryAttempt))):this._onError(t,n)}},n.prototype.getWindow=function(){var n=this._currentWindow;return n?n.getValue():null},n.prototype.getTrustedHost=function(){var n=this._currentWindow;return n&&n.getTrustedHost()},n.prototype.getWindowId=function(){return rt.
getWindowId(this)},n.prototype.loadAsync=function(n){var r,t,i,u,f;return this.unloaded?(r=this.getWindowId(),(!n||this._clean)&&(n={}),t=ci(r),i=n.manifest,hi(t)&&(u=bi(t&&t.extVersion),f=bi(n.version),u&&f&&u.compareTo(f)>=0&&(i=t.manifest)),i&&this._validateAndSetManifest(i,!0)?this.ensureInitialize():(kt.internalClient.acquireWindow(r,0),this._manifestLoaded.promise.isPending()||(this._manifestLoaded=Q.defer())),this._initializedInternal.promise):this.isExtensionLoadedAsync()},n.prototype.dispose=function(){this._currentWindow&&(this._currentWindow.dispose(),this._currentWindow=null)},n.prototype.processBootGetMessage=function(n,t){var i,r;try{i=gi(n)}catch(u){nt.error("Invalid version information '{0}' specified by '{1}'.".format(n,this.name),0,u)}return(i&&at.major===i.major&&at.minor===i.minor||(r="The '{0}' extension at '{1}' was compiled with version '{2}' of the SDK, whereas the shell is running on version '{3}'. You may see unexpected results.",nt.warning(r.format(this.name,
this.uri,i,at))),this._readyState===d.NotLoaded&&(this._readyState=d.FirstResponseReceived,this._initialResponseTraceKey&&(tt.completeTrace(this._initialResponseTraceKey),this._initialResponseTraceKey=null),this._manifestLoadTraceKey=tt.startTrace({source:et,action:"ManifestLoad",name:this.name,data:{fxcdn:di}})),this._bootGetCount++,this._bootGetCount>vt)?(this._onError(g.TooManyBootGets,"The iframe '{0}' sent more than '{1}' handshake messages over '{2}' attempts without making progress. it has been unloaded.".format(this.name,vt,this._retryAttempt)),!1):!this._tryLoadCachedManifest(t)},n.prototype._tryLoadCachedManifest=function(n){var i=!1,r,t;return this._extVersion=n,this.initializeRequired||!n||(r=this.getWindowId(),t=ci(r),hi(t)&&n===t.extVersion&&(i=this._validateAndSetManifest(t.manifest,!0),this.dispose(),this.ensureInitialize()),i||lu(r)),i},n.prototype._addManifestToCache=function(){var n=this._manifest,t=this._extVersion,i,r,u;if(n)if(t)if(n.sdkVersion)try{r=ri.format(this.
getWindowId());u={manifest:n,formatCulture:ti,displayLanguage:ni,extVersion:t,sdkVersion:at};it.localStorage.setItem(r,JSON.stringify(u))}catch(f){nt.warning(f,4,this.getWindowId())}else i="Unable to add manifest for '{0}' to cache since it has not specified the SDK version on which it was compiled. Specified version was '{1}'.",nt.warning(i.format(this.name,n.sdkVersion),102);else nt.warning("Unable to add manifest for '{0}' to cache since it has not specified a valid version. Specified version was '{1}'.".format(this.name,t),101);else nt.warning("Unable to add manifest for '{0}' to cache since it is unavailable.".format(this.name))},n.prototype._validateAndSetManifest=function(n,t){var i=!1,r=s.validate(n),u,f;return r.valid()?this.name.toLowerCase()!==n.name.toLowerCase()?(u="The extension name defined in the manifest '{0}' (obtained from the <Extension> tag in PDL) does not match the name '{1}' used to identify the extension with the portal. Ensure that the name you specify in the <Extension> tag in PDL matches the one used in the extensions.json file to identify the extension with the portal.",
this._onError(g.InvalidExtensionName,u.format(n.name,this.name))):(this._readyState!==d.NotLoaded&&this._readyState!==d.FirstResponseReceived&&(f="Extension manifest received at an incorrect point in time. "+"Current extension state: ExtensionReadyState.{0}. ".format(d[this._readyState])+"This method should be called when the extension state is ExtensionReadyState.NotLoaded or ExtensionReadyState.FirstResponseReceived. "+"Callstack: {0}".format(wi.getCurrentCallStack()),nt.error(f,5)),this._manifest=n,this._transitionStateTo(d.ManifestReceived),this._manifestLoaded.resolve(n),i=!0):(r.errors.forEach(nt.error,nt),this._onError(g.InvalidManifest,"The extension manifest has validation errors.")),(i||!t)&&this._manifestLoadTraceKey&&(tt.completeTrace(this._manifestLoadTraceKey),this._manifestLoadTraceKey=null),i},n.prototype._onError=function(n,t){var i="Failed to initialize extension '{0}' at '{1}'. ErrorState: {2}. Error: {3}.".format(this.name,this.uri,g[n],t),u=ot(),f=this._extensionLoadStartTime,
r;nt.error(i,1,{previousState:this._readyState,hasLoadTraceKey:this._loadTraceKey?1:0,hasInitializeTraceKey:this._initializeTraceKey?1:0,successfulExtensionLoads:or,failedExtensionLoads:er,timeThisFileLoaded:ou,scriptErrors:this._scriptErrors,timeThisExtensionStartedLoading:f,timeThisExtensionFailed:u,timeToFail:u-f});bt.Upload.flush();this._initializeCancelationToken&&(this._initializeCancelationToken.cancel(),this._initializeCancelationToken=null);this._manifestLoaded.reject(i);this._initializedInternal.reject(i);this._initializedDeferred.reject(i);this._readyState!==d.Error&&(this._transitionStateTo(d.Error,n),r=p.getNotificationManager(),r&&r.addClientNotification({title:tr.extensionError,description:tr.loadingError.format(this.name),status:kr.Error,timestamp:new Date,cloudName:ct.DefaultCloudName}));this.dispose()},n.prototype._transitionStateTo=function(n,t){var i=this;this._readyState=n;n===d.ManifestReceived?(this._loadTraceKey&&(tt.completeTrace(this._loadTraceKey),this._loadTraceKey=
null),this._initializeRequired&&(this._initializeTraceKey=tt.startTrace({source:et,action:"InitializeExtensions",name:this.name,data:{fxcdn:di}}))):n===d.Initialized?this._initializeTraceKey&&(tt.completeTrace(this._initializeTraceKey),this._initializeTraceKey=null,this._loadTime=ot()-this._extensionLoadStartTime,or++):n===d.Error&&(er++,this._loadTraceKey&&(tt.cancelTrace(this._loadTraceKey),this._loadTraceKey=null),this._initializeTraceKey&&(tt.cancelTrace(this._initializeTraceKey,{errorState:t}),this._initializeTraceKey=null),this._initialResponseTraceKey&&(tt.cancelTrace(this._initialResponseTraceKey),this._initialResponseTraceKey=null),this._manifestLoadTraceKey&&(tt.cancelTrace(this._manifestLoadTraceKey),this._manifestLoadTraceKey=null));t&&(this._errorState=t)},n.prototype._clearExtensionReloadHandle=function(){this._extensionReloadHandle&&(it.clearTimeout(this._extensionReloadHandle),this._extensionReloadHandle=null)},n}();t.ExtensionImpl=ai;ht=ct.BladeNames.Hubs.ResourceMenuBlade;
vi={};vi[wr]=[{partName:ht+"$"+ht,locator:o.resourceMenu.withLens(ht).withPartInstance(ht),getPartDefinition:function(n){return n.getBladeDefinition(ht).then(function(n){return n.lenses[0].partInstances[0].inline})}}];vr=function(){function n(n,t,f,e){var o=this,s,h,c;this.outstandingObjectCount=rr(0);this.metadataCount=rr(0);this._proxiedObjects=[];this._pools={};s=this._lifetime=new r.TriggerableLifetimeManager;s.registerForDispose(this._extension=n);this.cloudName=n.cloudName;h=this.name=n.name;this.manifest=t;this.definition=f;this.loadTime=e;(vi[h]||[]).forEach(function(n){o._pools[n.locator.toString()]=ku(s,5,function(){return n.getPartDefinition(o).then(function(t){var r=t.details;return Q(o.getPartViewModel(n.partName,{initialState:{},createSelectable:y.needContainerSelectable(r),createHubsInternalCloudNameProperty:u.needInternalProperty(h,r),partSize:t.initialSize,partLocation:i.ViewModels.PartLocation.Blade,collapsed:null,containerType:0}))})})});f.styleSheets?(c=n.getWindowId(
),this.injectStyles=function(n){a.injectStyles(n,{extensionName:c,uniqueName:c,styleSheets:f.styleSheets.map(function(n){return{file:null,content:n}})})}):this.injectStyles=i.noop}return Object.defineProperty(n.prototype,"extension",{get:function(){return this._extension},enumerable:!0,configurable:!0}),n.prototype.canUseInputsSetParameters=function(n){var t=this._pools[n.toString()];return!t||!t.size()},n.prototype.getBladeRedirect=function(n){return this._extension.getBladeRedirect(n)},n.prototype.getWindow=function(){return this._extension.getWindow()},n.prototype.processMessages=function(){return rt.pingEndPoint.invoke(ft,this._extension.getWindowId(),undefined)},n.prototype.dispose=function(){this._lifetime.dispose()},n.prototype.getBladeDefinition=function(n){var r=this,t=this.definition,i=t.bladeMap[n.toLowerCase()];return i?Q(i):Q(rt.getBladeDefinitionEndPoint.invoke(ft,this._extension.getWindowId(),n)).then(function(n){return f.processBlade(t,r.manifest,n)}).then(function(n){var
i=[],r=e.validateBlade(t,n,null,i);if(i.length)throw new Error("Invalid blade definition. Errors: "+i.join("\n"));return n})},n.prototype.getPartDefinition=function(n){var r=this,t=this.definition,i=t.partTypeMap[n.toLowerCase()];return i?Q(i):Q(rt.getPartDefinitionEndPoint.invoke(ft,this._extension.getWindowId(),n)).then(function(n){return f.processPart(t,r.manifest,n)}).then(function(n){var t=[],i=e.validatePartType(n,t);if(t.length)throw new Error("Invalid part type definition. Errors: "+t.join("\n"));return n})},n.prototype.getControlDefinition=function(n){var t=this;return Q(rt.getControlDefinitionEndPoint.invoke(ft,this._extension.getWindowId(),n)).then(function(n){return f.processControl(t.definition,t.manifest,n)}).then(function(n){var t=[],i=e.validateControl(n,t);if(t.length)throw new Error("Invalid control definition. Errors: "+t.join("\n"));return n})},n.prototype.getViewModel=function(n,t){return this._getViewModel(pt.Default,n,t)},n.prototype.getPartViewModel=function(n,t)
{var f,r,u;return t&&t.locator&&(f=this._pools[t.locator.toString()])&&!t.onInputsSetParameters&&!i.keysLength(t.initialState)&&(r=f.getItem(),r)?(u=t&&t.onViewModelAcquired,u&&u(r),ki().resolve(r).promise()):this._getViewModel(pt.Part,n,t)},n.prototype._getViewModel=function(n,t,i){var f=this,r;if(i=i||{},r=b.resolve(this,t,i.initialState,i.createSelectable),r)return r.then(function(n){if(i.onViewModelAcquired)i.onViewModelAcquired(n);return typeof i.partSize=="number"&&n&&n.content&&ko.isObservable(n.content.size)&&n.content.size(i.partSize),i.onInputsSetParameters&&n&&n.updatePartInputValues&&(n.onInputsSetPromise=Q().then(function(){return n.updatePartInputValues(i.onInputsSetParameters.inputs,i.onInputsSetParameters.settings,i.onInputsSetParameters.traceOptions)})),n});var u=ki(),e=n===pt.Part?ct.ViewModelTypes.PartViewModel:ct.ViewModelTypes.ViewModel,o=rt.getViewModelsDefinition.acquireObject(ft,this._extension.getWindowId(),{type:e,containerType:i.containerType||0,name:t,initialState:
i.initialState,createSelectable:i.createSelectable,createHubsInternalCloudNameProperty:i.createHubsInternalCloudNameProperty,telemetryContext:uu.getState(),partSize:i.partSize,partLocation:i.partLocation,onInputsSetParameters:i.onInputsSetParameters,collapsed:i.collapsed},i.onViewModelAcquired&&function(n){return i.onViewModelAcquired(n&&n.getValue())}).then(function(n){return f._proxiedObjects.push(n),n.getValue()}).then(function(n){u.resolve(n)},function(n){u.reject(n)});return u.promise()},n.prototype.releaseViewModel=function(n){i.disposeDisposable(n);var t=i.findIndex(this._proxiedObjects,function(t){return t.getValue()===n});t!==-1&&this._proxiedObjects.splice(t,1)[0].dispose()},n.prototype.isPreview=function(){var n=this.definition.isPreview;return lt(n)?this.extension.isPreview():n},n}();yi=function(){function n(){}return n.prototype.createRpcWindow=function(n){var i=(n.createIframe||ar)(),r=it.setTimeout(function(){n.onError()},ir),e,o,u,f;i.on("load",e=function(t){r&&(it.clearTimeout(
r),r=null);n.onLoad(t.originalEvent)});i.on("error",o=function(n){var t=n.originalEvent;nt.error(t.error,3,{message:t.message,filename:t.filename,colno:t.colno,lineno:t.lineno})});i.attr("src",n.frameUri);u=i[0].contentWindow;f=new pi({source:u,window:u,trustedHost:n.trustedHost||"*",initializationFunc:undefined},function(n){i.attr("src",n)});f.onDispose(function(){i.off("load",e);i.off("error",o);setTimeout(function(){i.remove()},t.frameRemovalDelay)});return f},n}();t.BrowserHostingContext=yi;yr=function(){function n(n){this._relexConfig=n}return n.prototype.createRpcWindow=function(n){return this._relexConfig.createRpcWindow(n)},n}();pi=function(n){function t(t,i){n.call(this,t);this.refresh=i}return __extends(t,n),t}(kt.RpcWindow);t.RpcWindow=pi}(k||(k={})),k});define("MsPortalImpl/Extension/ExtensionManager",["require","exports","f","../Base/Base.CustomControlsBladeHost","../_generated/Common/Relex.Channel","./Extension","MsPortalFx/Globalization","../Base/Languages","../Services/Services.GeneralSettings",
"../Base/Telemetry","../Base/Base.UriHelper"],function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return function(t){function ht(n){return Object.keys(n||{}).filter(function(t){var i=n[t];return i&&!!i.manifest}).length}function ct(n){var t=new c.Uri(location.href);return t.setPathname(n),t.toString()}function ut(n){return n.replace(/\\/g,"\\\\").replace(/\'/g,"\\'")}function gt(n){return new lt.ExtensionManagerImpl({createExtension:f.create,extensionVersionCache:n})}var ft=FxImpl,a=ft.Boot.MessageKind,g=ft.Extension,p=i.Base,at=p.Constants.ExtensionNames.Hubs,nt=p.Diagnostics,vt=nt.Telemetry,b=p.Rpc.Internal,w=f.LoadedExtensions,tt=h.Source,k=jQuery,y=window,et=y.fx.early,v=nt.createLog(n),yt=n.normalize(undefined),l=y.fx.environment,ot=l.bootMessageSignature,pt=l.bootGetConst,st=l.bootReturnConst,wt=6e4,d=vt.trace,it=y.fx.getTimestamp,bt=ut(ct(l.extensionTraceUri)),kt=ut(ct(l.extensionTelemetryUri)),dt="(function() {var impl = window.FxImpl;var env = window.fx.environment;"+("env.extensionTraceUri = '"+
bt+"';")+("env.extensionTelemetryUri = '"+kt+"';")+("env.fxRequireConfig = "+JSON.stringify(l.fxRequireConfig)+";")+"((impl && impl.startBoot) || MsPortalFx.Internal.startBoot)();})();",rt,lt;(function(n){function i(n){return p.Net2.ajax({uri:t.getUri(n),type:"GET",dataType:"json",contentType:"application/json"})}function r(){return Q(t.promise).catch(function(n){return v.warning(n,6),null}).then(function(n){return ht(n)?n:i()}).then(function(n){return n||{}}).catch(function(n){return v.error(n,7),{}})}var t=et.manifestCache;n.getManifestsAjax=i;n.getManifests=r})(rt=t.Relex||(t.Relex={}));t.escapeSingleQuote=ut;t.create=gt,function(n){function vt(n){var t=document.createElement("a");return t.href=n,t.href}function c(n,t,i){return n.count=i.count-t.count,n.chars=i.chars-t.chars,n}var ft=e.displayLanguage,ct=e.formatCulture,lt=ft+o.localeDelimiter+ct,bt=function(){function n(n){var i=this;this._messageHandlers=[];this._isRpcStarted=!1;this._manifestLoadCallbacks=k.Callbacks();this._callbacks=
k.Callbacks();this._unloadCallbacks=k.Callbacks();this._allManifestsLoaded=Q.defer();this._manifestLoadStarted=Q.defer();this._relexDisconnected=Q.defer();this._bladeFrameMap={};this.manifestLoadComplete=!1;this._createExtension=n.createExtension;this._extensionVersionCache=n.extensionVersionCache;w.loadedExtensions=[];n.skipRegisterManifest||g.registerManifestDefinition.register(b.client,null,function(n,t){var r=i._getExtensionByWindowId(t.srcWindowId);n.cloudName=r.cloudName;r.onManifestReceived(n)});this._relexConfig=new t(l.features.relex);this._addExtensionBootReceiver();l.features.relex&&this._addRelexReceiver()}return n.prototype.isRelexEnabled=function(){return this._relexConfig.enabled()},n.prototype.manifestLoadStarted=function(){return this._manifestLoadStarted.promise},n.prototype.initialManifestsLoadPromise=function(){return this._allManifestsLoaded.promise},n.prototype.getExtension=function(n,t){return this._getExtensionByDescriptor({cloudName:t,name:n})},n.prototype.getExtensions=
function(n){return this._getExtensionsList().filter(function(t){return!n||!!t.manifest})},n.prototype.getInitializedExtensions=function(){return w.loadedExtensions},n.prototype.getManifestByName=function(n,t){var i=this;return this._manifestLoadStarted.promise.then(function(){return i.getExtension(n,t).getManifest()})},n.prototype.getHubsExtension=function(){return this.getExtensionByName(at,g.getHubsCloudName())},n.prototype.getExtensionByName=function(n,t,i){var r=this;return i=i||{},this._manifestLoadStarted.promise.then(function(){var u=r._getExtensionByDescriptor({cloudName:t,name:n}),e,f;if(!u)throw new Error("extension {0}, in cloud {1} was not found".format(n,t));return u.unloaded?i.onlyIfLoaded||(e=u.loadAsync(),r._onExtensionLoaded(e)):u.initializeRequired||r._onExtensionLoaded(u.extensionLoadedInternal),u.ensureInitialize(),f=u.isExtensionLoadedAsync(),i.timeout>0&&(f=Q(f).timeout(i.timeout,"Timed out waiting for extension '{0}' to load.".format(n))),f.then(function(){return r.
_getLoadedExtensionByWindowId(u.getWindowId())})})},n.prototype.initialize=function(n){var t=this,e=n.onRelexDisconnected,o,i,u,s,c,l;return e&&this._relexDisconnected.promise.then(function(){e()}),this._extensionsMap={},o=this._createExtension,i=n.extensions.map(function(n){var r=o(n,t._extensionVersionCache.getLatest(n.name),t._relexConfig),i=r.getWindowId().toLowerCase();if(t._getExtensionByWindowId(i))throw new Error("Extension with window ID '{0}' has already been registered.".format(i));return t._extensionsMap[i]=r}),this.startRpc(),u=this._getExtensionByWindowId(g.getHubsWindowId()),u&&b.internalClient.acquireWindow(u.getWindowId()),s=it(),c=n.useCachedManifests?rt.getManifests():Q({}),c.then(function(n){d({source:"ExtensionManager",action:"CachedManifestCount",actionModifier:h.ActionModifier.Default,data:ht(n),duration:it()-s});t._extensionVersionCache.setLatest(n);i.forEach(function(t){var i=n[t.name],r;i&&i.manifest||(r=f.getCachedManifestFromLocalStorage(t.getWindowId()),f.canUseManifest(
r)&&r.manifest&&(i={manifest:r.manifest,version:r.extVersion}));(t.isTestExtension||t.isTestStamp)&&(i=null);t.loadAsync(i)})}),l=i.map(function(n){var i=n.getManifest();return i.then(function(i){t._manifestLoadCallbacks.fire(i,n.isPreview())}),i}),this._manifestLoadStarted.resolve(),r.getControlDefinitionEndpoint.register(b.client,null,function(n,i){return i.srcWindowId===p.Constants.Shell?Q.reject("Running custom controls from the shell frame is not allowed. Specify the HasCustomControls attribute in your template blade to enable this."):t.getExtensionByName(n.extension,n.cloud).then(function(t){return t.getControlDefinition(n.name)})}),Q.any([Q.allSettled(l),Q.delay(wt)]).then(function(){t._allManifestsLoaded.resolve();t.manifestLoadComplete=!0})},n.prototype.registerBladeFrame=function(n,t){this._bladeFrameMap[n]=t},n.prototype.unregisterBladeFrame=function(n){var t=this._bladeFrameMap;n in t&&(t[n]().dispose(),delete t[n])},n.prototype.startRpc=function(){var n=this;this._isRpcStarted||
(this._isRpcStarted=!0,b.start({originId:"fx",loadWindow:function(t){var r=n._bladeFrameMap[t],i;if(r)return r();if(i=n._getExtensionByWindowId(t),!i)throw new Error("Failed to load extension '{0}'.".format(t));return i.getOrLoadWindow()},parentWindow:y}))},n.prototype.pinExtensions=function(n){var t=this;return this._manifestLoadStarted.promise.then(function(){n.forEach(function(n){if(n){var i=t._getExtensionByWindowId(n);i&&b.internalClient.acquireWindow(i.getWindowId())}})})},n.prototype.unloadExtension=function(n){var i=n.extension.getWindowId(),t={cloudName:n.cloudName,name:n.name};n.dispose();w.removeLoadedExtension(n);this._unloadCallbacks.fire(t)},n.prototype.onManifestLoad=function(n){var i=this,r=this.getExtensions(!0),t=function(r,u){try{n(r,u)||i._manifestLoadCallbacks.remove(t)}catch(f){v.error("onManifestLoad event callback has thrown an exception for extension '{0}'.".format(r&&r.name),4,f)}};this._manifestLoadCallbacks.add(t);r.forEach(function(t){n(t.manifest,t.isPreview(
))})},n.prototype.onLoad=function(n){var i=this,r=w.loadedExtensions.slice(0),t=function(r){try{n(r)||i._callbacks.remove(t)}catch(u){v.error("onLoad event callback has thrown an exception.",2,u)}};this._callbacks.add(t);r.forEach(function(t){n(t)})},n.prototype.onUnload=function(n){var i=this,t=function(r){try{n(r)||i._unloadCallbacks.remove(t)}catch(u){v.error("onUnload event callback has thrown an exception.",3,u)}};this._unloadCallbacks.add(t)},n.prototype.refreshManifests=function(n){return rt.getManifestsAjax(n)},n.prototype.dispose=function(){this._messageHandlers&&(this._messageHandlers.forEach(function(n){y.removeEventListener("message",n)}),this._messageHandlers=[])},n.prototype._initializeRelexConfig=function(){},n.prototype._getExtensionByWindowId=function(n){return this._extensionsMap[n.toLowerCase()]},n.prototype._getExtensionByDescriptor=function(n){return this._getExtensionByWindowId(g.getWindowId(n))},n.prototype._onExtensionLoaded=function(n){var t=this;n.then(function(
n){w.addLoadedExtension(n);var i=n.extension;i.resolveExtensionLoaded&&i.resolveExtensionLoaded();t._callbacks.fire(n)})},n.prototype._getLoadedExtensionByWindowId=function(n){return w.loadedExtensions.first(function(t){return t.extension.getWindowId()===n})},n.prototype._getExtensionByWindow=function(n){return this._getExtensionsList().first(function(t){return t.getWindow()===n})},n.prototype._getExtensionsList=function(){var n=this;return Object.keys(this._extensionsMap||{}).map(function(t){return n._extensionsMap[t]})},n.prototype._addExtensionBootReceiver=function(){var n=this,t=function(t){var r=t,i=t.data,f;i&&i.signature===u.signature&&i.kind===u.MessageKind.Boot&&(f=n._getExtensionByWindowId(i.windowId),r={data:i.data,origin:t.origin,source:f.getWindow()});n._onBoot(r);n._onBootGetRequested(r)};y.addEventListener("message",t,!1);this._messageHandlers.push(t)},n.prototype._onBoot=function(n){var l=this,r=this._getExtensionByWindow(n.source),t=n.data,e,u,o,s,c;if(t&&t.signature===
ot){if(!r){e=i.find(Object.keys(this._bladeFrameMap),function(t){return l._bladeFrameMap[t]().getSource()===n.source});e||v.error("Received a boot message from '{0}' but _getExtensionByWindow returned null.".format(n.source),9,t);return}switch(t.kind){case a.BootGet:u=t.data;o=r.processBootGetMessage(u.sdkVersion,u.extVersion);o&&r.getWindow().postMessage({signature:ot,kind:a.BootReturn,data:{stopListening:!0,scripts:[{kind:1,data:dt}]}},"*");break;case a.BootError:s=t.data;v.error("{0} Origin: {1}".format(s.message,n.origin));r.noteScriptError({kind:a.BootError,error:t.data});break;case a.UnhandledError:c=yt+"/"+r.getWindowId();nt.Log.writeEntry2(nt.LogEntryLevel.Error,c,t.data,8);d({source:tt.Shell,action:h.Action.UnhandledExtensionError,actionModifier:h.ActionModifier.Default,extension:r.getWindowId(),data:f.ExtensionReadyState[r.readyState]});r.noteScriptError({kind:a.UnhandledError,error:t.data});break;case a.ScriptError:r.noteScriptError({kind:a.ScriptError,error:t.data});break;case
a.Initialize:break;default:v.error("Received a boot message from a source that isn't a recognized extension. Will ignore. Origin: {0}".format(n.origin))}}},n.prototype._onBootGetRequested=function(n){var i=n.data,t,r,u;i&&i.boot===pt&&(t=this._getExtensionByWindow(n.source),t?(r=t.processBootGetMessage(i.sdkVersion,i.extVersion),r&&(u={boot:st,stopListening:!1,scripts:f.getScriptUris(t.name,f.RequiredScripts.ExtensionScripts,t.useRelex())},t.getWindow().postMessage(u,"*"))):v.error("_onBootGetRequested receieve invalid evt.source. Origin:"+n.origin+" \n Data:"+JSON.stringify(i)))},n.prototype._addRelexReceiver=function(){var n=this,t;this._m={sent:{count:0,chars:0,startOffBy:0},recv:{count:0,chars:0}};t=function(t){var i=t.data,r=i&&i.messageTelemetry;if(r&&(n._m=r,delete i.messageTelemetry,r.sent.startOffBy=n._relexConfig.messagesSent-r.sent.count),i&&i.signature===u.signature)switch(i.kind){case u.MessageKind.Telemetry:d(i.data);break;case u.MessageKind.Connection:n._handleConnectionMessage(
i.data)}};y.addEventListener("message",t,!1);this._messageHandlers.push(t)},n.prototype._handleConnectionMessage=function(n){n.type===u.ConnectionEventType.Disconnected&&this._relexDisconnected.resolve()},n.prototype.getMessageTelemetry=function(n){var t=this._m;return n&&t?{sent:c({startOffBy:n.sent.startOffBy,stopOffBy:t.sent.startOffBy},n.sent,t.sent),recv:c({},n.recv,t.recv)}:t},n}(),t,ut;n.ExtensionManagerImpl=bt;t=function(){function n(n,t){var r=this;this.multiComm=!1;this.devMode=!1;this.messagesSent=0;this._allExtensionsOnRelex=!1;this._extensionMap={};n&&(n==="true"&&(n="*,HubsExtension"),n.toLowerCase().split(",").forEach(function(n){n==="*"?r._allExtensionsOnRelex=!0:n==="multicomm"?r.multiComm=!0:n==="devmode"?r.devMode=!0:r._extensionMap[n]=!0}),this._instancePromise=Q().then(function(){var n;if(r.devMode)return s.processor.initialized.then(function(n){var t=n.relexHost(),i=t.split("/"),r=location.protocol+"//"+i[2];return{uri:t,trustedHost:r}});n=new p.UriBuilder(l.relex.
instanceUri);n.path=i.ensureSuffix(n.path,"/")+"relexproxy";n.query.setParameter("verbose",l.isDevelopmentMode?"2":"0");var t=n.toString(),u=t.split("/"),f=location.protocol+"//"+u[2];return{uri:t,trustedHost:f}}),t||(t=function(n){return new ut(n)}),this.multiComm?this._createChannel=t:this._channelSingleton=t(this))}return n.prototype.enabled=function(){return this._allExtensionsOnRelex},n.prototype.getInstance=function(){return this._instancePromise},n.prototype.createRpcWindow=function(n){var t;return t=this.multiComm?this._createChannel(this):this._channelSingleton,t.createRpcWindow(n)},n.prototype.useRelex=function(n){return!n.isTestExtension&&this._allExtensionsOnRelex!==Boolean(this._extensionMap[n.name.toLowerCase()])},n}();n.DefaultRelexConfig=t;ut=function(){function n(n){var u=this,t,r,i;this._clientId=l.sessionId;this._config=n;t=et.relex;t?(this._readyPromise=Q(t.loadPromise),this._frame=k(t.frame),this._trustedHost=t.trustedHost,r=t.initRelexDelay):(i=Q.defer(),this._readyPromise=
i.promise,r=it(),n.getInstance().then(function(n){u._trustedHost=n.trustedHost;u._frame=k(MsPortalEarly.Relex.initializeRelexFrame(n,function(n){i.resolve(n)},function(n){i.reject(n)}))}));d({action:"InitRelexDelay",actionModifier:"complete",source:tt.Shell,duration:r});this._readyPromise.then(function(n){d({action:"RelexClientPageLoad",actionModifier:"complete",source:tt.Shell,duration:n})})}return n.prototype.createRpcWindow=function(n){var t=this,i=n.getWindowId(),e,r;this._readyPromise.then(function(){n.onLoad(null)&&t._postMessage(i,u.MessageKind.ExtensionLoad,{uri:vt(n.frameUri),locale:lt})});e=this._frame[0].contentWindow;r=new f.RpcWindow({source:e,window:{postMessage:function(n){var r=n&&n.boot===st?u.MessageKind.Boot:u.MessageKind.Rpc;t._postMessage(i,r,n)}},trustedHost:this._trustedHost,initializationFunc:undefined},function(){});r.onDispose(function(){t._postMessage(i,u.MessageKind.ExtensionUnload,{});t._config.multiComm&&setTimeout(function(){t.dispose()},f.frameRemovalDelay)}
);return r},n.prototype.dispose=function(){this._frame&&(this._frame.remove(),this._frame=null)},n.prototype._postMessage=function(n,t,i){var r={signature:u.signature,windowId:n,kind:t,data:i};this._frame[0].contentWindow.postMessage(r,this._trustedHost);this._config.messagesSent++},n}()}(lt=t.Internal||(t.Internal={}))}(l||(l={})),l});define("MsPortalImpl/Extension/ExtensionMetadataSource",["require","exports","f","../CodeComponentSideLoad/CodeComponentSideLoadManager","../CodeComponentSideLoad/CodeComponentSideLoadModels","./Extension","../Services/Services.Settings.Schema","../Base/Base.UriHelper"],function(n,t,i,r,u,f,e,o){"use strict";var s;return function(t){function k(n,t,i,r,u){var e=new s(n,t,i,r,u,f.canModifyExtensionsEnabled,l.isDevelopmentMode);return MsPortalImpl.Extension=e,e}var h=i.Base,v=h.Diagnostics,c=window,y=v.createLog(n),l=c.fx.environment,a="testExtensions",p="loadUntrustedExtensions",w=e.testExtensionsKey,b=5e3,s;t.initializeTestExtension=k;s=function(n){function t(
t,i,r,f,e,o,s){n.call(this,t,i,r,f,e,o,s,p,a,u.ExtensionMetadataExt.create,u.SideLoadComponentTypeEnum.Extension,w)}return __extends(t,n),t.prototype.registerTestExtension=function(n,t){var i=u.ExtensionMetadataExt.create(n);return this.registerTestCodeComponent(i,t).then(function(){console.log("Reload the portal with the query parameter ?feature.canmodifyextensions=true to load the test extension.")})},t.prototype.registerTestExtensionsFromUri=function(n,t){var r=this,s=new o.Uri(n),e=s.getHashQueryStringValue(a),i;return e?(i=JSON.parse(decodeURIComponent(e)),!f.canModifyExtensionsEnabled&&Object.keys(i).length&&console.warn("The ?feature.canmodifyextensions=true query parameter should be specified to load test extensions."),Q.allSettled(Object.getOwnPropertyNames(i).map(function(n){var f=new u.ExtensionMetadataExt;return f.name=n,f.cloudName=t,f.uri=i[n],r._isValidUri(f.uri)?r._registerTestCodeComponentFromUri(f):null}))):Q(null)},t.prototype._isValidUri=function(n){if(!f.localhostUriRegex.
test(n)){var t="Disallowed location for test extension: '{0}'. Test extensions registered by this method are only allowed on 'localhost'.".format(n);return y.error(t,u.ErrorCodes.InvalidMetadata),!1}return!0},t.prototype.unregisterTestExtension=function(n,t){var i=new u.ExtensionMetadataExt;return i.name=n,i.cloudName=t,this.unregisterTestCodeComponent(i)},t.prototype.listTestExtensions=function(){return this.listTestCodeComponents()},t.prototype.clearTemporaryTestExtensions=function(){this.clearTemporaryTestCodeComponents()},t.prototype.loadFromServer=function(n){var i=l.extensionsUri,r,t;return i?(t=c.location.search,t&&(i.indexOf("?")!==-1&&(t="&"+t.substr(1)),i+=t),r=h.Net2.postJSON({uri:i},n).then(function(n){return n.map(function(n){return u.ExtensionMetadataExt.create(n)})}).timeout(b,"Timed out fetching metadata for code components from the server.")):r=Q([]),r},t}(r.CodeComponentSideLoadManagerImpl);t.ExtensionMetadataSourceImpl=s}(s||(s={})),s});define("MsPortalImpl/GalleryPackage/GalleryPackageLoader",
["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){function o(n){return new t(n)}var f=i.Base,r=f.Constants,u=r.ExtensionNames,e=i.Services.Rpc,t;n.initialize=o;t=function(){function n(n){this._extensionManager=n}return n.prototype.loadGalleryPackages=function(n){if(n&&n.length>0)return this._extensionManager.getExtensionByName(u.Marketplace,r.DefaultCloudName).then(function(){e.invokeCallback(u.Marketplace,"loadGalleryPackages",n)})},n}();n.GalleryPackageLoaderImpl=t}(r||(r={})),r});define("MsPortalImpl/GalleryPackage/GalleryPackageMetadataSource",["require","exports","f","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels","../Services/Services.Settings.Schema","../Base/Base.UriHelper"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function d(n,t,i){var r=new s(n,t,i,p,h.isDevelopmentMode);return MsPortalImpl.GalleryPackage=r,r}var l=i.Base,a=l.Diagnostics,o=u.GalleryPackageExt,
v=window,y=a.createLog(n),h=v.fx.environment,p=h.features.canaddgallerypackages==="true",c="testGalleryPackages",w="loadUntrustedGalleryPackages",b=/^(https?:)?\/\/localhost(\:\d+)?(\/|$)/,k=f.testGalleryPackagesKey,s;t.initializeTestGalleryPackage=d;s=function(n){function t(t,i,r,f,e){n.call(this,t,i.settings,i.storageService,function(){return i.getService("DialogManager")},r,f,e,w,c,o.create,u.SideLoadComponentTypeEnum.GalleryPackage,k)}return __extends(t,n),t.prototype.registerTestGalleryPackage=function(n,t){var i=o.create(n);return this.registerTestCodeComponent(i,t)},t.prototype.registerTestGalleryPackagesFromUri=function(n){var t=this,f=new e.Uri(n),i=f.getHashQueryStringValue(c),r,u;return i?(r=JSON.parse(decodeURIComponent(i)),u=r.map(function(n){return{uri:n}}),Q.allSettled(u.map(function(n){var i=o.create(n);return t._isValidUri(i.uri)?t._registerTestCodeComponentFromUri(i):null}))):Q(null)},t.prototype._isValidUri=function(n){if(!b.test(n)){var t="Disallowed location for gallery package: '{0}'. Gallery packages registered by this method are only allowed on 'localhost'.".
format(n);return y.error(t,u.ErrorCodes.InvalidMetadata),!1}return!0},t.prototype.unregisterTestGalleryPackage=function(n){var t=new o;return t.uri=n,this.unregisterTestCodeComponent(t)},t.prototype.listTestGalleryPackages=function(){return this.listTestCodeComponents()},t.prototype.clearTemporaryTestGalleryPackages=function(){this.clearTemporaryTestCodeComponents()},t.prototype.loadFromServer=function(){return Q([])},t}(r.CodeComponentSideLoadManagerImpl);t.GalleryPackageMetadataSourceImpl=s}(o||(o={})),o});define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css",["require","exports","module"],function(n,t,i){"use strict";var r;return function(){window.fx.injectCss(i,".fxs-keyboardshortcuts{padding:20px}.fxs-keyboardshortcuts .fxs-keyboardshortcuts-category{margin-top:20px}.fxs-keyboardshortcuts .fxs-keyboardshortcuts-category .fxs-keyboardshortcuts-shortcut{display:-webkit-flex;display:flex}.fxs-keyboardshortcuts .fxs-keyboardshortcuts-category .fxs-keyboardshortcuts-shortcut .fxs-keyboardshortcuts-key{-webkit-flex:0 0 auto;flex:0 0 auto;width:70px}")}
(r||(r={})),r});define("MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources","../Base/Base.KeyboardHelper","../Base/Telemetry","../Widgets/Widgets.UIElementBase","../../_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function d(n){var t=n.isJourneyVisible()&&n.getPanorama();return t&&t.getJourneyWidget()}function p(n){var t=d(n);return t&&t.getFocusedBlade()}function ut(n,t){var i=p(t);i&&i.toggleBladeSize(n)}function w(n,t){var i=d(t);i&&i.setFocusToBlade(n)}function yt(n,t,i,r,u){return new ft(n,t,i,r,u)}var g=i.Base,nt=g.Diagnostics,et=nt.Telemetry,b=g.EventTypes,v=u.VariableKeyCode,y=e.BladeToFocus,ot=window,c=jQuery,k="#blade/HubsExtension/",a=k+"BrowseResourceBlade/resourceType/",st=i.disposeDisposable,l={allResources:k+"BrowseAllResourcesBlade",applicationInsights:a+"microsoft.insights%2Fcomponents",cloudServices:
a+"microsoft.classicCompute%2FdomainNames",resourceGroups:k+"BrowseResourceGroupBlade/resourceType/Microsoft.Resources%2Fsubscriptions%2FresourceGroups",virtualMachines:a+"Microsoft.ClassicCompute%2FVirtualMachines",virtualNetworks:a+"Microsoft.ClassicNetwork%2FvirtualNetworks",webApps:a+"Microsoft.Web%2Fsites"},tt="fxs-topbar",ht="fxs-sidebar-collapse-button",ct=tt+"-home",pt=tt+"-search",o=r.KeyboardShortcuts,h=o.Sections,s=o.GoTo,lt=nt.createLog(n),at=et.trace,vt=[49,50,51,52,53,54,55,56,57,48],it=ko.observable,rt=function(){function n(n,t){this.categories=it(n);this.shortcuts=it(t)}return n}(),ft;t.KeyboardShortcutsHelpViewModel=rt;t.setup=yt;ft=function(){function n(n,t,i,r,u){this._disposables=[];this._keyShortcuts={};this._goToShortcuts={};this._widgetPortal=n;this._addKeyShortcuts(t.contextPane);this._attachEventHandlers();this._errorLoggingFunc=u||function(n){lt.error(n)};this._registerActionShortcuts();this._addGoToShortcuts(t.router);this._registerSpecialShortcut(o.showDiagnostics,
i,65);this._registerSpecialShortcut(o.showDebugHelper,r,68)}return n.prototype.dispose=function(){this._removeEventHandlers()},n.prototype._attachEventHandlers=function(){var t=this,n;this._removeEventHandlers();n=!1;this._disposables.push(c(ot.document).setEvents([b.keydown,function(i){var r,s=u.getModifierKeys(i),o,e;if(i.keyCode===71&&s===0){n=!0;return}(o=n?t._goToShortcuts[i.keyCode]:t._keyShortcuts[i.keyCode],e=o&&o[s],e)&&((r=c(document.activeElement),r.length>0&&(r.is("input[type=text]")||r.is("textarea")||["azc-editableControl","fxc-editor","fxc-console","fxc-consolev2"].some(function(n){return r.closest("."+n).length>0})))||(e.handler(),at({source:f.Source.KeyboardShortcuts,action:f.Action.KeyboardShortcutExecuted,name:e.id}),i.preventDefault()))}],[b.keyup,function(t){var i=u.getModifierKeys(t);t.keyCode===71&&i===0&&(n=!1)}]))},n.prototype._removeEventHandlers=function(){st(this._disposables);this._disposables=[]},n.prototype._registerKeyboardShortcut=function(n,t,i,r){r===
void 0&&(r=0);var u=this._keyShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate shortcut: "+f):this._keyShortcuts[i]=[];this._keyShortcuts[i][r]=e},n.prototype._addKeyShortcuts=function(){var i=this,t=this._widgetPortal,n=function(n,t,r,u){u===void 0&&(u=0);i._registerKeyboardShortcut(n,t,r,u)};n(o.moveFocusToFirstBlade,function(){w(y.First,t)},70);n(o.toggleHomeAndJourneyMode,function(){t.handleStartButtonClick()},68);n(o.toggleHomeAndJourneyMode,function(){t.handleStartButtonClick()},72);n(o.moveFocusToPreviousBlade,function(){w(y.Previous,t)},74);n(o.moveFocusToNextBlade,function(){w(y.Next,t)},75);n(o.moveFocusToLastBlade,function(){w(y.Last,t)},76);n(o.showAvailableKeyboardShortcuts,function(){c(document).trigger(b.fxopenshortcutslegend)},191,4);n(o.minimizeOrRestore,function(){ut(!1,t)},v.Minus);n(o.maximizeOrRestore,function(){ut(!0,t)},v.Equals,4);n(o.closeBlade,function(){var n=p(t);n&&n.close(!1)}
,51,4);n(o.closeJourney,function(){var n=d(t);n&&n.close()},220,4);n(o.toggleFocusSideAndTopBar,function(){var n=c(document).findByClassName(ct)[0];c(document.activeElement)[0]===n?c(document).findByClassName(ht)[0].focus():n.focus()},190);n(o.moveFocusToCommandBar,function(){var n=p(t);n&&n.commandBar.setFocus()},188);n(o.bladeSearch,function(){var n=p(t);n&&n.focusSearchBox()},191,8)},n.prototype._registerGotoShortcut=function(n,t,i){var r=0,u=this._goToShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r,!0),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate goto shortcut: "+f):this._goToShortcuts[i]=[];this._goToShortcuts[i][r]=e},n.prototype._registerSpecialShortcut=function(n,t,i){c.isFunction(t)&&this._registerKeyboardShortcut(n,t,i,9)},n.prototype._addGoToShortcuts=function(n){var i=this,t=this._registerGotoShortcut.bind(this);t(s.allResources,function(){n.route(l.allResources)},65);t(s.applicationInsights,function(){n.route(l.applicationInsights)},73);
t(s.cloudServices,function(){n.route(l.cloudServices)},67);t(s.resourceGroups,function(){n.route(l.resourceGroups)},82);t(s.virtualMachines,function(){n.route(l.virtualMachines)},86);t(s.virtualNetworks,function(){n.route(l.virtualNetworks)},78);t(s.webApps,function(){n.route(l.webApps)},87);vt.forEach(function(n,r){var u=n===48?10:r+1;t(s.sideBarItem+u,function(){i._widgetPortal.getSideBarWidget().openFavorite(r)},n)})},n.prototype._generateIdForKeyboardShortcut=function(n,t,i){i===void 0&&(i=!1);var r=i?"G+":"";return t>15&&this._errorLoggingFunc("Not allowed modifier!"),t&8&&(r+="CTRL+"),t&1&&(r+="ALT+"),t&2&&(r+="WIN/CMD+"),r+u.mapKeyCodeToString((t&4)==4,n)},n.prototype._registerActionShortcuts=function(){var t=this._widgetPortal,n=this._registerKeyboardShortcut.bind(this),i;n(o.active,function(){var n=t.getTopBarWidget().getJourneysMenuWidget().getDropMenuWidget();n.toggle();n.setFocus()},65);n(o.browse,function(){t.getSideBarWidget().toggleFlyout()},66);i=function(){t.getSideBarWidget(
).openCreate()};n(o.new,i,78);n(o.new,i,67);n(o.search,function(){t.getSearchWidget().setFocus()},191)},n.prototype.getShortcutsHelpViewModel=function(){var f,t,i;if(!this._kbShortcutHelpVM){var n=this._addShortcutToArray.bind(this),r=this._addGoToShortcutToArray.bind(this),u={},e=[h.actions,h.navigation,h.goTo];u[h.actions]=[];f=u[h.actions];n(f,78);n(f,191);n(f,65);n(f,66);u[h.navigation]=[];t=u[h.navigation];n(t,68);n(t,74);n(t,75);n(t,70);n(t,76);n(t,v.Minus);n(t,v.Equals,4);n(t,51,4);n(t,220,4);n(t,188);n(t,190);n(t,191,4);u[h.goTo]=[];i=u[h.goTo];r(i,65);r(i,73);r(i,67);r(i,82);r(i,86);r(i,78);r(i,87);i.push({id:s.gPlusNumber,description:s.sideBarItem,handler:null});this._kbShortcutHelpVM=new rt(e,u)}return this._kbShortcutHelpVM},n.prototype._addShortcutToArray=function(n,t,i){i===void 0&&(i=0);var r=this._keyShortcuts;r[t]&&r[t][i]&&n.push(r[t][i])},n.prototype._addGoToShortcutToArray=function(n,t,i){i===void 0&&(i=0);var r=this._goToShortcuts;r[t]&&r[t][i]&&n.push(r[t][i])},n}
()}(o||(o={})),o});define("MsPortalImpl/Services/Services.AzureStorage",["require","exports","f","i"],function(n,t,i,r){"use strict";var u;return function(t){function a(){c.register(o.client,[r.Extension.getWindowId({name:"Microsoft_Azure_Scheduler",cloudName:u.Constants.DefaultCloudName})],v)}function v(n){var t={isBackgroundTask:!1,uri:l};return h.postJSON(t,n).then(function(n){return n.data})}var u=i.Base,f=u.Diagnostics,e=u.Resources,o=u.Rpc.Internal,s=r.InternalAzure,h=u.Net2,y=f.createLog(n),c=s.getSasUriForQueueEndPoint,l=e.getAppRelativeUri("api/Storage/getsasuriforqueue");t.registerSasEndPoint=a}(u||(u={})),u});define("MsPortalImpl/Services/Services.BrowseCurationEndpoints",["require","exports","f","h","i"],function(n,t,i,r,u){"use strict";var f;return function(n){function s(){r.RpcEndPoints.Curation.getSearchCurationEndpoint.register(e.client,[o],function(){return i.require("MsPortalImpl/Services/Services.BrowseCuration").then(function(n){return n.getSearchCuration()})})}var t=
u.Extension,f=i.Base,e=f.Rpc.Internal,o=t.getHubsWindowId();n.initializeRpc=s}(f||(f={})),f});define("MsPortalImpl/Services/Services.Controller",["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){function u(n){var i=[n?n.flushSettings():Q(),r.flush(),t.Upload.flush()],u=i.every(function(n){return!Q.isPending(n)});return u?Q():Q.all(i)}var t=i.Base.Diagnostics,r=t.Telemetry,f=window,e=jQuery;n.flush=u}(r||(r={})),r});define("MsPortalImpl/Services/Services.FileUploadEndpointRegistration",["require","exports","f","i"],function(n,t,i,r){"use strict";var u;return function(n){function s(){e||(e=!0,u.uploadActionEndPoint.register(t.client,null,function(n){return f().then(function(t){return t.invokeUploadAction(n.uploadKey,n.action,n.context)})}),u.getUploadInfosEndPoint.registerObjectFactory(t.client,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){return f().then(function(t){return t.getUploadInfos(n.uploadKeys,n.category,n.resumable)})}}))}var t=i.Base.
Rpc.Internal,u=r.FileUpload,o="MsPortalImpl/Services/Services.FileUploadManager",f=i.memoize(function(){return i.require(o).then(function(n){return n.fileUploadManagerInstance()})}),e=!1;n.registerFileUploadEndpoints=s}(u||(u={})),u});define("MsPortalImpl/Services/Services.GalleryEndpoints",["require","exports","f","i"],function(n,t,i,r){"use strict";var u;return function(n){var t=r.Extension,e=i.Base,o=e.Constants.ExtensionNames,s=window,u=s.fx.environment,f=u.features,h=function(){function n(n,i,r){var e=this;this._registeredEndpoints=[];this._extensionManager=i;this._extensionMetadataSource=r;t.getLocalGalleryPackagesEndpointsDefinition.register(n,null,function(n,i){var r=t.getDescriptor(i.srcWindowId).name.toLowerCase();return r===o.Marketplace.toLowerCase()?e._ensureAllTestExtensionsAreLoaded().then(function(){return e._registeredEndpoints.slice(0)}):null});t.registerLocalGalleryPackagesEndpointDefinition.register(n,null,function(n){if(u.isDevelopmentMode||f&&f.canmodifyextensions)
{var t=e._registeredEndpoints;t.indexOf(n)<0&&t.push(n)}})}return n.prototype._ensureAllTestExtensionsAreLoaded=function(){var n=this;return this._extensionMetadataSource.listTestExtensions().then(function(t){return Q.allSettled(t.map(function(t){return n._extensionManager.getExtensionByName(t.name,t.cloudName)}))})},n}();n.GalleryEndpointsService=h}(u||(u={})),u});define("MsPortalImpl/Services/Services.FavoritesSettings",["require","exports","./Services.Settings","./Services.SettingsProcessor"],function(n,t,i,r){"use strict";var u;return function(n){function h(i){if(u&&!s.isTestMode)throw new Error(t+" has already been called.");u=!0;n.processor.init(i,n.settings,o,t,!0)}var e=i.SettingStore,o=e.Favorites,t="InitializeFavoritesSettingsInternal",s=window.fx.environment,u=!1,f=ko.observable;n.processor=new r.SettingsProcessor;n.settings={favorites:f(""),version:f(0)};n.init=h}(u||(u={})),u});define("MsPortalImpl/Services/Services.SharedSettings",["require","exports","f","i"],function(n,
t,i,r){"use strict";var u;return function(n){function h(){f.getSharedSettingsEndPoint.register(o.client,null,function(){return u()})}function u(){return Q.fcall(function(){return{links:{accountPortal:t.accountPortal,classicPortal:t.classicPortal,createSupportRequest:t.createSupportRequest,helpAndSupport:t.helpAndSupport,manageSupportRequests:t.manageSupportRequests,giveFeedback:t.giveFeedback,privacyAndTerms:t.privacyAndTerms,learnRelatedResources:t.learnRelatedResources,resourceGroupOverview:t.resourceGroupOverview}}})}var f=r.Extension,e=i.Base,o=e.Rpc.Internal,s=window,t=s.fx.environment.links;n.initializeRpc=h;n.getSharedSettings=u}(u||(u={})),u});define("MsPortalImpl/Services/Services.SecurityTokens",["require","exports","f"],function(n,t,i){"use strict";var r;return function(t){function pt(){var n=l.getItem(y);return t.authState=JSON.parse(n),l.removeItem(y),t.authState}function wt(n){t.authState=n}function bt(){t.authState&&l.setItem(y,JSON.stringify(t.authState))}function kt(n)
{return n.refreshToken?new p(new it,n):new rt(n)}function dt(n,t,i){return new w(ot.client,n,t,i)}function gt(n,t,i){var r=n&&n.authHeader,u,f;return r?(u=n.expiresInMs||1,f=t+u,function(){var n=s();return n<f?Q(r):(i(v,n),Q.reject(o))}):function(){return Q.reject(o)}}var h=FxImpl,e=h.Extension,r=i.Base,b=r.Net2,c=r.Constants,ut=r.Constants.ExtensionNames.Hubs,k=r.Diagnostics,ft=k.Telemetry,et=r.Resources,ot=r.Rpc.Internal,st=r.Utilities,ht=r.Security,ct=h.Security,d=window,l=d.sessionStorage,g=k.createLog(n),lt=et.getAppRelativeUri("/api/DelegationToken"),a=ft,u=ct.tokenErrors,f="",v=c.Shell,at=u.accessDenied,nt=u.unknown,tt=u.sessionEnded,o=u.credentialsExpired,vt=u.networkError,yt=u.nullToken,s=Date.now,y=d.fx.environment.bootstrapAuthorizationKey,it,p,rt,w;t.extractAndClearAuthState=pt;t.updateAuthState=wt;t.writeAuthState=bt;t.createOAuthTokenProvier=kt;t.createSecurityTokensManager=dt;it=function(){function n(){}return n.prototype.getToken=function(n,t,i,r){var f={extensionName:n,
resourceName:i,tenant:t,portalAuthorization:r},u=a.startTrace({source:"Services.SecurityTokens",action:"Get",name:n,data:i});return b.postJSON({uri:lt,dataType:"json",setAuthorizationHeader:!1},f).then(function(n){return a.completeTrace(u),n},function(t){var r="Failed to get tokens for extension '{0}' resource '{1}'. {2} {3} {4}".format(n,i,t.jqXHR.status,t.textStatus,t.errorThrown);return a.cancelTrace(u,r),Q.reject(t.jqXHR)})},n}();p=function(){function n(n,t){var r=this._refreshToken=t.refreshToken,i;this._pendingAuthorization=Q.resolve(r);this._client=n;i=this._user=t.user;this._tenant=i&&i.tenantId}return n.prototype.getToken=function(n,t){var i=this;return this._pendingAuthorization.then(function(r){var u=i._client.getToken(n,i._tenant,t||f,r).catch(function(n){var t=h.Azure.buildSimplifiedError(n),i=t.status,u;return u=400<=i&&i<500?o:i?nt:vt,{portalAuthorization:r,value:{authHeader:null,expiresInMs:0,refreshToken:null,error:u,errorMessage:"code: {0}, statusText: {1}, message: {2}, stack: {3}".
format(i,t.statusText,t.message,t.stack||"")}}});return i._pendingAuthorization=u.then(function(n){return i._refreshToken=n.portalAuthorization||r}),u})},n.prototype.getRefreshToken=function(){return this._refreshToken},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n}();t.OAuthTokenProviderImpl=p;rt=function(){function n(n){this._token=n.oAuthToken;this._user=n.user}return n.prototype.getToken=function(){return Q.resolve({value:this._token,portalAuthorization:""})},n.prototype.getRefreshToken=function(){return""},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n}();w=function(){function n(n,t,i,r){this._privilegedExtensionsList={};this._sessionEnded=!1;this._extensionTokenFailures=[];this._hubsWindowId=e.getHubsWindowId();this._tokenProvider=t;this._rpcClient=n;this._sessionEndedHandler=i;this._tokenFailedHandler=r}return n.prototype.initializeSecurityForShell=function(n){var t=n||{},i=t.oAuthToken,u=t.refreshToken,r=t.createdOn||s(),f=u?this._createShellTokenFunc(
i,r):gt(i,r,this._sessionEndedHandler);this._enableShellTokenAccess();b.initialize(f)},n.prototype.registerGetAuthorizationTokenEndpoint=function(n){var t=this;this._privilegedExtensionsList=st.convertArrayToMap(n.filter(function(n){return!n.encryptTokens}).map(function(n){var t=n.cloudName;return e.getWindowId({name:n.name.toLowerCase(),cloudName:t?t.toLowerCase():undefined})}),function(n){return n});this._enableShellTokenAccess();e.getAuthorizationTokenEndPoint.register(this._rpcClient,null,function(n,i){var r;return r=i.srcWindowId===t._hubsWindowId?e.getWindowId({name:ut,cloudName:n.cloudName},{forceCloudName:!0}):i.srcWindowId,t._getSecurityToken(n.cloudName,r,n.resourceName||f,n.isBackground)})},n.prototype.getDiagnosticsData=function(){return this._tokenProvider.getDiagnosticsData()},n.prototype._getSecurityToken=function(n,t,r,u){var e=this;return r&&!this._privilegedExtensionsList[t.toLowerCase()]?Q({error:at}):this._sessionEnded?Q({error:tt}):this._tokenProvider.getToken(t,r,
u).then(function(h){var y=e._extensionTokenFailures,p=s(),c=h&&h.value||{},l=c?c.error:yt,d=c.errorMessage,w,a,b,it,k;return!l&&c.authHeader?(i.remove(y,t),{token:{header:c.authHeader,expiresAt:p+c.expiresInMs}}):(w=l===o,(l===tt||w)&&(e._sessionEnded=!0,a=void 0,b=e._shellTokenCache,w||!b?a=p:(it=t===v?r:f,a=b.getTokenExpiresAt(n,it)),e._sessionEndedHandler(t,a||p)),u||(i.pushUnique(y,[t]),e._tokenFailedHandler(y.join(", ")),k="Failed to get token for {0} and {1}. Error:{2}. Message:{3}".format(t,r,l,d),l===nt?g.error(k):g.verbose(k)),{error:l,errorMessage:d})})},n.prototype._createShellTokenFunc=function(n,i){var u=this,e={},r,o;return n&&(r=n.expiresInMs||1,e[f]={header:n.authHeader,expiresAt:r>0?i+r:-1}),o=this._shellTokenCache=ht.createAuthTokenCache(function(n){return u._getSecurityToken(n.cloudName,v,n?n.resourceName:f,n.isBackground).then(function(i){var o=(i||{}).token,h;if(!!o&&n.resourceName===f){var r=t.authState||{},c=s(),e=r.oAuthToken||{};e.authHeader=o.header;e.expiresInMs=
o.expiresAt-c;h=u._tokenProvider.getRefreshToken();h&&(e.refreshToken=h);r.createdOn=c;r.oAuthToken=e;t.authState=r}return i})},e),function(n){return o.getToken(n).then(function(n){return n&&n.header})}},n.prototype._enableShellTokenAccess=function(){this._privilegedExtensionsList[c.Shell]=c.Shell},n}();t.SecurityTokensManagerImpl=w}(r||(r={})),r});define("MsPortalImpl/Services/Services.ShellProvisioner",["require","exports","f","i","u","../Extension/Extension.Definition.Locator"],function(n,t,i,r,u,f){"use strict";var e;return function(t){var a=f.Locator,o=r.Extension,v=o.CloudName,s=r.ViewModels.ParameterCollectionV3,y=i.Base,p=y.Diagnostics,w=i.Parts.PartSize,c,e,l,h;t.promiseCleanupDelay=3e4;c=p.createLog(n);l=function(){function n(){}return Object.defineProperty(n,"currentInstance",{get:function(){return e},enumerable:!0,configurable:!0}),n.create=function(n){return e||(e=new h(n.desktop,n.rpcClient)),e},n}();t.ShellProvisionerFactory=l;h=function(){function n(n,t){this.provisioningPromisesLookup=
{};this._desktopManager=n;this._registerRpcCallbacks(t)}return n.prototype.processProvisioningRequest=function(n,i){var f=this,s=!0,r,e,o;if(!n)throw new Error("The provisioning request is null or undefined.");if(r=n.provisioningRefKey,!r)throw new Error("The provisioning request is missing the provisioning reference key.");if(!n.provisioningPromise)throw new Error("The provisioning request is missing the provisioning promise.");if(n.startboardInfo){if(this.provisioningPromisesLookup[r])throw new Error("A provisioning promise already exists with the same reference key.");this.provisioningPromisesLookup[r]={promise:n.provisioningPromise,wasAcquired:!1,data:u};e=function(n){f.provisioningPromisesLookup[r].data=n};n.provisioningPromise.progress(e).then(e).finally(function(){setTimeout(function(){f.provisioningPromisesLookup[r]&&!f.provisioningPromisesLookup[r].wasAcquired&&f._logWarning("Provisioning operation with ref key '{0}' wasn't aquired by the provisioning part and is now deleted at '{1}'.".
format(r,new Date));delete f.provisioningPromisesLookup[r]},t.promiseCleanupDelay)});this._addProvisioningPart(n,i)}else n.provisioningPromise.catch(function(n){var t=n||{};t=n.error||n;throw new Error(t.message||t);}),n.provisioningConfig&&!!n.provisioningConfig.dontDiscardJourney&&(s=!1);return s&&(o=this._desktopManager.getActiveJourney(),o&&this._desktopManager.forceDiscardJourney(o.id)),n.provisioningPromise},n.prototype._addProvisioningPart=function(n,t){var i=n.startboardInfo,r=i.provisioningPart,u=r.extension,f=r.name,e=a.forExtension(u,t).withPartType(f),o={provisioningConfig:n.provisioningConfig,provisioningRefKey:n.provisioningRefKey,startboardPart:i.startboardPart};this._desktopManager.addPartToStartBoard({originPartLocator:e,model:v.addToModel(t,{initialData:o}),initialSize:w.Normal})},n.prototype._registerRpcCallbacks=function(n){var t=this;s.initiateProvisioningRequestEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(i,r){var f,u=
r.srcWindowId;return(f=u!==o.getHubsWindowId()?o.getDescriptor(u).cloudName:i.cloudName,!i.provisionerId)?Q.reject("Cannot initiate the provisioning request. The 'provisionerId' was not specified."):i.provisioningRefKey?(s.getProvisioningRequestEndPoint.acquireObject(n,u,i).then(function(n){var i=n.getValue();t.processProvisioningRequest(i,f).finally(function(){n.dispose()})},function(n){throw new Error(n);}),Q.resolve(i)):Q.reject("Cannot initiate the provisioning request. The 'provisioningRefKey' was not specified.")}});s.getProvisioningOperationEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){if(!n)return Q.reject("Cannot return a provisioning operation. The 'provisioningRefKey' was not specified.");var i=t.provisioningPromisesLookup[n],r=i&&i.promise;return r&&(t.provisioningPromisesLookup[n].wasAcquired=!0),Q.resolve({provisioningPromise:r,data:i&&i.data})}})},n.prototype._logWarning=function(n){c.warning(n)},n}();t.ShellProvisionerImpl=
h}(e||(e={})),e});define("MsPortalImpl/Services/Services.TelemetrySharing",["require","exports","f","i"],function(n,t,i,r){"use strict";var u;return function(n){function h(n){return e.registerExtensionUnloadCallback(n),e}var o=r.Extension,u=i.Base,f=u.Constants,t=u.Rpc.Internal,s=function(){function n(){var n=this;this._extensions={};t.client.registerRpcEndPoint(f.TelemetrySharing.RegisterExtension,{allowedOrigin:null,handler:function(){n._extensions[t.messageContext.srcWindowId]=!0}})}return n.prototype.registerExtensionUnloadCallback=function(n){var t=this;n.onUnload(function(n){var i=o.getWindowId(n);return t._extensions[i]&&delete t._extensions[i],!0})},n.prototype.traceBrowserInfo=function(){},n.prototype.trace=function(n){var i=n.extension,r=n.data&&n.data.srcExtension,u=f.TelemetrySharing.TraceTelemetry;this._extensions[i]&&t.client.invokeRpc(u,i,n);i!==r&&this._extensions[r]&&t.client.invokeRpc(u,r,n)},n.prototype.flush=function(){return i.Helpers.Deferred().resolve().promise()}
,n}(),e=new s;n.getProcessor=h}(u||(u={})),u});define("MsPortalImpl/Services/Services.Util",["require","exports","f","i","Fx/Pinner"],function(n,t,i,r,u){"use strict";var f;return function(t){function s(n){return r.Extension.getWindowId({name:n,cloudName:o.DefaultCloudName})}function w(n){v.register(e.client,null,b);p.register(e.client,[o.ExtensionNames.Hubs,s("Microsoft_Azure_Monitoring"),s("Microsoft_OperationsManagementSuite_Workspace")],function(t,i){var u=r.Extension.getDescriptor(i.srcWindowId),f=t.options?t.options.notify:!0;return n.pinMultipleParts(t.parts,u.name,u.cloudName,f)})}function b(n){var t={isBackgroundTask:!1,uri:y};return a.postJSON(t,n).then(function(n){return n.data})}var f=i.Base,h=f.Diagnostics,c=f.Resources,e=f.Rpc.Internal,l=r.InternalCryptography,a=f.Net2,o=f.Constants,v=l.getHmacSha256EndPoint,y=c.getAppRelativeUri("api/Utilities/gethmacsha256"),p=u.Internal.pinEndPoint,k=h.createLog(n);t.registerEndPoints=w}(f||(f={})),f});define("MsPortalImpl/UI/Hubs/ViewModels/UI.Hubs.Common",
["require","exports","f"],function(n,t,i){"use strict";var r;return function(n){var r=i.ViewModels,u=r.Internal.ContainerViewModel,f=ko.observable,e,t;(function(n){n.newNonGroupingList="50px"})(e=n.IconColumnWidth||(n.IconColumnWidth={}));t=function(n){function t(){n.apply(this,arguments);this.failureMessage=f()}return __extends(t,n),t.prototype.fail=function(n){this.failureMessage(n)},t}(u);n.BladeContainerViewModel=t}(r||(r={})),r});define("MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",["require","exports","i","../../../Extension/ViewModelManager","./UI.Hubs.Common"],function(n,t,i,r,u){"use strict";var f;return function(n){function s(n){r.registerWithState("Browse$BrowseAllBlade$ServicesListPartViewModel",t+"UI.BrowseAll.Part",function(t,i){return f.composePartViewModel(function(r){return new t.ServicesListPartViewModel(r,i,n)},{initialState:i})});r.registerWithState("Browse$BrowseServiceBladeViewModel",t+"UI.BrowseService.Blade",function(t,i){var r=new u.BladeContainerViewModel,
f=new t.BrowseServiceBladeViewModel(r,i,n);return new o(r,f,i)});r.registerWithState("Browse$BrowseServiceBlade$ServiceItemsListPartViewModel",t+"UI.BrowseService.Part",function(t,i){return f.composePartViewModel(function(r){return new t.ServiceItemsListPartViewModel(r,i,n)})});r.registerWithState("Browse$BrowseServiceTileViewModel",t+"UI.BrowseService.PinnedPart",function(t,i){return f.composePartViewModel(function(r){return new t.BrowseServiceTileViewModel(r,i,n)},{createHubsInternalCloudNameProperty:!0})});r.registerWithState("Browse$BrowseServiceTileViewModel$Websites",t+"UI.BrowseService.PinnedPart",function(t,i){return f.composePartViewModel(function(r){var u=new t.BrowseServiceTileViewModel(r,i,n);return u.assetTypeId("WebsitesExtension_Website"),u})});r.registerWithState("Browse$BrowseServiceTileViewModel$Subscriptions",t+"UI.BrowseService.PinnedPart",function(t,i){return f.composePartViewModel(function(r){var u=new t.BrowseServiceTileViewModel(r,i,n);return u.assetTypeId("HubsExtension_Subscription"),
u})})}var e=i.ViewModels,o=e.CompositionViewModel,f=e.Part,t="./MsPortalImpl/UI/Hubs/ViewModels/";n.registerViewModels=s}(f||(f={})),f});define("MsPortalImpl/UI/Hubs/UI.FavoritesManager",["require","exports","f","i","MsPortalImpl/Resources/ImplScriptResources","../../Services/Services.AssetTypes","./UI.NotificationManager"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function st(n,t){var r=(t||"").toLowerCase(),i=n.assetTypeManifest.resourceType;return(t&&i&&i.kinds||[]).first(function(n){return n.name.toLowerCase()===r})}function y(n,t,i,r){i===nt.BrowseResourceGroupBlade&&(i=ii);var u=l.getWindowId({name:t,cloudName:n},{forceCloudName:!0});return bt.getAssetTypeOrResourceTypeIdByWindowId(u,i)+(r?"."+r.toLowerCase():"")}function p(n,t,i,r,u){var f=n.extension,e=n.assetTypeManifest.name,o=r.some(function(r){var u=y(n.cloudName,f,e,t)===r.id;return u&&(r.index=i),u}),s=function(r){var u=rt(n,!0,!0);return u.id=y(r,f,e,t),u.cloudName=r,u.index=i,u};u(s(n.cloudName),t,o)}
function ht(n,t){return t&&(t.serviceDisplayName||t.pluralDisplayName||tt.assetPlusKindFormat.format(n.compositeDisplayName.service,t.name))||n.compositeDisplayName.service}function ct(n,t){return t&&t.icon||n.icon}function lt(n,t){return t?t.keywords:n.assetTypeManifest.keywords}function at(n,t){return v(n.cloudName,t.cloudName)&&n.extension===t.extension&&n.assetTypeManifest.name===t.assetTypeManifest.name}function fi(n,t){return v(n.cloudName,t.cloudName)&&n.extensionName===t.extension&&n.assetType===t.assetTypeManifest.name}function ei(n,t,i){var u=[];if(i&&n.version()<ot){var r=n.favorites,e=r().toLowerCase(),f=c(r());["Microsoft_AAD_IAM_AzureActiveDirectory","Microsoft_Azure_Monitoring_AzureMonitoring","Microsoft_Azure_Security_SecurityDashboard","Microsoft_Azure_Billing_Billing","Microsoft_Azure_Support_HelpAndSupport",].forEach(function(n){var t=n.toLowerCase();e.indexOf(t)<0&&(f.push(n),u.push(n))});r(s(f))}t(u);n.version(ot)}function oi(n){return new vt(n)}var w=i.Base,yt=i.Extension,
b=w.Constants,nt=b.AssetNames,pt=b.ExtensionNames.Hubs,wt=yt.BrowseType,l=r.Extension,bt=r.Assets,kt=r.TriggerableLifetimeManager,dt=i.Hubs.Notifications.NotificationStatus,h=undefined,tt=u.Favorites,it=tt.Notification,gt=it.Description,ni=window,ti=ni.fx.environment,si=w.Diagnostics.createLog(n),ii=nt.ResourceGroups,o=ko.observable,a=ko.observableArray,rt=w.Utilities.clone,k=b.DefaultCloudName,c=JSON.parse,s=JSON.stringify,ut=i.isFeatureEnabled("browsecategories"),ri="uncurated",ft=/\s+/g,d=i.find,et=i.remove,g=i.stableSort,v=l.isEqualCloudName,ot=1,ui={},vt;r.getAssetTypeMappingData=function(){return ui};t.createFavoritesManager=oi;vt=function(){function n(n){var t=this;this.categories=a([]);this.categoriesLookup={};this.showCategories=o(!1);this.possibleFavorites=a([]);this.possibleFavoritesLookup={};this.favorites=a([]);this.selectedCloud=o();this._notificationsForItems=o();this._lifetime=new kt;this.removeFavoriteFromSettings=function(n){var i=c(t._savedFavorites())||[],r=i.indexOf(
n);r!==-1&&(i.splice(r,1),t._savedFavorites(s(i)))};this.addFavoriteToSettings=function(n){var i=c(t._savedFavorites())||[],r=i.indexOf(n);r===-1&&(i.push(n),t._savedFavorites(s(i)))};this.moveFavorite=function(n,i){var r=c(t._savedFavorites())||[];r.splice(n,0,r.splice(i,1)[0]);t._savedFavorites(s(r))};this._services=n}return n.prototype.initialize=function(n,t){var r=this,u=this._savedFavorites=n.favorites,e=u&&u().length,h=f.getCloudNames(),l,c,y;e||(l=this._getDefaultFavorites(t),u(s(l)));ei(n,this._notificationsForItems,e);ut&&i.require("MsPortalImpl/Services/Services.BrowseCuration").then(function(n){r._browseCuration=n;n.getBrowseCuration().then(function(n){var l=r._defaultFavorites=n.favorites,c;l&&!e&&r._savedFavorites(s(r._getDefaultFavorites(t)));var u=function(n,t){var i={id:n,showLabel:o(!0),isFilteredOut:o(!1),isHidden:ko.pureComputed(function(){var n=r.selectedCloud();return!i.possibleFavorites().some(function(t){return v(t.cloudName,n)&&!t.isHidden()&&!t.isFilteredOut()}
)}),label:f.provideCategoryName(n),possibleFavorites:a(),sourceCategory:t};return i},y=n.categories||[],i=y.map(function(n){return u(n.id,n)});i&&i.length&&(c=r._uncuratedCategory=u(ri),i.push(c));r.categories(i);r.possibleFavorites().forEach(function(n){var t=st(n.assetType,n.kind),i=n.assetType,r=ht(i,t);n.label(r);n.labelId(r.replace(ft,""));n.image=ct(i,t);n.keywords=lt(i,t)});r._addFavoriteTypes(h)})});this._addFavoriteTypes(h);c=this._services.browseManager;y=c.registerAssetTypesUpdateCallback(function(){r._addFavoriteTypes(h)});this._lifetime.registerForDispose(function(){c.unregisterAssetTypesUpdateCallback(y)})},n.prototype.applySettingsToFavorites=function(){this.possibleFavorites().forEach(function(n){n.isFavorite(!1)});var u=this.possibleFavoritesLookup,n=[],f=c(this._savedFavorites())||[];f.forEach(function(t){var i=u[t],r=i&&i.isFavorite;i&&!r()&&(r(!0),n.push(i))});var t=this._notificationsForItems,i=t()||[],r=i.slice(0);i.forEach(function(t){var i=d(n,function(n){return t===
n.id}),u,f;i&&(u=it.titleFmt.format(i.label()),f=i.assetType.assetTypeManifest||{},e.getNotificationManager().addClientNotification({title:u,description:gt[(f.name||"").toLowerCase()]||u,status:dt.Information,timestamp:new Date,cloudName:k,uri:i.uri}),r.remove(t))});t(r);this.favorites(n)},n.prototype.dispose=function(){var n=this._lifetime;n&&n.dispose();this._lifetime=null},n.prototype._getDefaultFavorites=function(n){var t=[],i=function(i,r,u,f,e){(!i||n)&&t.push(y(r||k,u,f,e))},r=this._defaultFavorites,u=ti.defaultFavorites;return r?r.forEach(function(n){i(n.checkSubscription,n.cloudName,n.extensionName,n.assetType,n.kind)}):u&&u.forEach(function(n){i(n.checkSubscription,h,n.extensionName,n.name,h)}),t},n.prototype._addFavoriteType=function(n,t,i){var r=this._getFavoriteType(n,t);i.splice(n.index,0,r);this.possibleFavoritesLookup[r.id]=r},n.prototype._addFavoriteTypeToCategory=function(n,t,i,r,u){var f=this._getFavoriteType(t,i),e=this.possibleFavoritesLookup[f.id],o;e&&(f.isFavorite=
e.isFavorite,o=f.isHidden=e.isHidden,o(o()||r));u.splice(t.index,0,f)},n.prototype._addFavoriteTypes=function(n){var f=this._services.browseManager,t=f.getFilteredAssetTypes()||[],b=this.possibleFavoritesLookup,nt=this._addFavoriteType.bind(this),tt=this._addFavoriteTypeToCategory.bind(this),e=this.possibleFavorites,i=e(),it=e(),r=!1,ft=[],o,s,c,u;if(t.forEach(function(t){t.extension===pt&&n.length>1&&n.forEach(function(n){if(!v(n,l.getHubsCloudName())){var i=rt(t,!0,!0);i.id=y(n,t.extension,t.assetTypeManifest.name,h);i.cloudName=n;ft.push(i)}})}),t=t.concat(ft),t.forEach(function(n,t){p(n,h,t,it,function(n,t,u){u||(r=!0,nt(n,t,i))})}),o=[],i.forEach(function(n){d(t,function(t){return at(n.assetType,t)})||o.push(n)}),o.forEach(function(n){r=!0;et(i,n)}),ut&&(s=this.categories(),this.showCategories(!!s.length),c=Object.keys(b).slice(0),s.forEach(function(n){var f=n.possibleFavorites,u=f(),l=f(),s=n.sourceCategory,h=s&&s.items||[],e=!1,o;h&&h.forEach(function(f,o){var s=-1,h,a;t.some(function(
n){var t,i,r;return f.cloudName=f.cloudName||k,fi(f,n)&&(t=n.assetTypeManifest.resourceType,i=(f.kind||"").toLowerCase(),i?(r=(t&&t.kinds||[]).some(function(n){return n.name.toLowerCase()===i}),r&&(s=o,h=n,a=f.kind)):(s=o,h=n)),s>-1});s>-1&&(a&&p(h,a,i.length,it,function(n,t,u){u||(r=!0,nt(n,t,i))}),p(h,a,s,l,function(t,i,r){c.remove(t.id);r||(e=!0,tt(n,t,i,!!f.isHidden,u))}))});o=[];u.forEach(function(n){d(t,function(t){return at(n.assetType,t)})||o.push(n)});o.forEach(function(n){e=!0;et(u,n)});e&&f(g(u,function(n,t){return n.index-t.index}))}),u=this._uncuratedCategory,u)){var ot=!1,a=u.possibleFavorites,w=a(),st=a();c.forEach(function(n){var t=b[n];p(t.assetType,h,w.length,st,function(n,t,i){i||(ot=!0,tt(u,n,t,!1,w))})});ot&&a(g(w,function(n,t){return f.compareAssetTypeNameForSorting(n.label(),t.label())}))}r&&e(g(i,function(n,t){return f.compareAssetTypeNameForSorting(n.label(),t.label())}));this.applySettingsToFavorites()},n.prototype._getFavoriteType=function(n,t){var u=n.assetTypeManifest,
f=u.browseType===wt.ServiceLink,i=st(n,t),r=ht(n,i);return{id:n.id,image:ct(n,i),isFavorite:o(!1),isFilteredOut:o(!1),isHidden:o(!1),label:o(r),labelId:o(r.replace(ft,"")),keywords:lt(n,i),matches:o(),uri:this._services.assetTypeService.getAssetTypeDeepLink(n,t),opensExternal:f,cloudName:l.normalizeCloudName(n.cloudName),isPreview:n.isPreview,index:n.index,assetType:n,kind:t}},n}()}(o||(o={})),o});define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration",["require","exports","f","../../../Extension/ViewModelManager"],function(n,t,i,r){"use strict";var u;return function(n){function f(){r.register("Gallery$CsmCommand",u+"UI.Gallery.CsmCommand",function(n){return new n.CsmCommand(t.DefaultCloudName)})}var t=i.Base.Constants,u="./MsPortalImpl/UI/Hubs/ViewModels/";n.registerViewModels=f}(u||(u={})),u});define("MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks",["require","exports","h","i","../../Services/Services.Settings"],function(n,t,i,r,u){"use strict";var f;return function(n){function h(
n,t){var r=Q.defer(),i={},u={store:f,keys:t};return n.querySettings(u).then(function(n){t.forEach(function(t){i[t]=t in n?n[t]:undefined});r.resolve(i)}),r.promise}function c(n,t,i){n.setSettings({store:f,settings:t},i)}function l(n){var i=n.settings,r=n.rpcClient,u=[e.getHubsWindowId()];t.readHubsUserSettings.register(r,u,function(n){return h(i,n)});t.writeHubsUserSettings.register(r,u,function(n){return c(i,n.settings,n.priority),undefined})}var e=r.Extension,o=u.SettingStore,s=i.Hubs,t=s.Settings.Schema,f=o.HubsExtension;n.registerRpcCallbacks=l}(f||(f={})),f});define("MsPortalImpl/UI/Hubs/UI.ResourceMapManagerRpc",["require","exports","h"],function(n,t,i){"use strict";var r;return function(n){function e(n,i){var u=function(n){return t.getDescriptor(n.srcWindowId).cloudName},e;t.mapAssetIdToResourceIdEndPoint.register(n,null,function(n,t){return i.getService(r).then(function(i){return i.mapAssetIdToResourceId(n,u(t))})});t.mapResourceIdToAssetIdEndPoint.register(n,null,function(n,t)
{return i.getService(r).then(function(i){return i.mapResourceIdToAssetId(n,u(t))})});t.mapResourceIdToDynamicSelectionAndIconEndPoint.register(n,null,function(n,t){return i.getService(r).then(function(i){return i.mapResourceIdToDynamicSelectionAndIcon(n.resourceId,u(t),{reason:"mapResourceIdToDynamicSelectionAndIcon",extension:t.srcWindowId})})});t.getResourceAssetInformationEndPoint.register(n,null,function(n,t){return i.getService(r).then(function(i){return i.getResourceAssetInformation(n,u(t),{reason:"getResourceAssetInformation",extension:t.srcWindowId})})});t.getResourceEndPoint.register(n,null,function(n,t){return i.getService(r).then(function(i){return i.getResource(n.resourceId,!1,u(t),{reason:n.caller+":getResource",extension:t.srcWindowId})})});t.signalResourcesChangedEndPoint.register(n,null,function(n,t){return i.getService(r).then(function(i){return Q(i.signalResourcesChanged(n,u(t)))})});e=t.getHubsWindowId();f.mapAssetIdToResourceIdEndPoint.register(n,[e],function(n){return i.
getService(r).then(function(t){return t.mapAssetIdToResourceId(n.assetTriplet,n.cloudName)})});i.assetManager.onAssetDeleted(function(n,t,u){i.getService(r).then(function(i){i.processAssetDeletion(n,t,u)})})}var u=FxImpl,t=u.Extension,f=i.RpcEndPoints.AssetTypes,r="ResourceMapManager";n.setupResourceMapManagerRpc=e}(r||(r={})),r});define("MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration",["require","exports","f","i","../../../Extension/ViewModelManager","./UI.Hubs.Common"],function(n,t,i,r,u,f){"use strict";var e;return function(n){function v(n){var r=u.registerWithState;r(c+"ViewModel",t+(i+"Blade"),function(n,t){var i=new f.BladeContainerViewModel,r=new n.SettingsBladeViewModel(i,t);return new o(i,r,t)});r(c+"$SettingsPartViewModel",t+(i+"SettingsPart"),function(t,i){return e(function(r){return new t.SettingsPartViewModel(r,i,n)},{createHubsInternalCloudNameProperty:!0})});r(l+"ViewModel",t+(i+"LanguageSelectionBlade"),function(n,t){var i=new f.BladeContainerViewModel,
r=new n.LanguageSelectionBladeViewModel(i,t);return new o(i,r,t)});r(l+"$LanguageGridViewModel",t+(i+"LanguageGrid"),function(n,t){return e(function(i){return new n.LanguageGridViewModel(i,t)})});r(a+"ViewModel",t+(i+"LocaleSelectionBlade"),function(n,t){var i=new f.BladeContainerViewModel,r=new n.LocaleSelectionBladeViewModel(i,t);return new o(i,r,t)});r(a+"$LocaleGridViewModel",t+(i+"LocaleGrid"),function(n,t){return e(function(i){return new n.LocaleGridViewModel(i,t)})});r("Help$HelpAndSupportBlade$DiagnosticsPartViewModel",t+(i+"DiagnosticsPart"),function(t,i){return e(function(r){return new t.DiagnosticsPartViewModel(r,i,n)})})}var h=r.ViewModels,o=h.CompositionViewModel,e=h.Part.composePartViewModel,t="./MsPortalImpl/UI/Hubs/ViewModels/",s="Settings$",c=s+"SettingsBlade",l=s+"LanguageSelectionBlade",a=s+"LocaleSelectionBlade",i="UI.Settings.";n.registerViewModels=v}(e||(e={})),e});define("MsPortalImpl/UI/UI.StatusHandler",["require","exports","f","MsPortalImpl/Resources/ImplScriptResources",
"../Services/Services.SecurityTokens","../Base/Telemetry"],function(n,t,i,r,u,f){"use strict";var e;return function(t){function v(n,t){return(n&t)===t}function st(n,t,i,r,u,f,e){return new y(n,t,i,r,u,f,e)}var s=i.Base,p=s.Diagnostics,w=p.Telemetry,ut=s.Utilities,b=i.ViewModels.Dialogs,k=b.DialogResult,h=b.MessageBoxButtons,o=f.Action,d=f.Source,g=window,ht=g.fx.environment,c=p.createLog(n),nt=s.Constants.Shell,tt=r.Shell,l=tt.Notifications,e=tt.Dialogs,a=l.SessionEnding,it=l.TokenFailure,rt=l.VersionChanged,ft=3e4,et=3,ot=[12e5,6e5],y;t.create=st;y=function(){function n(n,t,i,r,u,f,e){this._pageBlockingPrompt=!1;this._isDialogVisible=!1;this._unknownNetworkErrorCount=0;this._unknownNetworkErrorCanceled=!1;this._getDialogManager=n;this._extensionVersionCache=t;this._initializationPromise=i;this._redirectFunc=r;this._setDesktopManagerModeFunc=u;this._showSplashScreenFunc=f;this._notify=e}return n.prototype.onLastTokenRefresh=function(n,t){var r=this,i=Date.now();if(t<=i)this.onStatus({code:
2},n);ot.forEach(function(n){var u=t-n;g.setTimeout(function(){var t=Math.floor(n/6e4),i=t>10?a.messageFmt.format(t):a.message;r._notify(a.title,i)},u-i)})},n.prototype.onStatus=function(n,t){var y=this,i=Q.resolve(null),l,u,v,r,f,a;if(!n||this._pageBlockingPrompt)return i;l=t===nt;u=l||t===s.Constants.ExtensionNames.Hubs;switch(n.code){case 0:break;case 1:l||this._extensionVersionCache.expireLatest(t);u?i=this._showDialog(t,o.ShellVersionChanged,e.newVersionMessageTitle,e.newVersionMessageDescription,e.newVersionDefaultButtonText,null,ft,h.OKCancel,5):(w.trace({source:d.Shell,action:o.ExtensionVersionChanged,data:t}),c.warning("Extension reporting incompatible server version. {0}:{1}".format(t,n.message)),this._notify(rt.title,rt.messageFmt.format(t)));break;case 2:v=o.ExtensionSignedOut;u?i=this._showDialog(t,v,e.signedOutTitle,e.signedOutDescription,e.signedOutDefaultButtonText,null,0,h.OK,7):this._notify(it.title,it.messageFmt.format(t));break;case 4:if(r=n.message,c.verbose("Received a status code zero from extension {0} for URL '{1}'.".
format(t,r)),!u)break;if(this._unknownNetworkErrorCount>et||this._isDialogVisible||this._unknownNetworkErrorCanceled)break;this._unknownNetworkErrorCount++;ut.isUriAbsolute(r)||(r="//"+t+"/"+r);f=document.createElement("a");f.href=r;f.innerText=e.connectionErrorMessagePlaceHolder;i=this._showDialog(nt,o.UnknownNetworkError,e.connectionErrorMessageTitle,e.connectionErrorMessageDescription.format(f.outerHTML),null,e.connectionErrorCancelButtonText,0,h.OKCancel,0).then(function(n){y._unknownNetworkErrorCanceled=n===k.Cancel});break;case 5:i=this._showDialog(t,o.RelexDisconnected,e.relexDisconnectedMessageTitle,e.relexDisconnectedMessageDescription,e.relexDisconnectedDefaultButtonText,null,0,h.OKCancel,1);break;default:a="Received unknown extension event '{0}' for extension '{1}'.".format(n.code,t);i=Q.reject(a);c.error(a)}return i},n.prototype._showDialog=function(n,t,i,r,f,e,o,s,h){var a=this,y,g=this._redirectFunc,p=v(h,2),c,b,l;return this._pageBlockingPrompt=v(h,1),t&&w.trace({source:
d.Shell,action:t,data:n}),p&&u.updateAuthState(null),c=function(n){g({skipFlushBuffers:p,delayPromise:n&&o?Q.delay(o):null})},b=v(h,4)&&Q.isPending(this._initializationPromise),b?(y=Q.defer().promise,c(!1)):(l=Q.defer(),this._setDesktopManagerModeFunc(),this._isDialogVisible=!0,y=this._getDialogManager().then(function(n){return n.showModalDialog({title:i,description:r,defaultButtonText:f,cancelButtonText:e,buttons:s,uiShield:{hidePromise:l.promise}})}).then(function(n){return a._pageBlockingPrompt?(a._showSplashScreenFunc(),l.resolve(),c(!0)):n===k.Ok?c(!1):l.resolve(null),n}).finally(function(){a._isDialogVisible=!1})),y},n}();t.StatusHandlerImpl=y}(e||(e={})),e});define("MsPortalImpl/UI/UI.ViewTimeTelemetry",["require","exports","f","../Base/Base.Events","../Base/Telemetry"],function(n,t,i,r,u){"use strict";var f;return function(n){function st(n,i){o=n.desktop;tt=i&&i.increment||b;it=i&&i.tooSmall||k;nt=o.activeJourney.subscribe(function(n){n?c():s(l)});e.fx.environment.features.multidashboards===
"true"&&o.getDashboardManager().then(function(n){p=n.currentDashboardId.subscribe(function(n){c();v=n;s(l)});v=n.currentDashboardId()});a(t.blur,d=function(){c()});a(t.focus,g=function(){s(l)});a(t.mousemove,y=function(){h(t.mousemove,y);s()})}function ht(){h(t.blur,d);h(t.focus,g);h(t.mousemove,y);nt.dispose();p&&p.dispose();c()}function s(n){f||o.activeJourney()||(n&&(ut=0,++rt),ft=Date.now(),f=setTimeout(function(){et();f=null;s()},tt))}function c(){f!==null&&(clearTimeout(f),et());f=null}function et(){var n=Date.now()-ft;n>=it&&ot.trace({source:u.Source.Shell,action:u.Action.DashboardViewTime,data:{target:"Dashboard",trackId:v,timespan:n,sequenceId:rt,sequence:++ut,tileCount:o.startBoard.children.filter(function(n){return!n.dontSetupWidget}).length,fullscreen:!!r.isFullscreen()}})}var w=i.Base,ot=w.Diagnostics.Telemetry,t=w.EventTypes,e=window,l=!0,b=3e5,k=1e4,a=e.addEventListener.bind(e),h=e.removeEventListener.bind(e),o,v="",y,d,g,nt,p,tt=b,it=k,rt=0,ut=0,f=null,ft;n.start=st;n.stop=
ht}(f||(f={})),f});define("_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css",["require","exports","module"],function(n,t,i){"use strict";var r;return function(){window.fx.injectCss(i,".fxs-part-buttonpart-assetname,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-wide .fxs-part-buttonpart-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-buttonpart{height:100%;width:100%;box-sizing:border-box}.fxs-part-buttonpart-inner{display:-webkit-flex;display:flex;position:relative;height:100%;box-sizing:border-box;padding-top:28px;text-align:center;-webkit-align-items:center;align-items:center;-webkit-flex-direction:column;flex-direction:column}.fxs-part-buttonpart-iconcontainer{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.fxs-part-buttonpart-iconcontainer>img,.fxs-part-buttonpart-iconcontainer>svg{height:50px;width:50px}.fxs-part-buttonpart-textcontainer{width:100%;font-family:az_ea_font,wf_segoe-ui_normal,\"Segoe UI\",\"Segoe WP\",Tahoma,Arial,sans-serif;font-size:12px;line-height:18px}.fxs-part-buttonpart-assetname{margin:0;font-family:az_ea_font,wf_segoe-ui_semibold,\"Segoe UI Semibold\",\"Segoe WP Semibold\",\"Segoe UI\",\"Segoe WP\",Tahoma,Arial,sans-serif;font-size:10px;line-height:10px;text-transform:uppercase}.fxs-part-buttonpart-title{margin:10px 0 5px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-mini .fxs-part-buttonpart-title,.fxs-tilesize-small .fxs-part-buttonpart-title{margin:0}.fxs-part-buttonpart-title::after,.fxs-part-buttonpart-title::before,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{position:absolute;background-color:inherit}.fxs-part-buttonpart-title::before{content:'\\02026';top:18px;right:0}.fxs-part-buttonpart-title::after{content:'';height:100%;width:100%}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg{height:30px;width:30px}.fxs-tilesize-small .fxs-part-buttonpart-inner,.fxs-tilesize-wide .fxs-part-buttonpart-inner{padding-top:0;text-align:left;-webkit-flex-direction:row;flex-direction:row}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>svg{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{-webkit-flex:0 1 auto;flex:0 1 auto;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:center;justify-content:center}.fxs-tilesize-mini{font-family:az_ea_font,wf_segoe-ui_normal,\"Segoe UI\",\"Segoe WP\",Tahoma,Arial,sans-serif;font-size:12px;line-height:normal}.fxs-tilesize-mini .fxs-part-buttonpart-inner{padding-top:5px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:32px;line-height:15px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:16px;right:0}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer{width:51px;padding-left:6px}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer{width:calc(100% - 51px)}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:18px;right:0}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{width:85px;padding-left:15px}.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{width:calc(100% - 85px)}.fxs-tilesize-wide .fxs-part-buttonpart-title{margin:0}.fxs-tilesize-wide .fxs-part-buttonpart-assetname{padding-top:2px}.fxs-tilesize-wide .fxs-part-buttonpart-desc{display:block;margin-top:10px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:90px}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after,.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{position:absolute;background-color:inherit}.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{content:'\\02026';top:72px;right:0}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after{content:'';height:100%;width:100%}.fxs-part-buttonpart-externallink{position:absolute;top:0;right:0;height:12px;width:12px}.fxs-part-buttonpart-externallink>img,.fxs-part-buttonpart-externallink>svg{height:12px;width:12px}.fxs-tilesize-mini .fxs-part-buttonpart-externallink{top:-5px;right:5px}.fxs-part-buttonpart,.fxs-part-buttonpart .fxs-part-buttonpart-desc,.fxs-part-buttonpart .fxs-part-buttonpart-inner,.fxs-part-buttonpart .fxs-part-buttonpart-textcontainer,.fxs-part-buttonpart .fxs-part-buttonpart-title{background-color:inherit}.fxs-part-buttonpart-adornment{position:absolute;top:0;left:33px;height:14px;width:14px}.fxs-tilesize-mini .fxs-part-buttonpart-adornment{position:absolute;top:0;left:17px;height:10px;width:10px}.fxs-tilesize-small .fxs-part-buttonpart-adornment{position:absolute;top:50% - 30px/2;left:0;height:10px;width:10px}.fxs-tilesize-wide .fxs-part-buttonpart-adornment{position:absolute;top:50% - 50px/2;left:0;height:14px;width:14px}html[lang^=ja] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=ko] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=zh] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title{font-size:11px;line-height:11px}")}
(r||(r={})),r});define("MsPortalImpl/Parts/Parts.ButtonPart",["require","exports","f","../Base/Base.ImageHelper","./Parts","../../_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css"],function(n,t,i,r,u){"use strict";var f;return function(n){var o=i.Base,s=o.Images,t=i.Parts.PartSize,f,e;n.template="<div class='fxs-part-buttonpart'><div class='fxs-part-buttonpart-inner'><div class='fxs-part-buttonpart-iconcontainer' data-bind='image: icon'><\/div><!-- ko if: $data.adornmentUri --><img alt='' class='fxs-part-buttonpart-adornment' data-bind='attr: { src: adornmentUri }' /><!-- /ko --><div class='fxs-part-buttonpart-textcontainer'><h4 class='fxs-part-buttonpart-title msportalfx-tooltip-overflow' data-bind='text: _displayTitle, css: { \"fxs-should-use-single-line\": _assetNameVisible(),  \"fxs-can-use-multiline\": !_assetNameVisible() }'><\/h4><h5 data-bind='text: _assetName, visible: (_assetNameVisible())' class='fxs-part-buttonpart-assetname msportalfx-tooltip-overflow fxs-text-title'><\/h5><div data-bind='text: description, visible: ((size() === MsPortalFx.Parts.PartSize.Wide) && description())' class='fxs-part-buttonpart-desc msportalfx-tooltip-overflow'><\/div><\/div><!-- ko if: _isExternalLink --><div class='fxs-part-buttonpart-externallink azc-fill-heavy'>"+
r.GetImageData(s.Hyperlink())+"<\/div><!-- /ko --><\/div><\/div>";f=ko.observable;e=function(r){function u(){r.apply(this,arguments);this.template=n.template}return __extends(u,r),u.prototype._getContentForBinding=function(n,u){var y=this,o=u.content,s=u.container,e=s.clickableLink,h=function(n){return n.target()==="_self"||n.uri&&i.startsWith(n.uri(),"#")&&n.target()==="auto"},c=f(!!e&&!h(e)),a=o.size,p=ko.computed(n,function(){var n=a&&a(),r=o.shortTitle(),i=o.title();return n===t.Mini||n===t.Small?r||i:i}),w=ko.computed(n,function(){return!y.inContainerOfSameAsset()&&s.assetName()}),v=e&&e.target,l;return v&&v.subscribe(n,function(){c(!h(e))}),l=e&&e.uri,l&&l.subscribe(n,function(){c(!h(e))}),$.extend({},r.prototype._getContentForBinding.call(this,n,u),{_displayTitle:p,_assetName:s.assetName,_isExternalLink:c,_assetNameVisible:w})},u}(u.PartImpl);n.ButtonPart=e}(f||(f={})),f});define("_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",["require","exports","module"],function(n,
t,i){"use strict";var r;return function(){window.fx.injectCss(i,'.fxs-part-collectionpart .azc-grid table td[role=gridcell]:first-of-type,.fxs-part-collectionpart .azc-grid table thead tr th:first-child a{padding-left:15px}.fxs-part-collectionpart-more-data,.fxs-part-collectionpart-rollup-count{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif}.fxs-part-collectionpart .azc-grid table thead tr th{height:29px;border-top-width:1px;border-top-style:solid}.fxs-part-collectionpart .azc-grid table thead tr th>a{line-height:normal}.fxs-part-collectionpart .azc-grid table tbody tr td{height:27px}.fxs-part-collectionpart .azc-grid table td:last-child,.fxs-part-collectionpart .azc-grid table td:last-of-type{padding-right:15px}.fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:none}.fxs-part-collectionpart.fxs-part-collectionpart-rollup-forceshow .fxs-part-collectionpart-rollup-container{display:block}.fxs-part-collectionpart-more-data{text-align:right;font-size:14px;line-height:8px}.fxs-part-collectionpart-rollup-container{margin:-6px 0 6px}.fxs-part-collectionpart-rollup-count{font-size:30px;line-height:30px;letter-spacing:-.025em}.fxs-part-collectionpart-rollup-label{font-family:az_ea_font,wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:15px;line-height:15px;letter-spacing:-.02em;margin-left:4px}.fxs-part-collectionpart-part-title{font-family:az_ea_font,wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe UI","Segoe WP",Tahoma,Arial,sans-serif;font-size:10px;line-height:10px;text-transform:uppercase;margin:5px 0 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:none}.fxs-part-collectionpart-rollup-icon{width:21px;height:21px;margin-left:4px;display:inline-block}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:block;margin:0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label{display:none}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count{line-height:25px}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count{width:30px;height:30px;margin-left:0}.fxs-tilesize-mini .fxs-part-collectionpart{text-align:center;padding:5px 6px 0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-part-title{display:block}.fxs-tilesize-small .fxs-part-collectionpart{float:right;margin-top:-15px}html[lang^=ja] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=ko] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=zh] .fxs-part-collectionpart .fxs-part-collectionpart-part-title{font-size:11px;line-height:11px}')}
(r||(r={})),r});define("MsPortalImpl/Parts/Parts.Collection",["require","exports","f","./Parts","../../_generated/Less/MsPortalImpl/Parts/Parts.Collection.css"],function(n,t,i,r){"use strict";var u;return function(n){var e=i.Parts.PartSize,t="fxs-part-collectionpart",o=t+"-rollup-forceshow",s=t+"-rollup-container",h=t+"-rollup-count",c=t+"-rollup-label",u=t+"-rollup-icon",f=t+"-no-rollup-count",l=t+"-part-title",a=t+"-more-data",v='<div class="'+t+'" data-bind="css: {\''+o+"': alwaysShowRollupCount()}\">"+('<div class="'+s+'">')+('<span class="'+h+'" data-bind="text: rollupCount, visible: !noRollupCount()"><\/span>')+('<span class="'+c+'" data-bind="text: rollupCountLabel"><\/span>')+('<img class="'+u+'" data-bind="attr: { src: rollupCountIconUri }, visible: rollupCountIconUri, css: {\''+f+'\': noRollupCount }" alt=""/>')+('<div class="'+u+'" data-bind="image: rollupCountIcon, visible: rollupCountIcon, css: {\''+f+"': noRollupCount }\"><\/div>")+('<h4 class="'+l+'" data-bind="text: _partTitle"><\/h4>')+
'<\/div><!-- ko if: !!gridMode() --><div data-bind="pcGrid: grid" class="msportalfx-removepartpaddingside"><\/div>'+('<div class="'+a+'" data-bind="visible: hasMoreData">...<\/div>')+"<!-- /ko --><\/div>",y=function(n){function t(t,i,r,u){n.call(this,t,i,r,u);this.template=v;this._$partTitle=$(t).findByClassName("fxs-part-title")}return __extends(t,n),t.prototype._getContentForBinding=function(n,t){var i=this;return ko.reactor(n,function(){var n=t.content.size();t.container.partTitle();i._$partTitle.toggle(n!==e.Mini)}),$.extend({},t.content,{_partTitle:t.container.partTitle})},t}(r.PartImpl);n.CollectionPart=y}(u||(u={})),u});define("MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder",["require","exports","f","u","./UI.Composition.Part","./UI.Composition.PropertyBinding","./UI.Composition.CompositionBinder"],function(n,t,i,r,u,f,e){"use strict";var o;return function(t){function rt(n,t){var i=n.parent&&n.getPartsContainer(),f=i&&i.getCompatibleSourceReferences&&i.getCompatibleSourceReferences.
bind(i),o=function(n){if(f){var t=f(n);return t&&t[0]}},e,u;return t=t||[],e=n.overridesModel,u=[],t.forEach(function(n){var i=n.name,t;t=r.getModelValue(e,i).exists?null:o(n);u.push(h(n,t))}),u}function p(n){if(n.adapter){var i=w(n),t={},r=b(n,!1);return r.forEach(function(n){var r,f=n.compositionBindingDefinition,u=f&&f.source,e;u&&u.modelType===v&&(e=u.property,r=i[e]);r||(r={bindingSources:[],activeBindingSourceName:null});t[n.targetProperty]=r}),t}return w(n)}function ut(n,t,i){var u=n.getSettingsModel(),f=n.getViewModel().internal,e=f.updatedConfiguration;e.subscribe(n,function(f){var l,v,o,h;t&&t(0);i(0);try{var w=f.inputs,a=f.settings,b=f.inputsMetadata,e=n.partDefinition&&n.partDefinition.partState,k=e?(e.inputIdentityProperties||[]).concat((e.sharedProperties||[]).map(function(n){return n.property})):[],d=Object.keys(a);k.forEach(function(n){var f=y(r.getModelValue(u,n).value),t=n.startsWith("content.")?n.slice(8):n,i=s(r.getModelValue(a,t).value);c.deepEquals(i,f)||(r.setModelValue(
u,n,i),l=!0);d.remove(t)});o=p(n);Object.keys(o).forEach(function(t){var i=o[t],r=b[t],u=w[t];et(n,t,i,r.activeBindingSourceName,u)&&(v=!0)});v&&(n.widgetState.valueHasMutated(),ft(n),n.save())}finally{h=l?2:1;t&&t(h);i(h)}})}function ft(n){var t=n.widget;t&&t.element.trigger(u.fxpartinputchanged,{part:n})}function h(n,t){var r=n,i=n,e=i.targetProperty||r.name,o=!!n.optional,f;return t||(f=i.source&&i.source.property||r.name,t=u.createOverridesOrContainerModelSourceReference(f)),{targetProperty:e,optional:o,source:t,isDynamicBinding:!0}}function w(n){var t=n.parent&&n.getPartsContainer(),i=t&&t.getCompatibleSourceReferences&&t.getCompatibleSourceReferences.bind(t),f=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,s=function(n){var r,t;return f&&i&&(t=f.first(function(t){return t.name===n}),t&&(r=i(t))),(r||[]).map(function(n){return{sourceReference:n,name:n.property,acceptsValueUpdates:!1}})},e=n.overridesModel,h=function(n){if(!n||u.isDynamicBindingWithNonLocalSource(
n))return!1;var t=n.source&&n.source.property;return e&&t&&r.getModelValue(e,t).exists},o={},c=b(n);return c.forEach(function(n){var r=n.targetProperty,u=s(r),t=n.compositionBindingDefinition,i=t&&t.source,f=!h(t)&&i&&(u||[]).first(function(n){var t=n.sourceReference;return t.modelType===i.modelType&&t.property===i.property});o[r]={bindingSources:u,activeBindingSourceName:f&&f.name}}),o}function b(n,t){return t===void 0&&(t=!0),n.getNonDetailsContainerPropertyBindings(t).filter(function(n){var t=n.targetProperty;return!tt.isBladeCallerInput(t)&&t!==k.EditScopeId})}function et(n,t,i,u,f){var p=u&&i.bindingSources.first(function(n){return n.name===u}),w,e,k,d,ut,ft,b,rt;if(u&&!p){a.error("Source with name '{0}' for configurable Part input named '{1}' does not exist at the Dashboard/Blade-level.".format(u,t));return}if(w=n.getInputPropertyBindings(),e=w.properties.first(function(n){return n.targetProperty===t}),p?(ut=i.activeBindingSourceName,p.name!==ut&&(k=!0)):(ft=y(r.getModelValue(e.targetModel,
e.targetProperty).value),c.deepEquals(s(f),ft)||(d=!0)),!(k||d))return!1;if(n.adapter){var et=n.bindings.first(function(n){return n.targetProperty===t}),g=et&&et.source,ot=g&&g.modelType===v&&g.property;if(ot)b=ot;else return a.error("For Adapted Part '{0}', input named '{1}' to the inner Part is not configurable.  Presently, only those inner Part inputs using the 'AdapterInput' binding are configurable.".format(n.toString(),t)),!1}else b=t;var nt=n.adapter?n.adapter.inputPropertyBindings:n.getInputPropertyBindings(),tt=nt.properties.first(function(n){return n.targetProperty===b}),st=tt.compositionBindingDefinition,ht=n.overridesModel,vt=n.containerModel,o;if(k){var ct=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,lt=ct.first(function(n){return n.name===b}),at=p.sourceReference;o=h(lt,at)}return d&&(r.setModelValue(ht,tt.sourceProperty,s(f)),o=h(st)),o&&(nt.removeProperty(tt),rt=n.adapter?n.adapter.bindings:n.bindings,it(rt,st),l.setupPropertyBindings(n,nt,[o],
n.bindAgainstOverridesOrContainerModel.bind(n)),rt.push(o),n.adapter&&(w.removeProperty(e),l.setupPropertyBindings(n,w,e&&[e.compositionBindingDefinition],n.bindAdaptedInput.bind(n)))),!0}var o=i.Base,k=o.Constants.BladeParameterNames,d=o.Diagnostics,c=o.Utilities,g=i.Extension,nt=g.ReferenceType,tt=i.ViewModels.Internal,l=e.CompositionBinder,r=f.PropertyBinding,it=i.remove,a=d.createLog(n),v=nt.AdapterInput,y=ko.unwrap,s=ko.toJS;t.inferInitialBindingsForInputDefinitions=rt;t.getConfigurableInputsMetadata=p;t.listenForConfigurationChanges=ut}(o||(o={})),o});define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration",["require","exports","f","i","../../ViewModels/ViewModels.BladeCaller"],function(n,t,i,r,u){"use strict";var f;return function(n){function h(n,t,i){var r={};ko.reactor(n,function(){var u=t.internal,f=u.registeredSelectables()||{},n=u.registeredSelectableOptions,o=Object.keys(f),s=Object.keys(r),h=o.filter(function(n){return!r.hasOwnProperty(n)}),p=s.filter(function(
n){return!f.hasOwnProperty(n)}),e;ko.ignoreDependencies(function(){h.forEach(function(t){e=c(t,n);var f=a(t,n),u=l(t,n);v(t,r,i,e,f,u.openInContextPane,u.persistentContextPane)});p.forEach(function(n){y(n,r)})})})}function c(n,t){var i=t&&t.peek(),r=i&&i[n];return r&&r.parameterCollector?"{0}.{1}.parameterCollector".format(s,n):null}function l(n,t){var r=t&&t.peek(),i=r&&r[n],u,f;return i&&(u=i.openInContextPane,f=i.persistentContextPane),{openInContextPane:u,persistentContextPane:f}}function a(n,t){var r=t&&t.peek(),u=r&&r[n],i;if(u)return i=u.bladePairOptions,i?{actionName:n,shouldHideMasterBlade:!i.showParent,canNavigateMaster:!1,windowed:!i.fullScreen}:null}function v(n,i,r,e,s,h,c){var p=r.getBladeOpener(),w=r.getPartSettingsManager(),l={invocationInputArguments:[{valuesFrom:[{referenceType:t.Part,property:o+"."+n}]}]},a,y,v;s&&$.extend(l,{pairInfo:s});h&&(l.openInContextPane=h);c&&(l.persistentContextPane=c);a=new f;e&&u.addBladeCallerBindings(e+".bladeCaller",l,t.Part);y=p.registerInvocationProperty(
l,null,a);v=y.viewStatePropertyAdditions;v&&v.forEach(function(n){w.registerInstanceStateProperty(a,n)});i[n]=a}function y(n,t){t[n].dispose();delete t[n]}var f=r.TriggerableLifetimeManager,e=i.Extension,t=e.ReferenceType,o="internal.registeredSelectables",s="internal.registeredSelectableOptions";n.listenForRegistrationChanges=h}(f||(f={})),f});define("MsPortalImpl/UI/UI.Initialize",["require","exports","f","i","../Base/Base.KnockoutExtensions.FxParameterCollector","../Base/Base.Router","../Base/Telemetry","../Base/Base.UriHelper","../Base/ClaimsIdentity","../CodeComponentSideLoad/CodeComponentSideLoadModels","../Controls/ControlBindings.Async","../Extension/DefinitionPreprocessor","../Extension/ExtensionMetadataSource","../GalleryPackage/GalleryPackageLoader","../GalleryPackage/GalleryPackageMetadataSource","MsPortalImpl/Resources/ImplScriptResources","../Interactions/Interactions.DismissHandler","../Interactions/Interactions.KeyboardShortcutHandler","../Base/Languages","../../MsPortalImpl.Controls/Controls/ResourceFilterHelper",
"../Services/Services.AssetTypes","../Services/Services.AzureStorage","../Services/Services.BrowseCurationEndpoints","../Services/Services.Controller","../Services/Services.FileUploadEndpointRegistration","../Services/Services.FileUploadInitialization","../Services/Services.GalleryEndpoints","../Services/Services.GeneralSettings","../Services/Services.FavoritesSettings","../Services/Services.PortalIdentity","../Services/Services.SharedSettings","../Services/Services.Storage","../Services/Services.PortalIdleState","../Services/Services.SecurityTokens","../Services/Services.SelectedSubscriptions","../Services/Services.Settings","../Services/Services.ShellProvisioner","../Services/Services.TelemetrySharing","../Services/Services.Util","../Base/Telemetry","./Hubs/UI.BrowseManager","./Hubs/ViewModels/UI.Browse.ViewModelRegistration","../UI/Compositions/UI.Composition","./Compositions/UI.Composition.Services","./UI.DesktopManager","./UI.DesktopManagerImpl","./Hubs/UI.FavoritesManager","./Hubs/ViewModels/UI.Gallery.ViewModelRegistration",
"./Hubs/UI.HubsRpcCallbacks","./Hubs/UI.ResourceMapManagerRpc","./Hubs/ViewModels/UI.Settings.ViewModelRegistration","./UI.StatusHandler","./UI.ViewTimeTelemetry","../Extension/ViewModelManager","../Widgets/Widgets.Portal","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Parts/Parts.ButtonPart","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration"],function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,
wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai){"use strict";var vi;return function(t){function rr(n,t){t&&t.startsWith("#")&&n.route(t)}function fe(n,t,i){return[n,t].forEach(function(n){var t=n.length;if(t!==1)throw new Error("Unexpected length '"+n.selector+"': "+t);}),new nf(n,t,i)}function ee(){sr.FeatureAdoption.logFeatureAdoptionTelemetryEndpoint.register(hr.client,null,function(n,t){n&&e.traceFeatureAdoption(n.name,t.srcWindowId||"fx",n,n.status)})}function oe(n){try{n()}catch(t){}}function tf(){return fr("./UI.Portal.Actions",n)}function rf(n,t){return Q().then(t).catch(function(n){wr.error(n)}).then(function(){return n.getCodeComponentsMetadata()})}function se(n){var i=bi.performance,o,s;if(n&&i&&i.getEntriesByType&&i.timing){var f=uu(),r=function(n,t,r){hu(n,{duration:t,endTime:Math.round(r+i.timing.navigationStart)})},e=i.getEntriesByType("resource").filter(function(n){var t=n.initiatorType;return t==="link"||t==="script"}),u=e.reduce(function(n,t){return Math.min(t.
startTime,n)},Infinity),t=e.reduce(function(n,t){return Math.max(t.responseEnd,n)},0),h=t-u,c=t;u=Math.max(u,n);t=Math.min(t,f);o=t-u;s=f-o-n;r("TotalTimeToSplashScreen",n,n);r("TotalStartupResourceDownload",h,c);r("StartupResourceDownload",o,t);r("StartupScriptExecution",s,f);ar.traceResourceDownloads(e,"Redirect_InitialTiming",!0)}}function hu(n,t){t=t||{};var r=t.duration||uu(),i=t.data||{};return i.cdn="CdnIndex"+br.index,i.bundling="Bundling"+br.bundling,ii({timestamp:t.endTime,source:yi,action:n,actionModifier:ir.ActionModifier.Complete,duration:r,data:i}),r}function he(n,t){var i=n.getValue(bu,wu,ku);return t!==i&&n.setValue(bu,wu,t,ku),i}function ce(){li.registerPrefix(l.PinVMPrefix,"./MsPortalImpl/Extension/PinBladeInferred",function(n,t,i,r){return n.createViewModel(t,i,r)})}var sr=r,uf=sr.Data,cu=sr.Extension,ff=sr.TriggerableLifetimeManager,nr=i.Base,gr=nr.Constants,ef=gr.ExtensionNames,nu=nr.Diagnostics,ir=nu.Telemetry,di=nr.EventTypes,ar=nr.Internal.Diagnostics.Net,of=nr.
Resources,hr=nr.Rpc.Internal,sf=nr.Utilities,lu=i.Hubs.Notifications.NotificationStatus,hf=i.Services,cf=i.ViewModels.ParameterCollection.Internal,cr=yt.SettingStore,tu=gr.DefaultCloudName,au=nr.Net2,vi=kt.Action,vr=kt.Source,vu=i.Helpers,er=MsPortalImpl.Performance,iu=nr.UriBuilder,bi=window,ru=bi.fx,uu=ru.getTimestamp,le=ru.early,ii=ir.trace,yi=vr.Shell,pi=ru.environment,ur=pi.links,ki=vr.TopBar,fr=i.require,lr="/",gi="true",lf=i.ensureSuffix,af=i.pathJoin,yr=lf(of.getAppRelativeUri(lr),lr),or=jQuery,fu=bi.console,vf=or(bi.document),tr=bi.location,wi=pi.features,pr=p.Shell,yf=p.Controls.FileUpload,wr=nu.createLog(n),pf=yr+"SignOut",wf=yr+"signin/index",bf=pi.errorPageUri,yu=pi.isDevelopmentMode,kf=wi.hideavatartenant===gi,df=5e3,gf=yu?3e4:5e3,ne=wi.consoletelemetry===gi,ae=or("body"),pu=wi.showbugreportlink,te=1e4,ie=wi.ldnstrace===gi,wu="loadedPageVersion",bu=ct.ComponentName.Telemetry,ku=ct.Lifetime.Default,br=pi.cdn,re=i.forEachKey,eu=ko.observable,ue=ko.observableArray,kr=ir.startTrace,
dr=ir.completeTrace,du=st.getSignedInUser,gu="MsPortalImpl/Base/Base.DiagnosticsPopup",ou=wi.waitforpendingchanges===gi,su,nf;au.setAjaxLogFunc(wr.warning.bind(wr));t.routeIfHash=rr;t.create=fe;nf=function(){function t(n,t,i){this._lifetime=new ff;this._disposed=!1;this._dependencies=i;this._element=n;this._$splashScreen=t;this._idleSvc=lt.createInstance()}return t.prototype.initialize=function(){var e=this,l=this._lifetime,kt=this._$splashScreen,sr=Q.defer(),ru=i.memoize(function(){return ti.getDialogManagerModule().then(function(n){return n.getOrCreate(e._idleSvc)})}),li=function(n,t){return e._redirect({uri:n,skipFlushBuffers:t})},lt=this._dependencies,ct=lt.settings,p=lt.extensionManager,df=lt.extensionsMetadata,ke=df&&df.map(function(n){return h.ExtensionMetadataExt.create(n)}),nr=lt.storageService,ff=new iu(tr.href),fe=ff.query,it=at.extractAndClearAuthState(),vu,le=function(n,t,i){var r=new iu(n+tr.search+(i||"")),u=br.forceIndex,f=r.query;u&&f.setParameter(br.indexParameter,u);
t&&re(t,function(n,t){return f.setParameter(n,t)});li(r.toString())},wu,bu,pe,we,be;if(l.registerForDispose(ru),!it){le(yr,{reAuth:gi},tr.hash);return}wu=!1;it.createdOn||(it.createdOn=Date.now(),wu=!0);it.hash&&(tr.hash=it.hash,it.hash="",wu=!0);wu&&at.updateAuthState(it);pi.enableAnimations||or.enableAnimations(!1);wi.relexflighting!==gi||fe.getParameter("feature.relex")||(ii({action:vi.RelexOnReloadSet,source:yi}),vu=bi.setTimeout(function(){fe.setParameter("relexonreload",gi);f.history_replaceState(null,vf[0].title,ff.toString())},Math.max(0,te-uu())));bu=this._idleSvc;ir.initialize(yi,!0);ee();et.init(ct);ot.init(ct);vt.init(ct);var ae,ku=hi.create(ru,lt.extensionVersionCache,sr.promise,function(n){e._redirect(n)},function(){ae&&ae.mode(0)},function(){kt.show()},function(n,t){e._notificationManager.addClientNotification({title:n,description:t,status:lu.Information,timestamp:new Date,correlationIds:[sf.newGuid()],asset:null,cloudName:tu})}),de=function(n,t){return ku.onLastTokenRefresh(
n,t)},ge=function(n){ku.onStatus({code:2},n)},no=function(){ku.onStatus({code:5},gr.Shell)},ve=function(n,t){ku.onStatus(n,t)},nf=at.createSecurityTokensManager(at.createOAuthTokenProvier(it),de,ge),of=a.initializeTestExtension(ke,ct,nr,ru,kt),t,lf=eu(),af=ue(),to=new ft.GalleryEndpointsService(hr.client,p,of),ye=function(n){return n.getDiagnosticsData(t,lf,af,nf)},yf=function(){return i.require(gu).then(function(n){var t=ye(n);n.showDiagnosticsPopup(t)})};return uf.registerTelemetrySubmissionHandler(),ar.registerTelemetrySubmissionHandler(),cf.ProvisioningTelemetry.registerTelemetrySubmissionHandler(),au.status.subscribe(function(n){ve(n,yi)}),ir.addProcessor(wt.getProcessor(p)),ne&&(pe=hf.getConsoleTelemetryEventProcessor(),ir.addProcessor(pe)),MsPortalEarly.initializedTelemetry(ii.bind(ir)),se(er.splashScreenLoadTime),we=kr({source:yi,action:"InitializeGeneralSettings"}),be=rf(of,function(){return of.registerTestExtensionsFromUri(tr.href)}),et.processor.initialized.then(function(n){
var t=k.initialize(l,nr,n.rawLocale);return t&&(ou=!1,li(t,!0)),n}).then(function(f){function pe(n,t){ii({source:ki,action:t});rr(et,n)}function ne(n){return s.getAvatarImage(ci.avatarUri,ci.defaultAvatarUri,nr,n)}function lu(){return ou.currentTheme().name}var uf,sf,gr,rt,ir,wt,er,iu,hi,hf,cf,h,ft,et,vf,ee,uu,a,ou,wr,au,wu,vt,ku,te,re;dr(we);ii({source:yi,action:vi.PortalInitializeLanguage,data:{language:k.currentLocaleContext.selectedDisplayLanguage,formatCulture:k.currentLocaleContext.selectedFormatCulture?k.currentLocaleContext.selectedFormatCulture:k.currentLocaleContext.selectedDisplayLanguage}});uf=kr({source:yi,action:"GetExtensionMetadata"});st.initialize(it.user);var ci=du(),br=ci.tenantId,of=yt.queryStores(ct,[cr.JourneySession,cr.Startboard,cr.CrossTenant]);oe(function(){pi.suppressMicrosoftBrowserMessage||fu.log(pr.buildThisLong);fu.log(pi.version);fu.log("Session: "+pi.sessionId)});sf=st.getTenants();gr=eu(!1);w.initialize();l.registerForDispose(function(){w.dispose()});rt=
new ai.Widget(e._element,new ai.ViewModel);l.registerForDispose(rt);t=ti.initialize(l,lt,f,gr,rt,li,ru);c.initialize(t);ir=t.assetManager.assetMruList;ir.initialSettingsSyncPromise.then(function(){return p.initialManifestsLoadPromise()}).then(function(){p.pinExtensions(ir.mruList().map(function(n){return n.extension}).unique().slice(0,3))});wt=t.desktop;d.initialize(t.assetTypeService,l);er=Q(st.getSubscriptions());er.then(function(n){lf(n);gr((n&&n.subscriptions||[]).some(function(n){return n.requireRdfe}))}).done();e._notificationManager=t.notificationManager;cu.extensionStatusEndPoint.register(hr.client,null,function(n,t){n&&ve(n,t.srcWindowId)});iu=rt.options;hi=iu.topBar;hi.exitDevMode=function(){kt.show();MsPortalImpl.Extension.unregisterAll().then(function(){li(yr)})};hf="72f988bf-86f1-41af-91ab-2d7cd011db47";hi.canReportBug(pu==="force"||pu===gi&&br===hf);hi.reportBug=function(){tf().then(function(n){return i.require(gu).then(function(i){return n.reportBug(t,function(){return ye(
i)},ff)})})};h=iu.sideBar;ft=ui.createFavoritesManager(t);ft.favorites.subscribe(function(n){h.favorites(n)});ft.possibleFavorites.subscribe(function(n){h.possibleFavorites(n)});ft.categories.subscribe(function(n){h.categories(n)});ft.showCategories.subscribe(function(n){h.showCategories(n)});h.selectedCloud.subscribe(function(n){ft.selectedCloud(n)}).callback(h.selectedCloud());et=t.router;h.addFavoriteToSettings=ft.addFavoriteToSettings;h.moveFavorite=ft.moveFavorite;h.removeFavoriteFromSettings=ft.removeFavoriteFromSettings;h.launchBlade=function(n){et.route(n)};vf=be.then(function(n){g.setCloudNames(n.map(function(n){return n.cloudName}).unique());h.cloudOptions(g.getCloudNames().map(function(n){var t=cu.normalizeCloudName(n);return{text:eu(t),value:t}}));nf.registerGetAuthorizationTokenEndpoint(n);st.initializeRpc(n);ht.initializeRpc();tt.initializeRpc();nt.registerSasEndPoint();bt.registerEndPoints(t.desktop);dr(uf);cf=kr({source:yi,action:"DesktopAndExtensionManagerInitialize"});
p.initialize({extensions:n,useCachedManifests:!0,onRelexDisconnected:no});var i=y.initializeTestGalleryPackage([],t,kt);return rf(i,function(){return i.registerTestGalleryPackagesFromUri(tr.href)}).then(function(t){var u=n.some(function(n){return n.isTestExtension||n.isTestStamp}),f=t&&t.length>0,o=v.initialize(p),i,r;return o.loadGalleryPackages(t),hi.inDevMode(u||f),e._notificationManager.listenForClientNotifications(),i=n.filter(function(n){return n.startBoardParts&&n.startBoardParts.length>0}).map(function(n){return p.getManifestByName(n.name,n.cloudName)}),r=Q.any([Q.allSettled(i),Q.delay(gf)]),wt.initialize(n,of),Q.allSettled([r,wt.initializationPromise,p.getHubsExtension()])})}).then(function(){var t,n;er.then(function(n){var t=n.subscriptions.length>0;ir.initialSettingsSyncPromise.then(function(){ot.processor.initialized.then(function(n){var i=n&&n.favorites&&n.favorites(),r=i&&i.length&&JSON.parse(i);ii({source:vr.SideBar,action:"SideBarSettings",data:{collapsed:f.sideBarCollapsedKey(
),favorites:r,favoritesCount:r.length}});ft.initialize(n,t)})})});dr(cf);t=kr({source:yi,action:"SetupInitialRoute"});et.initialRoute();dr(t);kt.hide();vu&&(bi.clearTimeout(vu),vu=null);var i=new o.Uri(bi.location.href),e=i.isHashEmpty()?"TotalTimeToStartBoardReady":"TotalTimeToDeepLinkReady",r=pi.pageVersion,u=he(nr,r);hu(e,{data:{locationHash:i.hash,loadedSameVersion:r===u}});n=lt.cdnFailedIndex;su=hu("TotalTimeToPortalReady",{data:{cdnFailed:n&&"CdnFailedIndex"+n,previousVersion:u||""}});ar.traceDocumentNavigation()}).then(function(){e._idleHandle=bu.addCallbacks({onIdle:function(){a.avatarImage(ne(!0));wi.prefetch!=="false"&&fr("MsPortalImpl/Services/Services.PortalPrefetch").then(function(n){n.start(l,bu,nr,su)});pi.useCachedManifests&&p.refreshManifests().catch(function(){});ie&&fr("ldns");bu.removeCallbacks(e._idleHandle)},onBusy:or.noop})});vf.then(function(){if(!p.isRelexEnabled())return Q.delay(5e3)}).then(function(){if(!e._disposed){var n=(wi.pinnedextensions||"").split(",").
map(function(n){return n.trim()}),t=ef.Websites.toLowerCase(),i=p.getExtension(t,tu);return i&&i.useRelex()&&!n.some(function(n){return n.toLowerCase()===t})&&n.push(t),p.pinExtensions(n)}}).then(function(){ut.init(ct)}).then(function(){of.then(function(n){var t="userDefaultDirectory",i=n[cr.CrossTenant],r=i&&i[t];r!==br&&ct.setSetting(cr.CrossTenant,t,br)})});g.setupAssetTypeServiceRpc(t);oi.setupResourceMapManagerRpc(hr.client,t);var ue=t.contextPane,fe=rt.getNotificationMenuWidget().getToastWidget(),bf=function(){return t.getService("FeedbackPane")};if(wt.initializationPromise.finally(function(){sr.resolve(null)}),ee=pt.ShellProvisionerFactory.create(t),nu.ErrorReporter.initialize(function(){ri.logDiagnosticsData()}),u.initialize(wt,t),wi.feedback===gi){r.feedbackEndPoint.register(hr.client,null,function(n,t){bf().then(function(i){i.amdModule.toggleResourceDeletedPane(i.widget,t.srcWindowId,n)})});rt.element.on(di.fxcreateabandoned,function(n,t){bf().then(function(n){n.amdModule.toggleCreateAbandonedPane(
n.widget,t)})})}if(e._initializeTopBar(rt,t,er,h.selectedCloud),wi.nps===gi){var df=f.npsTimeMs,se=Date.now()-7776e6,ae=df()<se&&Math.random()<.01;ae&&tf().then(function(n){return n.showNpsSurvey(fe,df)})}uu=rt.getAvatarMenuWidget();a=uu.options;a.userIdentity(ci);a.hideTenant(kf);st.getUserInfo().then(function(n){a.userInfo(n)});sf.done(function(n){af(n);a.listOfTenants(n)});a.showDiagnostics=yf;a.signedOut=function(){at.updateAuthState(null);li(pf)};a.openAccountPortal=function(){var n=ur.accountPortal;pe(n.startsWith("#")?n:n+"subscriptions",vi.AvatarMenuOpenBilling)};a.avatarImage(ne());ou=t.themeManager;ii({source:yi,action:vi.SelectedTheme,data:lu()});rt.element.on(di.fxrotatetheme,function(){var t=lu(),n;ou.rotateTheme();n=lu();ii({source:yi,action:vi.RotateTheme,data:{fromTheme:t,toTheme:n}})});h.saveCollapseState=function(n){f.sideBarCollapsedKey(n)};a.giveFeedback=function(){ii({source:ki,action:vi.AvatarMenuOpenFeedback});rr(et,ur.giveFeedback)};a.showMyAccessBlade=function(
){ii({source:ki,action:vi.AvatarMenuOpenAccessDetails});rr(et,ur.accessDetails)};a.switchedTenant=function(n,t){var i=o.getHashQueryStringSegment(tr.href);le(wf+lr+t.tenant.domainName,null,"#"+i)};wr=i.memoize(function(){return fr("../Base/Base.DebugInfo",n).then(function(n){return n.initialize(l,t)})});(yu||pi.clientOptimizations&&pi.clientOptimizations!=="true"||wi.canmodifyextensions)&&wr().then(function(n){return n.startErrorDetection(l)});l.registerForDispose(wr);au=b.setup(rt,t,yf,function(){wr().then(function(n){return n.toggleStickys(su)})});l.registerForDispose(au);e._initializeHelpMenu(rt,et,yf,au,ue);!wi.nodirectory||uu.getDropMenuWidget().show();wu="data-click-telemetry";vt=rt.element[0];vt.addEventListener(di.mousedown,re=function(n){ku=n.target},!0);vt.addEventListener(di.mouseup,te=function(n){var i=ku,r,t;if((ku=null,n.target===i)&&(r=or(i),t=r.closest("["+wu+"]",vt),t.length)){var e=t.attr(wu)+"",u=t.closest(".fxs-tile",vt).data(ni.CompositionInstanceDataName),f=u&&u.locator,
o=f&&f.toFriendlyString()||yi;ii({source:o,action:vi.CustomClick,name:e})}},!0);l.registerForDispose(function(){vt.removeEventListener(di.mousedown,re,!0);vt.removeEventListener(di.mouseup,te,!0)});t.browseManager.initialize();gt.registerViewModels(t);fi.registerViewModels();si.registerViewModels({portalServices:t,securityTokensManager:nf,subscriptions:lf,tenants:af});ei.registerRpcCallbacks(t);ce();dt.subscribeToMruItems(t);dt.registerRpcEndpoints(t)}),sr.promise.then(function(){ci.start(t)}).then(function(){function i(n,t){wr.error("Injecting untrusted content : {0} from {1}".format(t,n));ii({source:yi,action:"UntrustedSource",data:{src:n,type:t}})}function t(t){var r=t.src,u=t.tag,f=r!=="document.write",e,o,s;return f&&(u==="SCRIPT"||u==="IFRAME")&&(e=document.createElement("a"),e.href=r,r=e.href,o=/(.*?)[#\?]|$/.exec(r)[1]||r,s=!!n.filter(function(n){return!!~o.indexOf(n||null)}).length,f=!r||s||i(r,u)&&!1),f}var n=er.allowList=er.allowList.concat(bi.fx.environment.cdnPrefixes);n.push(
bi.location.host);n.push("about:blank");er.sourceLogger=t;er.sourceBacklog.forEach(t)}),l.registerForDispose(ci.stop),nf.initializeSecurityForShell(it),rt.registerFileUploadEndpoints(),ut.uploadSettingsManager=ct,sr.promise.then(er.pageLoaded).catch(function(){e._redirect({uri:bf+"/LoadFailed"})})},t.prototype.dispose=function(){var n,t;this._disposed=!0;n=this._idleSvc;n&&(n.dispose(),this._idleSvc=null);sr.GlobalStateManager.resetGlobalState();t=this._lifetime;t&&(t.dispose(),this._lifetime=null);ar.resetTelemetryTimer();at.writeAuthState()},t.prototype.beforeUnload=function(){var u=this,n=[],t,r,i;return ou&&(t=it.flush(this._dependencies.settings),r=t.isPending(),t.then(function(){var n=u._notificationManager;n&&n.addClientNotification({title:pr.customizationsSavedLabel,description:pr.customizationsSavedDescription,status:lu.Success,timestamp:new Date,cloudName:tu})}),r&&n.push(pr.waitForPendingChangesMessage)),i=ut.hasFileUploads,i&&i()&&n.push(yf.unloadInfo),n.length?n.join("\n\n"):
void 0},t.prototype._flushBuffer=function(){var n=vu.Deferred();return it.flush(this._dependencies.settings).finally(function(){n.resolve()}),bi.setTimeout(function(){n.resolve()},df),n.promise()},t.prototype._redirect=function(n){var t=n.uri,i=vu.Deferred();this._$splashScreen.show();ii({source:yi,action:vi.PortalRedirect,actionModifier:kt.ActionModifier.Redirect,data:t});n.skipFlushBuffers?i.resolve():this._flushBuffer().finally(function(){ou=!1;i.resolve()});(n.delayPromise||Q.resolve(null)).finally(function(){i.finally(function(){if(!t){var n=new iu(tr.href);n.path=af(lr,n.path,du().tenantId,lr);t=n.toString()}tr.href=t})})},t.prototype._initializeHelpMenu=function(n,t,r,u,f){var o=n.getHelpMenuWidget(),e=o.options,s=i.memoize(function(){return fr("MsPortalImpl/Widgets/Widgets.KeyboardShortcutsPane").then(function(n){return new n.Widget(f,u.getShortcutsHelpViewModel())})});e.openKeyboardShortcutsPane=function(){s().then(function(n){ii({source:ki,action:vi.HelpMenuOpenKeyboardShortcuts});
n.toggle()})};e.openHelpAndSupport=function(){ii({source:ki,action:vi.HelpBladeOpen});rr(t,ur.helpAndSupport)};e.openSupportRequestBlade=function(){ii({source:ki,action:vi.HelpMenuOpenSupportRequest});rr(t,ur.createSupportRequest)};e.openManageSupportRequestsBlade=function(){ii({source:ki,action:vi.HelpMenuOpenManageSupportRequest});rr(t,ur.manageSupportRequests)};o.options.openPrivacyAndTerms=function(){ii({source:ki,action:vi.HelpMenuOpenLegal});rr(t,ur.privacyAndTerms)};e.showDiagnostics=function(){r()}},t.prototype._initializeTopBar=function(n,t,r,u){var e=this._lifetime,s=this._notificationManager,a=i.memoize(function(){return fr("MsPortalImpl/Widgets/Widgets.SettingsPane").then(function(n){var i=new n.ViewModel;return new n.Widget(or("<div/>"),i,t,r)})}),f,l;e.registerForDispose(a);var o=n.getTopBarWidget(),h=n.getSearchWidget(),v=n.getSideBarWidget(),c=n.getNotificationMenuWidget();o.element.on(di.fxsettingsbuttonclick,function(){a().then(function(n){ii({source:vr.TopBar,action:
vi.SettingsPaneOpen});n.toggleSettingsContextPane()})});o.options.feedbackButtonClick=function(){t.getService("FeedbackPane").then(function(n){var t=n.widget;ii({source:ki,action:vi.FeedbackSmileyClicked,data:{isPaneOpen:t.isVisible()}});t.toggleGeneralPane()})};var y=o.getBreadCrumbWidget(),p=o.options.journeysMenu,w=function(n){return fr("MsPortalImpl/Widgets/Widgets.SharedOptionsInit").then(function(t){n(t)})};h.initOptions(function(){return w(function(n){n.initSearchWidgetOptions(e,h,t,u)})});v.initOptions(function(){return w(function(n){n.initSideBarWidgetOptions(e,v,t)})});f=t.desktop;p.activateJourney=function(n){ii({source:ki,action:vi.JourneyActivated,journeyId:n});f.activateJourney(n)};y.element.on(di.fxbreadcrumbclick,function(n,t){f.activeJourney().goToBlade(t.bladeId)});p.discardJourney=function(n){ii({source:ki,action:vi.JourneyDiscarded,journeyId:n});f.tryDiscardJourney(n)};f.populateJourneysInJourneysMenu();ko.reactor(e,function(){var n=f.activeJourney();h.options.journeysShown(
!!n);y.options.breadCrumbs(n?n.getBreadCrumbs():[])});c.register(s.notifications);c.element.on(di.fxnotificationclickinmenu,function(n,t){s.handleNotificationClick(t)});if(l=c.getToastWidget(),l)l.element.on(di.fxtoastclick,function(n,t){s.handleNotificationClick(t)})},t}()}(vi||(vi={})),vi});define("MsPortalImpl/Init",["require","exports","f","./Base/Base.Router","./Extension/ExtensionManager","./Extension/Extension.Manifest","./Services/Services.PortalIdentity","./Services/Services.EditScopeManagement","./Services/Services.Settings","./Base/Telemetry","./UI/UI.Initialize","./Services/Services.Storage","../_generated/Less/MsPortalImpl/Base/Base.Images.css","../_generated/Less/MsPortalImpl/Widgets/HighContrastMode.css","../_generated/Less/MsPortalImpl/Themes/Themes.Universal.css"],function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a;return function(){function ot(n){var i={fx:t.version};n||b.getInitializedExtensions().forEach(function(n){i[n.name]=n.extension.getVersion()});at.custom("Session",
bt,kt++,dt,i)}var v=i.Base,ht=v.Diagnostics,ct=v.Rpc.Internal,lt=v.UriBuilder,g=l.ComponentName,h=window,t=h.fx.environment,at=ht.createLog(n),nt=t.cdn,vt=g.Cdn,yt=g.Redirect,tt=l.Lifetime.Session,it=i.ensureSuffix,pt=i.pathJoin,y="/",rt=new v.UriBuilder(h.location.href),w=rt.query,ut="flight.",wt=i.union(["pageVersion",nt.indexParameter,t.localeQueryStringParameterName],t.flightNames.map(function(n){return""+ut+n})),ft,p,a,et;w.removeParameters(wt);ft=Object.keys(w.getParameters()).filter(function(n){return i.startsWith(n,ut)});w.removeParameters(ft);r.history_replaceState(null,h.document.title,rt.toString());p=jQuery;a=l.create();nt.enabled||(et=a.clearValue(vt,"FailedIndex",tt));t.extensionUnloadTimeout>=6e4&&t.extensionUnloadTimeout<=6e5&&(ct.timeToDelayWindowUnload=t.extensionUnloadTimeout);var bt=1,kt=0,dt=a.clearValue(yt,"Referrers",tt)||"";ot(!0);h.setInterval(ot,36e5);var st=new f.ExtensionVersionCache(a),b=u.create(st),k=s.createUserSettingsManager(a),d=c.create(p("#web-container"),
p("body").find("> .fxs-splashscreen"),{storageService:a,settings:k,extensionManager:b,extensionVersionCache:st,editScopeManager:o.createEditScopeManager(k,b),extensionsMetadata:t.extensionsMetadata,hubsMetadata:t.hubsMetadata,openWindow:function(n){var t=h.open();return Q(n).then(function(n){if(n){var r=new lt(n),f=r.path,u=it(f,y);i.localeCompareIgnoreCase(u,it(location.protocol+"//"+location.host,y))||(r.path=pt(y,u,e.getSignedInUser().tenantId,y),n=r.toString())}t.location.href=n})},cdnFailedIndex:et});d.initialize();p(h).on("beforeunload",function(){return d.beforeUnload()}).on("unload",function(){k.dispose();d.dispose()})}(a||(a={})),a})